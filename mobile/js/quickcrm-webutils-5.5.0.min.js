var CurrentDate=new Date(),TimeZoneOffset=-CurrentDate.getTimezoneOffset()/60,date_format,datetime_format,time_format,sig_digits=2,number_separator="",decimal_separator=".",default_currency="",currency_digits=2,iOS=(navigator.userAgent.match(/(iPad|iPhone|iPod)/i)?true:false),app_languages={en:"en_us",fr:"fr_FR",it:"it_it",es:"es_es",sp:"es_es",ca:"CA_es",de:"de_de",nl:"nl_nl",ru:"ru_ru",zh:"zh_tw","zh-tw":"zh_tw","zh-hk":"zh_tw","zh-cn":"zh_cn","zh-sg":"zh_cn",lt:"lt_LT",pl:"pl_pl"};function GetServURL(){var b="http://www.quickcrm.fr/demo/quickcrm_demo/";if(!GetDemo()){var a=localStorage.getItem("SURL");if(a!==null&&a!==""){localStorage.setItem("SURL",a);b=a+(a.substr(-1)==="/"?"":"/")}}return b}function GetLogin(){var b="max";if(!GetDemo()){var a=localStorage.getItem("Susername");if(a!==null&&a!==""){localStorage.setItem("Susername",a);b=a}}return b}function GetPassword(){var b="max";if(!GetDemo()){var a=localStorage.getItem("Spassword");if(a!==null&&a!==""){localStorage.setItem("Spassword",a);b=a}}return b}function GetTrialCode(){var b="";if(!GetDemo()){var a=localStorage.getItem("Strial");if(a!==null&&a!==""){localStorage.setItem("Strial",a);b=a}}return b}function GetDemo(){var a=localStorage.getItem("SDemo");if(a==="0"){localStorage.setItem("SDemo",a)}return(a!=="0")}function OpenURL(a,b){if(mobile_app){return window.open(a,"_blank","location=no"+(iOS?(",closebuttoncaption="+sugar_app_strings.LBL_BACK+",enableViewportScale=yes,toolbarposition=top"):""))}else{if(b===undefined){b=""}$.mobile.changePage("#DownloadPage");$("#DownloadDiv").html('<iframe src="'+a+'" width="99%" height="800" allowtransparency="true" style="background: #FFFFFF;" ></iframe>');$("#DownloadPageTitle").text(b)}}function OpenURLinBrowser(a){window.open(a,"_system")}function OpenQuickCRM(){OpenURL("http://www.quickcrm.fr/mobile"+(GetLanguage().substr(0,2)==="fr"?"/fr":""),"QuickCRM")}function AppReload(){$("#LoginLoading").html("");if(mobile_app&&!iOS&&navigator.app!==undefined){navigator.app.loadUrl("file:///android_asset/www/app.htm")}else{document.location.href="index."+(mobile_app?"html":"php")+"?v="+Date.now()}}function GetLanguage(){var a=localStorage.getItem("QAppLanguage");if(a!==null&&a!==""){if(a!=="Auto"){return a}}try{var d,c;if(navigator&&navigator.userAgent&&(c=navigator.userAgent.match(/android.*\W(\w\w)-(\w\w)\W/i))){if(c&&c[1]){d=c[1]}}if(!d&&navigator){if(navigator.language){d=navigator.language}else{if(navigator.browserLanguage){d=navigator.browserLanguage}else{if(navigator.systemLanguage){d=navigator.systemLanguage}else{if(navigator.userLanguage){d=navigator.userLanguage}}}}if(d&&d.substr(0,2)!=="zh"){d=d.substr(0,2)}}if(!d){d="en"}}catch(b){d="en"}return d}function getAppLanguage(){var a=GetLanguage();return app_languages[a]===undefined?"en_us":app_languages[a]}function getMobileLanguage(){var b={en:"en_us",fr:"fr_FR",es:"es_es",ca:"CA_es",sp:"es_es",it:"it_it",de:"de_de",ru:"ru_ru",nl:"nl_nl",zh:"zh_tw","zh-tw":"zh_tw","zh-hk":"zh_tw","zh-cn":"zh_cn","zh-sg":"zh_cn",lt:"lt_LT",pl:"pl_pl"},a=GetLanguage();return b[a]===undefined?"en_us":b[a]}function getMobiscrollLanguage(){var a=getMobileLanguage().substr(0,2);if(a==="CA"){a="ca"}return a}function getSugarLanguage(a,e){var f=GetLanguage().substring(0,2),d;for(var b in a){var c=b.substring(0,2);if(c===f||(f==="es"&&c==="sp")){d=b;break}}if(d===undefined){d=e}return d}function QCreateId(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){var b=Math.random()*16|0,a=d=="x"?b:(b&3|8);return a.toString(16)})}Date.prototype.addHours=function(a){this.setTime(this.getTime()+(a*3600000));return this};Date.prototype.isDST=function(){var c=this.getTimezoneOffset(),b=new Date(),a=0;while(a<12){b.setMonth(++a);if(b.getTimezoneOffset()>c){return true}if(b.getTimezoneOffset()<c){return false}}return false};if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}function array_merge(d,c){return d.concat(c.filter(function(a){return d.indexOf(a)<0}))}function setMobiscrollDefaults(){var b="mmddy",d="hhiiA",a="mm/dd/yy",c="hh:ii A";if(date_format.indexOf("d")===0){b="ddmmy";a="dd/mm/yy"}if(time_format.indexOf("A")===-1){d="HHii";c="HH:ii"}$.mobiscroll.setDefaults({dateFormat:a,dateOrder:b.replace("dd","D dd"),timeFormat:c,timeWheels:d})}Number.prototype.formatNumber=function(k,g,e){var h=this,k=isNaN(k=Math.abs(k))?2:k,g=g==undefined?".":g,e=e==undefined?",":e,f=h<0?"-":"",b=parseInt(h=Math.abs(+h||0).toFixed(k))+"",a=(a=b.length)>3?a%3:0;return f+(a?b.substr(0,a)+e:"")+b.substr(a).replace(/(\d{3})(?=\d)/g,"$1"+e)+(k?g+Math.abs(h-b).toFixed(k).slice(2):"")};Number.prototype.formatCurrency=function(f,e,a,b){return b+this.formatNumber(f,e,a)};Number.prototype.formatPercent=function(e,b,a){return(this*100).formatNumber(e,b,a)+"%"};function Record2NVL(a,c){var d={},b;function e(f){if(a[f]===undefined){d[f]={name:f,value:""}}else{d[f]={name:f,value:a[f]}}}if(c===undefined){for(b in a){e(b)}}else{for(b in c){e(c[b])}}return d}function NVL2Record(a){var c={},b;function d(e){if(a[e].value!==undefined){c[e]=a[e].value}}for(b in a){d(b)}return c}function getUserFormats(d){var b;if(d&&d.user_default_dateformat!==undefined){date_format=d.user_default_dateformat.value.replace("Y","yyyy").replace("m","mm").replace("d","dd");if(d.user_default_timeformat.value==="H:i"||d.user_default_timeformat.value==="H.i"){time_format="HH:ii"}else{time_format="hh:ii A"}if(d.user_decimal_seperator){number_separator=d.user_number_seperator.value;decimal_separator=d.user_decimal_seperator.value;default_currency=d.user_currency_name.value}}else{if(localStorage.getItem("date_format")!==null){date_format=localStorage.getItem("date_format");time_format=localStorage.getItem("time_format");if(localStorage.getItem("number_separator")!==null){number_separator=localStorage.getItem("number_separator");decimal_separator=localStorage.getItem("decimal_separator");default_currency=localStorage.getItem("default_currency")}}else{var a=GetLanguage();try{date_format=(a==="en")?"mm/dd/yyyy":jQuery.mobiscroll.i18n[a].dateFormat;time_format=(a==="en")?"hh:ii A":jQuery.mobiscroll.i18n[a].timeFormat}catch(c){date_format="mm/dd/yyyy";time_format="hh:ii A"}}}if(d&&d.fdow!==undefined){b=d.fdow;if(typeof b==="string"){b=parseInt(b,10)}localStorage.setItem("fdow",d.fdow);QCRM.calendar.firstDay=b}else{b=localStorage.getItem("fdow");if(b&&b!==""){b=parseInt(b,10);QCRM.calendar.firstDay=b}}localStorage.setItem("date_format",date_format);localStorage.setItem("time_format",time_format);localStorage.setItem("number_separator",number_separator);localStorage.setItem("decimal_separator",decimal_separator);localStorage.setItem("default_currency",default_currency);datetime_format=date_format+" "+time_format;setMobiscrollDefaults()}function toDBDate(b){if(b===null||b===""){return""}var c=b.getFullYear().toString(),d=b.getMonth()+1,a=b.getDate();d=((d<10)?"0":"")+d.toString();a=((a<10)?"0":"")+a.toString();return c+"-"+d+"-"+a}function toDBDateTime(c,e){if(c===null||c===""){return""}var b=new Date();b.setTime(c.getTime());if(e!==false){b=b.addHours(-TimeZoneOffset);if(!c.isDST()){b=b.addHours(1)}}var a=b.getHours(),d=b.getMinutes();if(a===0){a="00"}else{a=((a<10)?"0":"")+a.toString()}if(d===0){d="00"}else{d=((d<10)?"0":"")+d.toString()}return toDBDate(b)+" "+a+":"+d+":00"}function fromDBDate(a){return new Date(a.substring(0,4),parseInt(a.substring(5,7),10)-1,a.substring(8,10))}function fromDBDateTime(g,e){if(g.length<14){return new Date()}var b=g.substring(8,10),h=parseInt(g.substring(5,7),10),d=parseInt(g.substring(0,4),10),a=parseInt(g.substring(11,13),10),c=parseInt(g.substring(14,16),10),f=new Date(d,h-1,b,a.toString(),c,0,0);if(!e){f=f.addHours(TimeZoneOffset);if(!f.isDST()){f=f.addHours(-1)}}return f}function checkDateTimeString(a){return true}function checkDateString(a){return true}function HTMLDecode(a){return jQuery("<div></div>").html(a).text()}function maxDate(f,e){if(!f){return null}var a=parseInt(f.substring(8,10),10),d=parseInt(f.substring(5,7),10)-1,c=parseInt(f.substring(0,4),10),b=new Date(c,d,a,0,0,0);b.setDate(b.getDate()+e);return b}function ValidDate(g,f){if(g!==null&&g!==""&&g!=="err"){var b=parseInt(g.substring(8,10),10);var e=parseInt(g.substring(5,7),10)-1;var d=parseInt(g.substring(0,4),10);var c=maxDate(g,f);var a=new Date();return(c>a)}else{return false}}function DisplayDate(b){var a=getMobileLanguage().substr(0,2);return jQuery.mobiscroll.formatDate((a==="en"||jQuery.mobiscroll.i18n[a]===undefined)?"mm/dd/yyyy":jQuery.mobiscroll.i18n[a].dateFormat,b)}function getAppString(b,a){return b.replace("@",a)}function CheckSOLicense(b,e,a){var d=false,c;if(Math.floor(Math.random()*15)!==8){e();return}if(QCRM.outfitterspackage==12){c="7dbcf9ea95e3f5be3cd6d360099e4eac"}else{c="1e2d915c00ebc72e5a1a6246e502e5cc"}setTimeout(function(){if(d===false){e()}},3000);$.ajax({url:"https://www.sugaroutfitters.com/api/v1/key/validate?public_key="+c+"&key="+b,dataType:"json",type:"get",async:false,success:function(g,h){try{console.log(g)}catch(f){InitApp(2)}}})}function ccc(c,g,h,b,e){function a(){var i=false;setTimeout(function(){if(i===false){h()}},3000);$.ajax({url:"https://www.quickcrm.fr/licenses/"+g+"/getcode.php?code="+c+"&url="+QuickCRMAddress,dataType:"text",type:"get",async:false,success:function(l,m){try{var j=l.split(";");i=j[0];if(j[1]){QCRM.MaxUsers=parseInt(j[1],10)}if(e||ValidDate(i,f)){localStorage.setItem("L"+c+"Start",i);localStorage.setItem("L"+c+"Max",QCRM.MaxUsers);h()}else{localStorage.setItem("L"+c+"Start",(i==="")?"err":"exp");b()}}catch(k){InitApp(2)}}})}var d=localStorage.getItem("L"+c+"Start"),f=(g==="trial"?15:366);if(d!==null&&d!==""&&d!=="err"&&d!=="exp"){if(e||ValidDate(d,f)){QCRM.MaxUsers=parseInt(localStorage.getItem("L"+c+"Max"),10);h()}else{a()}}else{a()}}function isPro(b){var a=false;if(QCRM.sugaroutfitters){return true}if(QProKey===""){if(ValidDate(QInDt,7)){$("#HomeWarning").append("<em>"+getAppString(RES_LIC_MAX,DisplayDate(maxDate(QInDt,7)))+"</em>");return true}else{$("#HomeWarning").append("<em>"+RES_NO_LIC+". "+(mobile_app?RES_PRO_VERSION:"")+"</em>");return false}}else{ccc(QProKey,"licenses",function(c){var d=localStorage.getItem("L"+QProKey+"Start"),e=false;if(d==null){e=true}else{if(!b&&!ValidDate(d,355)){$("#HomeWarning").append("<em>"+getAppString(RES_LIC_WILL_EXP,DisplayDate(maxDate(d,366)))+"</em>");e=true}else{e=(Math.floor(Math.random()*15)===8)}}if(e){delete localStorage["L"+QProKey+"Start"]}a=true},function(c){if(localStorage.getItem("L"+QProKey+"Start")==="exp"){$("#HomeWarning").append("<em>"+RES_LIC_EXP+". "+(mobile_app?RES_PRO_VERSION:"")+"</em>")}else{$("#HomeWarning").append("<em>Invalid license key. "+(mobile_app?RES_PRO_VERSION:"")+"</em>")}a=false},b)}return a}function b64toBlob(l,k,b){var f=atob(l);var g=f.length;var d=new ArrayBuffer(g);var j=new Uint8Array(d);var a;for(var e=0;e<g;e++){j[e]=f.charCodeAt(e)}try{a=new Blob([j.buffer],{type:k})}catch(c){window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;var h=new BlobBuilder();h.append(j.buffer);a=h.getBlob(k)}return a}function encodeObject(a){return btoa(unescape(encodeURIComponent(JSON.stringify(a))))}function decodeObject(a){return jQuery.parseJSON(decodeURIComponent(escape(atob(a))))}function encodeString(a){return btoa(unescape(encodeURIComponent(a)))}function decodeString(a){return decodeURIComponent(escape(atob(a)))}function SaveFile(e,d,f,c,b,g,a){if(typeof cordova!="undefined"){if(iOS){SaveDocumentIOS(e,d,f,c,cordova.file.dataDirectory,g,a)}else{SaveDocumentAndroid(e,d,f,c,window.TEMPORARY||window.applicationStorageDirectory||LocalFileSystem.TEMPORARY,g,a)}}else{a()}}function ReadDocumentAndroid(a,g,i,f,c,e){function d(j){if(e){e()}}function h(j){j.root.getDirectory(g,{create:false,exclusive:false},function(k){k.getFile(a,{create:false},function(l){c(l.toURL(),g,a)},d)},d)}try{window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem;window.requestFileSystem(f,0,h,d)}catch(b){e()}}function ReadDocumentIOS(a,h,i,g,d,f){function e(j){if(f){f()}}function b(j){j.getFile(a,{create:false},function(k){d(k.toURL(),h,a)},e)}try{window.resolveLocalFileSystemURL(g+h,b,e)}catch(c){f()}}function ReadFile(d,e,c,b,f,a){if(typeof cordova!="undefined"){if(iOS){ReadDocumentIOS(d,e,c,cordova.file.dataDirectory,f,a)}else{ReadDocumentAndroid(d,e,c,window.TEMPORARY||window.applicationStorageDirectory||LocalFileSystem.TEMPORARY,f,a)}}else{a()}}function isDecimal(a){if(typeof a=="string"&&a==""){return true}a=unformatNumberNoParse(a,number_separator,decimal_separator).toString();return/^[+-]?[0-9]*\.?[0-9]*$/.test(a)}function isNumeric(a){return isDecimal(a)}function unformat2Number(a){return unformatNumber(a,number_separator,decimal_separator)}function unformatNumber(d,c,b){var a=unformatNumberNoParse(d,c,b);a=a.toString();if(a.length>0){return parseFloat(a)}return""}function unformatNumberNoParse(e,c,b){if(typeof c=="undefined"||typeof b=="undefined"){return e}e=e?e.toString():"";if(e.length>0){if(c!=""){var d=new RegExp("\\"+c,"g");e=e.replace(d,"")}e=e.replace(b,".");if(typeof CurrencySymbols!="undefined"){for(var a in CurrencySymbols){e=e.replace(CurrencySymbols[a],"")}}return e}return""}function format2Number(c,b){if(typeof b==="undefined"){b=sig_digits}var a=Number(c);if(b==2){c=formatCurrency(a)}else{c=a.toFixed(b)}c=c.split(/,/).join("{,}").split(/\./).join("{.}");c=c.split("{,}").join(number_separator).split("{.}").join(decimal_separator);return c}function formatCurrency(b){b=b.toString().replace(/\$|\,/g,"");dblValue=parseFloat(b);blnSign=(dblValue==(dblValue=Math.abs(dblValue)));dblValue=Math.floor(dblValue*100+0.50000000001);intCents=dblValue%100;strCents=intCents.toString();dblValue=Math.floor(dblValue/100).toString();if(intCents<10){strCents="0"+strCents}for(var a=0;a<Math.floor((dblValue.length-(1+a))/3);a++){dblValue=dblValue.substring(0,dblValue.length-(4*a+3))+","+dblValue.substring(dblValue.length-(4*a+3))}return(((blnSign)?"":"-")+dblValue+"."+strCents)}function formatNumber(f,e,c,b,a){if(typeof e=="undefined"||typeof c=="undefined"){return f}if(f===0){f="0"}f=f?f.toString():"";if(f.split){f=f.split(".")}else{return f}if(f.length>2){return f.join(".")}if(typeof b!="undefined"){if(b>0&&f.length>1){f[1]=parseFloat("0."+f[1]);f[1]=Math.round(f[1]*Math.pow(10,b))/Math.pow(10,b);f[1]=f[1].toString().split(".")[1]}if(b<=0){f[0]=Math.round(parseInt(f[0],10)*Math.pow(10,b))/Math.pow(10,b);f[1]=""}}if(typeof a!="undefined"&&a>=0){if(f.length>1&&typeof f[1]!="undefined"){f[1]=f[1].substring(0,a)}else{f[1]=""}if(f[1].length<a){for(var d=f[1].length;d<a;d++){f[1]+="0"}}}regex=/(\d+)(\d{3})/;while(e!==""&&regex.test(f[0])){f[0]=f[0].toString().replace(regex,"$1"+e+"$2")}return f[0]+(f.length>1&&f[1]!==""?c+f[1]:"")};