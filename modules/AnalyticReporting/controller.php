<?php

/*** DOMAIN_CHECK ***/
 include_once "modules/AnalyticReporting/controllers/libs.php";global $current_user;date_default_timezone_set(TimeDate::userTimezone($current_user));class ZZZZZZZZZZu20{public $name;public $joinType;public $joinTable1;public $joinField1;public $joinTable2;public $joinField2;public $joinModule;public $manyToManyTable;public $sourceIndex;public $targetIndex;public $roleIndex;public $roleValue;function __construct($name, $joinType, $joinField1, $joinField2, $joinTable1, $joinTable2, $joinModule, $manyToManyTable = false, $sourceIndex = false, $targetIndex = false, $roleIndex = false, $roleValue = false) {$this->joinField1 = $joinField1;$this->joinField2 = $joinField2;$this->joinTable1 = $joinTable1;$this->joinTable2 = $joinTable2;$this->joinType = $joinType;$this->name = $name;$this->joinModule = $joinModule;$this->manyToManyTable = $manyToManyTable;$this->sourceIndex = $sourceIndex;$this->targetIndex = $targetIndex;$this->roleIndex = $roleIndex;$this->roleValue = $roleValue;}}
class ZZZZZZZZZZv21{protected $db;protected $ZZZZS1818;protected $ZZZZZZZZZZw22;protected $ZZZZZx23 = array();protected $isCombined = false;function __construct($ZZZZZZZZZZw22, $ZZZZZx23, ZZp15 $db, ZZZZT1919 $ZZZZS1818, $isCombined = false){$this->db = $db;$this->ZZZZS1818 = $ZZZZS1818;if($ZZZZZZZZZZw22){$this->ZZZZZZZZZZw22 = new ZZZZZZZZZZx23($ZZZZZZZZZZw22,$this->db,$this->ZZZZS1818);}else{$this->ZZZZZZZZZZw22 = false;} $ZZT1919 = count($ZZZZZx23);$this->isCombined = $isCombined;for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZx23[] = new ZZZZZZZZZZy24($ZZZZZx23[$Zf5]->name,$this->db,$this->ZZZZS1818,$ZZZZZx23[$Zf5]);}} function ZZZZZZZZZZz25($module){$ZZS1818 = $this->ZZZZS1818->ZZZZZk10($module->name,$module->name);if($this->isCombined){if($module->relationDescr->joinModule >0){$ZZS1818 = $this->ZZZZZZZZZZz25($this->ZZZZZx23[$module->relationDescr->joinModule-1])."-".$ZZS1818;}elseif($this->ZZZZZZZZZZw22){$ZZS1818 = $this->ZZZZS1818->ZZZZZk10($this->ZZZZZZZZZZw22->name,$this->ZZZZZZZZZZw22->name)."-".$ZZS1818;}} return $ZZS1818;} function ZZZZZZZZZZA00($module){return $ZZZZZZZZZZB11 = "(".$this->ZZZZZZZZZZz25($module).") ";} function ZZZZZZZZZZC22(){$ZZS1818 = array();if($this->ZZZZZZZZZZw22){$this->ZZZZZZZZZZw22->fieldTitlePrefix = "(".$this->ZZZZS1818->ZZZZZk10($this->ZZZZZZZZZZw22->name,$this->ZZZZZZZZZZw22->name).") ";$ZZS1818 = $this->ZZZZZZZZZZw22->ZZZZZZZZZZC22();} $ZZT1919 = count($this->ZZZZZx23);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZx23[$Zf5]->prefix = ($Zf5+1)."_".$this->ZZZZZx23[$Zf5]->name."_";$this->ZZZZZx23[$Zf5]->fieldTitlePrefix = $this->ZZZZZZZZZZA00($this->ZZZZZx23[$Zf5]);$ZZZZZq16 = $this->ZZZZZx23[$Zf5]->ZZZZZZZZZZC22();$ZZS1818 = array_merge($ZZS1818,$ZZZZZq16);} return $ZZS1818;} function ZZZZZZZZZZD33($ZZZZZZZZZZE44,$ZZZZZZZZZZF55){$ZZS1818 = array();if($this->ZZZZZZZZZZw22){$ZZS1818 = $this->ZZZZZZZZZZw22->ZZZZZZZZZZC22();} $ZZT1919 = count($this->ZZZZZx23);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(!in_array($Zf5,$ZZZZZZZZZZE44)){$this->ZZZZZx23[$Zf5]->prefix = ($Zf5+1)."_".$this->ZZZZZx23[$Zf5]->name."_";if($this->isCombined){$this->ZZZZZx23[$Zf5]->blockTitlePrefix= $this->ZZZZZZZZZZz25($this->ZZZZZx23[$Zf5])." ";if(in_array($this->ZZZZZx23[$Zf5]->name,$ZZZZZZZZZZF55)){$this->ZZZZZx23[$Zf5]->fieldTitlePrefix = "(".$this->ZZZZS1818->ZZZZZk10($this->ZZZZZx23[$Zf5]->name,$this->ZZZZZx23[$Zf5]->name).") ";}else{$this->ZZZZZx23[$Zf5]->fieldTitlePrefix = $this->ZZZZZZZZZZA00($this->ZZZZZx23[$Zf5]);}} $ZZZZZq16 = $this->ZZZZZx23[$Zf5]->ZZZZZZZZZZC22(true);$ZZS1818 = array_merge($ZZS1818,$ZZZZZq16);}} $ZZS1818[] = array("title"=>$this->ZZZZS1818->ZZZZZk10("Assigned To",$this->ZZZZZx23[1]->name), "fields"=>array(array("name"=>"00_ALL_assigned_user_id", "column"=>"assigned_user_id", "table"=>"vtiger_crmentity", "uitype"=>53, "type"=>"txt", "title"=>$this->ZZZZS1818->ZZZZZk10("Assigned To",$this->ZZZZZx23[1]->name), "bareTitle"=>$this->ZZZZS1818->ZZZZZk10("Assigned To",$this->ZZZZZx23[1]->name), "availableValues" =>array(),)));return $ZZS1818;}} class ZZZZZZZZZZG66{protected $ZZZZZZZZZZH77;protected $ZZZZZZZZZZI88;protected $ZZZZZZZZZZJ99;protected $ZZZZZZZZZZK1010 = 0;protected $ZZZZZZZZZZL1111 = false;protected $ZZZZZZZZZZM1212 = false;protected $ZZZZZZZZZZN1313 = array(array());protected $ZZZZZZZZZZO1414;protected $ZZZZZZZZZZP1515 = array();protected $ZZZZZZZZZZQ1616 = array();protected $ZZZZZZZZZZR1717 = array();protected $ZZZZZZZZZZS1818= array();protected $ZZZZZZZZZZT1919 = array();protected $ZZZZZZZZZZU2020 = array();protected $ZZZZZZZZZZV2121 = array();protected $ZZZZZZZZZZW2222 = array("day" => array("DATE"), "week" => array("WEEK"), "weekAndYear" => array("WEEK","YEAR"), "month" => array("MONTH"), "monthAndYear" => array("MONTH","YEAR"), "quarter" => array("QUARTER"), "quarterAndYear" => array("QUARTER","YEAR"), "year" => array("YEAR"),);protected $ZZZZZx23 = array();protected $db;protected $ZZZZS1818;function __construct(ZZp15 $db, ZZZZT1919 $ZZZZS1818, $ZZZZZZZZZZX2323 = false, ARUser $ZZZZZZZZZZJ99){$this->db = $db;$this->ZZZZS1818 = $ZZZZS1818;$this->ZZZZZZZZZZL1111 = $ZZZZZZZZZZX2323;$this->ZZZZZZZZZZJ99 = $ZZZZZZZZZZJ99;} function ZZZZZZZZZZY2424($field){$ZZS1818 = "";if(isset($field['related_module'])) {return array($field['related_module']);} return $ZZS1818;} function ZZZZZZZZZZZ2525($name,$ZZZZZZZZZZZa0){$ZZS1818 = false;$ZZT1919 = count($this->ZZZZZx23);if($ZZT1919>1){for($Zf5=1;$Zf5<$ZZT1919;$Zf5++){if($this->ZZZZZx23[$Zf5]->name == $name && $this->ZZZZZx23[$Zf5]->relationDescr->joinModule == $ZZZZZZZZZZZa0){$ZZS1818 = $Zf5;break;}}} return $ZZS1818;} function ZZZZZZZZZZZb1($field,$ZZZZZZZZZZZc2 = 0){$ZZZZZZZZZZZd3 = array();$moduleName = $this->ZZZZZZZZZZY2424($field);$ZZZZZZZZZZZe4 = "";$ZZT1919 = count($moduleName);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZf5 = $this->ZZZZZZZZZZZ2525($moduleName,$ZZZZZZZZZZZc2,$field);$ZZZZZZZZZZZg6 = $this->db->ZZZo14($moduleName[$Zf5],$field);if($ZZZZZZZZZZZf5 !==false && !($field["uitype"] == 66 && $moduleName[$Zf5]=="SalesOrder")) {if(!isset($this->ZZZZZZZZZZH77[$ZZZZZZZZZZZf5][$ZZZZZZZZZZZg6['field'][0]['tablename']])){$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZN1313[$ZZZZZZZZZZZf5][$ZZZZZZZZZZZg6['field'][0]['tablename']],false,$ZZZZZZZZZZZf5);} $ZZZZZZZZZZZd3[] = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZf5][$ZZZZZZZZZZZg6['field'][0]['tablename']].".`".$ZZZZZZZZZZZg6['field'][0]['columnname']."`";}else{$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['fieldname'].$ZZZZZZZZZZZg6['relation']["tablename"]] = "t".$this->ZZZZZZZZZZK1010;$this->ZZZZZZZZZZK1010++;$this->ZZZZZZZZZZI88[] = "LEFT JOIN `".$ZZZZZZZZZZZg6['relation']["tablename"] ."` AS ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['fieldname'].$ZZZZZZZZZZZg6['relation']["tablename"]] ." ON ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['fieldname'].$ZZZZZZZZZZZg6['relation']["tablename"]].".`".$ZZZZZZZZZZZg6['relation']["entityidfield"] ."` = `".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']]."`.`".$field['columnname']."`";$ZZZZZZZZZZZi8 = array();foreach($ZZZZZZZZZZZg6['field'] as $ZZZZZZZZZZZj9){$ZZZZZZZZZZZi8[] = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['fieldname'].$ZZZZZZZZZZZg6['relation']["tablename"]].".`".$ZZZZZZZZZZZj9['rname']."`";} if(count($ZZZZZZZZZZZi8)>1){if($moduleName[$Zf5]=="Contacts"){global $AdvancedReporting_username_sequence;if($AdvancedReporting_username_sequence=='last-first'){$ZZZZZZZZZZZi8 = array_reverse($ZZZZZZZZZZZi8);}} $ZZZZZZZZZZZd3[] = " CONCAT(".implode(",' ',",$ZZZZZZZZZZZi8).") ";}else{$ZZZZZZZZZZZd3[] = $ZZZZZZZZZZZi8[0];}}} $ZZT1919 = count($ZZZZZZZZZZZd3);$ZZS1818 = "'-'";$ZZZZZZZZZZZe4.= " CASE ";for($Zf5 = $ZZT1919-1;$Zf5>-1;$Zf5--){$ZZS1818 = "IFNULL(".$ZZZZZZZZZZZd3[$Zf5].",".$ZZS1818.")";$ZZZZZZZZZZZe4.= "WHEN ".$ZZZZZZZZZZZd3[$Zf5]." IS NOT NULL THEN '".$moduleName[$Zf5]."' ";} $ZZS1818.=" AS `".$field['fieldname']."`";$ZZZZZZZZZZZe4.= "ELSE NULL END AS `".$field['fieldname']."_setype`";return $ZZS1818.", ".$ZZZZZZZZZZZe4;} function ZZZZZZZZZZZk10($field,$ZZZZZZZZZZZc2,$ZZZZZZZZZZZl11 = false){$ZZS1818 = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']].".`".$field['columnname'].'`';if(isset($field['aliasOnly']) && $field['aliasOnly'] === true){$ZZS1818 = $field['columnname'];if($ZZZZZZZZZZZl11){$ZZS1818 = preg_replace('/^ROUND\(/',"",$ZZS1818);$ZZS1818 = preg_replace('/\,2\)$/',"",$ZZS1818);}} $ZZS1818 = str_replace("#alias#",$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']],$ZZS1818);return $ZZS1818;} function ZZZZZZZZZZZm12($ZZZZZZZL1111) {$ZZZZZZZT1919 = PlatformConnector::ZZZZZZL1111($this->ZZZZZZZZZZJ99);$ZZZZZZZZZZZn13 = PlatformConnector::ZZZZZZN1313("UTC");$ZZZZZZZZZZZo14 = PlatformConnector::ZZZZZZN1313($ZZZZZZZT1919);return ZZZZZZZa0::ZZZZZZZZZz25($ZZZZZZZL1111, $ZZZZZZZZZZZn13, $ZZZZZZZZZZZo14);} function ZZZZZZZZZZZp15($name, $ZZZZZZZZZZZq16 = true, $ZZZZZZZZZZZr17 = "", $prefix = "") {if($ZZZZZZZZZZZq16) {return " AS `{$prefix}{$name}{$ZZZZZZZZZZZr17}` ";} return "";} function ZZZZZZZZZZZs18($field,$ZZZH77 = null,$displayOptions = null, $ZZZZZZZZZZZq16 = true, $ZZZZZZZZZZZt19 = array()){$ZZZZZZZZZZZu20 = false;if(!empty($ZZZZZZZZZZZt19) || (isset($field['tablename']) && $field['tablename'] == '__virtual__')){$ZZZZZZZZZZZu20 = true;} $ZZZZZZZZZZZv21 = PlatformConnector::ZZZZZZz25();$ZZS1818 = array();$ZZZZZZZZZZZw22 = '';$ZZZZZZZZZZZx23 = '';$ZZZZZZZZZZZy24 = array();$ZZZZZZZZZZZz25 = array();$ZZZZZZZZZZZc2 = $field['module'];if(!isset($this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']]) && !$ZZZZZZZZZZZu20){$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZN1313[$ZZZZZZZZZZZc2][$field['tablename']],false,$ZZZZZZZZZZZc2);} if(!$ZZZZZZZZZZZu20){$ZZZZZZZZZZZA00 = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']].".".$field['columnname']."";}else{$ZZZZZZZZZZZA00 = $field['columnname'];} if(!$ZZZH77){if($displayOptions){$ZZZz25 = "";switch($displayOptions){case "nogroup": $ZZZz25.="''";break;case "day": $ZZZz25.= ZZZZZZZa0::getDate($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZZZZZZZZZw22 = "_day";$ZZZZZZZZZZZx23 = " (Day)";break;case "week": $ZZZz25.= ZZZZZZZa0::ZZZZZZZZZo14($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZZZZZZZZZw22 = "_week";$ZZZZZZZZZZZx23 = " (Week)";break;case "weekAndYear": $ZZZZZZZZZZZB11 = ZZZZZZZa0::ZZZZZZZZZp15($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZZZZZZZZZC22 = ZZZZZZZa0::ZZZZZZZZZo14($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZz25.= ZZZZZZZa0::ZZZZZZZZZh7(array($ZZZZZZZZZZZB11, "'-'", $ZZZZZZZZZZZC22));$ZZZZZZZZZZZw22 = "_weekAndYear";$ZZZZZZZZZZZx23 = " (Week and year)";break;case "month": $ZZZz25.= ZZZZZZZa0::ZZZZZZZZZq16($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZZZZZZZZZw22 = "_month";$ZZZZZZZZZZZx23 = " (Month)";break;case "monthAndYear": $ZZZZZZZZZZZB11 = ZZZZZZZa0::ZZZZZZZZZp15($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZZZZZZZZZD33 = ZZZZZZZa0::ZZZZZZZZZq16($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZz25.= ZZZZZZZa0::ZZZZZZZZZh7(array($ZZZZZZZZZZZB11, "'-'", $ZZZZZZZZZZZD33));$ZZZZZZZZZZZw22 = "_monthAndYear";$ZZZZZZZZZZZx23 = " (Month and year)";break;case "quarter": $ZZZz25.= ZZZZZZZa0::ZZZZZZZZZr17($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZZZZZZZZZw22 = "_quarter";$ZZZZZZZZZZZx23 = " (Quarter)";break;case "quarterAndYear": $ZZZZZZZZZZZB11 = ZZZZZZZa0::ZZZZZZZZZp15($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZZZZZZZZZE44 = ZZZZZZZa0::ZZZZZZZZZr17($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZz25.= ZZZZZZZa0::ZZZZZZZZZh7(array($ZZZZZZZZZZZB11, "'-'", $ZZZZZZZZZZZE44));$ZZZZZZZZZZZw22 = "_quarterAndYear";$ZZZZZZZZZZZx23 = " (Quarter and year)";break;case "year": $ZZZz25.= ZZZZZZZa0::ZZZZZZZZZp15($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZZZZZZZZZw22 = "_year";$ZZZZZZZZZZZx23 = " (Year)";break;default: $ZZZz25.= $ZZZZZZZZZZZA00;break;} $ZZZz25.= " AS `".$field['fieldname'].$ZZZZZZZZZZZw22."`";$ZZS1818[] = $ZZZz25;}else{if(($field['columnname']=="assigned_user_id" || $field['columnname']=="created_by" || $field['columnname']=="modified_user_id")){$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'] = "t".$this->ZZZZZZZZZZK1010;$this->ZZZZZZZZZZK1010++;$this->ZZZZZZZZZZI88[] = "LEFT JOIN users ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users']." ON ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".id = ".$ZZZZZZZZZZZA00;global $AdvancedReporting_username_sequence;$ZZS1818[] = "case when (".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".user_name not like \"\") then CONCAT(".($AdvancedReporting_username_sequence=='last-first'?$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".last_name,' ',".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".first_name":$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".first_name,' ',".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".last_name").") end AS `".$field['fieldname']."`";$ZZS1818[] = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".`id` ". $this->ZZZZZZZZZZZp15($field['fieldname'], $ZZZZZZZZZZZq16, "_id");$ZZS1818[] = "'Users' ". $this->ZZZZZZZZZZZp15($field['fieldname'], $ZZZZZZZZZZZq16, "_setype");}else{if($this->ZZZZS1818->ZZZZZy24($field)){$ZZS1818[] = $this->ZZZZZZZZZZZb1($field,$ZZZZZZZZZZZc2);$ZZS1818[] = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']].".`".$field['id_name']."` ". $this->ZZZZZZZZZZZp15($field['fieldname'], $ZZZZZZZZZZZq16, "_id");}else{if($this->ZZZZS1818->ZZZZZC22($field)) {$ZZZz25 = "ROUND(" . $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']] . ".`" . $field['columnname'] . "`,{$ZZZZZZZZZZZv21}) " . $this->ZZZZZZZZZZZp15($field['fieldname'], $ZZZZZZZZZZZq16);$ZZZz25 = str_replace("#alias#", $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']], $ZZZz25);$ZZS1818[] = $ZZZz25;} elseif($this->ZZZZS1818->ZZZZZD33($field)) {$ZZZz25 = $this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00) . $this->ZZZZZZZZZZZp15($field['fieldname'], $ZZZZZZZZZZZq16);$ZZS1818[] = $ZZZz25;}else{if(isset($field['aliasOnly']) && $field['aliasOnly'] === true){$ZZZz25 = str_replace('#alias#',$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']],$field['columnname']). $this->ZZZZZZZZZZZp15($field['fieldname'], $ZZZZZZZZZZZq16);} else {$ZZZz25 = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']].".`".$field['columnname']."` ". $this->ZZZZZZZZZZZp15($field['fieldname'], $ZZZZZZZZZZZq16);} $ZZS1818[] = $ZZZz25;if($this->ZZZZS1818->ZZZZZw22($field,$this->db,$this->ZZZZZx23)){$module = $this->ZZZZZx23[$ZZZZZZZZZZZc2];$ZZZZm12 = $module->ZZZZZZZZZZZF55();$ZZS1818[] = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$ZZZZm12['name']].".`".$ZZZZm12['idCol']."` ". $this->ZZZZZZZZZZZp15($field['fieldname'], $ZZZZZZZZZZZq16, "_id");$ZZS1818[] = "'".$module->name."' ". $this->ZZZZZZZZZZZp15($field['fieldname'], $ZZZZZZZZZZZq16, "_setype");}}}}} $ZZZZZZZZZZZy24[] = $field['fieldname'].$ZZZZZZZZZZZw22;$ZZZZZZZZZZZz25[] = $this->ZZZZZZZZZZM1212[$ZZZZZZZZZZZc2].$field['fieldlabel'].$ZZZZZZZZZZZx23;}elseif(is_array($ZZZH77)){$ZZZZZZZZZZZv21 = PlatformConnector::ZZZZZZz25();if(!$ZZZZZZZZZZZu20) {if(isset($ZZZH77["sum"]) && $ZZZH77["sum"] == true){$ZZS1818[] = "ROUND(SUM(".$this->ZZZZZZZZZZZk10($field,$ZZZZZZZZZZZc2,true)."),{$ZZZZZZZZZZZv21}) " . $this->ZZZZZZZZZZZp15($field['fieldname'], true, "_sum");$ZZZZZZZZZZZy24[] = $field['fieldname']."_sum";$ZZZZZZZZZZZz25[] = $this->ZZZZZZZZZZM1212[$ZZZZZZZZZZZc2].$this->ZZZZS1818->ZZZZZk10('label_sum',"AnalyticReporting")."(".$field['fieldlabel'].")";} if(isset($ZZZH77["count"]) && $ZZZH77["count"] == true){$ZZS1818[] = "COUNT(".$this->ZZZZZZZZZZZk10($field,$ZZZZZZZZZZZc2,true).")" . $this->ZZZZZZZZZZZp15($field['fieldname'], true, "_cnt");$ZZZZZZZZZZZy24[] = $field['fieldname']."_cnt";$ZZZZZZZZZZZz25[] = $this->ZZZZZZZZZZM1212[$ZZZZZZZZZZZc2].$this->ZZZZS1818->ZZZZZk10('label_count',"AnalyticReporting")."(".$field['fieldlabel'].")";} if(isset($ZZZH77["avg"]) && $ZZZH77["avg"] == true){$ZZS1818[] = "ROUND(AVG(".$this->ZZZZZZZZZZZk10($field,$ZZZZZZZZZZZc2,true)."),{$ZZZZZZZZZZZv21})" . $this->ZZZZZZZZZZZp15($field['fieldname'], true, "_avg");$ZZZZZZZZZZZy24[] = $field['fieldname']."_avg";$ZZZZZZZZZZZz25[] = $this->ZZZZZZZZZZM1212[$ZZZZZZZZZZZc2].$this->ZZZZS1818->ZZZZZk10('label_average',"AnalyticReporting")."(".$field['fieldlabel'].")";}} else {if(isset($ZZZH77["sum"]) && $ZZZH77["sum"] == true){$ZZS1818[] = "ROUND(SUM(".$this->ZZZZZZZZZZZG66($ZZZZZZZZZZZt19["val"])."),{$ZZZZZZZZZZZv21})" . $this->ZZZZZZZZZZZp15($ZZZZZZZZZZZt19['name'], true, "_sum");$ZZZZZZZZZZZy24[] = $ZZZZZZZZZZZt19['name']."_sum";$ZZZZZZZZZZZz25[] = $this->ZZZZS1818->ZZZZZk10('label_sum',"AnalyticReporting")."(".$ZZZZZZZZZZZt19['title'].")";} if(isset($ZZZH77["count"]) && $ZZZH77["count"] == true){$ZZS1818[] = "COUNT(".$this->ZZZZZZZZZZZG66($ZZZZZZZZZZZt19["val"]).")" . $this->ZZZZZZZZZZZp15($ZZZZZZZZZZZt19['name'], true, "_cnt");$ZZZZZZZZZZZy24[] = $ZZZZZZZZZZZt19['name']."_cnt";$ZZZZZZZZZZZz25[] = $this->ZZZZS1818->ZZZZZk10('label_count',"AnalyticReporting")."(".$ZZZZZZZZZZZt19['title'].")";} if(isset($ZZZH77["avg"]) && $ZZZH77["avg"] == true){$ZZS1818[] = "ROUND(AVG(".$this->ZZZZZZZZZZZG66($ZZZZZZZZZZZt19["val"])."),{$ZZZZZZZZZZZv21})".$this->ZZZZZZZZZZZp15($ZZZZZZZZZZZt19['name'], true, "_avg");$ZZZZZZZZZZZy24[] = $ZZZZZZZZZZZt19['name']."_avg";$ZZZZZZZZZZZz25[] = $this->ZZZZS1818->ZZZZZk10('label_average',"AnalyticReporting")."(".$ZZZZZZZZZZZt19['title'].")";}}} return array("fields" =>$ZZZZZZZZZZZy24, "select"=>$ZZS1818,"titles"=>$ZZZZZZZZZZZz25);} function ZZZZZZZZZZZH77($field,$ZZZZZZZZZZZI88){$ZZZZZZZZZZZc2 = $field["module"];if(!isset($this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']])){$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZN1313[$ZZZZZZZZZZZc2][$field['tablename']],false,$ZZZZZZZZZZZc2);} if($ZZZZZZZZZZZI88["sortAction"] =="nogroup"){$ZZS1818 = null;}elseif(!empty($ZZZZZZZZZZZI88["dateGrouping"]) && isset($this->ZZZZZZZZZZW2222[$ZZZZZZZZZZZI88["dateGrouping"]])){$ZZZZZZZZZZZJ99 = $this->ZZZZZZZZZZW2222[$ZZZZZZZZZZZI88["dateGrouping"]];$ZZS1818 = array();foreach($ZZZZZZZZZZZJ99 as $ZZZZZZZV2121){$ZZS1818[] = $ZZZZZZZV2121."(".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']].".`".$field['columnname']."`)";} $ZZS1818 = implode(", ",$ZZS1818);}else{$ZZS1818 = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']].".`".$field['columnname']."`";} return $ZZS1818;} function ZZZZZZZZZZZK1010($field,$ZZZZZZZZZZZI88,$includeDetails = false){$fieldName = $field['fieldname'];if(!empty($ZZZZZZZZZZZI88["aggregate"])){$ZZZZZq16 = explode("_",$ZZZZZZZZZZZI88["aggregate"],2);if($ZZZZZq16[0] =="count"){$ZZZZZq16[0] = "cnt";} if(isset($this->ZZZZZZZZZZT1919[$ZZZZZq16[1]."_".$ZZZZZq16[0]])){$fieldName = $ZZZZZq16[1]."_".$ZZZZZq16[0];}}else{$ZZZZZZZZZZZI88["aggregate"] = null;} $ZZZZZZZZZZZc2 = $field["module"];if(!isset($this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']])){$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZN1313[$ZZZZZZZZZZZc2][$field['tablename']],false,$ZZZZZZZZZZZc2);} $ZZZZZZZM1212 = "ASC";if($ZZZZZZZZZZZI88["sortDirection"]=="DESC"){$ZZZZZZZM1212 = "DESC";} if(($field['uitype'] == 'enum') && ($ZZZZZZZZZZZI88['name'] == $ZZZZZZZZZZZI88['aggregate'])){$ZZZZZZZZZZZL1111 = $field['fieldname_org'];$moduleName = $this->ZZZZZx23[$field["module"]]->name;$ZZZZZZZO1414 = $this->db->ZZN1313($ZZZZZZZZZZZL1111, $moduleName);$ZZZZZZZO1414 = array_keys($ZZZZZZZO1414);foreach ($ZZZZZZZO1414 as &$ZZZZZZZP1515) {$ZZZZZZZP1515 = "'{$ZZZZZZZP1515}'";} $ZZZZZZZO1414 = implode(",", $ZZZZZZZO1414);$ZZS1818 = "FIELD({$fieldName}, {$ZZZZZZZO1414}) {$ZZZZZZZM1212}";return $ZZS1818;} if(!empty($ZZZZZZZZZZZI88["dateGrouping"]) && ($ZZZZZZZZZZZI88["aggregate"] == $field['fieldname'] || $includeDetails ||!$ZZZZZZZZZZZI88["aggregate"])){if($includeDetails){switch($ZZZZZZZZZZZI88["dateGrouping"]) {case 'year': $ZZS1818 = "`".$fieldName."_year` $ZZZZZZZM1212";break;case 'quarterAndYear': $ZZS1818 = "LEFT(`".$fieldName."_quarterAndYear`,4) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_quarterAndYear`,6,2) AS UNSIGNED) $ZZZZZZZM1212";break;case 'quarter': $ZZS1818 = "LEFT(`".$fieldName."_quarter`,4) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_quarter`,6,2) AS UNSIGNED) $ZZZZZZZM1212";break;case 'monthAndYear': $ZZS1818 = "LEFT(`".$fieldName."_monthAndYear`,4) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_monthAndYear`,6,2) AS UNSIGNED) $ZZZZZZZM1212";break;case 'month': $ZZS1818 = "`".$fieldName."_month` $ZZZZZZZM1212";break;case 'weekAndYear': $ZZS1818 = "LEFT(`".$fieldName."_weekAndYear`,4) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_weekAndYear`,6,2) AS UNSIGNED) $ZZZZZZZM1212";break;case 'week': $ZZS1818 = "`".$fieldName."_week` $ZZZZZZZM1212";break;case 'day': $ZZS1818 = "LEFT(`".$fieldName."_day`,4) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_day`,6,2) AS UNSIGNED) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_day`,9,2) AS UNSIGNED) $ZZZZZZZM1212";break;default: $ZZS1818 = "LEFT(`$fieldName`,4) $ZZZZZZZM1212, CAST(MID(`$fieldName`,6,2) AS UNSIGNED) $ZZZZZZZM1212 , CAST(MID(`$fieldName`,9,2) AS UNSIGNED) $ZZZZZZZM1212";break;}}else{switch($ZZZZZZZZZZZI88["dateGrouping"]) {case 'year': $ZZS1818 = "`".$fieldName."_year` $ZZZZZZZM1212";break;case 'quarterAndYear': $ZZS1818 = "LEFT(`".$fieldName."_quarterAndYear`,4) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_quarterAndYear`,6,2) AS UNSIGNED) $ZZZZZZZM1212";break;case 'quarter': $ZZS1818 = "LEFT(`".$fieldName."_quarter`,4) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_quarter`,6,2) AS UNSIGNED) $ZZZZZZZM1212";break;case 'monthAndYear': $ZZS1818 = "LEFT(`".$fieldName."_monthAndYear`,4) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_monthAndYear`,6,2) AS UNSIGNED) $ZZZZZZZM1212";break;case 'month': $ZZS1818 = "`".$fieldName."_month` $ZZZZZZZM1212";break;case 'weekAndYear': $ZZS1818 = "LEFT(`".$fieldName."_weekAndYear`,4) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_weekAndYear`,6,2) AS UNSIGNED) $ZZZZZZZM1212";break;case 'week': $ZZS1818 = "`".$fieldName."_week` $ZZZZZZZM1212";break;case 'day': $ZZS1818 = "LEFT(`".$fieldName."_day`,4) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_day`,6,2) AS UNSIGNED) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_day`,9,2) AS UNSIGNED) $ZZZZZZZM1212";break;default: $ZZS1818 = "LEFT(`$fieldName`,4) $ZZZZZZZM1212, CAST(MID(`$fieldName`,6,2) AS UNSIGNED) $ZZZZZZZM1212, CAST(MID(`$fieldName`,9,2) AS UNSIGNED) $ZZZZZZZM1212";break;}}}else{$ZZS1818 = "`".$fieldName."` ".$ZZZZZZZM1212;} return $ZZS1818;} function ZZZZZZZZZZZM1212($ZZZZm12,$ZZZZZZZZZZZN1313,$ZZZZZZZZZZZc2 = 0, $ZZZZZt19=null,$type = "INNER",$ZZZZZZZZZZZO1414=null, $ZZZZZZZZZZZP1515=0){$ZZZZZZZZZZZQ1616 = $this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr;if(!$ZZZZZt19){$ZZZZZt19 = $ZZZZZZZZZZZN1313['idCol'];} if(!$ZZZZZZZZZZZO1414){$ZZZZZZZZZZZO1414 = $ZZZZm12['idCol'];} $ZZZZZZZZZZZR1717 = strpos($ZZZZm12['name'], "_cstm");$ZZZZZZZZZZZS1818 = strpos($ZZZZZZZZZZZN1313['name'], "_cstm");if($ZZZZZZZZZZZR1717 !== false || $ZZZZZZZZZZZS1818 !== false){$ZZZZZZZZZZZQ1616 = false;} if($ZZZZZZZZZZZQ1616 && $ZZZZZZZZZZZQ1616->joinType == 'many') {$ZZZZZZZZZZZT1919 = 't'.$this->ZZZZZZZZZZK1010.'_'.$ZZZZZZZZZZZQ1616->manyToManyTable;$this->ZZZZZZZZZZK1010++;$ZZS1818 = $type." JOIN `".$ZZZZZZZZZZZQ1616->manyToManyTable ."` AS `".$ZZZZZZZZZZZT1919 ."` ON (`".$ZZZZZZZZZZZT1919."`.`".$ZZZZZZZZZZZQ1616->sourceIndex ."` = `".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZP1515][$ZZZZZZZZZZZN1313['name']]."`.`".$ZZZZZt19."`";if($ZZZZZZZZZZZQ1616->roleIndex) {$ZZS1818.= " AND `".$ZZZZZZZZZZZT1919."`.`".$ZZZZZZZZZZZQ1616->roleIndex."` = '".$ZZZZZZZZZZZQ1616->roleValue."' ";} $ZZS1818.= " AND `".$ZZZZZZZZZZZT1919."`.`deleted` = '0' ";$ZZS1818.= ") ";$ZZS1818.= $type." JOIN `".$ZZZZm12["name"] ."` AS `".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$ZZZZm12['name']] ."` ON (`".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$ZZZZm12['name']]."`.`".$ZZZZZZZZZZZO1414 ."` = `".$ZZZZZZZZZZZT1919."`.`".$ZZZZZZZZZZZQ1616->targetIndex."`";$ZZS1818.= ") ";} else {if($ZZZZm12["name"] =="vtiger_inventoryproductrel"){$ZZS1818 = $type." JOIN `".$ZZZZm12["name"] ."` AS `".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$ZZZZm12['name']] ."` ON (`".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$ZZZZm12['name']]."`.`".$ZZZZZZZZZZZO1414 ."` = `".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZP1515][$ZZZZZZZZZZZN1313['name']]."`.`".$ZZZZZt19."`";$ZZS1818.= ") ";}else{$ZZS1818 = $type." JOIN `".$ZZZZm12["name"] ."` AS ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$ZZZZm12['name']] ." ON ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$ZZZZm12['name']].".`".$ZZZZZZZZZZZO1414 ."` = `".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZP1515][$ZZZZZZZZZZZN1313['name']]."`.`".$ZZZZZt19."`";}} return $ZZS1818;} function ZZZZZZZZZZZh7($ZZZZm12,$ZZZZZZZZZZZU2020 = false,$ZZZZZZZZZZZc2 = 0){$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$ZZZZm12['name']] = "t".$this->ZZZZZZZZZZK1010;$this->ZZZZZZZZZZK1010++;if(!$ZZZZZZZZZZZU2020){if(!in_array($ZZZZZZZZZZZc2,$this->ZZZZZZZZZZQ1616)){if($ZZZZm12 == $this->ZZZZZZZZZZO1414[$ZZZZZZZZZZZc2]){if(!isset($this->ZZZZZZZZZZH77[$this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr->joinModule][$this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr->joinTable1])){$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZN1313[$this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr->joinModule][$this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr->joinTable1],false,$this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr->joinModule);} $this->ZZZZZZZZZZI88[] = $this->ZZZZZZZZZZZM1212($ZZZZm12, $this->ZZZZZZZZZZN1313[$this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr->joinModule][$this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr->joinTable1], $ZZZZZZZZZZZc2, $this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr->joinField1, "LEFT", $this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr->joinField2, $this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr->joinModule);$this->ZZZZZZZZZZQ1616[] = $ZZZZZZZZZZZc2;}else{$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZO1414[$ZZZZZZZZZZZc2],false,$ZZZZZZZZZZZc2);$this->ZZZZZZZZZZI88[] = $this->ZZZZZZZZZZZM1212($ZZZZm12,$this->ZZZZZZZZZZO1414[$ZZZZZZZZZZZc2],$ZZZZZZZZZZZc2,null,"LEFT",null,$ZZZZZZZZZZZc2);}}else{$this->ZZZZZZZZZZI88[] = $this->ZZZZZZZZZZZM1212($ZZZZm12,$this->ZZZZZZZZZZO1414[$ZZZZZZZZZZZc2],$ZZZZZZZZZZZc2,null,"LEFT",null,$ZZZZZZZZZZZc2);}}} function ZZZZZZZZZZZV2121($ZZZZZZZZZZZW2222,$ZZZc2){$field = $ZZZc2[$ZZZZZZZZZZZW2222->fieldName];if($field['columnname']=="assigned_user_id" || $field['columnname']=="created_by" || $field['columnname']=="modified_user_id"){$ZZZZZZZZZZZc2 = $field['module'];if(!isset($this->ZZZZZZZZZZH77[$field["module"]][$field['tablename']])){$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZN1313[$field["module"]][$field["tablename"]],false,$field["module"]);} if(!isset($this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]["users"])){$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'] = "t".$this->ZZZZZZZZZZK1010;$this->ZZZZZZZZZZK1010++;$this->ZZZZZZZZZZI88[] = "LEFT JOIN users ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users']." ON ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".id = ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']].".".$field['columnname'];} global $AdvancedReporting_username_sequence;$ZZS1818 = "case when (".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".user_name not like \"\") then CONCAT(".($AdvancedReporting_username_sequence=='last-first'?$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".last_name,' ',".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".first_name":$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".first_name,' ',".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".last_name").") end ";}elseif($this->ZZZZS1818->ZZZZZy24($field)){$moduleName = $this->ZZZZZZZZZZY2424($field);$ZZZZZZZZZZZc2 = $field["module"];$ZZZz25 = array();$ZZT1919 = count($moduleName);for($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++){$ZZZZZZZZZZZf5 = $this->ZZZZZZZZZZZ2525($moduleName,$ZZZZZZZZZZZc2,$field);$ZZZZZZZZZZZg6 = $this->db->ZZZo14($moduleName[$Zf5]);if($ZZZZZZZZZZZf5 !==false){if(!isset($this->ZZZZZZZZZZH77[$ZZZZZZZZZZZf5][$ZZZZZZZZZZZg6['field'][0]['tablename']])){$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZN1313[$ZZZZZZZZZZZf5][$ZZZZZZZZZZZg6['field'][0]['tablename']],false,$ZZZZZZZZZZZf5);} $ZZZz25[] = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZf5][$ZZZZZZZZZZZg6['field'][0]['tablename']].".`".$ZZZZZZZZZZZg6['field'][0]['columnname']."`";}else{if(!isset($this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['fieldname'].$ZZZZZZZZZZZg6['relation']["tablename"]])){$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['fieldname'].$ZZZZZZZZZZZg6['relation']["tablename"]] = "t".$this->ZZZZZZZZZZK1010;$this->ZZZZZZZZZZK1010++;$this->ZZZZZZZZZZI88[] = "LEFT JOIN `".$ZZZZZZZZZZZg6['relation']["tablename"] ."` AS ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['fieldname'].$ZZZZZZZZZZZg6['relation']["tablename"]] ." ON ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['fieldname'].$ZZZZZZZZZZZg6['relation']["tablename"]].".`".$ZZZZZZZZZZZg6['relation']["entityidfield"] ."` = `".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']]."`.`".$field['columnname']."`";} $ZZZz25[] = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['fieldname'].$ZZZZZZZZZZZg6['relation']["tablename"]].".`".$ZZZZZZZZZZZg6['field'][0]['columnname']."`";}} $ZZS1818 = "(" .implode(" OR ",$ZZZz25).")";}else{if(!isset($this->ZZZZZZZZZZH77[$field["module"]][$field['tablename']])){$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZN1313[$field["module"]][$field["tablename"]],false,$field["module"]);} $ZZS1818 = "`".$this->ZZZZZZZZZZH77[$field["module"]][$field['tablename']]."`.`".$field['columnname']."`";$ZZS1818 = str_replace('#alias#',$this->ZZZZZZZZZZH77[$field["module"]][$field['tablename']],$ZZS1818);} return $ZZS1818;} function ZZZZZZZZZZZX2323($ZZZZZZZZZZZW2222,$ZZZc2){$ZZS1818 = " AND ";if($ZZZZZZZZZZZW2222->connector =="or" || $ZZZZZZZZZZZW2222->connector =="OR"){$ZZS1818 = " OR ";} $ZZZZZZZW2222 = null;if(isset($ZZZc2[$ZZZZZZZZZZZW2222->fieldName])){$field = $ZZZc2[$ZZZZZZZZZZZW2222->fieldName];$fieldName = $this->ZZZZZZZZZZZV2121($ZZZZZZZZZZZW2222,$ZZZc2);$ZZZZZZZZZZZY2424 = array("assigned_user_id", "created_by", "modified_user_id", "team_id", "team_set_id");$ZZZZZZZZZZZZ2525 = in_array($field['columnname'], $ZZZZZZZZZZZY2424);switch ($ZZZZZZZZZZZW2222->condition){case "neq": $ZZZZZZZZZZZZa0 = "";if(in_array($field['uitype'],array('enum', 'dynamicenum'))) {$ZZZZZZZZZZZZa0.= " $fieldName NOT IN(";$ZZZZZZZW2222 = array();$ZZZZZq16 = array();$ZZT1919 = count($ZZZZZZZZZZZW2222->value);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZW2222[] = $ZZZZZZZZZZZW2222->value[$Zf5];$ZZZZZq16[] = '?';} $ZZZZZZZZZZZZa0.= implode(' , ',$ZZZZZq16);$ZZZZZZZZZZZZa0.= ") ";$ZZS1818.= " ($ZZZZZZZZZZZZa0 OR $fieldName IS NULL) ";}elseif(in_array($field['uitype'],array('multienum'))){$ZZS1818.= " $fieldName <> ? ";$ZZZZZZZW2222 = $this->ZZZZS1818->ZZZZZU2020($ZZZZZZZZZZZW2222->value, "^");$ZZZZZZZW2222 = implode(",", $ZZZZZZZW2222);$ZZS1818.= " OR ($fieldName IS NULL) ";}else{$ZZZZZZZZZZZZa0.= " NOT $fieldName = ? ";$ZZZZZZZW2222 = $ZZZZZZZZZZZW2222->value[0];$ZZS1818.= " ($ZZZZZZZZZZZZa0 OR $fieldName IS NULL) ";} break;case "eq": if(in_array($field['uitype'],array('enum', 'dynamicenum'))) {$ZZS1818.= " $fieldName IN(";$ZZZZZZZW2222 = array();$ZZZZZq16 = array();$ZZT1919 = count($ZZZZZZZZZZZW2222->value);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZW2222[] = $ZZZZZZZZZZZW2222->value[$Zf5];$ZZZZZq16[] = '?';} $ZZS1818.= implode(' , ',$ZZZZZq16);$ZZS1818.= ") ";}elseif(in_array($field['uitype'],array('multienum'))){$ZZS1818.= " $fieldName = ? ";$ZZZZZZZW2222 = $this->ZZZZS1818->ZZZZZU2020($ZZZZZZZZZZZW2222->value, "^");$ZZZZZZZW2222 = implode(",", $ZZZZZZZW2222);}else{$ZZS1818.= " $fieldName = ? ";$ZZZZZZZW2222 = $ZZZZZZZZZZZW2222->value[0];} break;case "cont": if(in_array($field['uitype'],array('enum', 'dynamicenum'))) {$ZZS1818.= " $fieldName IN(";$ZZZZZZZW2222 = array();$ZZZZZq16 = array();$ZZT1919 = count($ZZZZZZZZZZZW2222->value);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZW2222[] = $ZZZZZZZZZZZW2222->value[$Zf5];$ZZZZZq16[] = '?';} $ZZS1818.= implode(' , ',$ZZZZZq16);$ZZS1818.= ") ";}elseif(in_array($field['uitype'],array('multienum'))){$ZZS1818.= " 1=2 ";$ZZZZZZZW2222 = array();$ZZZZZZZZZZZZb1 = $this->ZZZZS1818->ZZZZZU2020($ZZZZZZZZZZZW2222->value, "^");$ZZZZZZZZZZZZb1 = $this->ZZZZS1818->ZZZZZU2020($ZZZZZZZZZZZZb1, "%");foreach ($ZZZZZZZZZZZZb1 as $ZZZZZZZZZZZW2222) {$ZZZZZZZW2222[] = $ZZZZZZZZZZZW2222;$ZZS1818 .= " OR {$fieldName} like ?";}}else{$ZZS1818.= " $fieldName like ? ";$ZZZZZZZW2222 = "%".$ZZZZZZZZZZZW2222->value[0]."%";} break;case "ncont": if(in_array($field['uitype'],array('enum', 'dynamicenum'))) {$ZZS1818.= " $fieldName NOT IN(";$ZZZZZZZW2222 = array();$ZZZZZq16 = array();$ZZT1919 = count($ZZZZZZZZZZZW2222->value);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZW2222[] = $ZZZZZZZZZZZW2222->value[$Zf5];$ZZZZZq16[] = '?';} $ZZS1818.= implode(' , ',$ZZZZZq16);$ZZS1818.= ") ";}elseif(in_array($field['uitype'],array('multienum'))) {$ZZS1818 .= " 1=1 ";$ZZZZZZZW2222 = array();$ZZZZZZZZZZZZb1 = $this->ZZZZS1818->ZZZZZU2020($ZZZZZZZZZZZW2222->value, "^");$ZZZZZZZZZZZZb1 = $this->ZZZZS1818->ZZZZZU2020($ZZZZZZZZZZZZb1, "%");foreach ($ZZZZZZZZZZZZb1 as $ZZZZZZZZZZZW2222) {$ZZZZZZZW2222[] = $ZZZZZZZZZZZW2222;$ZZS1818 .= " AND {$fieldName} NOT like ?";}} else {$ZZS1818.= " $fieldName NOT like ? ";$ZZZZZZZW2222 = "%".$ZZZZZZZZZZZW2222->value[0]."%";} break;case "start": $ZZS1818.= " $fieldName like ? ";$ZZZZZZZW2222 = $ZZZZZZZZZZZW2222->value[0]."%";break;case "end": $ZZS1818.= " $fieldName like ? ";$ZZZZZZZW2222 = "%".$ZZZZZZZZZZZW2222->value[0];break;case "empty": $ZZS1818.= " ($fieldName IS NULL OR $fieldName ='')";$ZZZZZZZW2222 = null;break;case "filled": $ZZS1818.= " ($fieldName IS NOT NULL AND $fieldName <>'')";$ZZZZZZZW2222 = null;break;case "before": $ZZS1818.= " $fieldName < ?";if($this->ZZZZS1818->ZZZZZD33($field)){$ZZZZZZZZZZZZc2 = strtotime($ZZZZZZZZZZZW2222->value[0]." ".$ZZZZZZZZZZZW2222->value[1].":".$ZZZZZZZZZZZW2222->value[2].":00 ".$ZZZZZZZZZZZW2222->value[3]);$ZZZz25 = new DateTime();$ZZZz25->setTimestamp($ZZZZZZZZZZZZc2);$ZZZZZZH77 = $ZZZz25->format("Y-m-d H:i:s");$ZZZZZZH77 = PlatformConnector::ZZZZZZG66($this->ZZZZZZZZZZJ99, $ZZZZZZH77);$ZZZZZZZW2222 = $ZZZZZZH77;}else{$ZZZZZZZW2222 = $ZZZZZZZZZZZW2222->value[0];} break;case "after": $ZZS1818.= " $fieldName > ?";if($this->ZZZZS1818->ZZZZZD33($field)){$ZZZZZZZZZZZZc2 = strtotime($ZZZZZZZZZZZW2222->value[0]." ".$ZZZZZZZZZZZW2222->value[1].":".$ZZZZZZZZZZZW2222->value[2].":00 ".$ZZZZZZZZZZZW2222->value[3]);$ZZZz25 = new DateTime();$ZZZz25->setTimestamp($ZZZZZZZZZZZZc2);$ZZZZZZH77 = $ZZZz25->format("Y-m-d H:i:s");$ZZZZZZH77 = PlatformConnector::ZZZZZZG66($this->ZZZZZZZZZZJ99, $ZZZZZZH77);$ZZZZZZZW2222 = $ZZZZZZH77;}else{$ZZZZZZZW2222 = $ZZZZZZZZZZZW2222->value[0];} break;case "today": $ZZZZZZZZZZZZd3 = PlatformConnector::ZZZZZZI88($this->ZZZZZZZZZZJ99);$ZZZZZZZZZZZZe4 = PlatformConnector::ZZZZZZK1010($this->ZZZZZZZZZZJ99);$ZZS1818.= " $fieldName BETWEEN '{$ZZZZZZZZZZZZd3}' AND '{$ZZZZZZZZZZZZe4}' ";$ZZZZZZZW2222 = array();break;case "tomorrow": $ZZZZZZZZZZZZd3 = PlatformConnector::ZZZZZZI88($this->ZZZZZZZZZZJ99);$ZZZZZZZZZZZZe4 = PlatformConnector::ZZZZZZK1010($this->ZZZZZZZZZZJ99);$ZZZZZZZZZZZZf5 = new DateTime($ZZZZZZZZZZZZd3);$ZZZZZZZZZZZZg6 = new DateTime($ZZZZZZZZZZZZe4);$ZZZZZZZZZZZZd3 = $ZZZZZZZZZZZZf5->modify("+1 day")->format("Y-m-d H:i:s");$ZZZZZZZZZZZZe4 = $ZZZZZZZZZZZZg6->modify("+1 day")->format("Y-m-d H:i:s");$ZZS1818.= " $fieldName BETWEEN '{$ZZZZZZZZZZZZd3}' AND '{$ZZZZZZZZZZZZe4}' ";break;case "yesterday": $ZZZZZZZZZZZZd3 = PlatformConnector::ZZZZZZI88($this->ZZZZZZZZZZJ99);$ZZZZZZZZZZZZe4 = PlatformConnector::ZZZZZZK1010($this->ZZZZZZZZZZJ99);$ZZZZZZZZZZZZf5 = new DateTime($ZZZZZZZZZZZZd3);$ZZZZZZZZZZZZg6 = new DateTime($ZZZZZZZZZZZZe4);$ZZZZZZZZZZZZd3 = $ZZZZZZZZZZZZf5->modify("-1 day")->format("Y-m-d H:i:s");$ZZZZZZZZZZZZe4 = $ZZZZZZZZZZZZg6->modify("-1 day")->format("Y-m-d H:i:s");$ZZS1818.= " $fieldName BETWEEN '{$ZZZZZZZZZZZZd3}' AND '{$ZZZZZZZZZZZZe4}' ";break;case "aftert": $ZZS1818.= " " . ZZZZZZZa0::getDate($fieldName) . " > ?";$ZZZZZZZZZZZZe4 = PlatformConnector::ZZZZZZK1010($this->ZZZZZZZZZZJ99);$ZZZZZZZZZZZZg6 = new DateTime($ZZZZZZZZZZZZe4);$ZZZZZZZW2222 = $ZZZZZZZZZZZZg6->modify("+1 day")->format("Y-m-d H:i:s");break;case "tilly": $ZZS1818.= " " . ZZZZZZZa0::getDate($fieldName) . " < ?";$ZZZZZZZZZZZZd3 = PlatformConnector::ZZZZZZI88($this->ZZZZZZZZZZJ99);$ZZZZZZZZZZZZf5 = new DateTime($ZZZZZZZZZZZZd3);$ZZZZZZZW2222 = $ZZZZZZZZZZZZf5->modify("-1 day")->format("Y-m-d H:i:s");break;case "between": $ZZS1818.= " $fieldName >= ? AND $fieldName <= ?";if($this->ZZZZS1818->ZZZZZC22($field)){$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0],$ZZZZZZZZZZZW2222->value[1]);}elseif($this->ZZZZS1818->ZZZZZD33($field)){$ZZZZZZZZZZZZh7 = strtotime($ZZZZZZZZZZZW2222->value[0]." ".$ZZZZZZZZZZZW2222->value[1].":".$ZZZZZZZZZZZW2222->value[2].":00 ".$ZZZZZZZZZZZW2222->value[3]);$ZZZZZZZZZZZZi8 = strtotime($ZZZZZZZZZZZW2222->value[4]." ".$ZZZZZZZZZZZW2222->value[5].":".$ZZZZZZZZZZZW2222->value[6].":00 ".$ZZZZZZZZZZZW2222->value[7]);$ZZZZZZZZZZZZj9 = new DateTime();$ZZZZZZZZZZZZk10 = new DateTime();$ZZZZZZZZZZZZj9->setTimestamp($ZZZZZZZZZZZZh7);$ZZZZZZZZZZZZk10->setTimestamp($ZZZZZZZZZZZZi8);$ZZZZZZZZZZZZd3 = $ZZZZZZZZZZZZj9->format("Y-m-d H:i:s");$ZZZZZZZZZZZZe4 = $ZZZZZZZZZZZZk10->format("Y-m-d H:i:s");$ZZZZZZZZZZZZd3 = PlatformConnector::ZZZZZZG66($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZd3);$ZZZZZZZZZZZZe4 = PlatformConnector::ZZZZZZG66($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZe4);$ZZZZZZZW2222 = array($ZZZZZZZZZZZZd3,$ZZZZZZZZZZZZe4);}else{$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0],$ZZZZZZZZZZZW2222->value[1]);} break;case "nbetween": $ZZS1818.= " ($fieldName < ? OR $fieldName > ?)";if($this->ZZZZS1818->ZZZZZC22($field)){$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0],$ZZZZZZZZZZZW2222->value[1]);}elseif($this->ZZZZS1818->ZZZZZD33($field)){$ZZZZZZZZZZZZh7 = strtotime($ZZZZZZZZZZZW2222->value[0]." ".$ZZZZZZZZZZZW2222->value[1].":".$ZZZZZZZZZZZW2222->value[2].":00 ".$ZZZZZZZZZZZW2222->value[3]);$ZZZZZZZZZZZZi8 = strtotime($ZZZZZZZZZZZW2222->value[4]." ".$ZZZZZZZZZZZW2222->value[5].":".$ZZZZZZZZZZZW2222->value[6].":00 ".$ZZZZZZZZZZZW2222->value[7]);$ZZZZZZZZZZZZj9 = new DateTime();$ZZZZZZZZZZZZk10 = new DateTime();$ZZZZZZZZZZZZj9->setTimestamp($ZZZZZZZZZZZZh7);$ZZZZZZZZZZZZk10->setTimestamp($ZZZZZZZZZZZZi8);$ZZZZZZZZZZZZd3 = $ZZZZZZZZZZZZj9->format("Y-m-d H:i:s");$ZZZZZZZZZZZZe4 = $ZZZZZZZZZZZZk10->format("Y-m-d H:i:s");$ZZZZZZZZZZZZd3 = PlatformConnector::ZZZZZZG66($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZd3);$ZZZZZZZZZZZZe4 = PlatformConnector::ZZZZZZG66($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZe4);$ZZZZZZZW2222 = array($ZZZZZZZZZZZZd3,$ZZZZZZZZZZZZe4);}else{$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0],$ZZZZZZZZZZZW2222->value[1]);} break;case "ndays": $ZZS1818.= " $fieldName > ".ZZZZZZZa0::ZZZZZZZZZw22()." AND $fieldName < ".ZZZZZZZa0::ZZZZZZZZZx23("+", "day", "!", ZZZZZZZa0::ZZZZZZZZZw22());$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0]);break;case "pdays": $ZZS1818.= " $fieldName < ".ZZZZZZZa0::ZZZZZZZZZw22()." AND $fieldName > ".ZZZZZZZa0::ZZZZZZZZZx23("-", "day", "!", ZZZZZZZa0::ZZZZZZZZZw22());$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0]);break;case "gtdays": $ZZS1818.= " $fieldName > ".ZZZZZZZa0::ZZZZZZZZZx23("+", "day", "!", ZZZZZZZa0::ZZZZZZZZZw22());$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0]);break;case "ltdays": $ZZS1818.= " $fieldName < ".ZZZZZZZa0::ZZZZZZZZZx23("-", "day", "!", ZZZZZZZa0::ZZZZZZZZZw22());$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0]);break;case "tweek": $ZZS1818.= " $fieldName BETWEEN '".date("Y-m-d",strtotime('this week'))."' AND '".date("Y-m-d",strtotime('this week +6 days'))."'";$ZZZZZZZW2222 = array();break;case "lweek": $ZZS1818.= " $fieldName BETWEEN '".date("Y-m-d",strtotime('this week -7 days'))."' AND '".date("Y-m-d",strtotime('this week -1 days'))."'";$ZZZZZZZW2222 = array();break;case "nweek": $ZZS1818.= " $fieldName BETWEEN '".date("Y-m-d",strtotime('this week +7 days'))."' AND '".date("Y-m-d",strtotime('this week +13 days'))."'";$ZZZZZZZW2222 = array();break;case "tmonth": $ZZS1818.= " $fieldName BETWEEN '".date("Y-m-01")."' AND '".date("Y-m-t")."'";$ZZZZZZZW2222 = array();break;case "lmonth": $ZZZZZZZZZZZZl11 = date("Y-m-01 H:i:s", strtotime('-1 month'));$ZZZZZZZZZZZZm12 = date("Y-m-t H:i:s", strtotime('-1 month'));$ZZZZZZZZZZZZl11 = PlatformConnector::ZZZZZZA00($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZl11, $field['uitype']);$ZZZZZZZZZZZZm12 = PlatformConnector::ZZZZZZA00($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZm12, $field['uitype']);$ZZZZZZZZZZZZd3 = PlatformConnector::ZZZZZZG66($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZl11 . " 00:00:00");$ZZZZZZZZZZZZe4 = PlatformConnector::ZZZZZZG66($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZm12 . " 23:59:59");$ZZS1818.= " $fieldName BETWEEN '{$ZZZZZZZZZZZZd3}' AND '{$ZZZZZZZZZZZZe4}' ";$ZZZZZZZW2222 = array();break;case "tyear": $ZZS1818.= " $fieldName BETWEEN '".date("Y-01-01")."' AND '".date("Y-12-t")."'";$ZZZZZZZW2222 = array();break;case "lyear": $ZZZZZZZZZZZZl11 = date("Y-01-01 H:i:s", strtotime('-1 year'));$ZZZZZZZZZZZZm12 = date("Y-12-t H:i:s", strtotime('-1 year'));$ZZZZZZZZZZZZl11 = PlatformConnector::ZZZZZZA00($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZl11);$ZZZZZZZZZZZZm12 = PlatformConnector::ZZZZZZA00($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZm12);$ZZZZZZZZZZZZd3 = PlatformConnector::ZZZZZZZZZZZZn13($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZl11 . " 00:00:00");$ZZZZZZZZZZZZe4 = PlatformConnector::ZZZZZZZZZZZZn13($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZm12 . " 23:59:59");$ZZS1818.= " $fieldName BETWEEN '{$ZZZZZZZZZZZZd3}' AND '{$ZZZZZZZZZZZZe4}' ";$ZZZZZZZW2222 = array();break;case "nquarter": $ZZZZZZZZZZZZo14 = "'".date("Y-m-d",strtotime('+3 months'))."'";$ZZZZZZZZZZZZp15 = ZZZZZZZa0::ZZZZZZZZZr17($fieldName);$ZZZZZZZZZZZZq16 = ZZZZZZZa0::ZZZZZZZZZr17($ZZZZZZZZZZZZo14);$ZZZZZZZZZZZZr17 = ZZZZZZZa0::ZZZZZZZZZp15($fieldName);$ZZZZZZZZZZZZs18 = ZZZZZZZa0::ZZZZZZZZZp15($ZZZZZZZZZZZZo14);$ZZS1818.= " {$ZZZZZZZZZZZZp15} = {$ZZZZZZZZZZZZq16} AND {$ZZZZZZZZZZZZr17} = {$ZZZZZZZZZZZZs18} ";$ZZZZZZZW2222 = array();break;case "lquarter": $ZZZZZZZZZZZZt19 = "'".date("Y-m-d",strtotime('-3 months'))."'";$ZZZZZZZZZZZZp15 = ZZZZZZZa0::ZZZZZZZZZr17($fieldName);$ZZZZZZZZZZZZu20 = ZZZZZZZa0::ZZZZZZZZZr17($ZZZZZZZZZZZZt19);$ZZZZZZZZZZZZr17 = ZZZZZZZa0::ZZZZZZZZZp15($fieldName);$ZZZZZZZZZZZZv21 = ZZZZZZZa0::ZZZZZZZZZp15($ZZZZZZZZZZZZt19);$ZZS1818.= " {$ZZZZZZZZZZZZp15} = {$ZZZZZZZZZZZZu20} AND {$ZZZZZZZZZZZZr17} = {$ZZZZZZZZZZZZv21} ";$ZZZZZZZW2222 = array();break;case "gt": $ZZS1818.= " $fieldName > ?";$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0]);break;case "lt": $ZZS1818.= " $fieldName < ?";$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0]);break;case "egt": $ZZS1818.= " $fieldName >= ?";$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0]);break;case "elt": $ZZS1818.= " $fieldName <= ?";$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0]);break;case "unchecked": $ZZS1818.= " $fieldName = 0";$ZZZZZZZW2222 = array();break;case "checked": $ZZS1818.= " $fieldName = 1";$ZZZZZZZW2222 = array();break;case "assignedto": global $current_user;$ZZS1818.= " $fieldName LIKE ?";$ZZZZZZZZZZZZw22 = $current_user->first_name;$ZZZZZZZZZZZZx23 = $current_user->last_name;if($ZZZZZZZZZZZZw22 == ""){$ZZZZZZZZZZZZy24 = $ZZZZZZZZZZZZx23;}else{$ZZZZZZZZZZZZy24 = $ZZZZZZZZZZZZw22." ".$ZZZZZZZZZZZZx23;} $ZZZZZZZW2222 = array("%".$ZZZZZZZZZZZZy24."%");break;}}else{$ZZS1818 = " ";} return array("sql"=>$ZZS1818,"param"=>$ZZZZZZZW2222);} function ZZZZZZZZZZZZz25($ZZZZZZZZZZZZA00,$ZZZc2){$ZZS1818 = "AND ";if($ZZZZZZZZZZZZA00->connector =="OR"){$ZZS1818 = "OR ";} $ZZS1818.="(1=1 ";$ZZT1919 = count($ZZZZZZZZZZZZA00->filters);$ZZZx23 = array();for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZq16 = $this->ZZZZZZZZZZZX2323($ZZZZZZZZZZZZA00->filters[$Zf5],$ZZZc2);$ZZS1818.= $ZZZZZq16["sql"] . " ";if($ZZZZZq16["param"]!==null){if(is_array($ZZZZZq16["param"])){$ZZZx23 = array_merge($ZZZx23,$ZZZZZq16["param"]);}else{$ZZZx23[] = $ZZZZZq16["param"];}}} $ZZS1818.= ") ";return array("sql"=>$ZZS1818,"params"=>$ZZZx23);} function ZZZZZZZZZZZZB11($ZZZZZZZZZZZZC22,$ZZZZZZZZZZZZD33,$ZZZM1212){$ZZT1919 = count($ZZZZZZZZZZZZD33);$ZZZV2121 = array();for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(isset($ZZZZZZZZZZZZC22[$ZZZZZZZZZZZZD33[$Zf5]])){$ZZZV2121[] = $ZZZZZZZZZZZZC22[$ZZZZZZZZZZZZD33[$Zf5]];}} if(count($ZZZM1212) > 0){foreach($ZZZM1212 as $ZZZZZZZZZZZt19) {$ZZZV2121[] = array('tablename' => $ZZZZZZZZZZZt19['table'], 'columnname' => $ZZZZZZZZZZZt19['column'], 'fieldname' => $ZZZZZZZZZZZt19['name'], 'fieldlabel' => $ZZZZZZZZZZZt19['bareTitle'], 'uitype' => $ZZZZZZZZZZZt19['uitype'], 'typeofdata' => 'V~O', 'module' => 'X',);}} return $ZZZV2121;} function ZZZZZZZZZZZZE44($ZZZZZZZZZZj9){$ZZZc2 = array();$ZZT1919 = count($ZZZZZZZZZZj9);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZc2 = array_merge($ZZZc2,$ZZZZZZZZZZj9[$Zf5]->ZZZZZZZZZV2121($Zf5));} return $ZZZc2;} function ZZZZZZZZZZZZF55($ZZZZZZZZZZj9){$ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZj9);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = array();} return $ZZS1818;} function ZZZZZZZZZZZZG66($ZZZZZZZZZZj9){$ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZj9);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $ZZZZZZZZZZj9[$Zf5]->ZZZZZZZZZZZF55();} return $ZZS1818;} function ZZZZZZZZZZZZH77($ZZZZZZZZZZj9){$ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZj9);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $ZZZZZZZZZZj9[$Zf5]->ZZZZZZZZZZZZI88();} return $ZZS1818;} function ZZZZZZZZZZZZJ99(){$ZZq16 = " AND (1=1 ";$ZZT1919 = count($this->ZZZZZZZZZZQ1616);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(isset($this->ZZZZZZZZZZN1313[$this->ZZZZZZZZZZQ1616[$Zf5]]["vtiger_crmentity"])){if(!isset($this->ZZZZZZZZZZH77[$this->ZZZZZZZZZZQ1616[$Zf5]]["vtiger_crmentity"])){$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZN1313[$this->ZZZZZZZZZZQ1616[$Zf5]]["vtiger_crmentity"],false,$this->ZZZZZZZZZZQ1616[$Zf5]);} $ZZq16.= "AND (`".$this->ZZZZZZZZZZH77[$this->ZZZZZZZZZZQ1616[$Zf5]]["vtiger_crmentity"]."`.`deleted` = 0 ";$ZZq16.= "OR `".$this->ZZZZZZZZZZH77[$this->ZZZZZZZZZZQ1616[$Zf5]]["vtiger_crmentity"]."`.`deleted` IS NULL) ";}} $ZZq16.=")";return $ZZq16;} function ZZZZZZZZZZZZK1010($ZZZZZZZZZZZZL1111,$includeDetails = false){$ZZS1818 = "";$ZZZZH77 = array();$ZZT1919 = count($ZZZZZZZZZZZZL1111);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(isset($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZZL1111[$Zf5]["name"]]) && isset($ZZZZZZZZZZZZL1111[$Zf5]["sortDirection"]) && isset($ZZZZZZZZZZZZL1111[$Zf5]["sortAction"]) && in_array($ZZZZZZZZZZZZL1111[$Zf5]["sortAction"],array("sort","groupsort"))){$ZZZZH77[] = $this->ZZZZZZZZZZZK1010($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZZL1111[$Zf5]["name"]],$ZZZZZZZZZZZZL1111[$Zf5],$includeDetails);}} if(!empty($ZZZZH77)){$ZZS1818= " ORDER BY ".implode(" , ",$ZZZZH77);} return $ZZS1818;} function ZZZZZZZZZZZZM1212($module){$ZZS1818 = $this->ZZZZS1818->ZZZZZk10($module->name,$module->name);if($module->relationDescr!==null){$ZZS1818 = $this->ZZZZZZZZZZZZM1212($this->ZZZZZx23[$module->relationDescr->joinModule])."-".$ZZS1818;} return $ZZS1818;} function ZZZZZZZZZZZZN1313($module,$ZZZZZx23,$ZZZZZZZZZZZZD33,$ZZZM1212){$this->ZZZZZx23 = array_merge(array($module),$ZZZZZx23);$this->ZZZZZZZZZZH77 = $this->ZZZZZZZZZZZZF55($this->ZZZZZx23);$this->ZZZZZZZZZZI88 = array();$this->ZZZZZZZZZZT1919 = array();$this->ZZZZZZZZZZV2121 = array();$this->ZZZZZZZZZZK1010 = 0;$this->ZZZZZZZZZZN1313 = $this->ZZZZZZZZZZZZH77($this->ZZZZZx23);$this->ZZZZZZZZZZO1414 = $this->ZZZZZZZZZZZZG66($this->ZZZZZx23);$this->ZZZZZZZZZZQ1616 = array(0);$this->ZZZZZZZZZZU2020 = array();$this->ZZZZZZZZZZR1717 = $this->ZZZZZZZZZZZZE44($this->ZZZZZx23);$this->ZZZZZZZZZZS1818 = $this->ZZZZZZZZZZZZB11($this->ZZZZZZZZZZR1717,$ZZZZZZZZZZZZD33,$ZZZM1212);$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZO1414[0],true);$ZZT1919 = count($this->ZZZZZx23);if($this->ZZZZZZZZZZL1111 == true){for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZZZZZZM1212[$Zf5] = $this->ZZZZZZZZZZZZM1212($this->ZZZZZx23[$Zf5])." ";}}else{for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZZZZZZM1212[$Zf5] = "";}}} function ZZZZZZZZZZZZO1414($field,$ZZZZZZZZZZZZP1515,$ZZZZZZZZZZZZQ1616, $ZZZZZZZZZZZq16 = true, $ZZZZZZZZZZZt19 = array()){$ZZZz25 = $this->ZZZZZZZZZZZs18($field,$ZZZZZZZZZZZZP1515,$ZZZZZZZZZZZZQ1616, $ZZZZZZZZZZZq16, $ZZZZZZZZZZZt19);if(!$ZZZz25) {return false;} foreach($ZZZz25["fields"] as $Zu20=>$fieldName){$this->ZZZZZZZZZZT1919[$fieldName] = $ZZZz25["titles"][$Zu20];} $this->ZZZZZZZZZZU2020 = array_merge($this->ZZZZZZZZZZU2020,$ZZZz25["select"]);} function ZZZZZZZZZZZG66($ZZZZZZZZZZZt19){$ZZZZZZZZZZZZR1717 = array("avg" => array("args" => 1, "isExpr" => false, "fn" => "AVG",), "cnt" => array("args" => 1, "isExpr" => false, "fn" => "COUNT",), "min" => array("args" => 1, "isExpr" => false, "fn" => "MIN",), "max" => array("args" => 1, "isExpr" => false, "fn" => "MAX",), "sum" => array("args" => 1, "isExpr" =>false, "fn" => "SUM",), "plus" => array("args" => 2, "isExpr" =>true, "fn" => "+",), "minus" => array("args" => 2, "isExpr" =>true, "fn" => "-",), "mult" => array("args" => 2, "isExpr" =>true, "fn" => "*",), "div" => array("args" => 2, "isExpr" =>true, "fn" => "/",),);$ZZS1818 = "NULL";if(isset($ZZZZZZZZZZZZR1717[$ZZZZZZZZZZZt19["op"]]) && count($ZZZZZZZZZZZt19["val"]) == $ZZZZZZZZZZZZR1717[$ZZZZZZZZZZZt19["op"]]["args"] && count($ZZZZZZZZZZZt19["valType"]) == $ZZZZZZZZZZZZR1717[$ZZZZZZZZZZZt19["op"]]["args"]){$ZZZz25 = array();for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZR1717[$ZZZZZZZZZZZt19["op"]]["args"];$Zf5++){$ZZZZZZZZZZZZS1818 = "NULL";if(isset($ZZZZZZZZZZZt19["valType"][$Zf5]) && isset($ZZZZZZZZZZZt19["val"][$Zf5])){if($ZZZZZZZZZZZt19["valType"][$Zf5] == "c"){$ZZZZZq16 = str_replace(",",".",$ZZZZZZZZZZZt19["val"][$Zf5]);if(preg_match("/^([0-9]+)(\\.|,)?[0-9]{0,}$/",$ZZZZZq16)){$ZZZZZZZZZZZZS1818 = $ZZZZZq16;}}elseif($ZZZZZZZZZZZt19["valType"][$Zf5] == "f"){if(isset($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZt19["val"][$Zf5]])){$ZZZZZq16 = $this->ZZZZZZZZZZZs18($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZt19["val"][$Zf5]],null,null,false,false);$ZZZZZZZZZZZZS1818 = $ZZZZZq16["select"][0];}}elseif($ZZZZZZZZZZZt19["valType"][$Zf5] == "op"){$ZZZZZZZZZZZZS1818 = $this->ZZZZZZZZZZZG66($ZZZZZZZZZZZt19["val"][$Zf5]);}} $ZZZz25[] = $ZZZZZZZZZZZZS1818;} if($ZZZZZZZZZZZZR1717[$ZZZZZZZZZZZt19["op"]]["isExpr"]){$ZZS1818 = "(". implode($ZZZZZZZZZZZZR1717[$ZZZZZZZZZZZt19["op"]]["fn"],$ZZZz25) .")";}else{$ZZS1818 = $ZZZZZZZZZZZZR1717[$ZZZZZZZZZZZt19["op"]]["fn"]."(".implode($ZZZZZZZZZZZZR1717[$ZZZZZZZZZZZt19["op"]]["fn"],$ZZZz25) .")";}} return $ZZS1818;} function ZZZZZZZZZZZZT1919($ZZZc2){$ZZZZZZZZZZZv21 = PlatformConnector::ZZZZZZz25();$ZZT1919 = count($ZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZz25 = "ROUND(".$this->ZZZZZZZZZZZG66($ZZZc2[$Zf5]["val"]).", {$ZZZZZZZZZZZv21}) AS `".$ZZZc2[$Zf5]['name']."`";$this->ZZZZZZZZZZU2020[] = $ZZZz25;$this->ZZZZZZZZZZT1919[$ZZZc2[$Zf5]['name']] = $ZZZc2[$Zf5]["title"];}} function ZZZZZZZZZZZZU2020($filters){$ZZT1919 = count($filters);$ZZZx23 = array();$ZZZW2222 = " WHERE (1=1 ";for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZq16 = $this->ZZZZZZZZZZZZz25($filters[$Zf5],$this->ZZZZZZZZZZR1717);$ZZZW2222.= $ZZZZZq16["sql"];if(!empty($ZZZZZq16["params"])){$ZZZx23 = array_merge($ZZZx23,$ZZZZZq16["params"]);}} $this->ZZZZZZZZZZV2121 = $ZZZx23;$ZZZW2222.= ") ".$this->ZZZZZZZZZZZZJ99();return $ZZZW2222;} function ZZZZZZZZZZZZV2121(ZZZZZZZZZZx23 $module,$ZZZZZZZZZZZZD33,$filters,$ZZZZZx23 = array(),$ZZZZZZZZZZZZL1111 = array(),$ZZZH77 = array(),$ZZZZZZZZZZZZW2222 = false, $ZZZM1212 = array(), $ZZZZZZZZZZZZX2323 = array()){$ZZZZZZZZZZZZY2424 = array();$this->ZZZZZZZZZZZZN1313($module,$ZZZZZx23,$ZZZZZZZZZZZZD33,$ZZZM1212);$ZZZG66 = array();if($ZZZZZZZZZZZZW2222 == false){$ZZT1919 = count($this->ZZZZZZZZZZS1818);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){foreach($ZZZZZZZZZZZZL1111 as $ZZZZZZZZZZZZZ2525) {if($this->ZZZZZZZZZZS1818[$Zf5]['fieldname'] == $ZZZZZZZZZZZZZ2525['name']) {if(!empty($ZZZZZZZZZZZZZ2525['dateGrouping'])) {array_push($ZZZZZZZZZZZZY2424, $this->ZZZZZZZZZZS1818[$Zf5]['fieldname']);$this->ZZZZZZZZZZZZO1414($this->ZZZZZZZZZZS1818[$Zf5], null, $ZZZZZZZZZZZZZ2525['dateGrouping']);}}} if(!in_array($this->ZZZZZZZZZZS1818[$Zf5]['fieldname'], $ZZZZZZZZZZZZY2424)) {if($this->ZZZZZZZZZZS1818[$Zf5]['tablename'] !== '__virtual__') {$this->ZZZZZZZZZZZZO1414($this->ZZZZZZZZZZS1818[$Zf5],null,null);}}} $this->ZZZZZZZZZZZZT1919($ZZZM1212);} else{$ZZT1919 = count($ZZZZZZZZZZZZL1111);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(isset($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZZL1111[$Zf5]["name"]])){$ZZZZZZZZZZZZQ1616 = null;if(isset($ZZZZZZZZZZZZL1111[$Zf5]["dateGrouping"]) && isset($this->ZZZZZZZZZZW2222[$ZZZZZZZZZZZZL1111[$Zf5]["dateGrouping"]])){$ZZZZZZZZZZZZQ1616 = $ZZZZZZZZZZZZL1111[$Zf5]["dateGrouping"];} if(isset($ZZZZZZZZZZZZL1111[$Zf5]["sortAction"]) && $ZZZZZZZZZZZZL1111[$Zf5]["sortAction"] =="nogroup"){$ZZZZZZZZZZZZQ1616 = "nogroup";} $this->ZZZZZZZZZZZZO1414($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZZL1111[$Zf5]["name"]],null,$ZZZZZZZZZZZZQ1616);$ZZZz25 = $this->ZZZZZZZZZZZH77($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZZL1111[$Zf5]["name"]],$ZZZZZZZZZZZZL1111[$Zf5]);if(!empty($ZZZz25)){$ZZZG66[] = $ZZZz25;}}} $ZZT1919 = count($ZZZH77);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(isset($this->ZZZZZZZZZZR1717[$ZZZH77[$Zf5]["selectedField"]])){$this->ZZZZZZZZZZZZO1414($this->ZZZZZZZZZZR1717[$ZZZH77[$Zf5]["selectedField"]],$ZZZH77[$Zf5]["value"],null);} foreach($ZZZM1212 as $ZZZZZZZZZZZt19) {if($ZZZZZZZZZZZt19["name"] == $ZZZH77[$Zf5]["selectedField"]) {$this->ZZZZZZZZZZZZO1414(null, $ZZZH77[$Zf5]["value"], null, true, $ZZZZZZZZZZZt19);}}} $ZZT1919 = count($ZZZZZZZZZZZZL1111);for($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++){if(isset($ZZZZZZZZZZZZL1111[$Zf5]["dateGrouping"]) && !empty($ZZZZZZZZZZZZL1111[$Zf5]["dateGrouping"])){foreach($this->ZZZZZZZZZZS1818 as &$ZZZZZZZZZZZZZa0) {if($ZZZZZZZZZZZZZa0['fieldname'] == $ZZZZZZZZZZZZL1111[$Zf5]["name"]) {$ZZZZZZZZZZZZZa0['fieldname'] = $ZZZZZZZZZZZZZa0['fieldname'] . "_" . $ZZZZZZZZZZZZL1111[$Zf5]["dateGrouping"];$ZZZZZZZZZZZZZa0['dateGrouping'] = $ZZZZZZZZZZZZL1111[$Zf5]["dateGrouping"];}}}}} $ZZZW2222 = $this->ZZZZZZZZZZZZU2020($filters);$ZZZZH77 = $this->ZZZZZZZZZZZZK1010($ZZZZZZZZZZZZL1111,!$ZZZZZZZZZZZZW2222);$ZZZZy24 = "";if(!empty($ZZZG66)){$ZZZZy24= " GROUP BY ".implode(" , ",$ZZZG66);} if(in_array($this->ZZZZZZZZZZO1414[0]['name'], array('oqc_offering'))) {$ZZZZZZZZZZZZZb1 = $this->ZZZZZZZZZZH77[0][$this->ZZZZZZZZZZO1414[0]['name']];$ZZZW2222 .= " AND `$ZZZZZZZZZZZZZb1`.`is_latest` = 1 ";} $ZZZZZZZZZZN1313 = $this->ZZZZZZZZZZZZZc2($ZZZZZZZZZZZZL1111, $filters, $this->ZZZZZZZZZZO1414[0]['name'], $this->ZZZZZZZZZZI88);$ZZZZZZZZZZZZZd3 = array();foreach($ZZZZZZZZZZZZL1111 as $ZZZZZZZZZZZZZe4) {if(in_array($ZZZZZZZZZZZZZe4['name'], $ZZZZZZZZZZZZZd3)) {continue;} if(isset($ZZZZZZZZZZZZZe4['showTop']) && $ZZZZZZZZZZZZZe4['showTop'] > 0) {$ZZZZZZZZZZZZZd3[] = $ZZZZZZZZZZZZZe4['name'];$this->ZZZZZZZZZZV2121 = array_merge($this->ZZZZZZZZZZV2121, $this->ZZZZZZZZZZV2121);}} $ZZq16 ="SELECT ".implode(" , ",$this->ZZZZZZZZZZU2020);$ZZq16.= " FROM ".$ZZZZZZZZZZN1313['mainTable']. " AS ".$this->ZZZZZZZZZZH77[0][$this->ZZZZZZZZZZO1414[0]['name']];$ZZq16.= " ".implode(" ", $ZZZZZZZZZZN1313['joinTables']);$ZZq16.= $ZZZW2222;$ZZq16.= $ZZZZy24;$ZZq16.= $ZZZZH77;$ZZZZZZZZZZZZZf5 = $this->ZZZZZZZZZZZZZg6($ZZq16, $this->ZZZZZZZZZZV2121, $ZZZZZZZZZZZZX2323);$ZZq16.= $ZZZZZZZZZZZZZf5["sql"];return array("sql" => $ZZq16, "params" => $this->ZZZZZZZZZZV2121, "cols" => $this->ZZZZZZZZZZT1919, "fields" => $this->ZZZZZZZZZZS1818, "meta" => $ZZZZZZZZZZZZZf5["meta"],);} function ZZZZZZZZZZZZZg6($ZZq16, $ZZZx23, $ZZZZZZZZZZZZX2323){$ZZZZZZZZZZZZZf5 = array("meta" => array(), "sql" => '');if(!isset($ZZZZZZZZZZZZX2323["pagination"])) {$ZZZZZZZZZZZZX2323["pagination"] = false;} if(!isset($ZZZZZZZZZZZZX2323['records']) && $ZZZZZZZZZZZZX2323["pagination"]) {$query = 'SELECT COUNT(*) AS `COUNT` FROM ('.$ZZq16.') AS `counterTable`';$ZZn13 = $this->db->ZZZw22($query, $ZZZx23);$ZZZZZZZZZZZZX2323['records'] = (int) $ZZn13[0]['COUNT'];} if(isset($ZZZZZZZZZZZZX2323['records']) && isset($ZZZZZZZZZZZZX2323['limit']) && $ZZZZZZZZZZZZX2323["pagination"]) {$limit = (int) $ZZZZZZZZZZZZX2323['limit'];$ZZZZZZZZZZZZZh7 = 0;if($ZZZZZZZZZZZZX2323['records'] > 0 && $limit > 0) {$ZZZZZZZZZZZZZh7 = (int) ceil($ZZZZZZZZZZZZX2323['records'] / $limit);} $ZZZZZZZZZZZZX2323['pages'] = $ZZZZZZZZZZZZZh7;if(isset($ZZZZZZZZZZZZX2323['currentPage'])) {if($ZZZZZZZZZZZZX2323['currentPage'] > $ZZZZZZZZZZZZX2323['pages']) {$ZZZZZZZZZZZZX2323['currentPage'] = 1;} $ZZZZZZZT1919 = ($ZZZZZZZZZZZZX2323['currentPage'] - 1) * $limit;} else {$ZZZZZZZT1919 = 0;$ZZZZZZZZZZZZX2323['currentPage'] = 1;} $ZZZZZZZZZZZZZf5["sql"] = " LIMIT $ZZZZZZZT1919, $limit";} $ZZZZZZZZZZZZZf5["meta"] = $ZZZZZZZZZZZZX2323;return $ZZZZZZZZZZZZZf5;} function ZZZZZZZZZZZZZi8($ZZZZZZZZZZZZL1111, $filters) {$ZZZZZZZZZZZZZj9 = array('limit' => 0, 'column' => false, 'sortDirection' => 'DESC', 'table' => false, 'tableAlias' => false, 'sql' => '',);if(empty($ZZZZZZZZZZZZL1111)) {return false;} $ZZZZZW2222 = 0;foreach($ZZZZZZZZZZZZL1111 as $ZZZZZZZZZZZZZk10 => $ZZZZZZZZZZZZZl11){if(isset($ZZZZZZZZZZZZZl11['showAggregates'])) {$ZZZZZW2222 = $ZZZZZZZZZZZZZk10;break;}} if(!isset($ZZZZZZZZZZZZL1111[$ZZZZZW2222]['showTop']) || empty($ZZZZZZZZZZZZL1111[$ZZZZZW2222]['showTop'])) {return false;} if($ZZZZZZZZZZZZL1111[$ZZZZZW2222]['showTop'] > 0) {$ZZZZZZZZZZZZZj9['limit'] = $ZZZZZZZZZZZZL1111[$ZZZZZW2222]['showTop'];$ZZZZZZZZZZZZZj9['field'] = $ZZZZZZZZZZZZL1111[$ZZZZZW2222]['name'];$ZZZZZZZZZZZZZj9['aggregate'] = $ZZZZZZZZZZZZL1111[$ZZZZZW2222]['aggregate'];$ZZZZZZZZZZZZZj9['aggregateSortDirection'] = $ZZZZZZZZZZZZL1111[$ZZZZZW2222]['sortDirection'];$ZZZ2525 = $this->ZZZZZZZZZZZZZm12($ZZZZZZZZZZZZL1111[$ZZZZZW2222]['name']);$ZZZZZZZZZZZZZj9 = array_merge($ZZZZZZZZZZZZZj9, $ZZZ2525);if($ZZZZZZZZZZZZZj9['aggregate']) {$ZZZZZZZZZZZZZn13 = false;$ZZZZZZZZZZZZZj9['aggregateTable'] = false;$ZZZZZZZZZZZZZj9['aggregateTableAlias'] = false;$ZZZZZq16 = explode("_", $ZZZZZZZZZZZZZj9['aggregate'], 2);if(in_array($ZZZZZq16[0], array("sum", "avg", "count"))) {$ZZZZZZZZZZZZZn13 = $ZZZZZq16[0];array_shift($ZZZZZq16);$ZZZZZZZZZZZZZo14 = $ZZZZZq16[0];} else {$ZZZZZZZZZZZZZo14 = $ZZZZZZZZZZZZZj9['aggregate'];} $ZZZ2525 = $this->ZZZZZZZZZZZZZm12($ZZZZZZZZZZZZZo14);$ZZZZZZZZZZZZZj9['aggregateType'] = $ZZZZZZZZZZZZZn13;$ZZZZZZZZZZZZZj9['aggregateColumn'] = $ZZZ2525['column'];$ZZZZZZZZZZZZZj9['aggregateTable'] = $ZZZ2525['table'];$ZZZZZZZZZZZZZj9['aggregateTableAlias'] = $ZZZ2525['tableAlias'];$ZZZZZZZZZZZZZj9['aggregateColumn'] = str_replace("#alias#", $ZZZ2525['tableAlias'], $ZZZZZZZZZZZZZj9['aggregateColumn']);} $ZZZZm12 = $ZZZZZZZZZZZZZj9['table'];$ZZZZZZZZZZZZZb1 = $ZZZZZZZZZZZZZj9['tableAlias'];$ZZZZZZZL1111 = $ZZZZZZZZZZZZZj9['column'];$limit = $ZZZZZZZZZZZZZj9['limit'];$aggregateColumn= $ZZZZZZZZZZZZZj9['aggregateColumn'];$ZZZZZZZZZZZZZp15 = $ZZZZZZZZZZZZZj9['aggregateTableAlias'];$ZZZZZZZZZZZZZq16 = $ZZZZZZZZZZZZZj9['aggregateSortDirection'];$ZZZZZZZZZZZZZn13 = $ZZZZZZZZZZZZZj9['aggregateType'];$ZZZZZZZZZZZZZr17 = " `$ZZZZZZZZZZZZZp15`.`$aggregateColumn` ";if($ZZZZZZZZZZZZZn13 && in_array(strtoupper($ZZZZZZZZZZZZZn13), array('SUM', 'COUNT', 'AVG'))) {$ZZZZZZZZZZZZZr17 = " $ZZZZZZZZZZZZZn13($ZZZZZZZZZZZZZr17) ";} $ZZZW2222 = $this->ZZZZZZZZZZZZU2020($filters);$ZZq16 = "SELECT * FROM `".$ZZZZm12."` WHERE `".$ZZZZm12."`.`".$ZZZZZZZL1111."` IN (SELECT * FROM (SELECT `".$ZZZZZZZZZZZZZb1."`.`".$ZZZZZZZL1111."` FROM `".$this->ZZZZZZZZZZO1414[0]['name']."` AS ".$this->ZZZZZZZZZZH77[0][$this->ZZZZZZZZZZO1414[0]['name']]." ".implode("\n", $this->ZZZZZZZZZZI88)." $ZZZW2222 GROUP BY `".$ZZZZZZZZZZZZZb1."`.`".$ZZZZZZZL1111."` ORDER BY $ZZZZZZZZZZZZZr17 ".$ZZZZZZZZZZZZZq16." LIMIT $limit) AS tmp_limit_table) ";$ZZZZZZZZZZZZZj9['sql'] = "($ZZq16)";} return $ZZZZZZZZZZZZZj9;} function ZZZZZZZZZZZZZm12($field) {$r17 = array();foreach($this->ZZZZZZZZZZR1717 as $ZZZZZZZZZZZZZs18) {if ($ZZZZZZZZZZZZZs18['fieldname'] == $field) {$r17['column'] = $ZZZZZZZZZZZZZs18['columnname'];$r17['table'] = $ZZZZZZZZZZZZZs18['tablename'];$r17['tableAlias'] = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZZZs18['module']][$ZZZZZZZZZZZZZs18['tablename']];break;}} return $r17;} function ZZZZZZZZZZZZZc2($ZZZZZZZZZZZZL1111, $filters, $ZZZZZZZZZZO1414, $ZZZZZZZZZZZZZt19) {$ZZZZZZZZZZZZZj9 = $this->ZZZZZZZZZZZZZi8($ZZZZZZZZZZZZL1111, $filters);if($ZZZZZZZZZZZZZj9) {if($ZZZZZZZZZZO1414 == $ZZZZZZZZZZZZZj9['table']) {$ZZZZZZZZZZO1414 = $ZZZZZZZZZZZZZj9['sql'];} foreach($ZZZZZZZZZZZZZt19 as &$ZZZZZZZZZZZN1313) {$ZZZZZZZZZZZZZu20 = strpos($ZZZZZZZZZZZN1313, $ZZZZZZZZZZZZZj9['table']);if($ZZZZZZZZZZZZZu20) {$ZZZZZZZZZZZN1313 = str_replace("`".$ZZZZZZZZZZZZZj9['table']."`", $ZZZZZZZZZZZZZj9['sql'], $ZZZZZZZZZZZN1313);break;}}} $r17 = array('mainTable' => $ZZZZZZZZZZO1414, 'joinTables' => $ZZZZZZZZZZZZZt19,);return $r17;}} class ZZZZZZZZZZZZZv21{protected $db;protected $ZZZZS1818;protected $ZZZK1010 = array();function __construct(ZZp15 $db, ZZZZT1919 $ZZZZS1818, $ZZZK1010 = array()){$this->db = $db;$this->ZZZZS1818 = $ZZZZS1818;$this->ZZZK1010 = $ZZZK1010;} function translate($Zu20,$ZZZZZZZZZZZZZw22 = false) {if(isset($this->ZZZK1010[$Zu20])) {return $this->ZZZK1010[$Zu20];} return $ZZZZZZZZZZZZZw22;} function ZZZZZZZZZZZZZx23($G66) {$ZZZZZZZZZZZZZy24 = array();foreach($G66 as $Zu20 => $value) {$ZZZZZZZZZZZZZz25 = $this->translate($Zu20);if($ZZZZZZZZZZZZZz25) {$value = $ZZZZZZZZZZZZZz25;} $ZZZZZZZZZZZZZy24[$Zu20] = $value;} return $ZZZZZZZZZZZZZy24;} function ZZZZZZZZZZZZZA00($module,$ZZZV2121,$filters,$ZZZZZx23 = array(),$ZZZG66,$ZZZH77,$ZZZZZZZZZZZZW2222 = false,$isCrosstab = true,$ZZZZZZZZZZZZZB11 = true,$aggregateColumn = false, $dateFormat = "yyyy-mm-dd",$ZZZZZZZZZZZZZC22 = false, $ZZZM1212 = array(), $ZZZZZZZZZZZZX2323 = array(), ARUser $ZZZZZZZZZZZZZD33){$ZZZZZZZZZZZZZE44 = new ZZZZZZZZZZG66($this->db,$this->ZZZZS1818, false, $ZZZZZZZZZZZZZD33);$ZZZZZZZZZZZZZF55 = array();$ZZT1919 = count($ZZZZZx23);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZF55[] = new ZZZZZZZZZZy24($ZZZZZx23[$Zf5]->name,$this->db,$this->ZZZZS1818,$ZZZZZx23[$Zf5]);} $ZZq16 = $ZZZZZZZZZZZZZE44->ZZZZZZZZZZZZV2121($module,$ZZZV2121,$filters,$ZZZZZZZZZZZZZF55,$ZZZG66,$ZZZH77,$ZZZZZZZZZZZZW2222,$ZZZM1212,$ZZZZZZZZZZZZX2323);$this->db->ZZZA00("SET NAMES utf8", array());$ZZS1818 = $this->db->ZZZw22($ZZq16["sql"],$ZZq16["params"]);array_unshift($ZZZZZZZZZZZZZF55,$module);$ZZZZZZZZZZZZZG66 = new ZZZZZZZZZZZZZH77($ZZZG66,$ZZq16["fields"],$ZZZZZZZZZZZZW2222);$ZZZZZZZZZZZZZG66->ZZZZZZZZZZZZZI88($ZZS1818);$ZZZZZZZZZZZZZJ99 = new ZZZZZZZZZZZZZK1010($this->ZZZZS1818,$this->db,$ZZq16["fields"],$ZZZG66,$ZZZZZZZZZZZZZF55,$dateFormat,$ZZZZZZZZZZZZZC22);$ZZZZZZZZZZZZZJ99->ZZZZZZZZZZZZZI88($ZZS1818);$ZZS1818 = array("cols" => $this->ZZZZZZZZZZZZZx23($ZZq16["cols"]), "data" => $ZZS1818);if($isCrosstab && count($ZZS1818["data"])>0){if($aggregateColumn){$ZZZZZZZZZZZZZL1111 = new ZZZZZZZZZZZZZM1212($this->db,$this->ZZZZS1818,$ZZZZZZZZZZZZZF55);}else{$ZZZZZZZZZZZZZL1111 = new ZZZZZZZZZZZZZN1313($this->db,$this->ZZZZS1818,$ZZZZZZZZZZZZZF55);} $ZZS1818 = $ZZZZZZZZZZZZZL1111->ZZZZZZZZZZZZZO1414($ZZS1818,$ZZZG66,$ZZZH77,$ZZq16["fields"]);} $ZZS1818["cols"] = $this->ZZZZZZZZZZZZZx23($ZZS1818["cols"]);if($ZZZZZZZZZZZZZB11){$ZZZZZZZZZZZZZJ99 = new ZZZZZZZZZZZZZP1515();$ZZZZZZZZZZZZZJ99->ZZZZZZZZZZZZZI88($ZZS1818["data"]);} $ZZS1818["meta"] = $ZZq16["meta"];$ZZS1818["pdffields"] = $this->ZZZZZZZZZZZZZQ1616($ZZZZZZZZZZZZZF55, $ZZS1818["cols"], $ZZS1818["data"], $isCrosstab, $aggregateColumn);return $ZZS1818;} function ZZZZZZZZZZZZZQ1616($ZZZZZZZZZZj9, $ZZZZZZZZZZZd3, $r17, $isCrosstab = false, $aggregateColumn = false) {$ZZZZZZZZZZZZZR1717 = array();if(!$aggregateColumn) {$ZZZZZZZZZZZZZS1818 = array();foreach ($ZZZZZZZZZZZd3 as $ZZZZn13 => $title) {$ZZZZZZZZZZZZZT1919 = strstr($ZZZZn13,'_');if(in_array(substr($ZZZZZZZZZZZZZT1919, -4), array('_sum','_min','_max','_cnt'))){if($isCrosstab){$ZZZZZZZZZZZZZT1919 = strstr(ltrim(substr($ZZZZZZZZZZZZZT1919,0,-4),'_'),'_');} else {$ZZZZZZZZZZZZZT1919 = substr($ZZZZZZZZZZZZZT1919,0,-4);}} $ZZZZZZZZZZZZZS1818[$ZZZZn13] = $ZZZZZZZZZZZZZT1919;} foreach ($ZZZZZZZZZZj9 as $module) {$ZZZc2 = $module->ZZZZZZZZZZZZZU2020();foreach ($ZZZc2 as $field) {if(in_array(strstr($field['name'],'_'), $ZZZZZZZZZZZZZS1818)){$ZZZZZZZZZZZZZV2121 = array_keys($ZZZZZZZZZZZZZS1818, strstr($field['name'],'_'));foreach ($ZZZZZZZZZZZZZV2121 as $ZZZZZZZZZZZZZW2222) {$ZZZZZZZZZZZZZR1717[$ZZZZZZZZZZZZZW2222] = $field['type'];}}}}} else {$ZZZZZZZZZZZZZX2323 = array();foreach ($ZZZZZZZZZZj9 as $module) {$ZZZc2 = $module->ZZZZZZZZZZZZZU2020();foreach ($ZZZc2 as $field) {if($field['type'] == 'integer'){$ZZZZZZZZZZZZZX2323[] = $field['name'];}}} $ZZZZZZZZZZZZZY2424 = array();foreach ($this->ZZZK1010 as $Zu20 => $ZZZZZl11) {$ZZZZZZZZZZZr17 = substr($Zu20, -4);if($ZZZZZZZZZZZr17 == '_cnt' || in_array($Zu20, $ZZZZZZZZZZZZZX2323)) {$ZZZZZZZZZZZZZR1717[$ZZZZZl11] = 'integer';} elseif (in_array($ZZZZZZZZZZZr17, array('_sum','_min','_max'))) {foreach ($ZZZZZZZZZZZZZX2323 as $field) {if(strpos($Zu20, $field) !== false){$ZZZZZZZZZZZZZR1717[$ZZZZZl11] = 'integer';}}}}} return $ZZZZZZZZZZZZZR1717;}}
class ZZZZZZZZZZZZZZ2525 extends ZZZZZZZZZZZZZv21{protected $ZZZZZZZZZZZZZZa0 = array();protected $ZZZZZZZZZZZZZZb1 = array();protected $ZZZZZZZZZZZZZZc2 = array();protected $ZZZZZZZZZZZZZZd3 = array();protected $ZZZZZZZZZZZZZZe4 = array();protected $ZZZZZZZZZZZZZZf5 = "";protected $ZZZZZZZZZZZZZZg6 = array();protected $ZZZZZZZZZZZZZZh7 = array();protected $ZZZR1717 = array();function ZZZZZZZZZZZZZZi8($ZZZZZZZZZZj9){$ZZT1919 = count($ZZZZZZZZZZj9);$ZZS1818 = 0;$ZZZZZZZZZZZZZZj9 = array();$ZZZZZZZZZZZZZZk10 = array();for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if($ZZZZZZZZZZj9[$Zf5]->joinModule == 0){$ZZZZZZZZZZj9[$Zf5]->joinModule = -1;$this->ZZZZZZZZZZZZZZa0[] = $Zf5;$ZZZZZZZZZZZZZZj9[$Zf5+1] = array();$ZZS1818++;} if($ZZZZZZZZZZj9[$Zf5]->joinModule>-1 && $ZZZZZZZZZZZZZZk10[$ZZZZZZZZZZj9[$Zf5]->joinModule]){$ZZZZZZZZZZZZZZj9[$ZZZZZZZZZZZZZZk10[$ZZZZZZZZZZj9[$Zf5]->joinModule]][$Zf5] = $ZZZZZZZZZZj9[$Zf5]->name;$ZZZZZZZZZZZZZZk10[$Zf5+1] = $ZZZZZZZZZZZZZZk10[$ZZZZZZZZZZj9[$Zf5]->joinModule];}else{$ZZZZZZZZZZZZZZk10[$Zf5+1] = $Zf5+1;}} if(!empty($ZZZZZZZZZZZZZZj9)){$this->ZZZZZZZZZZZZZZd3 = array_values(call_user_func_array("array_intersect",$ZZZZZZZZZZZZZZj9));} $this->ZZZZZZZZZZZZZZe4 = array();foreach($ZZZZZZZZZZZZZZj9 as $ZZZZZZZZZZZZZZl11 => $ZZZZZZZZZZZZZZm12){foreach($ZZZZZZZZZZZZZZm12 as $ZZZZZZZZZZZZZZn13 => $ZZZZZZZZZZZZZZo14){if(in_array($ZZZZZZZZZZZZZZo14,$this->ZZZZZZZZZZZZZZd3)){if(!isset($this->ZZZZZZZZZZZZZZe4[$ZZZZZZZZZZZZZZo14])){$this->ZZZZZZZZZZZZZZe4[$ZZZZZZZZZZZZZZo14] = array();} $this->ZZZZZZZZZZZZZZe4[$ZZZZZZZZZZZZZZo14][$ZZZZZZZZZZZZZZl11] = $ZZZZZZZZZZZZZZn13+1;}}} return $ZZS1818;} function ZZZZZZZZZZZZZZp15($module,$ZZZZZx23){$ZZS1818 = unserialize(serialize($ZZZZZx23));$ZZS1818[$module]->joinModule = -1;$ZZT1919 = count($ZZS1818);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if($ZZS1818[$Zf5]->joinModule == $module+1){$ZZS1818[$Zf5]->joinModule=0;}} $this->ZZZZZZZZZZZZZZb1 = array($module+1);$this->ZZZZZZZZZZZZZZc2 = array($module+1 => 0);do{$ZZZz25 = count($this->ZZZZZZZZZZZZZZb1);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if((in_array($ZZS1818[$Zf5]->joinModule,$this->ZZZZZZZZZZZZZZb1)||$ZZS1818[$Zf5]->joinModule==0) && !in_array($Zf5+1,$this->ZZZZZZZZZZZZZZb1)){$this->ZZZZZZZZZZZZZZb1[] = $Zf5+1;$this->ZZZZZZZZZZZZZZc2[$Zf5+1] = count($this->ZZZZZZZZZZZZZZc2);if(!$ZZS1818[$Zf5]->joinModule==0){$ZZS1818[$Zf5]->joinModule = $this->ZZZZZZZZZZZZZZc2[$ZZS1818[$Zf5]->joinModule];}}}}while($ZZZz25 < count($this->ZZZZZZZZZZZZZZb1));$ZZZZZZZZZZZZZZq16 = array();$ZZT1919 = count($this->ZZZZZZZZZZZZZZb1);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZq16[] = $ZZS1818[$this->ZZZZZZZZZZZZZZb1[$Zf5]-1];} return $ZZZZZZZZZZZZZZq16;} function ZZZZZZZZZZZZZZr17($filters){$ZZZz25 = unserialize(serialize($filters));$ZZS1818 = array();$ZZT1919 = count($ZZZz25);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $ZZZz25[$Zf5];$ZZZZZZZZZZZZZZs18 = count($ZZZz25[$Zf5]->filters);$ZZZZZZZZZZZZZZt19 = array();for($ZZZZZK1010 = 0;$ZZZZZK1010<$ZZZZZZZZZZZZZZs18;$ZZZZZK1010++){$ZZZZZq16 = explode("_",$ZZZz25[$Zf5]->filters[$ZZZZZK1010]->fieldName,2);if(!in_array($ZZZZZq16[0],$this->ZZZZZZZZZZZZZZb1)){$ZZZZZZZZZZZZZZt19[] = $ZZZZZK1010;}else{$ZZZZZq16[0] = $this->ZZZZZZZZZZZZZZc2[$ZZZZZq16[0]];$ZZZz25[$Zf5]->filters[$ZZZZZK1010]->fieldName = $ZZZZZq16[0]."_".$ZZZZZq16[1];}} $ZZZZZZZZZZZZZZs18 = count($ZZZZZZZZZZZZZZt19)-1;for($ZZZZZK1010 = $ZZZZZZZZZZZZZZs18;$ZZZZZK1010>-1;$ZZZZZK1010--){array_splice($ZZS1818[$Zf5]->filters,$ZZZZZZZZZZZZZZt19[$ZZZZZK1010],1);}} return $ZZS1818;} function ZZZZZZZZZZZZZZu20($ZZZc2,$module){$ZZZz25 = unserialize(serialize($ZZZc2));$ZZS1818 = array();$ZZT1919 = count($ZZZz25);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZq16 = explode("_",$ZZZz25[$Zf5],2);if(in_array($ZZZZZq16[0],$this->ZZZZZZZZZZZZZZb1)){$ZZS1818[] = array_search($ZZZZZq16[0],$this->ZZZZZZZZZZZZZZb1)."_".$ZZZZZq16[1];}elseif($ZZZZZq16[0]=="00"){$ZZZZZZZZZZZZZZv21 = explode("_",$ZZZZZq16[1],2);$ZZS1818[] = "0_".$module."_".$ZZZZZZZZZZZZZZv21[1];}} return $ZZS1818;} function ZZZZZZZZZZZZZZw22($ZZZZy24,$module){$ZZZz25 = unserialize(serialize($ZZZZy24));$ZZS1818 = array();$ZZT1919 = count($ZZZz25);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZq16 = explode("_",$ZZZz25[$Zf5]["name"],2);$ZZZZZZZZZZZZZZv21 = explode("_",$ZZZZZq16[1],2);$ZZZZZZZZZZZZZZx23 = $ZZZz25[$Zf5]["name"];if(in_array($ZZZZZq16[0],$this->ZZZZZZZZZZZZZZb1)){$ZZZz25[$Zf5]["name"] = $this->ZZZZZZZZZZZZZZc2[$ZZZZZq16[0]]."_".$ZZZZZq16[1];}elseif(isset($this->ZZZZZZZZZZZZZZe4[$ZZZZZZZZZZZZZZv21[0]])){$ZZZz25[$Zf5]["name"] = $this->ZZZZZZZZZZZZZZc2[$this->ZZZZZZZZZZZZZZe4[$ZZZZZZZZZZZZZZv21[0]][$this->ZZZZZZZZZZZZZZb1[0]]]."_".$ZZZZZq16[1];if(!in_array($ZZZz25[$Zf5]["name"],$this->ZZZZZZZZZZZZZZg6)){$this->ZZZZZZZZZZZZZZg6[] = $ZZZz25[$Zf5]["name"];$this->ZZZZZZZZZZZZZZh7[$ZZZz25[$Zf5]["name"]] = $ZZZZZZZZZZZZZZx23;}}elseif($ZZZz25[$Zf5]["name"] =="00_ALL_assigned_user_id"){$ZZZz25[$Zf5]["name"] = "0_".$module."_assigned_user_id";$this->ZZZZZZZZZZZZZZg6[] = $ZZZz25[$Zf5]["name"];$this->ZZZZZZZZZZZZZZh7[$ZZZz25[$Zf5]["name"]] = $ZZZZZZZZZZZZZZx23;} if(isset($ZZZz25[$Zf5]["aggregate"]) && $ZZZz25[$Zf5]["aggregate"] == $ZZZZZZZZZZZZZZx23){$ZZZz25[$Zf5]["aggregate"] = $ZZZz25[$Zf5]["name"];} $ZZS1818[] = $ZZZz25[$Zf5];} $this->commonFieldsCount = count($this->ZZZZZZZZZZZZZZg6);return $ZZS1818;} function ZZZZZZZZZZZZZZy24($ZZZH77){$ZZZz25 = unserialize(serialize($ZZZH77));$ZZS1818 = array();$ZZT1919 = count($ZZZz25);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZq16 = explode("_",$ZZZz25[$Zf5]["selectedField"],2);if(in_array($ZZZZZq16[0],$this->ZZZZZZZZZZZZZZb1)){$ZZZz25[$Zf5]["selectedField"] = $this->ZZZZZZZZZZZZZZc2[$ZZZZZq16[0]]."_".$ZZZZZq16[1];$ZZS1818[] = $ZZZz25[$Zf5];}} return $ZZS1818;} function ZZZZZZZZZZZZZZz25($ZZq16,$prefix){$ZZZZZZZZZZZZZZA00 = "SELECT DISTINCT `date_field` ";$ZZZZZZZZZZZZZZg6 = "";if(!empty($this->commonFieldsCount)){$ZZZZZZZZZZZZZZg6 = array();$ZZT1919 = $this->commonFieldsCount;for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZg6[] = "c_".$Zf5;if($this->ZZZZZZZZZZZZZZh7[$this->ZZZZZZZZZZZZZZg6[$Zf5]]!=="00_ALL_assigned_user_id"){$ZZZZZq16 = explode("_",$this->ZZZZZZZZZZZZZZg6[$Zf5]);$field = $this->db->ZZU2020($ZZZZZq16[1],$ZZZZZq16[2]);$field["fieldname_org"] = $field["fieldname"];if($this->ZZZZS1818->ZZZZZw22($field,$this->db,false,$ZZZZZq16[1])){$ZZZZZZZZZZZZZZg6[] = "c_".$Zf5."_setype";$ZZZZZZZZZZZZZZg6[] = "c_".$Zf5."_id";}}} $ZZZZZZZZZZZZZZg6 = ", ".implode(", ",$ZZZZZZZZZZZZZZg6);} $ZZZZZZZZZZZZZZA00.= $ZZZZZZZZZZZZZZg6." FROM (";$ZZZZZZZZZZZZZZB11 = array();$ZZT1919 = count($ZZq16);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if($ZZq16[$Zf5]!==null){$ZZZZZZZZZZZZZZB11[] = "SELECT `date_field` $ZZZZZZZZZZZZZZg6 FROM ".$ZZq16[$Zf5]["table"];}} $ZZZZZZZZZZZZZZA00.= implode(" UNION ",$ZZZZZZZZZZZZZZB11);$ZZZZZZZZZZZZZZA00.= ")`date_fields`";$ZZZZZZZZZZZZZZC22 = "CREATE TEMPORARY TABLE IF NOT EXISTS ar_temp_{$prefix}_union AS ($ZZZZZZZZZZZZZZA00)";$this->ZZZZZZZZZZZZZZf5 = "ar_temp_".$prefix."_union";return $ZZZZZZZZZZZZZZC22;} function ZZZZZZZZZZZZZZD33(&$ZZq16,$ZZZZZF55){$ZZZZZZZZZZZZZZE44 = array_keys($ZZq16["cols"]);$ZZZZZZZZZZZZZZA00 = "SELECT ";$ZZZZZZZZZZZZZZA00.= "`combined`.`{$ZZZZZZZZZZZZZZE44[0]}` AS `date_field` ";array_shift($ZZZZZZZZZZZZZZE44);$ZZT1919 = count($ZZZZZZZZZZZZZZE44);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZA00.= ", `combined`.`{$ZZZZZZZZZZZZZZE44[$Zf5]}` AS `c_$Zf5` ";if($ZZZZZZZZZZZZZZE44[$Zf5]!=="00_ALL_assigned_user_id"){$ZZZZZq16 = $this->db->ZZZe4($ZZZZZZZZZZZZZZE44[$Zf5]);$field = $this->db->ZZU2020($ZZZZZq16[1],$ZZZZZq16[2]);$field["fieldname_org"] = $field["fieldname"];if($this->ZZZZS1818->ZZZZZw22($field,$this->db,false,$ZZZZZq16[1])){$ZZZZZZZZZZZZZZA00.=", `combined`.`{$ZZZZZZZZZZZZZZE44[$Zf5]}_setype` AS `c_{$Zf5}_setype` ";$ZZZZZZZZZZZZZZA00.=", `combined`.`{$ZZZZZZZZZZZZZZE44[$Zf5]}_id` AS `c_{$Zf5}_id` ";}}} $ZZZZZZZZZZZZZZA00.= " FROM ({$ZZq16["sql"]}) `combined`";$ZZZZZZZZZZZZZZC22 = "CREATE TEMPORARY TABLE IF NOT EXISTS ar_temp_$ZZZZZF55 AS ($ZZZZZZZZZZZZZZA00)";$ZZq16["table"] = "ar_temp_$ZZZZZF55";$ZZq16["createTmpTable"] = $ZZZZZZZZZZZZZZC22;$ZZq16["fixTable"] = "UPDATE ".$ZZq16["table"]." SET `date_field` ='-' WHERE `date_field` IS NULL";$ZZq16["removeTable"] = "DROP TEMPORARY TABLE IF EXISTS ".$ZZq16["table"];} function ZZZZZZZZZZZZZZF55(&$ZZq16){$ZZZZZZZZZZZZZZE44 = array_keys($ZZq16["cols"]);$ZZZz25 = array_shift($ZZZZZZZZZZZZZZE44);$ZZT1919 = count($ZZZZZZZZZZZZZZE44);$ZZZZZZZZZZZZZZG66 = array($ZZZz25=> $ZZq16["cols"][$ZZZz25]);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZq16 = explode("_",$ZZZZZZZZZZZZZZE44[$Zf5],2);$ZZZZZZZZZZZc2 = array_search($ZZZZZq16[0],$this->ZZZZZZZZZZZZZZc2);$ZZZZZZZZZZZZZZG66[$ZZZZZZZZZZZc2."_".$ZZZZZq16[1]] = $ZZq16["cols"][$ZZZZZZZZZZZZZZE44[$Zf5]];$ZZq16["sql"] = str_replace($ZZZZZZZZZZZZZZE44[$Zf5],$ZZZZZZZZZZZc2."_".$ZZZZZq16[1],$ZZq16["sql"]);} $ZZT1919 = count($ZZq16["fields"]);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZq16 = explode("_",$ZZq16["fields"][$Zf5]["fieldname"],2);$ZZZZZZZZZZZc2 = array_search($ZZZZZq16[0],$this->ZZZZZZZZZZZZZZc2);$ZZq16["fields"][$Zf5]["fieldname"] = $ZZZZZZZZZZZc2."_".$ZZZZZq16[1];$ZZq16["fields"][$Zf5]["module"] = $ZZZZZZZZZZZc2;} $ZZq16["cols"] = $ZZZZZZZZZZZZZZG66;} function ZZZZZZZZZZZZZZH77($ZZZZZZZZZZZZZE44,$ZZZZZZZZZZZZZZI88,$ZZZV2121,$filters,$ZZZZZx23 = array(),$ZZZG66,$ZZZH77,$ZZZZZZZZZZZZW2222 = false){$this->ZZZZZZZZZZZZZZg6 = array();$ZZZZZZZZZZZZZF55 = array();$ZZZZZx23 = $this->ZZZZZZZZZZZZZZp15($ZZZZZZZZZZZZZZI88,$ZZZZZx23);$ZZZZZZZZZZw22 = array_shift($ZZZZZx23);$ZZT1919 = count($ZZZZZx23);$filters = $this->ZZZZZZZZZZZZZZr17($filters);$ZZZV2121 = $this->ZZZZZZZZZZZZZZu20($ZZZV2121,$ZZZZZZZZZZw22->name);$ZZZG66 = $this->ZZZZZZZZZZZZZZw22($ZZZG66,$ZZZZZZZZZZw22->name);$ZZZH77 = $this->ZZZZZZZZZZZZZZy24($ZZZH77);if(count($ZZZV2121)== 0 || count($ZZZH77)== 0 ||count($ZZZG66)== 0){return null;} for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZF55[] = new ZZZZZZZZZZy24($ZZZZZx23[$Zf5]->name,$this->db,$this->ZZZZS1818,$ZZZZZx23[$Zf5]);} $module = new ZZZZZZZZZZx23($ZZZZZZZZZZw22->name,$this->db,$this->ZZZZS1818);$ZZq16 = $ZZZZZZZZZZZZZE44->ZZZZZZZZZZZZV2121($module,$ZZZV2121,$filters,$ZZZZZZZZZZZZZF55,$ZZZG66,$ZZZH77,$ZZZZZZZZZZZZW2222);$this->ZZZZZZZZZZZZZZF55($ZZq16);$ZZq16["commonFields"] = $this->ZZZZZZZZZZZZZZg6;return $ZZq16;} function ZZZZZZZZZZZZZZJ99($ZZZZZZZZZZZZZZK1010, $ZZZZZZZZZZZZZE44, $ZZZZZZZZZZZZZZL1111,$ZZZZZZZZZZZZZZf5,$ZZZG66, $ZZZZZZZZZZZZX2323 = array()){$ZZZZZZZZZZI88 = array();$ZZZZG66 = array();$ZZZZZZZZZZZd3 = array("date_field"=>"Date");$ZZZc2 = array();$ZZT1919 = $this->commonFieldsCount;$ZZZZZZZZZZZZZZg6 = "";$ZZZZZZZZZZZZZZM1212 = $ZZT1919;$field = array();$field["fieldname_org"] = "date_field";$field["fieldname"] = "date_field";$field["module"] = 0;$field["uitype"] = 'date';$ZZZc2[] = $field;if(!empty($ZZZZZZZZZZZZZZL1111[1]["commonFields"])){$ZZZZZZZZZZZZZZg6 = array();for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZg6[] = "`t{{i}}`.`c_".$Zf5."` = `u`.`c_".$Zf5."`";$ZZZZG66[] = "`u`.`c_".$Zf5."` AS `".$this->ZZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZL1111[1]["commonFields"][$Zf5]]."`";$ZZZZZq16 = explode("_",$this->ZZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZL1111[1]["commonFields"][$Zf5]],3);if($ZZZZZq16[0]=="00"){$field = array("name"=>"00_ALL_assigned_user_id", "column"=>"assigned_user_id", "table"=>"vtiger_crmentity", "uitype"=>53, "type"=>"txt", "title"=>$this->ZZZZS1818->ZZZZZk10("Assigned To",$this->ZZZZZx23[1]->name), "bareTitle"=>$this->ZZZZS1818->ZZZZZk10("Assigned To",$this->ZZZZZx23[1]->name), "availableValues" =>array(),);}else{$field = $this->db->ZZU2020($ZZZZZq16[1],$ZZZZZq16[2]);} $field["fieldname_org"] = $field["fieldname"];$field["fieldname"] = $this->ZZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZL1111[1]["commonFields"][$Zf5]];$field["module"] = $ZZZZZq16[0]-1;if($this->ZZZZS1818->ZZZZZw22($field,$this->db,false,$ZZZZZq16[1])){$ZZZZG66[] = "`u`.`c_".$Zf5."_id` AS `".$this->ZZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZL1111[1]["commonFields"][$Zf5]]."_id`";$ZZZZG66[] = "`u`.`c_".$Zf5."_setype` AS `".$this->ZZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZL1111[1]["commonFields"][$Zf5]]."_setype`";} $ZZZc2[] = $field;if($ZZZZZq16[0]=="00"){$ZZZZZZZZZZZd3[$this->ZZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZL1111[1]["commonFields"][$Zf5]]] = "Assigned To";}else{$ZZZZZZZZZZZd3[$this->ZZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZL1111[1]["commonFields"][$Zf5]]] = $this->ZZZZS1818->ZZZZZk10($ZZZZZq16[1],$ZZZZZq16[1])." ".$this->ZZZZS1818->ZZZZZk10($field["fieldlabel"],$ZZZZZq16[1]);}} $ZZZZZZZZZZZZZZg6 = " AND ".implode(" AND ",$ZZZZZZZZZZZZZZg6);} array_unshift($ZZZG66,"tmp");$ZZT1919 = count($ZZZZZZZZZZZZZZL1111);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if($ZZZZZZZZZZZZZZL1111[$Zf5]!==null){$ZZZZZZZZZZI88[$Zf5] = "LEFT JOIN ".$ZZZZZZZZZZZZZZL1111[$Zf5]["table"]." `t".$Zf5."` ON (`t".$Zf5."`.`date_field`=`u`.`date_field` ".str_replace("{{i}}",$Zf5,$ZZZZZZZZZZZZZZg6).")";$ZZZZZZZZZZZZZZE44 = array_keys($ZZZZZZZZZZZZZZL1111[$Zf5]["cols"]);array_shift($ZZZZZZZZZZZZZZE44);$ZZZZZZZZZZZZZZs18 = count($ZZZZZZZZZZZZZZE44);for($ZZZZZK1010 = 0;$ZZZZZK1010<$ZZZZZZZZZZZZZZM1212;$ZZZZZK1010++){array_shift($ZZZZZZZZZZZZZZE44);} for($ZZZZZK1010=$ZZZZZZZZZZZZZZM1212;$ZZZZZK1010<$ZZZZZZZZZZZZZZs18;$ZZZZZK1010++){$ZZZZG66[] = "`t".$Zf5."`.`c_".$ZZZZZK1010."` AS `".$ZZZZZZZZZZZZZZE44[$ZZZZZK1010-$ZZZZZZZZZZZZZZM1212]."`";$ZZZZZZZZZZZd3[$ZZZZZZZZZZZZZZE44[$ZZZZZK1010-$ZZZZZZZZZZZZZZM1212]] = $ZZZZZZZZZZZZZZL1111[$Zf5]["cols"][$ZZZZZZZZZZZZZZE44[$ZZZZZK1010-$ZZZZZZZZZZZZZZM1212]];} array_shift($ZZZG66);}} $ZZZZH77 = array();$ZZT1919 = count($ZZZc2);if($ZZZG66[0]["sortAction"] =="groupsort"){if($ZZZG66[0]["sortDirection"]=="DESC"){$ZZZZZZZM1212 = "DESC";}else{$ZZZZZZZM1212 = "ASC";} if(isset($ZZZG66[0]["dateGrouping"]) && ($ZZZG66[0]["dateGrouping"]=="monthAndYear" ||$ZZZG66[0]["dateGrouping"]=="weekAndYear")){$ZZZZH77[] = "LEFT(`u`.`date_field`,4) $ZZZZZZZM1212, CAST(MID(`u`.`date_field`,6,2) AS UNSIGNED) $ZZZZZZZM1212";}else{$ZZZZH77[] = "`u`.`date_field` $ZZZZZZZM1212 ";}} for($Zf5=1;$Zf5<$ZZT1919;$Zf5++){if($ZZZc2[$Zf5]["fieldname"]== $ZZZG66[$Zf5]["name"]){if($ZZZG66[$Zf5]["sortAction"] =="groupsort"){if($ZZZG66[$Zf5]["sortDirection"]=="DESC"){$ZZZZH77[] = "`u`.c_".($Zf5-1)." DESC ";}else{$ZZZZH77[] = "`u`.c_".($Zf5-1)." ASC ";}}}} if(!empty($ZZZZH77)){$ZZZZH77 = " ORDER BY ".implode(" ,",$ZZZZH77);}else{$ZZZZH77 = "";} $ZZq16 = "SELECT `u`.`date_field`, ";$ZZq16.= implode(", ",$ZZZZG66);$ZZq16.= "FROM ".$ZZZZZZZZZZZZZZf5." `u` ";$ZZq16.= implode(" ",$ZZZZZZZZZZI88).$ZZZZH77;$ZZZz25 = $this->db->ZZZA00($ZZZZZZZZZZZZZZK1010,array());$ZZZZZZZZZZZZZf5 = $ZZZZZZZZZZZZZE44->ZZZZZZZZZZZZZg6($ZZq16, array(), $ZZZZZZZZZZZZX2323);$ZZq16.= $ZZZZZZZZZZZZZf5["sql"];$ZZZZZZZZZZZZZZN1313 = "DROP TEMPORARY TABLE IF EXISTS ".$this->ZZZZZZZZZZZZZZf5;return array("sql" => $ZZq16, "params" => array(), "cols" => $ZZZZZZZZZZZd3, "fields" => $ZZZc2, "removeTable" => $ZZZZZZZZZZZZZZN1313, "meta" => $ZZZZZZZZZZZZZf5["meta"],);} function ZZZZZZZZZZZZZZO1414($ZZZZZx23){$this->ZZZZZZZZZZZZZZi8($ZZZZZx23);$ZZS1818 = array();foreach($this->ZZZZZZZZZZZZZZa0 as $ZZZZZZZZZZZZZZl11){$ZZS1818[] = $ZZZZZZZZZZZZZZl11+1;} return $ZZS1818;} function ZZZZZZZZZZZZZZP1515($ZZZZZx23){$ZZZZZZZZZZZZZZQ1616 = $this->ZZZZZZZZZZZZZZO1414($ZZZZZx23);$ZZZZZZZZZZZZZZR1717 = array();$ZZZZZZZZZZZZZZS1818 = array("00");$ZZS1818 = array();$ZZT1919 = count($ZZZZZx23);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(in_array($ZZZZZx23[$Zf5]->name,$this->ZZZZZZZZZZZZZZd3)){$ZZZZZZZZZZZZZZS1818[] = $Zf5+1;if(in_array($ZZZZZx23[$Zf5]->name,$ZZZZZZZZZZZZZZR1717)){$ZZS1818[] = $Zf5;}else{$ZZZZZZZZZZZZZZR1717[] = $ZZZZZx23[$Zf5]->name;}}} return array("skip"=>$ZZS1818,"common"=>$this->ZZZZZZZZZZZZZZd3,"commonIds"=>$ZZZZZZZZZZZZZZS1818);} function ZZZZZZZZZZZZZZT1919($ZZZc2){$this->ZZZR1717 = $ZZZc2;} function ZZZZZZZZZZZZZZU2020(&$ZZZZy24){$ZZZZZq16 = null;$ZZT1919 = count($this->ZZZR1717);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(in_array($ZZZZy24[0]["name"],$this->ZZZR1717)){$ZZZZZq16 = array_shift($ZZZZy24);}}} function ZZZZZZZZZZZZZA00($module,$ZZZV2121,$filters,$ZZZZZx23 = array(),$ZZZG66,$ZZZH77,$ZZZZZZZZZZZZW2222 = false,$isCrosstab = true,$ZZZZZZZZZZZZZB11 = true,$aggregateColumn = false, $dateFormat = "yyyy-mm-dd", $ZZZZZZZZZZZZZC22 = false, $ZZZM1212 = array(), $ZZZZZZZZZZZZX2323 = array(), ARUser $ZZZZZZZZZZZZZD33){$ZZZZZZZZZZZZZE44 = new ZZZZZZZZZZG66($this->db,$this->ZZZZS1818,true, $ZZZZZZZZZZZZZD33);$ZZZZZZX2323 = $this->ZZZZZZZZZZZZZZi8($ZZZZZx23);$ZZZZZZZZZZZZZZV2121 = str_replace('-', '_', session_id());$ZZq16 = array();for($Zf5 = 0;$Zf5<$ZZZZZZX2323;$Zf5++){$ZZq16[$Zf5] = $this->ZZZZZZZZZZZZZZH77($ZZZZZZZZZZZZZE44,$this->ZZZZZZZZZZZZZZa0[$Zf5],$ZZZV2121,$filters,$ZZZZZx23,$ZZZG66,$ZZZH77,$ZZZZZZZZZZZZW2222);} for($Zf5 = 0;$Zf5<$ZZZZZZX2323;$Zf5++){if($ZZq16[$Zf5]!==null){$this->ZZZZZZZZZZZZZZD33($ZZq16[$Zf5],$Zf5.$ZZZZZZZZZZZZZZV2121);}} for($Zf5 = 0;$Zf5<$ZZZZZZX2323;$Zf5++){if($ZZq16[$Zf5]!==null){$ZZZz25 = $this->db->ZZZA00($ZZq16[$Zf5]["removeTable"],array());$ZZZz25 = $this->db->ZZZA00($ZZq16[$Zf5]["createTmpTable"],$ZZq16[$Zf5]["params"]);$ZZZz25 = $this->db->ZZZA00($ZZq16[$Zf5]["fixTable"],array());}} $ZZZZZZZZZZZZZZK1010 = $this->ZZZZZZZZZZZZZZz25($ZZq16,"report".$ZZZZZZZZZZZZZZV2121);$ZZZZZZZZZZZZZZW2222 = $this->ZZZZZZZZZZZZZZJ99($ZZZZZZZZZZZZZZK1010, $ZZZZZZZZZZZZZE44, $ZZq16,$this->ZZZZZZZZZZZZZZf5,$ZZZG66,$ZZZZZZZZZZZZX2323);$ZZZz25 = $this->db->ZZZA00($ZZZZZZZZZZZZZZW2222["removeTable"],array());$ZZZz25 = $this->db->ZZZA00($ZZZZZZZZZZZZZZK1010,array());$ZZS1818 = $this->db->ZZZw22($ZZZZZZZZZZZZZZW2222["sql"],array());for($Zf5 = 0;$Zf5<$ZZZZZZX2323;$Zf5++){$ZZZz25 = $this->db->ZZZA00($ZZq16[$Zf5]["removeTable"],array());} $ZZZz25 = $this->db->ZZZA00($ZZZZZZZZZZZZZZW2222["removeTable"],array());$ZZT1919 = count($ZZZZZx23);$ZZZZZZZZZZZZZF55 = array();for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZF55[] = new ZZZZZZZZZZy24($ZZZZZx23[$Zf5]->name,$this->db,$this->ZZZZS1818,$ZZZZZx23[$Zf5]);} $ZZZZZZZZZZZZZG66 = new ZZZZZZZZZZZZZH77($ZZZG66,$ZZZZZZZZZZZZZZW2222["fields"],$ZZZZZZZZZZZZW2222);$ZZZZZZZZZZZZZG66->ZZZZZZZZZZZZZI88($ZZS1818);$ZZZG66[] = array("name"=>"date_field","dateGrouping"=>$ZZZG66[0]["dateGrouping"],"sortAction"=>$ZZZG66[0]["sortAction"],"position" =>$ZZZG66[0]["position"]);$ZZZZZZZZZZZZZJ99 = new ZZZZZZZZZZZZZK1010($this->ZZZZS1818,$this->db,$ZZZZZZZZZZZZZZW2222["fields"],$ZZZG66,$ZZZZZZZZZZZZZF55,$dateFormat,$ZZZZZZZZZZZZZC22);$ZZZZZZZZZZZZZJ99->ZZZZZZZZZZZZZI88($ZZS1818);if($ZZZG66[0]["sortAction"]=="nogroup"){unset($ZZZZZZZZZZZZZZW2222["cols"]['date_field']);} $ZZS1818 = array("cols" => $this->ZZZZZZZZZZZZZx23($ZZZZZZZZZZZZZZW2222["cols"]), "data" => $ZZS1818);if($isCrosstab && count($ZZS1818["data"])>0){$this->ZZZZZZZZZZZZZZU2020($ZZZG66);if($aggregateColumn){$ZZZZZZZZZZZZZL1111 = new ZZZZZZZZZZZZZM1212($this->db,$this->ZZZZS1818,$ZZZZZZZZZZZZZF55);}else{$ZZZZZZZZZZZZZL1111 = new ZZZZZZZZZZZZZN1313($this->db,$this->ZZZZS1818,$ZZZZZZZZZZZZZF55);} $ZZS1818 = $ZZZZZZZZZZZZZL1111->ZZZZZZZZZZZZZO1414($ZZS1818,$ZZZG66,$ZZZH77,$ZZZZZZZZZZZZZZW2222["fields"]);} $ZZS1818["cols"] = $this->ZZZZZZZZZZZZZx23($ZZS1818["cols"]);$ZZS1818["meta"] = $ZZZZZZZZZZZZZZW2222["meta"];$ZZS1818["pdffields"] = $this->ZZZZZZZZZZZZZQ1616($ZZZZZZZZZZZZZF55, $ZZS1818["cols"], $ZZS1818["data"], $isCrosstab, $aggregateColumn);if($ZZZZZZZZZZZZZB11){$ZZZZZZZZZZZZZJ99 = new ZZZZZZZZZZZZZP1515();$ZZZZZZZZZZZZZJ99->ZZZZZZZZZZZZZI88($ZZS1818["data"]);} return $ZZS1818;}} class ZZZZZZZZZZZZZN1313{protected $ZZZZZZZZZZZZZZX2323;protected $ZZZH77;protected $ZZZZZZZZZZZZZZY2424;protected $ZZZZS1818;protected $db;protected $ZZZZZZZZZZj9;function __construct($db, $ZZZZS1818,$ZZZZZZZZZZj9) {$this->db = $db;$this->ZZZZS1818 = $ZZZZS1818;$this->ZZZZZZZZZZj9 = $ZZZZZZZZZZj9;} function ZZZZZZZZZZZZZZZ2525($ZZZZZZZZZZZZZZZa0,$ZZZZZZZZZZZZZZX2323){$ZZZZZZZZZZZZZZZb1 = count($ZZZZZZZZZZZZZZZa0);$ZZS1818 = array();for($Zf5=0;$Zf5<$ZZZZZZZZZZZZZZZb1;$Zf5++){$ZZS1818[$ZZZZZZZZZZZZZZZa0[$Zf5]] = array();} $ZZT1919 = count($ZZZZZZZZZZZZZZX2323);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){for($ZZZZZK1010=0;$ZZZZZK1010<$ZZZZZZZZZZZZZZZb1;$ZZZZZK1010++){if(!in_array($ZZZZZZZZZZZZZZX2323[$Zf5][$ZZZZZZZZZZZZZZZa0[$ZZZZZK1010]],$ZZS1818[$ZZZZZZZZZZZZZZZa0[$ZZZZZK1010]])){$ZZS1818[$ZZZZZZZZZZZZZZZa0[$ZZZZZK1010]][] = $ZZZZZZZZZZZZZZX2323[$Zf5][$ZZZZZZZZZZZZZZZa0[$ZZZZZK1010]];}}} return $ZZS1818;} function ZZZZZZZZZZZZZZZc2($ZZZZZn13,$ZZZZZZZZZZZZZZZd3 = false){$ZZZz25 = $ZZZZZn13;$ZZT1919 = count($ZZZz25);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZz25[$Zf5] = strtoupper(trim($ZZZZZn13[$Zf5]));} if($ZZZZZZZZZZZZZZZd3){arsort($ZZZz25);}else{asort($ZZZz25);} $ZZS1818 = array();foreach($ZZZz25 as $ZZZT1919 => $ZZZZZZZZZZZZZZZe4){$ZZS1818[] = $ZZZZZn13[$ZZZT1919];} return $ZZS1818;} function ZZZZZZZZZZZZZZZf5(&$ZZZZZZZZZZZZZZZg6,$ZZZZZZZZZZZZZZZh7,$ZZZZZZZZZZZZZZZi8){$ZZT1919 = count($ZZZZZZZZZZZZZZZg6);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZg6[$Zf5]["values"] = $ZZZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZZg6[$Zf5]["name"]];if($ZZZZZZZZZZZZZZZi8 && $ZZZZZZZZZZZZZZZg6[$Zf5]["sort"] === 1){$ZZZZZZZZZZZZZZZg6[$Zf5]["values"] = $this->ZZZZZZZZZZZZZZZc2($ZZZZZZZZZZZZZZZg6[$Zf5]["values"]);} if($ZZZZZZZZZZZZZZZi8 && $ZZZZZZZZZZZZZZZg6[$Zf5]["sort"] === 2){$ZZZZZZZZZZZZZZZg6[$Zf5]["values"] = $this->ZZZZZZZZZZZZZZZc2($ZZZZZZZZZZZZZZZg6[$Zf5]["values"],true);}}} function ZZZZZZZZZZZZZZZj9($ZZZc2,$ZZZZZZZZZZZZZZZk10){$ZZS1818 = $ZZZZZZZZZZZZZZZk10;$ZZT1919 = count($ZZZc2);for($Zf5 = $ZZT1919;$Zf5>0;$Zf5--){$ZZZz25 = $ZZZc2[$Zf5-1];$ZZZz25["data"] = array();$ZZZz25["next"] = $ZZS1818;$ZZS1818 = $ZZZz25;} return $ZZS1818;} function ZZZZZZZZZZZZZZZl11($ZZZZZZu20,&$ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZZn13,$ZZZH77){if($ZZZZZZZZZZZZZZZn13){$Zf5 =array_search($ZZZZZZu20[$ZZZZZZZZZZZZZZZm12["name"]],$ZZZZZZZZZZZZZZZm12["values"]);if(!isset($ZZZZZZZZZZZZZZZm12["data"][$Zf5])){$ZZZZZZZZZZZZZZZm12["data"][$Zf5] = $ZZZZZZZZZZZZZZZm12["next"];} $this->ZZZZZZZZZZZZZZZl11($ZZZZZZu20,$ZZZZZZZZZZZZZZZm12["data"][$Zf5],$ZZZZZZZZZZZZZZZn13-1,$ZZZH77);}else{$ZZT1919 = count($ZZZH77);for($Zf5 =0;$Zf5<$ZZT1919;$Zf5++){if($ZZZH77[$Zf5]["value"]["sum"]==true){$ZZZZZZZZZZZZZZZm12["data"][$ZZZH77[$Zf5]["selectedField"]."_sum"] = $ZZZZZZu20[$ZZZH77[$Zf5]["selectedField"]."_sum"];} if($ZZZH77[$Zf5]["value"]["count"]==true){$ZZZZZZZZZZZZZZZm12["data"][$ZZZH77[$Zf5]["selectedField"]."_cnt"] = $ZZZZZZu20[$ZZZH77[$Zf5]["selectedField"]."_cnt"];} if($ZZZH77[$Zf5]["value"]["avg"]==true){$ZZZZZZZZZZZZZZZm12["data"][$ZZZH77[$Zf5]["selectedField"]."_avg"] = $ZZZZZZu20[$ZZZH77[$Zf5]["selectedField"]."_avg"];}}}} function ZZZZZZZZZZZZZZZo14(&$ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZZp15,$ZZZZZZZZZZZZZZZq16,$ZZZH77,$ZZZZZZZZZZZZZZZr17,$ZZZZZZZZZZZZZZY2424){$ZZZZZZZZZZZZZZZn13 = $ZZZZZZZZZZZZZZZp15+$ZZZZZZZZZZZZZZZq16;if($ZZZZZZZZZZZZZZZr17<($ZZZZZZZZZZZZZZZn13 -1)) {if($ZZZZZZZZZZZZZZZm12["sort"] === 1 || $ZZZZZZZZZZZZZZZm12["sort"] === 2){ksort($ZZZZZZZZZZZZZZZm12["data"]);} foreach($ZZZZZZZZZZZZZZZm12["data"] as $ZZZT1919 =>$ZZZZZZZZZZZZZZZe4){$this->ZZZZZZZZZZZZZZZo14($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919],$ZZZZZZZZZZZZZZZp15,$ZZZZZZZZZZZZZZZq16,$ZZZH77,$ZZZZZZZZZZZZZZZr17+1,$ZZZZZZZZZZZZZZY2424);} if($ZZZZZZZZZZZZZZZq16 -1 <$ZZZZZZZZZZZZZZZr17){$this->ZZZZZZZZZZZZZZZs18($ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZZr17,$ZZZZZZZZZZZZZZZn13);if($ZZZZZZZZZZZZZZZr17== 0){$this->ZZZZZZZZZZZZZZZt19($ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZY2424,$ZZZH77);}}else{$this->ZZZZZZZZZZZZZZZu20($ZZZZZZZZZZZZZZZm12,($ZZZZZZZZZZZZZZZr17 === $ZZZZZZZZZZZZZZZq16-1));}}else{$this->ZZZZZZZZZZZZZZZv21($ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZY2424,$ZZZH77);if($ZZZZZZZZZZZZZZZr17== 0){$this->ZZZZZZZZZZZZZZZt19($ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZY2424,$ZZZH77);}}} function ZZZZZZZZZZZZZZZt19(&$ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZY2424,$ZZZH77){$ZZS1818 = array("cols"=>array(),"data"=>array(array()));$ZZZZZZZZZZZZZZs18 = count($ZZZH77);$ZZZZZZZZZZZZZZZw22 = array();for($ZZZZZK1010 =0;$ZZZZZK1010<$ZZZZZZZZZZZZZZs18;$ZZZZZK1010++){if($ZZZH77[$ZZZZZK1010]["value"]["sum"]==true){$ZZZZZZZZZZZZZZZw22[$ZZZH77[$ZZZZZK1010]["selectedField"]."_sum"] = $ZZZZZZZZZZZZZZY2424[$ZZZH77[$ZZZZZK1010]["selectedField"]."_sum"];} if($ZZZH77[$ZZZZZK1010]["value"]["count"]==true){$ZZZZZZZZZZZZZZZw22[$ZZZH77[$ZZZZZK1010]["selectedField"]."_cnt"] = $ZZZZZZZZZZZZZZY2424[$ZZZH77[$ZZZZZK1010]["selectedField"]."_cnt"];} if($ZZZH77[$ZZZZZK1010]["value"]["avg"]==true){$ZZZZZZZZZZZZZZZw22[$ZZZH77[$ZZZZZK1010]["selectedField"]."_avg"] = $ZZZZZZZZZZZZZZY2424[$ZZZH77[$ZZZZZK1010]["selectedField"]."_avg"];}} foreach($ZZZZZZZZZZZZZZZm12["cols"] as $ZZZT1919=>$ZZZZZZZZZZZZZZZe4){foreach ($ZZZZZZZZZZZZZZZw22 as $ZZZZZZZZZZZZZZZx23=>$ZZZZZZZZZZZZZZZy24) {$ZZS1818["data"][0][$ZZZT1919] = (isset($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]))?($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]):"";$ZZS1818["cols"][$ZZZT1919] = $ZZZZZZZZZZZZZZZe4;}} $ZZZZZZZZZZZZZZZm12 = $ZZS1818;} function ZZZZZZZZZZZZZZZs18(&$ZZZZZZZZZZZZZZZm12){$ZZS1818 = array("cols"=>array(),"data"=>array());$ZZT1919 = count($ZZZZZZZZZZZZZZZm12["values"]);reset($ZZZZZZZZZZZZZZZm12["data"]);$Zu20 = key($ZZZZZZZZZZZZZZZm12["data"]);for ($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++) {foreach($ZZZZZZZZZZZZZZZm12["data"][$Zu20]["cols"] as $ZZZT1919 => $ZZZZZZZZZZZZZZZe4){$ZZS1818["cols"]["v".$Zf5."_".$ZZZT1919] = $ZZZZZZZZZZZZZZZm12["values"][$Zf5]." ".$ZZZZZZZZZZZZZZZe4;}} foreach($ZZZZZZZZZZZZZZZm12["data"] as $ZZZT1919 =>$ZZZZZZZZZZZZZZZe4){foreach($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"] as $ZZZZZZZZZZZZZZZx23 =>$ZZZZZZZZZZZZZZZy24){$ZZS1818["data"]["v".$ZZZT1919."_".$ZZZZZZZZZZZZZZZx23] = $ZZZZZZZZZZZZZZZy24;}} $ZZZZZZZZZZZZZZZm12 = $ZZS1818;} function ZZZZZZZZZZZZZZZu20(&$ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZZz25){$ZZS1818 = array("cols"=>array(),"data"=>array());$ZZS1818["cols"][$ZZZZZZZZZZZZZZZm12["name"]] = $ZZZZZZZZZZZZZZZm12["title"];reset($ZZZZZZZZZZZZZZZm12["data"]);$Zu20 = key($ZZZZZZZZZZZZZZZm12["data"]);$ZZS1818["cols"] = array_merge($ZZS1818["cols"],$ZZZZZZZZZZZZZZZm12["data"][$Zu20]["cols"]);foreach ($ZZZZZZZZZZZZZZZm12["data"] as $ZZZT1919 => $ZZZZZZZZZZZZZZZe4){if($ZZZZZZZZZZZZZZZm12["values"][$ZZZT1919]===null){$ZZZZZZZZZZZZZZZm12["values"][$ZZZT1919] = " - ";} if($ZZZZZZZZZZZZZZZz25){$ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZZZZZZZZZZZm12["name"]] = $ZZZZZZZZZZZZZZZm12["values"][$ZZZT1919];$ZZS1818["data"][] = $ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"];}else{$ZZZZZZZZZZZZZZs18 = count($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"]);for ($ZZZZZK1010 = 0;$ZZZZZK1010 < $ZZZZZZZZZZZZZZs18;$ZZZZZK1010++) {$ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZK1010][$ZZZZZZZZZZZZZZZm12["name"]] = $ZZZZZZZZZZZZZZZm12["values"][$ZZZT1919];$ZZS1818["data"][] = $ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZK1010];}}} $ZZZZZZZZZZZZZZZm12 = $ZZS1818;} function ZZZZZZZZZZZZZZZv21(&$ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZY2424,$ZZZH77){$ZZT1919 = count($ZZZZZZZZZZZZZZZm12["values"]);$ZZS1818 = array("cols"=>array(),"data"=>array());for($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++){if(!empty($ZZZZZZZZZZZZZZZm12["data"][$Zf5])){foreach($ZZZZZZZZZZZZZZZm12["data"][$Zf5]["data"] as $ZZZT1919 => $ZZZZZZZZZZZZZZZe4){$this->ZZZZZZZZZZZZZZZw22[$ZZZT1919] = $ZZZZZZZZZZZZZZY2424[$ZZZT1919];$ZZS1818["cols"]["v".$Zf5."_".$ZZZT1919] = $ZZZZZZZZZZZZZZZm12["values"][$Zf5]." ".$ZZZZZZZZZZZZZZY2424[$ZZZT1919];$ZZS1818["data"]["v".$Zf5."_".$ZZZT1919] = $ZZZZZZZZZZZZZZZe4;}}else{$ZZZZZZZZZZZZZZs18 = count($ZZZH77);for($ZZZZZK1010 =0;$ZZZZZK1010<$ZZZZZZZZZZZZZZs18;$ZZZZZK1010++){if($ZZZH77[$ZZZZZK1010]["value"]["sum"]==true){$this->ZZZZZZZZZZZZZZZw22[$ZZZH77[$ZZZZZK1010]["selectedField"]."_sum"] = $ZZZZZZZZZZZZZZY2424[$ZZZH77[$ZZZZZK1010]["selectedField"]."_sum"];$ZZS1818["cols"]["v".$Zf5."_".$ZZZH77[$ZZZZZK1010]["selectedField"]."_sum"] = $ZZZZZZZZZZZZZZZm12["values"][$Zf5]." ".$ZZZZZZZZZZZZZZY2424[$ZZZH77[$ZZZZZK1010]["selectedField"]."_sum"];} if($ZZZH77[$ZZZZZK1010]["value"]["count"]==true){$this->ZZZZZZZZZZZZZZZw22[$ZZZH77[$ZZZZZK1010]["selectedField"]."_cnt"] = $ZZZZZZZZZZZZZZY2424[$ZZZH77[$ZZZZZK1010]["selectedField"]."_cnt"];$ZZS1818["cols"]["v".$Zf5."_".$ZZZH77[$ZZZZZK1010]["selectedField"]."_cnt"] = $ZZZZZZZZZZZZZZZm12["values"][$Zf5]." ".$ZZZZZZZZZZZZZZY2424[$ZZZH77[$ZZZZZK1010]["selectedField"]."_cnt"];} if($ZZZH77[$ZZZZZK1010]["value"]["avg"]==true){$this->ZZZZZZZZZZZZZZZw22[$ZZZH77[$ZZZZZK1010]["selectedField"]."_avg"] = $ZZZZZZZZZZZZZZY2424[$ZZZH77[$ZZZZZK1010]["selectedField"]."_avg"];$ZZS1818["cols"]["v".$Zf5."_".$ZZZH77[$ZZZZZK1010]["selectedField"]."_avg"] = $ZZZZZZZZZZZZZZZm12["values"][$Zf5]." ".$ZZZZZZZZZZZZZZY2424[$ZZZH77[$ZZZZZK1010]["selectedField"]."_avg"];}}}} $ZZZZZZZZZZZZZZZm12 = $ZZS1818;} function ZZZZZZZZZZZZZO1414($r17,$ZZZG66,$ZZZH77,$ZZZc2){$ZZZZZZZZZZZZZZZA00 = $r17["data"];$ZZZZZZZZZZZZZZZB11 = array();$ZZZZZZZZZW2222 = $this->ZZZZS1818->ZZZZZH77($ZZZc2, $ZZZG66);$ZZZZZZZZZZZZZZZC22 = array();$ZZZZZZZZZZZZZZZD33 = array();$ZZZZZZZZZZZZZZZE44 = array();$ZZT1919 = count($ZZZG66);for($Zf5 =0;$Zf5<$ZZT1919;$Zf5++){if(($ZZZG66[$Zf5]["sortAction"]=="group" || $ZZZG66[$Zf5]["sortAction"]=="groupsort")){if($ZZZG66[$Zf5]["name"]!="date_field" && isset($ZZZG66[$Zf5]['dateGrouping']) && !empty($ZZZG66[$Zf5]['dateGrouping'])) {$ZZZG66[$Zf5]['name'] = $ZZZG66[$Zf5]['name'] . '_' . $ZZZG66[$Zf5]['dateGrouping'];} if(isset($r17["cols"][$ZZZG66[$Zf5]["name"]])){$ZZZz25 = array("name" =>$ZZZG66[$Zf5]["name"], "title" => $r17["cols"][$ZZZG66[$Zf5]["name"]], "sort" => false);if($ZZZG66[$Zf5]["sortAction"]=="groupsort"){if(isset($ZZZG66[$Zf5]["sortDirection"]) && $ZZZG66[$Zf5]["sortDirection"] == "ASC"){$ZZZz25["sort"] = 1;}else{$ZZZz25["sort"] = 2;}} $ZZZZZZZZZZZZZZZE44[] = $ZZZG66[$Zf5]["name"];if($ZZZG66[$Zf5]["position"] == "row" || $ZZZG66[$Zf5]["position"] == ""){if($ZZZG66[$Zf5]["name"] == "00_ALL_assigned_user_id"){$ZZZZZZZZZZZZZZZF55 = false;}else{$ZZZZZZZZZZZZZZZF55 = $this->ZZZZS1818->ZZZZZw22($ZZZZZZZZZW2222[$ZZZG66[$Zf5]["name"]],$this->db,$this->ZZZZZZZZZZj9);} if($ZZZZZZZZZZZZZZZF55){$ZZZZZZZZZZZZZZZD33[] = array("name" =>$ZZZG66[$Zf5]["name"]."_id", "title" => $r17["cols"][$ZZZG66[$Zf5]["name"]], "sort" => false);$ZZZZZZZZZZZZZZZD33[] = array("name" =>$ZZZG66[$Zf5]["name"]."_setype", "title" => $r17["cols"][$ZZZG66[$Zf5]["name"]], "sort" => false);$ZZZZZZZZZZZZZZZB11[] = $ZZZG66[$Zf5]["name"]."_id";$ZZZZZZZZZZZZZZZB11[] = $ZZZG66[$Zf5]["name"]."_setype";$ZZZZZZZZZZZZZZZE44[] = $ZZZG66[$Zf5]["name"]."_id";$ZZZZZZZZZZZZZZZE44[] = $ZZZG66[$Zf5]["name"]."_setype";} $ZZZZZZZZZZZZZZZD33[] = $ZZZz25;}else{$ZZZZZZZZZZZZZZZC22[] = $ZZZz25;}}}} $ZZZZZZZZZZZZZZZG66 = $this->ZZZZZZZZZZZZZZZ2525($ZZZZZZZZZZZZZZZE44,$ZZZZZZZZZZZZZZZA00);$this->ZZZZZZZZZZZZZZZf5($ZZZZZZZZZZZZZZZD33,$ZZZZZZZZZZZZZZZG66,true);$this->ZZZZZZZZZZZZZZZf5($ZZZZZZZZZZZZZZZC22,$ZZZZZZZZZZZZZZZG66,false);$ZZZZZZZZZZZZZZZH77 = $this->ZZZZZZZZZZZZZZZj9($ZZZZZZZZZZZZZZZC22,array());$ZZZZZZZZZZZZZZZm12 = $this->ZZZZZZZZZZZZZZZj9($ZZZZZZZZZZZZZZZD33,$ZZZZZZZZZZZZZZZH77);$ZZZZZZZZZZZZZZZn13 = count($ZZZZZZZZZZZZZZZD33) + count($ZZZZZZZZZZZZZZZC22);$ZZT1919 = count($ZZZZZZZZZZZZZZZA00);for($Zf5 =0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZZZZZZZZZZZl11($ZZZZZZZZZZZZZZZA00[$Zf5],$ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZZn13,$ZZZH77);} $this->ZZZZZZZZZZZZZZX2323 = $ZZZZZZZZZZZZZZZD33;$this->ZZZH77 = $ZZZH77;$this->ZZZZZZZZZZZZZZY2424 = $r17["cols"];$this->ZZZZZZZZZZZZZZZo14($ZZZZZZZZZZZZZZZm12,count($ZZZZZZZZZZZZZZZC22),count($ZZZZZZZZZZZZZZZD33),$ZZZH77,0,$r17["cols"]);$ZZT1919 = count($ZZZZZZZZZZZZZZZB11);for($Zf5 =0;$Zf5<$ZZT1919;$Zf5++){unset($ZZZZZZZZZZZZZZZm12["cols"][$ZZZZZZZZZZZZZZZB11[$Zf5]]);} return $ZZZZZZZZZZZZZZZm12;}} class ZZZZZZZZZZZZZM1212 extends ZZZZZZZZZZZZZN1313{function ZZZZZZZZZZZZZZZs18(&$ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZZr17,$ZZZZZZZZZZZZZZZn13){if($ZZZZZZZZZZZZZZZr17 == $ZZZZZZZZZZZZZZZn13 - 1){$ZZS1818 = array("cols"=>array(""=>""),"data"=>array());$ZZZZZZZZZZZZZZZm12 = $ZZS1818;}else{parent::ZZZZZZZZZZZZZZZs18($ZZZZZZZZZZZZZZZm12);}} function ZZZZZZZZZZZZZZZt19(&$ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZY2424,$ZZZH77){$ZZS1818 = array("cols"=>array("aggregates"=>"Aggregate"),"data"=>array(array()));$ZZZz25 = array();foreach($ZZZZZZZZZZZZZZZm12["cols"] as $ZZZT1919=>$ZZZZZZZZZZZZZZZe4){$ZZS1818["cols"][$ZZZT1919] = $ZZZZZZZZZZZZZZZe4;if(isset($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]))foreach ($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"] as $ZZZZZZZZZZZZZZZx23=>$ZZZZZZZZZZZZZZZy24) {if(!isset($ZZZz25[$ZZZZZZZZZZZZZZZx23])){$ZZZz25[$ZZZZZZZZZZZZZZZx23] = array("aggregates"=>$ZZZZZZZZZZZZZZY2424[$ZZZZZZZZZZZZZZZx23]);} $ZZZz25[$ZZZZZZZZZZZZZZZx23][$ZZZT1919] = (is_array($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"]) && isset($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZZZZZZZZZZZx23]))?($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZZZZZZZZZZZx23]):"";}} $ZZS1818["data"] = array_values($ZZZz25);$ZZZZZZZZZZZZZZZm12 = $ZZS1818;} function ZZZZZZZZZZZZZZZu20(&$ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZZI88){if($ZZZZZZZZZZZZZZZI88){$ZZZZZZZZZZZZZZY2424 = $this->ZZZZZZZZZZZZZZY2424;$ZZZH77 = $this->ZZZH77;$ZZT1919 = count($ZZZZZZZZZZZZZZZm12["values"]);$ZZZZZZZZZZZZZZZJ99["aggregates"] = "Aggregate";reset($ZZZZZZZZZZZZZZZm12["data"]);$Zu20 = key($ZZZZZZZZZZZZZZZm12["data"]);$ZZZZZZZZZZZZZZZJ99 = array_merge($ZZZZZZZZZZZZZZZJ99,$ZZZZZZZZZZZZZZZm12["data"][$Zu20]["cols"]);$ZZZZZZZZZZZZZZs18 = count($ZZZZZZZZZZZZZZZm12["data"][$Zu20]["cols"]);$ZZZZZZZZZZZd3 = array_keys($ZZZZZZZZZZZZZZZm12["data"][$Zu20]["cols"]);$ZZZZZZZZZZZZZZZK1010 = count($ZZZH77);$ZZZZZq16 = array();for($Zf5=0;$Zf5<$ZZZZZZZZZZZZZZZK1010;$Zf5++){$ZZZZZZZZZZZZZZZL1111 = array("aggregates"=>($ZZZH77[$Zf5]["value"]["sum"]==true)?$ZZZZZZZZZZZZZZY2424[$ZZZH77[$Zf5]["selectedField"]."_sum"]:"");$ZZZZZZZZZZZZZZZM1212 = array("aggregates"=>($ZZZH77[$Zf5]["value"]["count"]==true)?$ZZZZZZZZZZZZZZY2424[$ZZZH77[$Zf5]["selectedField"]."_cnt"]:"");$ZZZZZZZZZZZZZZZN1313 = array("aggregates"=>($ZZZH77[$Zf5]["value"]["avg"]==true)?$ZZZZZZZZZZZZZZY2424[$ZZZH77[$Zf5]["selectedField"]."_avg"]:"");for($ZZZT1919 = 0;$ZZZT1919<$ZZT1919;$ZZZT1919++){$ZZZZZZZZZZZZZZZO1414 = $ZZZZZZZZZZZZZZZL1111;$ZZn13 = $ZZZZZZZZZZZZZZZM1212;$ZZZZZZZZZZZZZZZP1515 = $ZZZZZZZZZZZZZZZN1313;for($ZZZZZK1010=0;$ZZZZZK1010<$ZZZZZZZZZZZZZZs18;$ZZZZZK1010++){if($ZZZH77[$Zf5]["value"]["sum"]==true){if(!empty($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZZZZZZZd3[$ZZZZZK1010]])){$ZZZZZZZZZZZZZZZO1414[$ZZZZZZZZZZZd3[$ZZZZZK1010]] = $ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZZZZZZZd3[$ZZZZZK1010]]["data"][$ZZZH77[$Zf5]["selectedField"]."_sum"];}} if($ZZZH77[$Zf5]["value"]["count"]==true){if(!empty($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZZZZZZZd3[$ZZZZZK1010]])){$ZZn13[$ZZZZZZZZZZZd3[$ZZZZZK1010]] = $ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZZZZZZZd3[$ZZZZZK1010]]["data"][$ZZZH77[$Zf5]["selectedField"]."_cnt"];}} if($ZZZH77[$Zf5]["value"]["avg"]==true){if(!empty($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZZZZZZZd3[$ZZZZZK1010]])){$ZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZd3[$ZZZZZK1010]] = $ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZZZZZZZd3[$ZZZZZK1010]]["data"][$ZZZH77[$Zf5]["selectedField"]."_avg"];}}} if(!isset($ZZZZZq16[$ZZZT1919])){$ZZZZZq16[$ZZZT1919] = array();} if(count($ZZZZZZZZZZZZZZZO1414)>1){$ZZZZZq16[$ZZZT1919][]=$ZZZZZZZZZZZZZZZO1414;} if(count($ZZn13)>1){$ZZZZZq16[$ZZZT1919][]=$ZZn13;} if(count($ZZZZZZZZZZZZZZZP1515)>1){$ZZZZZq16[$ZZZT1919][]=$ZZZZZZZZZZZZZZZP1515;}}} for($ZZZZZK1010=0;$ZZZZZK1010<$ZZZZZZZZZZZZZZs18;$ZZZZZK1010++){if($ZZZZZZZZZZZZZZZJ99[$ZZZZZZZZZZZd3[$ZZZZZK1010]] === null){$ZZZZZZZZZZZZZZZJ99[$ZZZZZZZZZZZd3[$ZZZZZK1010]] = "-";}} for($ZZZT1919 = 0;$ZZZT1919<$ZZT1919;$ZZZT1919++){if(!empty($ZZZZZq16[$ZZZT1919])){$ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["cols"] = $ZZZZZZZZZZZZZZZJ99;$ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"] = $ZZZZZq16[$ZZZT1919];}}} parent::ZZZZZZZZZZZZZZZu20($ZZZZZZZZZZZZZZZm12,false);} function ZZZZZZZZZZZZZZZv21(&$ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZY2424,$ZZZH77){$ZZT1919 = count($ZZZZZZZZZZZZZZZm12["values"]);$ZZS1818 = array("cols"=>array(),"data"=>array());for($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++){$ZZS1818["cols"]["v".$Zf5."_"] = $ZZZZZZZZZZZZZZZm12["values"][$Zf5];if(isset($ZZZZZZZZZZZZZZZm12["data"][$Zf5])){$ZZS1818["data"]["v".$Zf5."_"] = $ZZZZZZZZZZZZZZZm12["data"][$Zf5];}} $ZZZZZZZZZZZZZZZm12 = $ZZS1818;}}
class ZZZZZZZZZZZZZK1010{protected $ZZZZZZZZZZZZZZZQ1616 = array();protected $ZZZZZZZZZZZZZF55 = array();protected $ZZT1919 = 0;protected $ZZZZS1818;protected $db;protected $dateFormat;protected $ZZZc2;protected $ZZZZZZZZZZZZZC22;function __construct($ZZZZS1818,$db,$ZZZc2,$ZZZG66,$ZZZZZZZZZZZZZF55,$dateFormat,$ZZZZZZZZZZZZZC22) {$this->db = $db;$this->ZZZZS1818 = $ZZZZS1818;$this->ZZZZZZZZZZZZZZZQ1616 = $this->ZZZZZZZZZZZZZZZR1717($ZZZc2,$ZZZG66);$this->ZZT1919 = count($this->ZZZZZZZZZZZZZZZQ1616);$this->ZZZc2 = $ZZZc2;$this->ZZZZZZZZZZZZZF55 = $ZZZZZZZZZZZZZF55;$this->dateFormat = $dateFormat;$this->ZZZZZZZZZZZZZC22 = $ZZZZZZZZZZZZZC22;} protected function ZZZZZZZZZZZZZZZR1717($ZZZc2,$ZZZG66){$ZZS1818 = array();$ZZZZZZZZZZZZZZZS1818 = array();$ZZZZZF55 = 0;$ZZT1919 = count($ZZZc2);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(in_array($ZZZc2[$Zf5]["uitype"],array('date', 'datetime', 'datetimecombo', 'enum', 'multienum', 'currency', 'dynamicenum'))){$ZZS1818[$ZZZZZF55] = $ZZZc2[$Zf5];$ZZZZZZZZZZZZZZZS1818[$ZZZc2[$Zf5]["fieldname"]] = &$ZZS1818[$ZZZZZF55];$ZZZZZF55++;}} $ZZT1919 = count($ZZZG66);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(isset($ZZZZZZZZZZZZZZZS1818[$ZZZG66[$Zf5]["name"]])){if(isset($ZZZG66[$Zf5]["dateGrouping"])){$ZZZZZZZZZZZZZZZS1818[$ZZZG66[$Zf5]["name"]]["dateGrouping"]= $ZZZG66[$Zf5]["dateGrouping"];}}} $ZZZZZZZZZZZZZZZT1919 = array();foreach($ZZS1818 as $ZZZZZZZZZZZZZZZU2020) {if(isset($ZZZZZZZZZZZZZZZU2020['dateGrouping']) && !empty($ZZZZZZZZZZZZZZZU2020['dateGrouping']) && $ZZZZZZZZZZZZZZZU2020['fieldname']!="date_field") {foreach($ZZZG66 as $ZZZZZZZZZZZZZZZV2121) {$ZZZZZZZZZZZZZZZW2222 = $ZZZZZZZZZZZZZZZV2121['name'] . '_' . $ZZZZZZZZZZZZZZZV2121['dateGrouping'];if($ZZZZZZZZZZZZZZZU2020['fieldname'] == $ZZZZZZZZZZZZZZZV2121['name']) {$ZZZZZZZZZZZZZZZX2323 = $ZZZZZZZZZZZZZZZU2020;$ZZZZZZZZZZZZZZZX2323['fieldname'] = $ZZZZZZZZZZZZZZZW2222;$ZZZZZZZZZZZZZZZX2323['dateGrouping'] = $ZZZZZZZZZZZZZZZV2121['dateGrouping'];$ZZZZZZZZZZZZZZZT1919[] = $ZZZZZZZZZZZZZZZX2323;} else if ($ZZZZZZZZZZZZZZZU2020['fieldname'] == $ZZZZZZZZZZZZZZZW2222){$ZZZZZZZZZZZZZZZT1919[] = $ZZZZZZZZZZZZZZZU2020;}}} else {$ZZZZZZZZZZZZZZZT1919[] = $ZZZZZZZZZZZZZZZU2020;}} $ZZS1818 = $ZZZZZZZZZZZZZZZT1919;return $ZZS1818;} function ZZZZZZZZZZZZZZZY2424($ZZZZZZZZZZZZZZZZ2525){$ZZZz25 = explode(" ",$ZZZZZZZZZZZZZZZZ2525,2);$ZZZZZZZZZZZZk10 = explode("-",$ZZZz25[0],3);if(count($ZZZZZZZZZZZZk10) == 1) {return $this->ZZZZS1818->ZZZZZE44($ZZZZZZZZZZZZk10[0]);} if(!preg_match("/^[0-9]{1,2}$/",$ZZZZZZZZZZZZk10[1])){return $ZZZZZZZZZZZZZZZZ2525;} $ZZZZZZZZZZZZk10[1] = $this->ZZZZS1818->ZZZZZE44(intval($ZZZZZZZZZZZZk10[1],10));switch($this->dateFormat){case "mm-dd-yyyy": $ZZZz25[0] = $ZZZZZZZZZZZZk10[1]."-".$ZZZZZZZZZZZZk10[2]."-".$ZZZZZZZZZZZZk10[0];break;case "dd-mm-yyyy": $ZZZz25[0] = $ZZZZZZZZZZZZk10[2]."-".$ZZZZZZZZZZZZk10[1]."-".$ZZZZZZZZZZZZk10[0];break;case "yyyy-mm-dd": default: $ZZZz25[0] = $ZZZZZZZZZZZZk10[0]."-".$ZZZZZZZZZZZZk10[1]."-".$ZZZZZZZZZZZZk10[2];break;} $ZZS1818 = $ZZZz25[0];if(isset($ZZZz25[1])){$ZZS1818.=" ".$ZZZz25[1];} return $ZZS1818;} function ZZZZZZZZZZZZZZZZa0($value,$field,$ZZZZZZZZZZj9){static $ZZZp15 = array('its_currencies' =>array());$ZZS1818 = $value;switch ($field['uitype']){case 'date': case 'datetime': case 'datetimecombo': if(!isset($field["dateGrouping"]) || in_array($field["dateGrouping"],array("day","month","monthAndYear"))){if(count(explode("-",$value))==2){$ZZZz25 = explode(" ",$value,2);$ZZZZZZZZZZZZk10 = explode("-",$ZZZz25[0],3);if(!preg_match("/^[0-9]{1,2}$/",$ZZZZZZZZZZZZk10[1])){return $ZZS1818;} $ZZZZZZZZZZZZk10[1] = $this->ZZZZS1818->ZZZZZE44(intval($ZZZZZZZZZZZZk10[1],10));$ZZZz25[0] = implode("-",$ZZZZZZZZZZZZk10);$ZZS1818 = implode(" ",$ZZZz25);}else{if(!empty($value)){$ZZS1818 = $this->ZZZZZZZZZZZZZZZY2424($value);}}} break;case 'enum': case 'multienum': case 'dynamicenum': $ZZZZZZZZZZZZZZZZb1 = $field["module"].$field["tablename"].$field["columnname"];if(!isset($ZZZp15[$ZZZZZZZZZZZZZZZZb1])){$ZZZZZZZZZZZZZZZZc2 = $ZZZZZZZZZZj9[$field["module"]]->name;$ZZZp15[$ZZZZZZZZZZZZZZZZb1] = $this->ZZZZS1818->ZZZZZm12($field["fieldname_org"],$ZZZZZZZZZZZZZZZZc2,$this->db);} if(isset($ZZZp15[$ZZZZZZZZZZZZZZZZb1][$value])){$ZZS1818 = $ZZZp15[$ZZZZZZZZZZZZZZZZb1][$value];} break;case '33': $ZZZZZZZZZZZZZZZZb1 = $field["module"].$field["tablename"].$field["columnname"];if(!isset($ZZZp15[$ZZZZZZZZZZZZZZZZb1])){$ZZZZZZZZZZZZZZZZc2 = $ZZZZZZZZZZj9[$field["module"]]->name;$ZZZp15[$ZZZZZZZZZZZZZZZZb1] = $this->ZZZZS1818->ZZZZZm12($field["fieldname_org"],$ZZZZZZZZZZZZZZZZc2,$this->db);} $ZZZZZZZZZZZZZZZZd3 = explode(" |##| ", $value);$ZZZZZZZZZZZZZZZZe4 = array();foreach($ZZZZZZZZZZZZZZZZd3 as $ZZZZZZZZZZZZZZZZf5){if(!empty($ZZZZZZZZZZZZZZZZf5)){$ZZZZZZZZZZZZZZZZg6 = $ZZZZZZZZZZZZZZZZf5;if(isset($ZZZp15[$ZZZZZZZZZZZZZZZZb1][$ZZZZZZZZZZZZZZZZf5])){$ZZZZZZZZZZZZZZZZg6 = $ZZZp15[$ZZZZZZZZZZZZZZZZb1][$ZZZZZZZZZZZZZZZZf5];} $ZZZZZZZZZZZZZZZZe4[] = $ZZZZZZZZZZZZZZZZg6;}} if(!empty($ZZZZZZZZZZZZZZZZe4)){$ZZS1818 = implode(", ",$ZZZZZZZZZZZZZZZZe4);} break;case '117': if(!isset($ZZZp15['its_currencies'][$value])){$ZZZZZZZZZZZZZZZZh7 = $this->db->ZZQ1616($value);$ZZZp15['its_currencies'][$value] = ($ZZZZZZZZZZZZZZZZh7)?($ZZZZZZZZZZZZZZZZh7):($value);} if(isset($ZZZp15['its_currencies'][$value])){$ZZS1818 = $ZZZp15['its_currencies'][$value];} break;case '-24': $ZZZZZZZZZZZZZZZZb1 = $field["module"].$field["tablename"].$field["columnname"];if(!isset($ZZZp15[$ZZZZZZZZZZZZZZZZb1])){$ZZZZZZZZZZZZZZZZc2 = $ZZZZZZZZZZj9[$field["module"]]->name;$ZZZp15[$ZZZZZZZZZZZZZZZZb1] = $this->ZZZZS1818->ZZZZZo14($field["fieldname_org"],$ZZZZZZZZZZZZZZZZc2,$this->db);} if(isset($ZZZp15[$ZZZZZZZZZZZZZZZZb1][$value])){$ZZS1818 = $ZZZp15[$ZZZZZZZZZZZZZZZZb1][$value];} break;default: break;} return $ZZS1818;} function ZZZZZZZZZZZZZI88(&$ZZZZZZZZZZZZZZX2323){$ZZT1919 = count($ZZZZZZZZZZZZZZX2323);for($Zf5 = 0;$Zf5< $ZZT1919;$Zf5++){$this->ZZZZZZZZZZZZZZZZi8($ZZZZZZZZZZZZZZX2323[$Zf5]);}} function ZZZZZZZZZZZZZZZZi8(&$ZZr17){for($Zf5 = 0;$Zf5<$this->ZZT1919;$Zf5++){foreach($ZZr17 as $Zu20 => $value) {$ZZr17[$Zu20] = html_entity_decode($value, ENT_QUOTES, "UTF-8");} if(isset($ZZr17[$this->ZZZZZZZZZZZZZZZQ1616[$Zf5]["fieldname"]])){$ZZr17[$this->ZZZZZZZZZZZZZZZQ1616[$Zf5]["fieldname"]] = $this->ZZZZZZZZZZZZZZZZa0($ZZr17[$this->ZZZZZZZZZZZZZZZQ1616[$Zf5]["fieldname"]],$this->ZZZZZZZZZZZZZZZQ1616[$Zf5],$this->ZZZZZZZZZZZZZF55);}} if($this->ZZZZZZZZZZZZZC22){$ZZZZZZZZZZZZZZs18 = count($this->ZZZc2);for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZZZs18;$Zf5++){if(isset($ZZr17[$this->ZZZc2[$Zf5]["fieldname"]]) && $ZZr17[$this->ZZZc2[$Zf5]["fieldname"]] === null){$ZZr17[$this->ZZZc2[$Zf5]["fieldname"]] = 0;}}}}} class ZZZZZZZZZZZZZH77{protected $ZZZZZZZZZZZZZZZZj9 = array();protected $ZZZc2;protected $ZZZZZZZZZZZZZZZZk10 = 0;protected $ZZZG66;protected $ZZZZZZZZZZZZW2222 = false;protected $ZZZZZZZZZZZZZZZZl11 = array();protected $ZZZZZZZZZZZZZZZZm12 = array();function ZZZZZZZZZZZZZZZZn13(){$ZZS1818 = array();$ZZZZZZZZZZZZZZY2424 = array();$ZZT1919 = count($this->ZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZZZZZZZZZZZZl11[$this->ZZZc2[$Zf5]["fieldname"]] = $this->ZZZc2[$Zf5]["uitype"];$ZZZZZZZZZZZZZZY2424[] = $this->ZZZc2[$Zf5]["fieldname"];} $ZZT1919 = count($this->ZZZG66);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(in_array($this->ZZZG66[$Zf5]["name"],$ZZZZZZZZZZZZZZY2424) && $this->ZZZZZZZZZZZZZZZZl11[$this->ZZZG66[$Zf5]["name"]] == 33 && !empty($this->ZZZG66[$Zf5]["transform"])){$ZZS1818[] = $this->ZZZG66[$Zf5];} if(in_array($this->ZZZG66[$Zf5]["name"],$ZZZZZZZZZZZZZZY2424)){$this->ZZZZZZZZZZZZZZZZm12[] = $this->ZZZG66[$Zf5]["name"];}} return $ZZS1818;} function __construct($ZZZG66,$ZZZc2,$ZZZZZZZZZZZZW2222){$this->ZZZG66= $ZZZG66;$this->ZZZc2 = $ZZZc2;$this->ZZZZZZZZZZZZW2222 = $ZZZZZZZZZZZZW2222;$this->ZZZZZZZZZZZZZZZZj9 = $this->ZZZZZZZZZZZZZZZZn13();} function ZZZZZZZZZZZZZZZZo14($ZZZZn13,$r17){$ZZZZZZZZZZZZZZZG66 = array();for($Zf5 = 0;$Zf5<$this->ZZZZZZZZZZZZZZZZk10;$Zf5++){if(!in_array($r17[$Zf5][$ZZZZn13],$ZZZZZZZZZZZZZZZG66)){$ZZZZZZZZZZZZZZZG66[] = $r17[$Zf5][$ZZZZn13];}} $ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZG66);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[$ZZZZZZZZZZZZZZZG66[$Zf5]] = explode(' |##| ',$ZZZZZZZZZZZZZZZG66[$Zf5]);if(count($ZZS1818[$ZZZZZZZZZZZZZZZG66[$Zf5]]) == 1){unset($ZZS1818[$ZZZZZZZZZZZZZZZG66[$Zf5]]);}} return $ZZS1818;} function ZZZZZZZZZZZZZZZZp15($ZZZZO1414,$r17){} function ZZZZZZZZZZZZZZZZq16($ZM1212,$ZZZZZZZZZZZZZZZZr17){$ZZZZZZZZZZZZZZZZs18 = true;$ZZT1919 = count($this->ZZZZZZZZZZZZZZZZm12);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if($ZM1212[$this->ZZZZZZZZZZZZZZZZm12[$Zf5]] !== $ZZZZZZZZZZZZZZZZr17[$this->ZZZZZZZZZZZZZZZZm12[$Zf5]]){$ZZZZZZZZZZZZZZZZs18 = false;}} return $ZZZZZZZZZZZZZZZZs18;} function ZZZZZZZZZZZZZZZZt19(&$r17,$ZZZZZZu20,$ZZZZZZZZZZZZZZZZu20,$field,&$ZZZZZZZZZZZZZZZZv21,&$ZZZZZZZZZZZZZZZZw22){$ZZZZZZZZZZZZZZE44 = array_merge(array_keys($r17[$ZZZZZZZZZZZZZZZZu20]),array_keys($r17[$ZZZZZZu20]));$ZZZZZZZZZZZZZZE44 = array_unique($ZZZZZZZZZZZZZZE44);$ZZT1919 = count($ZZZZZZZZZZZZZZE44);$ZZZZZZZZZZZv21 = PlatformConnector::ZZZZZZz25();for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(is_numeric($r17[$ZZZZZZu20][$ZZZZZZZZZZZZZZE44[$Zf5]]) && !in_array($ZZZZZZZZZZZZZZE44[$Zf5],$this->ZZZZZZZZZZZZZZZZm12)){$r17[$ZZZZZZZZZZZZZZZZu20][$ZZZZZZZZZZZZZZE44[$Zf5]] = (string)round((floatval($r17[$ZZZZZZZZZZZZZZZZu20][$ZZZZZZZZZZZZZZE44[$Zf5]]) + floatval($r17[$ZZZZZZu20][$ZZZZZZZZZZZZZZE44[$Zf5]])),$ZZZZZZZZZZZv21);}} array_splice($r17,$ZZZZZZu20,1);$this->ZZZZZZZZZZZZZZZZk10--;if($ZZZZZZZZZZZZZZZZu20>$ZZZZZZu20){$ZZZZZZZZZZZZZZZZu20--;} $ZZT1919 = count($ZZZZZZZZZZZZZZZZv21);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if($ZZZZZZZZZZZZZZZZv21[$Zf5]>$ZZZZZZu20){$ZZZZZZZZZZZZZZZZv21[$Zf5]--;}} $ZZZZZZZZZZZZZZZZx23 = array_search($ZZZZZZu20,$ZZZZZZZZZZZZZZZZw22[$r17[$ZZZZZZZZZZZZZZZZu20][$field]]);array_splice($ZZZZZZZZZZZZZZZZw22[$r17[$ZZZZZZZZZZZZZZZZu20][$field]],$ZZZZZZZZZZZZZZZZx23,1);foreach ($ZZZZZZZZZZZZZZZZw22 as &$ZZZZZn13) {$ZZT1919 = count($ZZZZZn13);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if($ZZZZZn13[$Zf5]>$ZZZZZZu20){$ZZZZZn13[$Zf5]--;}}}} function ZZZZZZZZZZZZZZZZy24($ZZZZZZZZZZZZZZZZz25,$field,&$r17){$ZZZZZZZZZZZZZZZZA00 = array();$ZZZZZZZZZZZZZZZZB11 = array();foreach($ZZZZZZZZZZZZZZZZz25 as $ZZZZZn13){$ZZT1919 = count($ZZZZZn13);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(!isset($ZZZZZZZZZZZZZZZZA00[$ZZZZZn13[$Zf5]])){$ZZZZZZZZZZZZZZZZA00[$ZZZZZn13[$Zf5]] = array();}}} for($Zf5 = 0;$Zf5<$this->ZZZZZZZZZZZZZZZZk10;$Zf5++){if(isset($ZZZZZZZZZZZZZZZZz25[$r17[$Zf5][$field]])){$ZZZz25 = $r17[$Zf5];$ZZZZZZZZZZZZZZZZC22 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZZz25[$r17[$Zf5][$field]]);for($ZZZZZK1010 = 0;$ZZZZZK1010 < $ZZT1919;$ZZZZZK1010++){$ZZZZZZZZZZZZZZZZC22[$ZZZZZK1010] = $ZZZz25;$ZZZZZZZZZZZZZZZZC22[$ZZZZZK1010][$field] = $ZZZZZZZZZZZZZZZZz25[$r17[$Zf5][$field]][$ZZZZZK1010];$ZZZZZZZZZZZZZZZZB11[] = $Zf5+$ZZZZZK1010;$ZZZZZZZZZZZZZZZZA00[$ZZZZZZZZZZZZZZZZz25[$r17[$Zf5][$field]][$ZZZZZK1010]][] = $Zf5+$ZZZZZK1010;} $this->ZZZZZZZZZZZZZZZZk10 = $this->ZZZZZZZZZZZZZZZZk10 + $ZZT1919 -1;array_splice($r17,$Zf5,1,$ZZZZZZZZZZZZZZZZC22);$Zf5 = $Zf5 + $ZZT1919 -1;}elseif(isset($ZZZZZZZZZZZZZZZZA00[$r17[$Zf5][$field]])){$ZZZZZZZZZZZZZZZZA00[$r17[$Zf5][$field]][] = $Zf5;}} if ($this->ZZZZZZZZZZZZW2222) {$ZZT1919 = count($ZZZZZZZZZZZZZZZZB11);for ($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++) {$ZZZZZZZZZZZZZZs18 = count($ZZZZZZZZZZZZZZZZA00[$r17[$ZZZZZZZZZZZZZZZZB11[$Zf5]][$field]]);for ($ZZZZZK1010 = 0;$ZZZZZK1010 < $ZZZZZZZZZZZZZZs18;$ZZZZZK1010++) {if ($ZZZZZZZZZZZZZZZZB11[$Zf5] != $ZZZZZZZZZZZZZZZZA00[$r17[$ZZZZZZZZZZZZZZZZB11[$Zf5]][$field]][$ZZZZZK1010]) {if ($this->ZZZZZZZZZZZZZZZZq16($r17[$ZZZZZZZZZZZZZZZZB11[$Zf5]], $r17[$ZZZZZZZZZZZZZZZZA00[$r17[$ZZZZZZZZZZZZZZZZB11[$Zf5]][$field]][$ZZZZZK1010]])) {$this->ZZZZZZZZZZZZZZZZt19($r17, $ZZZZZZZZZZZZZZZZB11[$Zf5], $ZZZZZZZZZZZZZZZZA00[$r17[$ZZZZZZZZZZZZZZZZB11[$Zf5]][$field]][$ZZZZZK1010], $field, $ZZZZZZZZZZZZZZZZB11, $ZZZZZZZZZZZZZZZZA00);break;}}}}}} function ZZZZZZZZZZZZZI88(&$r17){$this->ZZZZZZZZZZZZZZZZk10 = count($r17);$ZZT1919 = count($this->ZZZZZZZZZZZZZZZZj9);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZz25 = $this->ZZZZZZZZZZZZZZZZo14($this->ZZZZZZZZZZZZZZZZj9[$Zf5]["name"],$r17);$this->ZZZZZZZZZZZZZZZZy24($ZZZZZZZZZZZZZZZZz25,$this->ZZZZZZZZZZZZZZZZj9[$Zf5]["name"],$r17);}}}
class ZZZZZZZZZZZZZP1515{protected $id = 0;function ZZZZZZZZZZZZZI88(&$ZZZZZZZZZZZZZZX2323){$ZZT1919 = count($ZZZZZZZZZZZZZZX2323);for($Zf5 = 0;$Zf5< $ZZT1919;$Zf5++){$this->ZZZZZZZZZZZZZZZZi8($ZZZZZZZZZZZZZZX2323[$Zf5]);}} function ZZZZZZZZZZZZZZZZi8(&$ZZr17){$this->id++;$ZZr17["id"] = $this->id;}} class ZZZZZZZZZZx23 {public $name;protected $db;protected $ZZZZS1818;public $prefix = "";public $fieldTitlePrefix = "";public $relationDescr = null;function __construct($name, ZZp15 $db, ZZZZT1919 $ZZZZS1818){$this->name = $name;$this->db = $db;$this->ZZZZS1818 = $ZZZZS1818;$this->prefix = "0_".$this->name."_";} function ZZZZZZZZZZZZZZZZD33($field){$ZZZZZn13 = $this->ZZZZS1818->ZZZZZm12($field['fieldname'],$this->name,$this->db);$ZZS1818 = array();foreach($ZZZZZn13 as $ZZZT1919 => $ZZZZZZZZZZZZZZZe4){$ZZS1818[] = array("val" => $ZZZT1919,"title" => $ZZZZZZZZZZZZZZZe4);} return $ZZS1818;} function ZZZZZZZZZZZZZZZZE44($field){$ZZZZZZZZZZZZZZZh7 = array();switch ($field['uitype']) {case 'name': case 'text': case 'varchar': $type = "txt";break;case 'enum': case 'multienum': case 'dynamicenum': $type = "select";$ZZZZZZZZZZZZZZZh7 = $this->ZZZZZZZZZZZZZZZZD33($field);break;case 'id': $type = "txt";break;case 'int': $type = "integer";break;case 'currency': case 'float': case 'decimal': $type = "number";break;case 'datetimecombo': case 'datetime': $type = "datetime";break;case 'date': $type = "date";break;case 'bool': $type = "checkbox";break;case 'relate': if(in_array($field["fieldname"], array("assigned_user_id"))) {$type = "user";} else {$type = "txt";} break;case 'assigned_user_name': $type = "user";break;default: $type = "txt";break;} $ZZZZZZZZZZZZZZZZF55 = explode("~", $field['typeofdata']);if($ZZZZZZZZZZZZZZZZF55[0]=="D"){$type = "date";} if($ZZZZZZZZZZZZZZZZF55[0]=="N"||$ZZZZZZZZZZZZZZZZF55[0]=="I"){if(!$this->ZZZZS1818->ZZZZZy24($field)){$type = "number";}} return array("name"=>$this->prefix.$field['fieldname'], "column"=>$field['columnname'], "table"=>$field['tablename'], "uitype"=>$field['uitype'], "type"=>$type, "title"=>$this->fieldTitlePrefix.$this->ZZZZS1818->ZZZZZk10($field['fieldlabel'],$this->name), "availableValues" =>$ZZZZZZZZZZZZZZZh7, "bareTitle"=>$this->ZZZZS1818->ZZZZZk10($field['fieldlabel'],$this->name),);} function ZZZZZZZZZZZF55(){return $this->ZZZZS1818->ZZZZZp15($this->name);} function ZZZZZZZZZZZZI88(){$ZZZz25 = $this->ZZZZS1818->ZZZZZs18($this->name);$ZZT1919 = count($ZZZz25);$ZZS1818 = array();for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[$ZZZz25[$Zf5]['name']] = $ZZZz25[$Zf5];} return $ZZS1818;} function ZZZZZZZZZZZZZU2020(){$ZZZc2 = $this->db->ZZW2222($this->name);$ZZS1818 = array();$ZZT1919 = count($ZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $this->ZZZZZZZZZZZZZZZZE44($ZZZc2[$Zf5]);} return $ZZS1818;} function ZZZZZZZZZZZZZZZZG66($ZZZZo14,$ZZZZZZZZZZZZZZZZH77 = false){if($ZZZZo14['label'] == "---"){$ZZS1818 = array("title" => $this->ZZZZS1818->ZZZZZk10($this->name,$this->name), "fields" => array(),);}else{$ZZS1818 = array("title" => $this->ZZZZS1818->ZZZZZk10($ZZZZo14['label'],$this->name), "fields" => array(),);} if($ZZZZo14['id'] === 52){$ZZS1818["title"] = $this->ZZZZS1818->ZZZZZk10($ZZZZo14['label'],"Invoice");} $ZZT1919 = count($ZZZZo14['fields']);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(!$ZZZZZZZZZZZZZZZZH77 || !($ZZZZo14['fields'][$Zf5]['tablename']== "vtiger_crmentity" && $ZZZZo14['fields'][$Zf5]['columnname']=='assigned_user_id')){$ZZS1818['fields'][] = $this->ZZZZZZZZZZZZZZZZE44($ZZZZo14['fields'][$Zf5]);}} return $ZZS1818;} function ZZZZZZZZZV2121(){$ZZZc2 = $this->db->ZZW2222($this->name);$ZZS1818 = array();$ZZT1919 = count($ZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZc2[$Zf5]["module"] = 0;$ZZZc2[$Zf5]['fieldname_org'] = $ZZZc2[$Zf5]['fieldname'];$ZZZc2[$Zf5]['fieldname'] = "0_".$this->name."_".$ZZZc2[$Zf5]['fieldname'];$ZZZc2[$Zf5]['fieldlabel'] = $this->ZZZZS1818->ZZZZZk10($ZZZc2[$Zf5]['fieldlabel'],$this->name);$ZZS1818[$ZZZc2[$Zf5]['fieldname']] = $ZZZc2[$Zf5];} return $ZZS1818;} function ZZZZZZZZZZC22($ZZZZZZZZZZZZZZZZH77 = false){$ZZZZZZZZZZZZZZZZI88 = $this->db->ZZZr17($this->name);$ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZZI88);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $this->ZZZZZZZZZZZZZZZZG66($ZZZZZZZZZZZZZZZZI88[$Zf5],$ZZZZZZZZZZZZZZZZH77);} return $ZZS1818;}} class ZZZZZZZZZZy24 extends ZZZZZZZZZZx23{public $relationDescr;public $prefix = "";public $ZZZZZZZZZZZZZZZZJ99 = "";function __construct($name, ZZp15 $db, ZZZZT1919 $ZZZZS1818,$relationDescr){parent::__construct($name,$db,$ZZZZS1818);$this->relationDescr = $relationDescr;} function ZZZZZZZZZZZZZZZZG66($ZZZZo14,$ZZZZZZZZZZZZZZZZH77 = false){$ZZS1818 = parent::ZZZZZZZZZZZZZZZZG66($ZZZZo14,$ZZZZZZZZZZZZZZZZH77);$ZZS1818["title"] = $this->ZZZZZZZZZZZZZZZZJ99.$ZZS1818["title"];return $ZZS1818;} function ZZZZZZZZZV2121($ZZZZZZZZZZZc2 = 0){$ZZZc2 = $this->db->ZZW2222($this->name);$ZZS1818 = array();$ZZT1919 = count($ZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZc2[$Zf5]['fieldname_org'] = $ZZZc2[$Zf5]['fieldname'];$ZZZc2[$Zf5]['fieldname'] = $ZZZZZZZZZZZc2."_".$this->name."_".$ZZZc2[$Zf5]['fieldname'];$ZZZc2[$Zf5]['fieldlabel'] = $this->ZZZZS1818->ZZZZZk10($ZZZc2[$Zf5]['fieldlabel'],$this->name);$ZZZc2[$Zf5]['module'] = $ZZZZZZZZZZZc2;$ZZS1818[$ZZZc2[$Zf5]['fieldname']] = $ZZZc2[$Zf5];} return $ZZS1818;}}
;class ZZZZZZZZZZZZZZZZK1010 {public $ZZZZZZZZZZZZZZZZL1111 = array();public $ZZZZZZZZZZZZZZZZM1212 = array();function ZZZZZZZZZZZZZZZZK1010($ZZZZZZZZZZZZZZZZM1212) {$this->ZZZZZZZZZZZZZZZZM1212 = $ZZZZZZZZZZZZZZZZM1212;} function ZZZZZZZZZZZZZZZZN1313() {return $this->ZZZZZZZZZZZZZZZZL1111;} function ZZZZZZZZZZZZZZZZO1414($title) {if(isset($this->ZZZZZZZZZZZZZZZZM1212[$title]) && !empty($this->ZZZZZZZZZZZZZZZZM1212[$title])) {$title = $this->ZZZZZZZZZZZZZZZZM1212[$title];} return $title;} function ZZZZZZZZZZZZZZZZP1515($ZZZP1515, $ZZZZZZZZZZZZZZZZQ1616, $db,$ZZZZS1818,$current_user, $ZZZZa0) {$G66 = array();$ZZZX2323 = $ZZZZS1818->ZZZZU2020($current_user);$ZZZY2424 = $ZZZZS1818->ZZZZV2121($current_user);$ZZZZy24 = $ZZZZS1818->getUserGroups($ZZZY2424);$ZZZZZZZZZZZZZZZZR1717 = $db->listReports($ZZZX2323, $ZZZY2424, $ZZZZy24, $ZZZP1515, $ZZZZa0);$ZZZZZZZZZZZZZZZZS1818 = $ZZZZZZZZZZZZZZZZQ1616 . $ZZZP1515;foreach($ZZZZZZZZZZZZZZZZR1717 as $ZZZZZZu20) {if(($ZZZZZZu20["can_edit"]+$ZZZZZZu20["can_delete"])>0){$this->ZZZZZZZZZZZZZZZZL1111[] = $ZZZZZZu20["id"];} $ZZZZZZZZZZZZZZZZT1919 = "";if($ZZZZZZu20["can_delete"] > 0) {$ZZZZZZZZZZZZZZZZT1919 .= '<a href="index.php?module=AnalyticReporting&action=Delete&record='.$ZZZZZZu20["id"].'" data-action="deleteItem" data-id="'.$ZZZZZZu20["id"].'" onclick="return confirm(\''.$ZZZZS1818->ZZZZZk10('label_delete', 'AnalyticReporting').': '.htmlspecialchars($ZZZZZZu20["title"]).' ?\')">'.$ZZZZS1818->ZZZZZk10('label_delete', 'AnalyticReporting').'</a>';} if($ZZZX2323) {$ZZZZZZZZZZZZZZZZT1919 .= ' | ';if($ZZZZZZu20["visible"] == 1) {$ZZZZZZZZZZZZZZZZT1919 .= '<a href="index.php?module=AnalyticReporting&action=Toggle&key=report&record='.$ZZZZZZu20["id"].'&value=0&to_pdf=1">'.$ZZZZS1818->ZZZZZk10('label_hide', 'AnalyticReporting').'</a>';} else {$ZZZZZZZZZZZZZZZZT1919 .= '<a href="index.php?module=AnalyticReporting&action=Toggle&key=report&record='.$ZZZZZZu20["id"].'&value=1&to_pdf=1">'.$ZZZZS1818->ZZZZZk10('label_unhide', 'AnalyticReporting').'</a>';}} $G66[] = array("id" => $ZZZZZZu20['id'], "parent" => $ZZZZZZZZZZZZZZZZS1818, "text" => $this->ZZZZZZZZZZZZZZZZO1414($ZZZZZZu20["title"]), "data" => array("description" => $ZZZZZZu20["description"], "tools"	=> $ZZZZZZZZZZZZZZZZT1919,), "a_attr" => array("href" => "index.php?module=AnalyticReporting&action=report&record=".$ZZZZZZu20["id"],), "type" => "report");} return $G66;} function ZZZZZZZZZZZZZZZZU2020($db, $ZZZZS1818, $current_user, $ZZZZa0) {$ZZZZZZZZZZZZZZZZV2121 = array();$ZZZZZZZZZZZZZZZZQ1616 = "c_";$ZZZX2323 = $ZZZZS1818->ZZZZU2020($current_user);$ZZZZZZZZZZZZZZZZW2222 = " WHERE `visible` = 1 ";$ZZZZZZS1818 = " AND `visible` = 1 ";if($ZZZZa0) {$ZZZZZZZZZZZZZZZZW2222 = "";$ZZZZZZS1818 = "";} $ZZq16 = "SELECT * FROM `advancedreports_categories` $ZZZZZZZZZZZZZZZZW2222 ORDER BY `sequence` ASC";$ZZZZI88 = $db->ZZZu20($ZZq16);foreach($ZZZZI88 as $ZZZZZZZZZZZZZZZZX2323) {$ZZZP1515 = $ZZZZZZZZZZZZZZZZX2323["id"];$ZZZZZZZZZZZZZZZZY2424 = $ZZZZZZZZZZZZZZZZX2323["parent_id"];$ZZZZZZZZZZZZZZZZZ2525 = $db->ZZZu20("SELECT COUNT(*) FROM `advancedreports` WHERE `category_id` = ". (int)$ZZZP1515 . " " . $ZZZZZZS1818);$ZZZZZZZZZZZZZZZZZ2525 = $ZZZZZZZZZZZZZZZZZ2525[0]['COUNT(*)'];$ZZZZZZZZZZZZZZZZS1818 = $ZZZZZZZZZZZZZZZZQ1616 . $ZZZP1515;$ZZZZZZZZZZZZZZZZZa0 = $ZZZZZZZZZZZZZZZZQ1616 . $ZZZZZZZZZZZZZZZZY2424;if(!$ZZZZZZZZZZZZZZZZY2424 || $ZZZZZZZZZZZZZZZZY2424 == 0) {$ZZZZZZZZZZZZZZZZZa0 = "#";} $ZZZZZZZZZZZZZZZZT1919 = "";if($ZZZZZZZZZZZZZZZZZ2525 == 0) {$ZZZZZZZZZZZZZZZZT1919 .= '<a href="#" data-action="deleteCategory" data-id="'.$ZZZP1515.'">'.$ZZZZS1818->ZZZZZk10('label_delete', 'AnalyticReporting').'</a>';$ZZZZZZZZZZZZZZZZT1919 .= ' | ';} $ZZZZZZZZZZZZZZZZT1919 .= '<a href="#" data-action="editCategory" data-id="'.$ZZZP1515.'" data-title="'.$ZZZZZZZZZZZZZZZZX2323["title"].'" data-description="'.$ZZZZZZZZZZZZZZZZX2323["description"].'">'.$ZZZZS1818->ZZZZZk10('label_edit', 'AnalyticReporting').'</a>';$ZZZZZZZZZZZZZZZZT1919 .= ' | ';$ZZZZZZZZZZZZZZZZT1919 .= '<a href="#" data-action="addCategory" data-id="'.$ZZZP1515.'">'.$ZZZZS1818->ZZZZZk10('label_add_folder', 'AnalyticReporting').'</a>';if($ZZZX2323) {$ZZZZZZZZZZZZZZZZT1919 .= ' | ';if($ZZZZZZZZZZZZZZZZX2323["visible"] == 1) {$ZZZZZZZZZZZZZZZZT1919 .= '<a href="index.php?module=AnalyticReporting&action=Toggle&key=category&record='.$ZZZP1515.'&value=0&to_pdf=1">'.$ZZZZS1818->ZZZZZk10('label_hide', 'AnalyticReporting').'</a>';} else {$ZZZZZZZZZZZZZZZZT1919 .= '<a href="index.php?module=AnalyticReporting&action=Toggle&key=category&record='.$ZZZP1515.'&value=1&to_pdf=1">'.$ZZZZS1818->ZZZZZk10('label_unhide', 'AnalyticReporting').'</a>';}} $ZZZZZZZZZZZZZZZZV2121[] = array("id" => $ZZZZZZZZZZZZZZZZS1818, "parent" => $ZZZZZZZZZZZZZZZZZa0, "text" => $this->ZZZZZZZZZZZZZZZZO1414($ZZZZZZZZZZZZZZZZX2323["title"]), "data" => array("description" => $ZZZZZZZZZZZZZZZZX2323["description"], "tools"	=> $ZZZZZZZZZZZZZZZZT1919), "type" => "category");$ZZZZZZZZZZZZZZZZZb1 = $this->ZZZZZZZZZZZZZZZZP1515($ZZZP1515, $ZZZZZZZZZZZZZZZZQ1616, $db, $ZZZZS1818, $current_user, $ZZZZa0);$ZZZZZZZZZZZZZZZZV2121 = array_merge($ZZZZZZZZZZZZZZZZZb1, $ZZZZZZZZZZZZZZZZV2121);} return $ZZZZZZZZZZZZZZZZV2121;}}
;class ZZZZZZZZZZZZZZZZZc2 {protected $db;protected $ZZZZS1818;function __construct($db, $ZZZZS1818) {$this->db = $db;$this->ZZZZS1818 = $ZZZZS1818;} function ZZZZZZZZZZZZZZZZZd3($ZZZZZZZZZZZZZZZZZe4,$ZZZZZZZZZZZZZZZZZf5,$ZZZZZZZZZZZZZZZZZg6){$ZZS1818 = array();$ZZT1919= count($ZZZZZZZZZZZZZZZZZe4);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = array('id'=>$ZZZZZZZZZZZZZZZZZf5.$ZZZZZZZZZZZZZZZZZe4[$Zf5]["id"], 'name'=>$ZZZZZZZZZZZZZZZZZg6.$ZZZZZZZZZZZZZZZZZe4[$Zf5]["name"]);} return $ZZS1818;} function ZZZZZZZZZZZZZZZZZh7($ZZZZZZZZZZZZZZZZZe4,$prefix){$ZZS1818 = array();$ZZT1919= count($ZZZZZZZZZZZZZZZZZe4);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if($ZZZZZZZZZZZZZZZZZe4[$Zf5]["level"]==2) $ZZS1818[$prefix.$ZZZZZZZZZZZZZZZZZe4[$Zf5]["id"]] = "DELETE";elseif($ZZZZZZZZZZZZZZZZZe4[$Zf5]["level"]==1) $ZZS1818[$prefix.$ZZZZZZZZZZZZZZZZZe4[$Zf5]["id"]] = "EDIT";else $ZZS1818[$prefix.$ZZZZZZZZZZZZZZZZZe4[$Zf5]["id"]] = "VIEW";} return $ZZS1818;} function ZZZZf5(){return $this->db->ZZZZf5();} function ZZZZZZZZZZZZZZZZZi8(){$ZZZZA00 = $this->db->ZZZZf5();$ZZZZA00 = $this->ZZZZZZZZZZZZZZZZZd3($ZZZZA00,"u_",$this->ZZZZS1818->ZZZZZk10("label_user","AnalyticReporting")."::");$ZZZZE44 = $this->db->ZZZZr17();$ZZZZE44 = $this->ZZZZZZZZZZZZZZZZZd3($ZZZZE44,"r_",$this->ZZZZS1818->ZZZZZk10("label_role","AnalyticReporting")."::");$ZZS1818 = array_merge($ZZZZA00, $ZZZZE44);return $ZZS1818;} function ZZZZZZZZZZZZZZZZZj9($ZZZC22){$ZZZZA00 = $this->db->ZZZZg6($ZZZC22);$ZZZZA00 = $this->ZZZZZZZZZZZZZZZZZh7($ZZZZA00,"u_");$ZZZZE44 = $this->db->ZZZZp15($ZZZC22);$ZZZZE44 = $this->ZZZZZZZZZZZZZZZZZh7($ZZZZE44,"r_");$ZZS1818 = array_merge($ZZZZA00,$ZZZZE44);return $ZZS1818;} function ZZZZZZZZZZZZZZZZZk10(){$ZZS1818 = $this->ZZZZZZZZZZZZZZZZZi8();$ZZZZE44 = $this->db->ZZZZr17();$ZZZZE44 = $this->ZZZZZZZZZZZZZZZZZd3($ZZZZE44,"r_",$this->ZZZZS1818->ZZZZZk10("label_role","AnalyticReporting")."::");$ZZS1818 = array_merge($ZZS1818,$ZZZZE44);return $ZZS1818;} function ZZZZZZZZZZZZZZZZZl11($prefix,$name,$ZZZZZZZZZZZZZZZZR1717){$ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZZR1717);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $prefix.$ZZZZZZZZZZZZZZZZR1717[$Zf5][$name];} return $ZZS1818;} function ZZZZZZZZZZZZZZZZZm12($ZZZC22){$ZZZZA00 = $this->db->ZZZZh7($ZZZC22);$ZZZZA00 = $this->ZZZZZZZZZZZZZZZZZl11("u_","user",$ZZZZA00);$ZZZZE44 = $this->db->ZZZZj9($ZZZC22);$ZZZZE44 = $this->ZZZZZZZZZZZZZZZZZl11("r_","role",$ZZZZE44);$ZZS1818 = array_merge($ZZZZA00,$ZZZZE44);return $ZZS1818;} function ZZZZZZZZZZZZZZZZZn13($ZZZC22){$ZZZz25 = $this->db->ZZZu20("SELECT * FROM advancedreports_schedule WHERE id = $ZZZC22");$ZZS1818 = array("isScheduled" => false, "interval" => 0, "intervalOptions" => array("01","01"), "timeH" => "12", "timeM" => "00", "formats" =>new stdClass(),);if(!empty($ZZZz25)){$ZZS1818["isScheduled"] = true;$ZZS1818["interval"] = $ZZZz25[0]['interval'];$ZZZZZZZZZZZZZZZZZo14 = explode(":",$ZZZz25[0]["time"]);$ZZS1818["timeH"] = $ZZZZZZZZZZZZZZZZZo14[0];$ZZS1818["timeM"] = $ZZZZZZZZZZZZZZZZZo14[1];$ZZS1818["intervalOptions"] = $ZZZz25[0]["interval_options"];if(in_array($ZZS1818["interval"],array(2,4))){$ZZS1818["intervalOptions"] = explode("-",$ZZS1818["intervalOptions"]);}elseif($ZZS1818["interval"]==3){$ZZS1818["intervalOptions"] = array("01",$ZZS1818["intervalOptions"]);}elseif($ZZS1818["interval"]==1){$ZZS1818["intervalOptions"] = array($ZZS1818["intervalOptions"],"01");} if(!empty($ZZZz25[0]["formats"])){$ZZS1818["formats"] = json_decode($ZZZz25[0]["formats"]);}else{$ZZS1818["formats"] = json_decode('{"xlsx":true,"pdf":false,"url":false}');}} return $ZZS1818;} function ZZZZZZZZZZZZZZZZZp15($ZZZZW2222,$report){if($this->ZZZZS1818->ZZZZU2020($ZZZZW2222)){return 3;} $ZZZY2424 = $this->ZZZZS1818->ZZZZV2121($ZZZZW2222);$ZZZZy24 = $this->ZZZZS1818->getUserGroups($ZZZY2424);$ZZZz25 = $this->db->ZZZZw22($ZZZY2424,$ZZZZy24,$report);$ZZS1818 = ($ZZZz25[0]['level'] == null) ? 0 : $ZZZz25[0]['level'] + 1;return $ZZS1818;} function ZZZZZZZZZZZZZZZZZq16($ZZZC22,$r17){$ZZZZy24 = array();$ZZZZA00 = array();foreach($r17 as $ZZZT1919 => $ZZZZZZZZZZZZZZZe4){$ZZZz25 = explode("_",$ZZZT1919,2);if(count($ZZZz25) == 2){if($ZZZZZZZZZZZZZZZe4=="DELETE") $ZZZZZZZZZZZZZZZZZr17 = 2;elseif ($ZZZZZZZZZZZZZZZe4=="EDIT") $ZZZZZZZZZZZZZZZZZr17 = 1;else $ZZZZZZZZZZZZZZZZZr17 = 0;if($ZZZz25[0]=="u"){$ZZZZA00[] = array($ZZZC22,$ZZZz25[1],$ZZZZZZZZZZZZZZZZZr17);}else{$ZZZZy24[] = array($ZZZC22,$ZZZz25[1],$ZZZZZZZZZZZZZZZZZr17);}}} $this->db->ZZZZx23($ZZZC22,$ZZZZy24);$this->db->ZZZZz25($ZZZC22,$ZZZZA00);} function ZZZZZZZZZZZZZZZZZs18($ZZZC22,$r17){$ZZZZA00 = array();$ZZZZy24 = array();$ZZZZE44 = array();$ZZT1919 = count($r17);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZz25 = explode("_",$r17[$Zf5], 2);switch($ZZZz25[0]){case "u": $ZZZZA00[]= $ZZZz25[1];break;case "g": $ZZZZy24[]= $ZZZz25[1];break;case "r": $ZZZZE44[]= $ZZZz25[1];break;}} $this->db->ZZZZC22($ZZZC22,$ZZZZA00);$this->db->ZZZZD33($ZZZC22,$ZZZZE44);} function ZZZZZZZZZZZZZZZZZt19($ZZZC22){$this->db->ZZZA00("DELETE FROM advancedreports_schedule WHERE id = ?", array($ZZZC22));$this->db->ZZZA00("DELETE FROM advancedreports_schedule_u WHERE id = ?", array($ZZZC22));$this->db->ZZZA00("DELETE FROM advancedreports_schedule_r WHERE id = ?", array($ZZZC22));} function ZZZZZZZZZZZZZZZZZu20($ZZZZZZZZZZZZZZZZZv21,$ZZZZZZZZZZZZZZZZZw22,$ZZZZZZZZZZZZZZZZZo14,$ZZZZZZO1414){$ZZZZZZZZZZZZZZZZZx23 = array("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday");switch($ZZZZZZZZZZZZZZZZZv21){case 1: $ZZZZZZZZZZZZZZZZZy24 = strtotime("this ".$ZZZZZZZZZZZZZZZZZx23[$ZZZZZZZZZZZZZZZZZw22]);break;case 2: $ZZZZZZZZZZZZZZZZZw22 = explode("-",$ZZZZZZZZZZZZZZZZZw22,2);if($ZZZZZZZZZZZZZZZZZw22[1] == 0){$ZZZZZZZZZZZZZZZZZz25 = "first";$ZZZZZZZZZZZZZZZZZA00 = "third";}else{$ZZZZZZZZZZZZZZZZZz25 = "second";$ZZZZZZZZZZZZZZZZZA00 = "fourth";} $ZZZZZZZZZZZZZZZZZB11 = strtotime('today');$ZZZZZZZZZZZZZZZZZy24 = strtotime($ZZZZZZZZZZZZZZZZZz25." ".$ZZZZZZZZZZZZZZZZZx23[$ZZZZZZZZZZZZZZZZZw22[0]]." of this month");if($ZZZZZZZZZZZZZZZZZB11>$ZZZZZZZZZZZZZZZZZy24){$ZZZZZZZZZZZZZZZZZy24 = strtotime($ZZZZZZZZZZZZZZZZZA00." ".$ZZZZZZZZZZZZZZZZZx23[$ZZZZZZZZZZZZZZZZZw22[0]]." of this month");} break;case 3: $ZZZz25 = date("Y-m-d");$ZZZz25 = preg_replace('/[0-9][0-9]$/',$ZZZZZZZZZZZZZZZZZw22,$ZZZz25);$ZZZZZZZZZZZZZZZZZC22 = date('Y-m-d', strtotime('last day of this month'));if($ZZZz25>$ZZZZZZZZZZZZZZZZZC22){$ZZZz25 = $ZZZZZZZZZZZZZZZZZC22;} $ZZZZZZZZZZZZZZZZZy24 = strtotime($ZZZz25);break;case 4: $ZZZZZZZZZZZB11 = ((int)date("Y"));$ZZZz25 = $ZZZZZZZZZZZB11."-".$ZZZZZZZZZZZZZZZZZw22;$ZZZZZZZZZZZZZZZZZy24 = strtotime($ZZZz25);break;case 0: default: $ZZZZZZZZZZZZZZZZZy24 = strtotime("today");break;} $ZZZZZZZZZZZZo14 = date("Y-m-d ",$ZZZZZZZZZZZZZZZZZy24);$ZZZZZZZZZZZZZZZZZD33 = $ZZZZZZZZZZZZo14.$ZZZZZZZZZZZZZZZZZo14.":00";$ZZZZZZZZZZZZZZZZZE44 = date_default_timezone_get();date_default_timezone_set($ZZZZZZO1414);$ZZZZZZZZZZZZc2 = strtotime($ZZZZZZZZZZZZZZZZZD33);date_default_timezone_set($ZZZZZZZZZZZZZZZZZE44);return date("Y-m-d H:i:s",$ZZZZZZZZZZZZc2);} function ZZZZZZZZZZZZZZZZZF55($ZZZZZZZZZZZZZZZZZv21,$ZZZZZZZZZZZZZZZZZw22,$ZZZZZZZZZZZZZZZZZo14,$ZZZZZZO1414){$ZZZZZZZZZZZZZZZZZx23 = array("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday");switch($ZZZZZZZZZZZZZZZZZv21){case 1: $ZZZZZZZZZZZZZZZZZy24 = strtotime("next ".$ZZZZZZZZZZZZZZZZZx23[$ZZZZZZZZZZZZZZZZZw22]);break;case 2: $ZZZZZZZZZZZZZZZZZw22 = explode("-",$ZZZZZZZZZZZZZZZZZw22,2);if($ZZZZZZZZZZZZZZZZZw22[1] == 0){$ZZZZZZZZZZZZZZZZZz25 = "first";$ZZZZZZZZZZZZZZZZZA00 = "third";}else{$ZZZZZZZZZZZZZZZZZz25 = "second";$ZZZZZZZZZZZZZZZZZA00 = "fourth";} $ZZZZZZZZZZZZZZZZZB11 = date("Y-m-d");$ZZZZZZZZZZZZZZZZZy24 = strtotime($ZZZZZZZZZZZZZZZZZA00." ".$ZZZZZZZZZZZZZZZZZx23[$ZZZZZZZZZZZZZZZZZw22[0]]." of this month");if($ZZZZZZZZZZZZZZZZZB11>=date("Y-m-d",$ZZZZZZZZZZZZZZZZZy24)){$ZZZZZZZZZZZZZZZZZy24 = strtotime($ZZZZZZZZZZZZZZZZZz25." ".$ZZZZZZZZZZZZZZZZZx23[$ZZZZZZZZZZZZZZZZZw22[0]]." of next month");} break;case 3: $ZZZz25 = date("Y-m-d",strtotime("+1 month"));$ZZZz25 = preg_replace('/[0-9][0-9]$/',$ZZZZZZZZZZZZZZZZZw22,$ZZZz25);$ZZZZZZZZZZZZZZZZZC22 = date('Y-m-d', strtotime('last day of next month'));if($ZZZz25>$ZZZZZZZZZZZZZZZZZC22){$ZZZz25 = $ZZZZZZZZZZZZZZZZZC22;} $ZZZZZZZZZZZZZZZZZy24 = strtotime($ZZZz25);break;case 4: $ZZZZZZZZZZZB11 = ((int)date("Y") + 1);$ZZZz25 = $ZZZZZZZZZZZB11."-".$ZZZZZZZZZZZZZZZZZw22;$ZZZZZZZZZZZZZZZZZy24 = strtotime($ZZZz25);break;case 0: default: $ZZZZZZZZZZZZZZZZZy24 = strtotime("+1 day");break;} $ZZZZZZZZZZZZo14 = date("Y-m-d ",$ZZZZZZZZZZZZZZZZZy24);$ZZZZZZZZZZZZZZZZZD33 = $ZZZZZZZZZZZZo14.$ZZZZZZZZZZZZZZZZZo14.":00";$ZZZZZZZZZZZZZZZZZE44 = date_default_timezone_get();date_default_timezone_set($ZZZZZZO1414);$ZZZZZZZZZZZZc2 = strtotime($ZZZZZZZZZZZZZZZZZD33);date_default_timezone_set($ZZZZZZZZZZZZZZZZZE44);return date("Y-m-d H:i:s",$ZZZZZZZZZZZZc2);} function ZZZZZZZZZZZZZZZZZG66($id,$ZZZZZZZZZZZZZZZZZv21,$ZZZZZZZZZZZZZZZZZH77,$ZZZZZZZZZZZZZZZZZI88,$ZZZZZZZZZZZZZZZZZJ99,$ZZZF55,$ZZZZZZZZZZZZZZZZZK1010){$ZZZZW2222 = new User();$ZZZZW2222->retrieve((int)$ZZZF55);$ZZZZZZZZZZZZZZZZZK1010 = json_decode($ZZZZZZZZZZZZZZZZZK1010);if(is_a($ZZZZZZZZZZZZZZZZZK1010,"stdClass") && (property_exists($ZZZZZZZZZZZZZZZZZK1010,"xlsx") || property_exists($ZZZZZZZZZZZZZZZZZK1010,"pdf") || property_exists($ZZZZZZZZZZZZZZZZZK1010,"url"))){$ZZZZZZZZZZZZZZZZZK1010 = json_encode($ZZZZZZZZZZZZZZZZZK1010);}else{$ZZZZZZZZZZZZZZZZZK1010 = "";} $ZZZZZZZZZZZZZZZZZL1111 = TimeDate::userTimezone($ZZZZW2222);$ZZZZZZZZZZZZZZZZZo14 = $ZZZZZZZZZZZZZZZZZH77.":".$ZZZZZZZZZZZZZZZZZI88;$ZZZJ99 = "";if($ZZZZZZZZZZZZZZZZZv21 == 1){$ZZZJ99 = (int)$ZZZZZZZZZZZZZZZZZJ99[0];}else if($ZZZZZZZZZZZZZZZZZv21 == 2){$ZZZJ99 = ((int)$ZZZZZZZZZZZZZZZZZJ99[0])."-".((int)$ZZZZZZZZZZZZZZZZZJ99[1]) ;}else if($ZZZZZZZZZZZZZZZZZv21 == 3){$ZZZJ99 = $ZZZZZZZZZZZZZZZZZJ99[1];}else if($ZZZZZZZZZZZZZZZZZv21 == 4){$ZZZJ99 = $ZZZZZZZZZZZZZZZZZJ99[0]."-".$ZZZZZZZZZZZZZZZZZJ99[1];} $ZZZZZZZZZZZZZZZZZM1212 = $this->ZZZZZZZZZZZZZZZZZu20($ZZZZZZZZZZZZZZZZZv21,$ZZZJ99,$ZZZZZZZZZZZZZZZZZo14,$ZZZZZZZZZZZZZZZZZL1111);if($ZZZZZZZZZZZZZZZZZM1212<date("Y-m-d H:i:s")){$ZZZZZZZZZZZZZZZZZM1212 = $this->ZZZZZZZZZZZZZZZZZF55($ZZZZZZZZZZZZZZZZZv21,$ZZZJ99,$ZZZZZZZZZZZZZZZZZo14,$ZZZZZZZZZZZZZZZZZL1111);} $this->db->ZZZA00("INSERT INTO advancedreports_schedule (`id`, `interval`, `interval_options`, `time`,`nexttime`, `formats`) VALUES(?,?,?,?,'$ZZZZZZZZZZZZZZZZZM1212',?) ON DUPLICATE KEY UPDATE `interval`=VALUES(`interval`), `interval_options`=VALUES(`interval_options`), `time`=VALUES(`time`), `formats`=VALUES(`formats`), `nexttime`='$ZZZZZZZZZZZZZZZZZM1212' ", array($id,$ZZZZZZZZZZZZZZZZZv21,$ZZZJ99,$ZZZZZZZZZZZZZZZZZo14,$ZZZZZZZZZZZZZZZZZK1010));}} ;class ZZZZZZZZZZZZZZZZZN1313{public static function ZZZZZZZZZZZZZZZZZO1414($ZZZZZZZZZP1515){global $mod_strings;$ZZZZZZZZZZZZZZZZZP1515 = array();if(empty($ZZZZZZZZZP1515['reportTitle'])){$ZZZZZZZZZZZZZZZZZP1515['statusCode'] = 2;$ZZZZZZZZZZZZZZZZZP1515['statusMessage'] = $mod_strings['noNameError'];}else{$ZZZZZZZZZZZZZZZZZP1515['statusCode'] = 1;} return $ZZZZZZZZZZZZZZZZZP1515;} public static function ZZZZZZZZZZZZZZZZZQ1616($ZZZZZZZZZP1515, $ZZZZZZZZZZJ99){$ZZZZZZZZZZZZZZZZZR1717 = $ZZZZZZZZZP1515['selectedReportType'] == 'combined'?"":$ZZZZZZZZZP1515['selectedModules'][0]['moduleName'];$ZZZZZZZZZZZZZZZZZS1818 = ZZZZZZZZZZZZZZZZZN1313::ZZZZZZZZZZZZZZZZZT1919($ZZZZZZZZZP1515['selectedModules'][0]['children']);$ZZZZZZZZZZZZZZZZZU2020 = "'[".implode ("," , $ZZZZZZZZZZZZZZZZZS1818)."]'";$ZZZZZZZZZZZZZZZZZV2121 = $ZZZZZZZZZP1515;$ZZZZZZZZZZZZZZZZZV2121['selectedReportType'] = $ZZZZZZZZZP1515['selectedReportType'] == 'combined'?1:0;$ZZZZZZZZZZZZZZZZZV2121['selectedModules'] = $ZZZZZZZZZZZZZZZZZU2020;$ZZZZZZZZZZZZZZZZZV2121['mainModuleName'] = $ZZZZZZZZZZZZZZZZZR1717;$ZZZZZZZZZZZZZZZZZV2121['owner'] = $ZZZZZZZZZZJ99;return $ZZZZZZZZZZZZZZZZZV2121;} public static function ZZZZZZZZZZZZZZZZZW2222($ZZZZZZZZZZj9){$ZZZZZZZZZZZZZZZZZX2323 = array();foreach($ZZZZZZZZZZj9 as $module){$ZZZZZZZZZZZZZZZZZX2323[] = array('name' => $module, 'title' => $module);} return $ZZZZZZZZZZZZZZZZZX2323;} public static function ZZZZZZZZZZZZZZZZZY2424($ZZZZZZZZZZj9, $ZZZZZZZZZZZZZZZZZZ2525){$ZZV2121 = array();foreach($ZZZZZZZZZZj9 as $module){$ZZV2121[$module]['fields'] = $ZZZZZZZZZZZZZZZZZZ2525->ZZW2222($module);} return $ZZV2121;} public static function ZZZZZZZZZZZZZZZZZZa0($ZZZZZZZZZZZZZZZZZZb1){$ZZZZZZZZZZZZZZZZZZc2 = array();foreach($ZZZZZZZZZZZZZZZZZZb1 as $moduleName => $ZZZZZn13){$ZZZZZz25 = "";$ZZZZZZZZZZZZZZZZZZd3 = array();$ZZZZZZZZZZZZZZZZZZe4 = array();if(isset($ZZZZZn13['nameField']['relation']['entityidfield'])){$ZZZZZz25 = $ZZZZZn13['nameField']['relation']['entityidfield'];} foreach($ZZZZZn13['fields'] as $field){if(strpos($field['columnname'], 'id')!==false){$ZZZZZZZZZZZZZZZZZZd3[] = array('name' => $field['columnname'], 'title'=> $field['columnname']);}else{$ZZZZZZZZZZZZZZZZZZe4[] = array('name' => $field['columnname'], 'title'=> $field['columnname']);}} if(!empty($ZZZZZz25)){$ZZZZZZZZZZZZZZZZZZc2[$moduleName][] = array('name' => 'decorator', 'title'=> '---Primary Key---', 'disabled'=>'disabled');$ZZZZZZZZZZZZZZZZZZc2[$moduleName][] = array('name' => $ZZZZZz25, 'title'=> $ZZZZZz25);} if(!empty($ZZZZZZZZZZZZZZZZZZd3)){$ZZZZZZZZZZZZZZZZZZc2[$moduleName][] = array('name' => 'decorator', 'title'=> '---Filtered IDs---', 'disabled'=>'disabled');$ZZZZZZZZZZZZZZZZZZc2[$moduleName] = array_merge($ZZZZZZZZZZZZZZZZZZc2[$moduleName], $ZZZZZZZZZZZZZZZZZZd3);} if(!empty($ZZZZZZZZZZZZZZZZZZe4)){$ZZZZZZZZZZZZZZZZZZc2[$moduleName][] = array('name' => 'decorator', 'title'=> '---Other---', 'disabled'=>'disabled');$ZZZZZZZZZZZZZZZZZZc2[$moduleName] = array_merge($ZZZZZZZZZZZZZZZZZZc2[$moduleName], $ZZZZZZZZZZZZZZZZZZe4);}} return $ZZZZZZZZZZZZZZZZZZc2;} public static function ZZZZZZZZZZZZZZZZZT1919($ZZZZZZZZZZj9, $ZZZZZF55 = 0){$ZY2424 = array();static $ZZZZZZZZZZZZZZZZZZf5 = 0;if(empty($ZZZZZZZZZZj9)){return array();} foreach($ZZZZZZZZZZj9 as $module){$ZZZZZZZZZZl11 = ZZZZZZZZZZm12::ZZZb1($module['moduleName'], true);$ZZZf5 = $ZZZZZZZZZZl11->ZZZZZZZZZZh7('columnname', $module['moduleFieldName']);$ZZY2424 = PlatformConnector::ZZZZZY2424($module['moduleName']);if($ZZZf5 !== false){$ZZY2424 = $ZZZf5['tablename'];} $ZZZZZZZZZZl11 = ZZZZZZZZZZm12::ZZZb1($module['parentModuleName'], true);$ZZZZZZZZZZZZZZZZZZg6 = $ZZZZZZZZZZl11->ZZZZZZZZZZh7('columnname', $module['parentModuleFieldName']);$ZZZZZZZZZZZZZZZZZZh7 = PlatformConnector::ZZZZZY2424($module['parentModuleName']);if($ZZZZZZZZZZZZZZZZZZg6 !== false){$ZZZZZZZZZZZZZZZZZZh7 = $ZZZZZZZZZZZZZZZZZZg6['tablename'];} $ZZZZZZZZZZZZZZZZZZi8 = "";$ZZZZZZq16 = "inverse";if($module['relation'] == 'manyToMany'){$ZZZZZZq16="many";$ZZZZZZZZZZZZZZZZZZi8 = ", \"{$module['manyToMany']['tableName']}\", \"{$module['manyToMany']['mainModuleColumnName']}\", \"{$module['manyToMany']['subModuleColumnName']}\"";if($module['manyToMany']['roleRequired']=="true"){$ZZZZZZZZZZZZZZZZZZi8 .= ", \"{$module['manyToMany']['roleIndex']}\", \"{$module['manyToMany']['roleValue']}\"";}} $ZY2424[] = "[\"{$module['moduleName']}\",\"{$ZZZZZZq16}\",\"{$module['parentModuleFieldName']}\",\"{$module['moduleFieldName']}\",\"{$ZZZZZZZZZZZZZZZZZZh7}\",\"{$ZZY2424}\",{$ZZZZZF55}{$ZZZZZZZZZZZZZZZZZZi8}]";$ZZZZZZZZZZZZZZZZZZf5++;if(isset($module['children']) && !empty($module['children'])){$ZZZZZZZZZZZZZZZZZZj9 = ZZZZZZZZZZZZZZZZZN1313::ZZZZZZZZZZZZZZZZZT1919($module['children'], $ZZZZZZZZZZZZZZZZZZf5);foreach($ZZZZZZZZZZZZZZZZZZj9 as $report){$ZY2424[] = $report;}}} return $ZY2424;} public static function ZZZZZZZZZZZZZZZZZZk10($ZZZZI88){$ZZZZZZZZZZZZZZZZZZl11 = array();for($Zf5=0,$ZZZZZZZZZZk10=count($ZZZZI88);$Zf5<$ZZZZZZZZZZk10;$Zf5++){$ZZZZZZZZZZZZZZZZZZl11[] = array('name' => $ZZZZI88[$Zf5]['id'], 'title' => $ZZZZI88[$Zf5]['title']);} return $ZZZZZZZZZZZZZZZZZZl11;}}
;require_once 'modules/AnalyticReporting/lib/PHPEXCEL/Classes/PHPExcel.php';function retrieveData($adb,$ZZZZZZZZZZZZZZZZZZm12 = false,$ZZZZZZZZZZZZZZZZZZn13 = null){$ZZZZS1818 = new ZZZZT1919();if(!$ZZZZZZZZZZZZZZZZZZm12){$db = new ZZp15($adb);$ZZZZZZZZZZZZZZZZZZn13 = $db->loadReport((int)$_REQUEST["record"]);}else{$db = $adb;$ZZZZZZZZZZZZZZZZZZn13["related_data"] = json_decode($ZZZZZZZZZZZZZZZZZZn13["related_data"]);} $ZZZZZZZZZZZZZD33 = PlatformConnector::ZZZZZZe4();$ZZZK1010 = ($ZZZZZZZZZZZZZZZZZZm12)?json_decode($ZZZZZZZZZZZZZZZZZZn13["labels"],true):json_decode($_POST['labels'],true);if(isset($_REQUEST["combined"]) &&$_REQUEST["combined"] == 1){$module = null;$ZZZZZZZZZZZZZZZZZZo14 = new ZZZZZZZZZZZZZZ2525($db, $ZZZZS1818, $ZZZK1010);}else{$module = new ZZZZZZZZZZx23($ZZZZZZZZZZZZZZZZZZn13["module"],$db,$ZZZZS1818);$ZZZZZZZZZZZZZZZZZZo14 = new ZZZZZZZZZZZZZv21($db, $ZZZZS1818, $ZZZK1010);} $ZZZZZZZZZZZZZZZZZZp15 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZZZZn13["related_data"]);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZZZp15[] = new ZZZZZZZZZZu20($ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][0], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][1], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][2], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][3], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][4], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][5], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][6], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][7], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][8], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][9]);} $ZZZJ99 = ($ZZZZZZZZZZZZZZZZZZm12)?json_decode($ZZZZZZZZZZZZZZZZZZn13["options"]):json_decode($_POST["options"]);if(!isset($ZZZJ99->aggregateColumn)){$ZZZJ99->aggregateColumn = false;} global $current_user;$id = (int)$_REQUEST["record"];$ZZZZZZZZZZZZZZZZZZq16 = new ZZZZZZZZZZZZZZZZZc2($db,$ZZZZS1818);$ZZZZZZZZZZZZZZZZZZr17 = $ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZp15($current_user,$id);if($ZZZZZZZZZZZZZZZZZZr17 == 1){$_POST['columns'] = $ZZZZZZZZZZZZZZZZZZn13["fields"];$_POST['filters'] = $ZZZZZZZZZZZZZZZZZZn13["filters"];$_POST['labels'] = $ZZZZZZZZZZZZZZZZZZn13["labels"];} $r17 = $ZZZZZZZZZZZZZZZZZZo14->ZZZZZZZZZZZZZA00($module, ($ZZZZZZZZZZZZZZZZZZm12)?json_decode($ZZZZZZZZZZZZZZZZZZn13["fields"]):json_decode($_POST['columns']), ($ZZZZZZZZZZZZZZZZZZm12)?json_decode($ZZZZZZZZZZZZZZZZZZn13["filters"]):json_decode($_POST['filters']), $ZZZZZZZZZZZZZZZZZZp15, ($ZZZZZZZZZZZZZZZZZZm12)?json_decode($ZZZZZZZZZZZZZZZZZZn13["grouping"],true):json_decode($_POST['grouping'],true), ($ZZZZZZZZZZZZZZZZZZm12)?json_decode($ZZZZZZZZZZZZZZZZZZn13["aggregates"],true):json_decode($_POST['aggregates'],true), !$ZZZJ99->includeDetails, $ZZZJ99->isCrosstab, false, $ZZZJ99->aggregateColumn, "yyyy-mm-dd", false, ($ZZZZZZZZZZZZZZZZZZm12) ? json_decode($ZZZZZZZZZZZZZZZZZZn13["calcFields"],true) : json_decode($_POST['calcFields'], true), array(), $ZZZZZZZZZZZZZD33);if((isset($_REQUEST['file']) && $_REQUEST['file'] == 'makePDF') || count($_REQUEST) == 0){$ZZZZZZZZZZZZZZZZZZs18 = $ZR1717 = $ZZZZZZZZZZZZZZZZZZt19 = $ZZZH77 = $ZZZZZZZZZZZZZZZZZZu20 = $ZZZZZZZZZZZZZZZZZZv21 = array();$ZZZZZZZZZZZZZZZZZZs18 = ($ZZZZZZZZZZZZZZZZZZm12)?json_decode($ZZZZZZZZZZZZZZZZZZn13["grouping"],true):json_decode($_POST['grouping'],true);$ZZZZZZZZZZZZZZZZZZw22 = 0;if(!$ZZZJ99->includeDetails && !$ZZZJ99->aggregateColumn){foreach ($ZZZZZZZZZZZZZZZZZZs18 as $ZZZZn13) {if(!$ZZZJ99->isCrosstab || $ZZZZn13['position'] == 'row'){if($ZZZZn13['dateGrouping'] != "") $ZZZZZZZZZZZZZZZZZZx23 = $ZZZZn13['name']."_".$ZZZZn13['dateGrouping'];else $ZZZZZZZZZZZZZZZZZZx23 = $ZZZZn13['name'];$ZZZZZZZZZZZZZZZJ99[] = $ZZZZZZZZZZZZZZZZZZx23;if(isset($ZZZZn13['showAggregates'])){foreach($ZZZZn13['showAggregates'] as $ZZZZZZZZZZZZZZZZZZy24 => $ZZZZZZZZZZZZP1515){if(isset($ZZZZZZZZZZZZP1515['sum']) && $ZZZZZZZZZZZZP1515['sum']) $ZZZH77[] = $ZZZZZZZZZZZZZZZZZZy24."_sum";if(isset($ZZZZZZZZZZZZP1515['count']) && $ZZZZZZZZZZZZP1515['count']) $ZZZH77[] = $ZZZZZZZZZZZZZZZZZZy24."_cnt";}}}} array_pop($ZZZZZZZZZZZZZZZJ99);$ZZZH77 = array_unique($ZZZH77);if(count($ZZZZZZZZZZZZZZZJ99)>0){foreach ($r17['data'] as $ZZZZZZZZZZZZZZZZZZz25 => $ZZZZZZZZZZZZZZZZZZA00) {foreach ($ZZZZZZZZZZZZZZZJ99 as $ZZZZZZZZZZZZZZZZZZB11) {if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZB11]) && $ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZB11] != $ZZZZZZZZZZZZZZZZZZA00[$ZZZZZZZZZZZZZZZZZZB11]){$ZZZZZK1010 = count($ZZZZZZZZZZZZZZZJ99)-1;do{$ZZZZZZZZZZZZZZZZZZC22 = $ZZZZZZZZZZZZZZZJ99[$ZZZZZK1010];foreach ($ZR1717[$ZZZZZZZZZZZZZZZZZZC22] as $Zu20 => $value) {$ZZZZZZZZZZZZZZZZZZj9[$Zu20] = "<SubTotal>".$value;if(in_array($Zu20, $ZZZZZZZZZZZZZZZJ99) && $Zu20 != $ZZZZZZZZZZZZZZZZZZC22) unset($ZZZZZZZZZZZZZZZZZZj9[$Zu20]);} if(!isset($ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22]))$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22] = 0;array_splice($r17['data'], (int)$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22], 0, array($ZZZZZZZZZZZZZZZZZZj9));$ZZZZZZZZZZZZZZZZZZw22++;$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22] = $ZZZZZZZZZZZZZZZZZZz25+$ZZZZZZZZZZZZZZZZZZw22;$ZZZZZK1010--;unset($ZZZZZZZZZZZZZZZZZZj9);}while($ZZZZZZZZZZZZZZZZZZC22 != $ZZZZZZZZZZZZZZZZZZB11);if($ZZZZZZZZZZZZZZZZZZB11 == $ZZZZZZZZZZZZZZZJ99[0]) {foreach ($ZZZZZZZZZZZZZZZZZZt19 as &$ZZZZZZZZZZZZZZZZZZD33) $ZZZZZZZZZZZZZZZZZZD33 = $ZZZZZZZZZZZZZZZZZZz25+$ZZZZZZZZZZZZZZZZZZw22;unset($ZR1717);} if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11]))unset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11]);break;}} foreach ($ZZZZZZZZZZZZZZZZZZA00 as $ZZZZZZZZZZZZZZZZZZE44 => $ZZZZZZZZZZZZZZZZZZF55) {$ZZZZZZZZZZZZZZZZZZG66 = preg_replace('/[v]\d+[_]/', '', $ZZZZZZZZZZZZZZZZZZE44);foreach ($ZZZZZZZZZZZZZZZJ99 as $ZZZZZZZZZZZZZZZZZZB11) {if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44]) && in_array($ZZZZZZZZZZZZZZZZZZG66, $ZZZH77)){$ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44] += $ZZZZZZZZZZZZZZZZZZF55;} elseif((!isset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44]) && in_array($ZZZZZZZZZZZZZZZZZZG66, $ZZZH77)) || in_array($ZZZZZZZZZZZZZZZZZZG66, $ZZZZZZZZZZZZZZZJ99)){$ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44] = $ZZZZZZZZZZZZZZZZZZF55;}}}} $ZZZZZK1010 = count($ZZZZZZZZZZZZZZZJ99)-1;if(!empty($ZR1717)){do{$ZZZZZZZZZZZZZZZZZZC22 = $ZZZZZZZZZZZZZZZJ99[$ZZZZZK1010];foreach ($ZR1717[$ZZZZZZZZZZZZZZZZZZC22] as $Zu20 => $value) {$ZZZZZZZZZZZZZZZZZZj9[$Zu20] = "<SubTotal>".$value;if(in_array($Zu20, $ZZZZZZZZZZZZZZZJ99) && $Zu20 != $ZZZZZZZZZZZZZZZZZZC22) unset($ZZZZZZZZZZZZZZZZZZj9[$Zu20]);} if(!isset($ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22]))$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22] = 0;array_splice($r17['data'], (int)$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22], 0, array($ZZZZZZZZZZZZZZZZZZj9));$ZZZZZZZZZZZZZZZZZZw22++;$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22] = $ZZZZZZZZZZZZZZZZZZz25+$ZZZZZZZZZZZZZZZZZZw22;$ZZZZZK1010--;unset($ZZZZZZZZZZZZZZZZZZj9);}while($ZZZZZZZZZZZZZZZZZZC22 != $ZZZZZZZZZZZZZZZJ99[0]);} $r17["data"] = ZZZZZZZZZZZZZZZZZZH77($r17["data"], $ZZZH77);}}elseif ($ZZZJ99->includeDetails) {foreach ($ZZZZZZZZZZZZZZZZZZs18 as $ZZZZn13) {if($ZZZZn13['dateGrouping'] != "") $ZZZZZZZZZZZZZZZZZZx23 = $ZZZZn13['name']."_".$ZZZZn13['dateGrouping'];else $ZZZZZZZZZZZZZZZZZZx23 = $ZZZZn13['name'];$ZZZZZZZZZZZZZZZJ99[] = $ZZZZZZZZZZZZZZZZZZx23;$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZx23] = 0;foreach($ZZZZn13['showAggregates'] as $ZZZZZZZZZZZZZZZZZZy24 => $ZZZZZZZZZZZZP1515){if(isset($ZZZZZZZZZZZZP1515['sum']) && $ZZZZZZZZZZZZP1515['sum']) $ZZZZZZZZZZZZZZZZZZu20[] = $ZZZZZZZZZZZZZZZZZZy24;if(isset($ZZZZZZZZZZZZP1515['count']) && $ZZZZZZZZZZZZP1515['count']) $ZZZZZZZZZZZZZZZZZZv21[] = $ZZZZZZZZZZZZZZZZZZy24;} $ZZZZZZZZZZZZZZZZZZu20 = array_unique($ZZZZZZZZZZZZZZZZZZu20);$ZZZZZZZZZZZZZZZZZZv21 = array_unique($ZZZZZZZZZZZZZZZZZZv21);} if(count($ZZZZZZZZZZZZZZZJ99)>0){foreach ($r17['data'] as $ZZZZZZZZZZZZZZZZZZz25 => $ZZZZZZZZZZZZZZZZZZA00) {foreach ($ZZZZZZZZZZZZZZZJ99 as $ZZZZZZZZZZZZZZZZZZB11) {if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZB11]) && $ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZB11] != $ZZZZZZZZZZZZZZZZZZA00[$ZZZZZZZZZZZZZZZZZZB11]){$ZZZZZK1010 = count($ZZZZZZZZZZZZZZZJ99)-1;do{$ZZZZZZZZZZZZZZZZZZC22 = $ZZZZZZZZZZZZZZZJ99[$ZZZZZK1010];foreach ($ZR1717[$ZZZZZZZZZZZZZZZZZZC22] as $Zu20 => $value) {$ZZZZZZZZZZZZZZZZZZj9[$Zu20] = "<SubTotal>".$value;if(in_array($Zu20, $ZZZZZZZZZZZZZZZJ99) && $Zu20 != $ZZZZZZZZZZZZZZZZZZC22) unset($ZZZZZZZZZZZZZZZZZZj9[$Zu20]);} array_splice($r17['data'], (int)$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22], 0, array($ZZZZZZZZZZZZZZZZZZj9));$ZZZZZZZZZZZZZZZZZZw22++;$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22] = $ZZZZZZZZZZZZZZZZZZz25+$ZZZZZZZZZZZZZZZZZZw22;$ZZZZZK1010--;}while($ZZZZZZZZZZZZZZZZZZC22 != $ZZZZZZZZZZZZZZZZZZB11);if($ZZZZZZZZZZZZZZZZZZB11 == $ZZZZZZZZZZZZZZZJ99[0]) {foreach ($ZZZZZZZZZZZZZZZZZZt19 as &$ZZZZZZZZZZZZZZZZZZD33) $ZZZZZZZZZZZZZZZZZZD33 = $ZZZZZZZZZZZZZZZZZZz25+$ZZZZZZZZZZZZZZZZZZw22;unset($ZR1717);} if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11]))unset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11]);break;}} foreach ($ZZZZZZZZZZZZZZZZZZA00 as $ZZZZZZZZZZZZZZZZZZE44 => $ZZZZZZZZZZZZZZZZZZF55) {foreach ($ZZZZZZZZZZZZZZZJ99 as $ZZZZZZZZZZZZZZZZZZB11) {if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44]) && in_array($ZZZZZZZZZZZZZZZZZZE44, $ZZZZZZZZZZZZZZZZZZu20)) $ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44] += $ZZZZZZZZZZZZZZZZZZF55;elseif(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44]) && in_array($ZZZZZZZZZZZZZZZZZZE44, $ZZZZZZZZZZZZZZZZZZv21)) $ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44]++;elseif(!isset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44]) && (in_array($ZZZZZZZZZZZZZZZZZZE44, $ZZZZZZZZZZZZZZZJ99) || in_array($ZZZZZZZZZZZZZZZZZZE44, $ZZZZZZZZZZZZZZZZZZu20))){$ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44] = $ZZZZZZZZZZZZZZZZZZF55;} elseif(!isset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44]) && in_array($ZZZZZZZZZZZZZZZZZZE44, $ZZZZZZZZZZZZZZZZZZv21)) $ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44] = 1;}}} $ZZZZZK1010 = count($ZZZZZZZZZZZZZZZJ99)-1;do{$ZZZZZZZZZZZZZZZZZZC22 = $ZZZZZZZZZZZZZZZJ99[$ZZZZZK1010];foreach ($ZR1717[$ZZZZZZZZZZZZZZZZZZC22] as $Zu20 => $value) {$ZZZZZZZZZZZZZZZZZZj9[$Zu20] = "<SubTotal>".$value;if(in_array($Zu20, $ZZZZZZZZZZZZZZZJ99) && $Zu20 != $ZZZZZZZZZZZZZZZZZZC22) unset($ZZZZZZZZZZZZZZZZZZj9[$Zu20]);} array_splice($r17['data'], (int)$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22], 0, array($ZZZZZZZZZZZZZZZZZZj9));$ZZZZZZZZZZZZZZZZZZw22++;$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22] = $ZZZZZZZZZZZZZZZZZZz25+$ZZZZZZZZZZZZZZZZZZw22;$ZZZZZK1010--;}while($ZZZZZZZZZZZZZZZZZZC22 != $ZZZZZZZZZZZZZZZJ99[0]);$r17["data"] = ZZZZZZZZZZZZZZZZZZH77($r17["data"], $ZZZZZZZZZZZZZZZZZZv21);}}} $r17["title"] = $ZZZZZZZZZZZZZZZZZZn13["title"];return $r17;} function ZZZZZZZZZZZZZZZZZZH77($r17, $ZZZZZZZZZZZZZZZZZZv21){global $current_user;$ZZZZS1818 = new ZZZZT1919();$ZZZZZZZZZZZZZZZZZZI88 = $ZZZZS1818->ZZZZX2323($current_user);$ZZZZZZZZZZZZZZZZZZJ99 = $ZZZZZZZZZZZZZZZZZZI88['decimal'];$ZZZZZZZZZZZZZZZZZZK1010 = $ZZZZZZZZZZZZZZZZZZI88['seperator'];$ZZZZZZZZZZZv21 = PlatformConnector::ZZZZZZz25();foreach ($r17 as $ZZZZZZZZZZZZZZZZZZL1111 => $ZZZZZZZZZZZZZZZZZZM1212) {foreach ($ZZZZZZZZZZZZZZZZZZM1212 as $ZZZZZZZZZZZZZZZZZZN1313 => $ZZZZZZZZZZZZZZZZZZO1414) {if(substr($ZZZZZZZZZZZZZZZZZZO1414, 0, 10) == "<SubTotal>" && is_numeric(str_replace("<SubTotal>", "", $ZZZZZZZZZZZZZZZZZZO1414))){if(substr($ZZZZZZZZZZZZZZZZZZN1313, -4) != "_cnt" && !in_array($ZZZZZZZZZZZZZZZZZZN1313."_cnt", $ZZZZZZZZZZZZZZZZZZv21) && !in_array($ZZZZZZZZZZZZZZZZZZN1313, $ZZZZZZZZZZZZZZZZZZv21)){$r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313] = str_replace("<SubTotal>", "", $r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313]);$r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313] = number_format(floatval($r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313]),$ZZZZZZZZZZZv21,$ZZZZZZZZZZZZZZZZZZJ99,$ZZZZZZZZZZZZZZZZZZK1010);$r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313] = "<SubTotal>".$r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313];}else{$r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313] = str_replace("<SubTotal>", "", $r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313]);$r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313] = number_format(floatval($r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313]),0,$ZZZZZZZZZZZZZZZZZZJ99,$ZZZZZZZZZZZZZZZZZZK1010);$r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313] = "<SubTotal>".$r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313];}}}} return $r17;} function ZZZZZZZZZZZZZZZZZZP1515($r17){$ZZZZZZZZZZZZZZE44 = array_keys($r17["cols"]);$ZZS1818 = array();$ZZS1818[] = array_values($r17["cols"]);$ZZT1919 = count($ZZZZZZZZZZZZZZE44);$ZZZZZZZZZZZZZZs18 = count($r17["data"]);for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZZZs18;$Zf5++){$ZZZz25 = array();for($ZZZZZK1010 = 0;$ZZZZZK1010<$ZZT1919;$ZZZZZK1010++){$ZZZz25[] = (isset($r17["data"][$Zf5][$ZZZZZZZZZZZZZZE44[$ZZZZZK1010]]))?($r17["data"][$Zf5][$ZZZZZZZZZZZZZZE44[$ZZZZZK1010]]):("");} $ZZS1818[] = $ZZZz25;} $ZZZZZZZZZZZZZZZZZZQ1616 = new PHPExcel();$ZZZZZZZZZZZZZZZZZZQ1616->getProperties()->setCreator("Advanced Reporting For vTiger") ->setLastModifiedBy("ITSAPIENS.EU") ->setTitle("REPORT") ->setSubject("REPORT") ->setDescription("REPORT");$ZZZZZZZZZZZZZZZZZZR1717 = $ZZZZZZZZZZZZZZZZZZQ1616->getActiveSheet();$ZZZZZZZZZZZZZZZZZZR1717->fromArray($ZZS1818);return $ZZZZZZZZZZZZZZZZZZQ1616;} function ZZZZZZZZZZZZZZZZZZS1818($r17){if(file_exists(dirname(__FILE__)."/generatePDFHTML.php")) {require_once dirname(__FILE__)."/generatePDFHTML.php";}else{$ZZZZZZZZZZZd3 = array_keys($r17["cols"]);$ZZZZZZZZZZZZZZZZZZT1919 = count($ZZZZZZZZZZZd3);$ZZZZZZZZZZZZZZZZZZU2020 = "<style> thead{font-weight: bold;} th{font-weight: bold;font-size: 12pt;} td,th{border: solid 1px #000000;page-break-inside:avoid;} tr{page-break-inside:avoid;} table{white-space: nowrap;} </style> <h3>".$r17["title"]."</h3> ";$ZZZZZZZZZZZZZZZZZZU2020.= "<table><thead><tr>";for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZZZZZZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZZZU2020.= "<th><b>";$ZZZZZZZZZZZZZZZZZZU2020.= $r17["cols"][$ZZZZZZZZZZZd3[$Zf5]];$ZZZZZZZZZZZZZZZZZZU2020.= "</b></th>";} $ZZZZZZZZZZZZZZZZZZU2020.= "</tr></thead><tbody>";$ZZT1919 = count($r17["data"]);for($ZZZZZK1010 = 0;$ZZZZZK1010<$ZZT1919;$ZZZZZK1010++){$ZZZZZZZZZZZZZZZZZZU2020.= "<tr>";for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZZZZZZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZZZU2020.= "<td>";if(isset($r17["data"][$ZZZZZK1010][$ZZZZZZZZZZZd3[$Zf5]])){@$ZZZZZZZZZZZZZZZZZZU2020.= (($ZZZZZZZZZZZd3[$Zf5] == "grand_total" || $r17["data"][$ZZZZZK1010][$ZZZZZZZZZZZd3[0]] == "Grand Total" || substr($r17["data"][$ZZZZZK1010][$ZZZZZZZZZZZd3[$Zf5]], 0, 10) == "<SubTotal>") ? "<b>".$r17["data"][$ZZZZZK1010][$ZZZZZZZZZZZd3[$Zf5]]."</b>":$r17["data"][$ZZZZZK1010][$ZZZZZZZZZZZd3[$Zf5]]);} $ZZZZZZZZZZZZZZZZZZU2020.= "</td>";} $ZZZZZZZZZZZZZZZZZZU2020.= "</tr>";} $ZZZZZZZZZZZZZZZZZZU2020.= "</tbody></table>";} return $ZZZZZZZZZZZZZZZZZZU2020;}
function ZZZZZZZZZZZZZZZZZZV2121($ZZZZZZZZZZZZZZZZZZW2222){if($ZZZZZZZZZZZZZZZZZZW2222 <= 760) {$ZZZZZZZZZZZZZZZZZZX2323 = "L";$ZZZZZZZZZZZZZZZZZZY2424 = "A4";} elseif($ZZZZZZZZZZZZZZZZZZW2222 >= 761 && $ZZZZZZZZZZZZZZZZZZW2222 <= 1120) {$ZZZZZZZZZZZZZZZZZZX2323 = "L";$ZZZZZZZZZZZZZZZZZZY2424 = "A3";}elseif($ZZZZZZZZZZZZZZZZZZW2222 >=1121 && $ZZZZZZZZZZZZZZZZZZW2222 <= 1600) {$ZZZZZZZZZZZZZZZZZZX2323 = "L";$ZZZZZZZZZZZZZZZZZZY2424 = "A2";}elseif($ZZZZZZZZZZZZZZZZZZW2222 >=1601 && $ZZZZZZZZZZZZZZZZZZW2222 <= 2200) {$ZZZZZZZZZZZZZZZZZZX2323 = "L";$ZZZZZZZZZZZZZZZZZZY2424 = "A1";} elseif($ZZZZZZZZZZZZZZZZZZW2222 >=2201 && $ZZZZZZZZZZZZZZZZZZW2222 <= 3360) {$ZZZZZZZZZZZZZZZZZZX2323 = "L";$ZZZZZZZZZZZZZZZZZZY2424 = "A0";} elseif($ZZZZZZZZZZZZZZZZZZW2222 >=3361 && $ZZZZZZZZZZZZZZZZZZW2222 <= 4680) {$ZZZZZZZZZZZZZZZZZZX2323 = "L";$ZZZZZZZZZZZZZZZZZZY2424 = "2A0";} elseif($ZZZZZZZZZZZZZZZZZZW2222 >=4681 && $ZZZZZZZZZZZZZZZZZZW2222 <= 6490) {$ZZZZZZZZZZZZZZZZZZX2323 = "L";$ZZZZZZZZZZZZZZZZZZY2424 = "4A0";}else{$ZZZZZZZZZZZZZZZZZZX2323 = "L";$ZZZZZZZZZZZZZZZZZZY2424 = array(round($ZZZZZZZZZZZZZZZZZZW2222/1.5),$ZZZZZZZZZZZZZZZZZZW2222);} return array($ZZZZZZZZZZZZZZZZZZX2323,$ZZZZZZZZZZZZZZZZZZY2424);}
;class ZZZZZZZZZZo14{static private $ZZZZZZZZZZZZZZZZZZZ2525 = 'modules/AnalyticReporting/config';static private $ZZZZZZZZZZZZZZZZZZZa0 = array('reportBuilder' => array('common' => 'common', 'manyToMany' => 'manyToMany',), 'common' => array('common' => 'common'));static function load($type, $name){if(isset(ZZZZZZZZZZo14::$ZZZZZZZZZZZZZZZZZZZa0[$type][$name])){$ZZZZZZZZZZZZZZZZZZZb1 = ZZZZZZZZZZo14::$ZZZZZZZZZZZZZZZZZZZ2525."/".$type."/".$name;$ZZZZZZZZZZZZZZZZZZZc2 = $ZZZZZZZZZZZZZZZZZZZb1."Custom.php";$ZZZZZZZZZZZZZZZZZZZd3 = $ZZZZZZZZZZZZZZZZZZZb1."Default.php";if (file_exists($ZZZZZZZZZZZZZZZZZZZc2)){return include $ZZZZZZZZZZZZZZZZZZZc2;}elseif(file_exists($ZZZZZZZZZZZZZZZZZZZd3)){return include $ZZZZZZZZZZZZZZZZZZZd3;}} return false;} static function save($type, $name, $ZU2020){if(isset($ZZZZZZZZZZZZZZZZZZZa0[$type][$name])){$ZZZZZZZZZZZZZZZZZZZb1 = ZZZZZZZZZZo14::$ZZZZZZZZZZZZZZZZZZZ2525."/".$type."/".$name;$ZZZZZZZZZZZZZZZZZZZc2 = $ZZZZZZZZZZZZZZZZZZZb1."Custom.php";file_put_contents($ZZZZZZZZZZZZZZZZZZZc2, "<?"."php return " . var_export($ZU2020, true) . ";");return true;} return false;}}
;class ZZZZZZZZZZZZZZZZZZZe4
{public $ZZZZZZZZZZZZZZZZZZZf5 = array();public $ZZZZZZZZZZZZZZZZZZZg6 = false;function __construct() {set_time_limit(0);} function ZZZZZZZZZZZZZZZZZZZh7($url, $r17, $ZZZZZZZZZZZZZZZZZZZi8 = false) {$ZZZZZZZZZZZZZZZZZZZj9 = http_build_query($r17);$ZZZZZZZZZZZZZZZZZZZk10 = curl_init();curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_URL, $url);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_POST, true);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_POSTFIELDS, $ZZZZZZZZZZZZZZZZZZZj9);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_VERBOSE, 1);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_HEADER, 1);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_BINARYTRANSFER, 1);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_RETURNTRANSFER, 1);$ZZZZZZZZZZZZZZZZZP1515 = curl_exec($ZZZZZZZZZZZZZZZZZZZk10);$this->ZZZZZZZZZZZZZZZZZZZf5[] = curl_error($ZZZZZZZZZZZZZZZZZZZk10);$ZZZZZZZZZZZZZZZZZZZl11 = curl_getinfo($ZZZZZZZZZZZZZZZZZZZk10, CURLINFO_HEADER_SIZE);curl_close ($ZZZZZZZZZZZZZZZZZZZk10);$ZZZZZZZZZZZZZZZZZZZm12 = substr($ZZZZZZZZZZZZZZZZZP1515, 0, $ZZZZZZZZZZZZZZZZZZZl11);$ZZZZZZZZZZZZZZZZZZZn13 = substr($ZZZZZZZZZZZZZZZZZP1515, $ZZZZZZZZZZZZZZZZZZZl11);$ZZZZZZZZZZZZZZZZZZZo14 = explode("\n", $ZZZZZZZZZZZZZZZZZZZm12);foreach($ZZZZZZZZZZZZZZZZZZZo14 as $ZZZZZZZZZZZZZZZZZZZp15) {$ZZZZZZZZZZZZZZZZZZZq16 = explode(':', $ZZZZZZZZZZZZZZZZZZZp15);if(count($ZZZZZZZZZZZZZZZZZZZq16) == 2) {$ZZZZZZZZZZZZZZZZZZZr17[$ZZZZZZZZZZZZZZZZZZZq16[0]] = trim($ZZZZZZZZZZZZZZZZZZZq16[1]);}} if($ZZZZZZZZZZZZZZZZZZZi8) {return $ZZZZZZZZZZZZZZZZZZZn13;} header('Content-type: ' . $ZZZZZZZZZZZZZZZZZZZr17['Content-Type']);header('Content-Disposition: ' . $ZZZZZZZZZZZZZZZZZZZr17['Content-Disposition']);echo $ZZZZZZZZZZZZZZZZZZZn13;} function retrieve($url, $ZZZZZZZZZZZZZZZZZZZs18 = true, $ZZZZZZZZZZZZZZZZZZZt19 = false) {$ZZZZZZZZZZZZZZZZZZZk10 = curl_init();curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_URL, $url);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_RETURNTRANSFER, 1);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_TIMEOUT, 50);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_FAILONERROR, true);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_FOLLOWLOCATION, true);if($ZZZZZZZZZZZZZZZZZZZt19) {curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_NOPROGRESS, false);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_PROGRESSFUNCTION, $ZZZZZZZZZZZZZZZZZZZt19);} $ZZZZZZZZZZZZZZZZZP1515 = curl_exec($ZZZZZZZZZZZZZZZZZZZk10);$this->ZZZZZZZZZZZZZZZZZZZf5[] = curl_error($ZZZZZZZZZZZZZZZZZZZk10);curl_close($ZZZZZZZZZZZZZZZZZZZk10);if($ZZZZZZZZZZZZZZZZZZZs18) {return json_decode($ZZZZZZZZZZZZZZZZZP1515, true);} return $ZZZZZZZZZZZZZZZZZP1515;}}
;class AnalyticReportingController extends SugarController {function ZZZZZZZZZZZZZZZZZZZu20() {foreach($_POST as $Zu20 => &$value) {$value = $this->ZZZZZZZZZZZZZZZZZZZv21($value);} foreach($_REQUEST as $Zu20 => &$value) {$value = $this->ZZZZZZZZZZZZZZZZZZZv21($value);} foreach($_GET as $Zu20 => &$value) {$value = $this->ZZZZZZZZZZZZZZZZZZZv21($value);}} function ZZZZZZZZZZZZZZZZZZZv21($value) {if(isset($value)) {if(is_array($value)) {} else {$value = stripslashes(html_entity_decode($value));}} return $value;} function action_listview() {global $current_user, $mod_strings;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZS1818 = new ZZZZT1919();$ZZZZZZZZZZZZZZZZZZq16 = new ZZZZZZZZZZZZZZZZZc2($db, $ZZZZS1818);$this->view = 'list';$this->ZZZZZZZZZZZZZZZZZZZu20();$ZZZZa0 = false;if(is_admin($current_user) && isset($_REQUEST["showHidden"]) && !empty($_REQUEST["showHidden"])) {$ZZZZa0 = true;} $ZZZZZZZZZZZZZZZZV2121 = new ZZZZZZZZZZZZZZZZK1010($mod_strings);$ZZZZZZZZZZZZZZZZZZZw22 = $ZZZZZZZZZZZZZZZZV2121->ZZZZZZZZZZZZZZZZU2020($db, $ZZZZS1818, $current_user, $ZZZZa0);$ZZZZZZZZZZZZZZZZZZZx23 = $ZZZZZZZZZZZZZZZZV2121->ZZZZZZZZZZZZZZZZN1313();$this->view_object_map['toggleHidden'] = ($ZZZZa0) ? 'false' : 'true';$this->view_object_map['reportTreeData'] = json_encode($ZZZZZZZZZZZZZZZZZZZw22);$this->view_object_map['reportTreeDeletable'] = json_encode($ZZZZZZZZZZZZZZZZZZZx23);$this->view_object_map["REPORTSCHEDULEUSERS"] = json_encode($ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZk10());$this->view_object_map["REPORTACCESSUSERS"] = json_encode($ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZi8());$this->view_object_map["REPORTUSERS"] = json_encode($ZZZZZZZZZZZZZZZZZZq16->ZZZZf5());$this->view_object_map["isAdmin"] = is_admin($current_user)?1:0;} function action_loadReport() {global $current_user, $mod_strings;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZS1818 = new ZZZZT1919();$ZZZZZZZZZZZZZZZZZZq16 = new ZZZZZZZZZZZZZZZZZc2($db, $ZZZZS1818);$ZZZZZZZZZZZZZD33 = PlatformConnector::ZZZZZZe4();$this->ZZZZZZZZZZZZZZZZZZZu20();$id = (int)$_REQUEST["record"];$ZZZZZZZZZZZZZZZZZZr17 = $ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZp15($current_user, $id);if($ZZZZZZZZZZZZZZZZZZr17 == 0){$ZZZZS1818->ZZZZZg6();die();} $ZZZZZZZZZZZZZZZZZZn13 = $db->loadReport($id);if($ZZZZZZZZZZZZZZZZZZr17 == 1){$_POST['columns'] = $ZZZZZZZZZZZZZZZZZZn13["fields"];$_POST['filters'] = $ZZZZZZZZZZZZZZZZZZn13["filters"];$_POST['labels'] = $ZZZZZZZZZZZZZZZZZZn13["labels"];} $ZZZK1010 = array();if(!empty($_POST['labels'])) {$ZZZK1010 = json_decode(html_entity_decode($_POST['labels']), true);} $ZZZZZZZZZZZZZZZZZZZy24 = false;if(isset($_GET["chart"]) && $_GET["chart"] == 1){$ZZZZZZZZZZZZZZZZZZZy24 = true;} if(isset($_GET["combined"]) && $_GET["combined"] == 1) {$module = null;$ZZZZZZZZZZZZZZZZZZo14 = new ZZZZZZZZZZZZZZ2525($db, $ZZZZS1818, $ZZZK1010);if(isset($_POST["combinedSelectedFields"])){$ZZZZZZZZZZZZZZZZZZo14->ZZZZZZZZZZZZZZT1919(json_decode(html_entity_decode($_POST["combinedSelectedFields"]),true));}} else {$module = new ZZZZZZZZZZx23($ZZZZZZZZZZZZZZZZZZn13["module"],$db,$ZZZZS1818);$ZZZZZZZZZZZZZZZZZZo14 = new ZZZZZZZZZZZZZv21($db, $ZZZZS1818, $ZZZK1010);} $ZZZZZZZZZZZZZZZZZZp15 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZZZZn13["related_data"]);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZZZp15[] = new ZZZZZZZZZZu20($ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][0], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][1], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][2], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][3], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][4], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][5], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][6], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][7], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][8], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][9], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][10], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][11]);} $ZZZJ99 = json_decode(html_entity_decode($_POST["options"]));if(!isset($ZZZJ99->aggregateColumn)){$ZZZJ99->aggregateColumn = false;} $ZZZZZZZZZZZZZZZZZZZz25 = true;$isCrosstab = $ZZZJ99->isCrosstab;$ZZZZZZZZZZZZZZZZZZZy24 = false;if(isset($_GET["chart"]) && $_GET["chart"] == 1){$ZZZZZZZZZZZZZZZZZZZz25 = false;$ZZZZZZZZZZZZZZZZZZZy24 = true;$isCrosstab = false;} if(isset($_GET["distinct"]) && !empty($_GET["distinct"])) {$isCrosstab = false;} if($isCrosstab) {$ZZZZZZZZZZZZZZZZZZZz25 = false;} $ZZZZZZZZZZZZX2323 = array("pagination" => $ZZZZZZZZZZZZZZZZZZZz25,);if(isset($_REQUEST['limit'])) {$ZZZZZZZZZZZZX2323["limit"] = $_REQUEST['limit'];} else if (isset($ZZZJ99->limit)) {$ZZZZZZZZZZZZX2323["limit"] = $ZZZJ99->limit;} else {$ZZv21 = new ZV2121($db);$ZZZZZZZZZZZZX2323["limit"] = $ZZv21->getValue("limit");} if(isset($_REQUEST['currentPage'])) {$ZZZZZZZZZZZZX2323["currentPage"] = (int) $_REQUEST['currentPage'];} $ZZZZZZZZZZZZZZZZZZZA00 = $ZZZZZZZZZZZZZZZZZZo14->ZZZZZZZZZZZZZA00($module, json_decode($_POST['columns']), json_decode($_POST['filters']), $ZZZZZZZZZZZZZZZZZZp15, json_decode($_POST['grouping'],true), json_decode($_POST['aggregates'],true), !$ZZZJ99->includeDetails, $isCrosstab, true, $ZZZJ99->aggregateColumn, $ZZZZS1818->ZZZZZe4($current_user), $ZZZZZZZZZZZZZZZZZZZy24, isset($_POST['calcFields']) ? json_decode($_POST['calcFields'], true) : array(), $ZZZZZZZZZZZZX2323, $ZZZZZZZZZZZZZD33);if(isset($_GET["distinct"]) && !empty($_GET["distinct"])) {$ZZZZZZZZZZZZZZZZZZZB11 = $_GET["distinct"];$ZZZZZZZZZZZZZZZZZZZC22 = array();$ZZZZy24 = array();foreach($ZZZZZZZZZZZZZZZZZZZA00["data"] as $ZZZZZZZZZZZZZZZZZZZD33) {if(isset($ZZZZZZZZZZZZZZZZZZZD33[$ZZZZZZZZZZZZZZZZZZZB11]) && !empty($ZZZZZZZZZZZZZZZZZZZD33[$ZZZZZZZZZZZZZZZZZZZB11])) {$ZZZZZZZZZZZZZZZZZZZC22[] = $ZZZZZZZZZZZZZZZZZZZD33[$ZZZZZZZZZZZZZZZZZZZB11];}} $ZZZZZZZZZZZZZZZZZZZC22 = array_unique($ZZZZZZZZZZZZZZZZZZZC22);foreach($ZZZZZZZZZZZZZZZZZZZC22 as $Zf5 => $ZZZZZZZZZZZZZZZZZZZD33) {$ZZZZy24[] = array("name" => $ZZZZZZZZZZZZZZZZZZZD33, "title" => $ZZZZZZZZZZZZZZZZZZZD33,);} $ZZZZZZZZZZZZZZZZZZZA00 = $ZZZZy24;} echo json_encode($ZZZZZZZZZZZZZZZZZZZA00);exit();} function action_report() {global $current_user, $mod_strings, $app_strings;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZS1818 = new ZZZZT1919();$this->view = 'report';$this->ZZZZZZZZZZZZZZZZZZZu20();$ZZZZZZZZZZZZZZZZZZq16 = new ZZZZZZZZZZZZZZZZZc2($db,$ZZZZS1818);$ZZZZZZZZZZZZZZZZZZZE44 = $ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZp15($current_user,$_REQUEST["record"]);if(!$ZZZZZZZZZZZZZZZZZZZE44){$ZZZZS1818->ZZZZZg6();die;} $ZZZZZZZZZZZZZZZZZZZF55 = $ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZi8();$ZZZZZZZZZZZZZZZZZZn13 = $db->loadReport((int)$_REQUEST["record"]);$module = new ZZZZZZZZZZx23($ZZZZZZZZZZZZZZZZZZn13["module"],$db,$ZZZZS1818);$ZZZZZZZZZZZZZZZZZZp15 = array();$isCombined = false;if(isset($ZZZZZZZZZZZZZZZZZZn13["iscombined"])&&$ZZZZZZZZZZZZZZZZZZn13["iscombined"] == 1){$isCombined = true;} $ZZT1919 = count($ZZZZZZZZZZZZZZZZZZn13["related_data"]);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZZZp15[] = new ZZZZZZZZZZu20($ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][0], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][1], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][2], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][3], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][4], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][5], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][6], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][7], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][8], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][9], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][10], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][11]);} $ZZZZZZZZZZZZZZZZZZZG66 = new ZZZZZZZZZZv21($ZZZZZZZZZZZZZZZZZZn13["module"], $ZZZZZZZZZZZZZZZZZZp15, $db, $ZZZZS1818, $isCombined);$ZZZZZZZZZZZZZZZZZZZH77 = json_decode($ZZZZZZZZZZZZZZZZZZn13["options"],true);$ZZZZZZZZZZZZZZZZZZZH77['isCombined'] = $isCombined;$this->view_object_map['REPORTFIELDS'] = json_encode($ZZZZZZZZZZZZZZZZZZZG66->ZZZZZZZZZZC22());$this->view_object_map['REPORTCOLUMNS'] = $ZZZZZZZZZZZZZZZZZZn13['fields'];$this->view_object_map['REPORTCALCCOLUMNS'] = (isset($ZZZZZZZZZZZZZZZZZZn13['calcFields']) && !empty($ZZZZZZZZZZZZZZZZZZn13['calcFields']))?($ZZZZZZZZZZZZZZZZZZn13['calcFields']):"[]";$this->view_object_map['REPORTFILTERS'] = $ZZZZZZZZZZZZZZZZZZn13['filters'];$this->view_object_map['REPORTGROUPING'] = $ZZZZZZZZZZZZZZZZZZn13['grouping'];$this->view_object_map['REPORTAGGREGATES'] = $ZZZZZZZZZZZZZZZZZZn13['aggregates'];$this->view_object_map['REPORTTOTALAGGREGATES'] = $ZZZZZZZZZZZZZZZZZZn13['totalAggregates'];$this->view_object_map['REPORTOPTIONS'] = json_encode($ZZZZZZZZZZZZZZZZZZZH77);$this->view_object_map['REPORTLABELS'] = !empty($ZZZZZZZZZZZZZZZZZZn13['labels']) ? ($ZZZZZZZZZZZZZZZZZZn13['labels']) : json_encode(false);$this->view_object_map['REPORTID'] = (int)$_REQUEST["record"];$this->view_object_map['REPORTTITLE'] = $ZZZZZZZZZZZZZZZZZZn13['title'];$this->view_object_map['REPORTDESCRIPTION'] = $ZZZZZZZZZZZZZZZZZZn13['description'];$ZZZZZZZZZZZZZZZZZZZI88 = json_decode($ZZZZZZZZZZZZZZZZZZn13["chart"]);$this->view_object_map['CHARTTITLE'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartTitle)?($ZZZZZZZZZZZZZZZZZZZI88->chartTitle):("")) ;$this->view_object_map['CHARTTYPE'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartType)?($ZZZZZZZZZZZZZZZZZZZI88->chartType):("")) ;$this->view_object_map['CHARTCUMULATED'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartCumulated)?($ZZZZZZZZZZZZZZZZZZZI88->chartCumulated):(true)) ;if(isset($ZZZZZZZZZZZZZZZZZZZI88->chartSortableValues) && !empty($ZZZZZZZZZZZZZZZZZZZI88->chartSortableValues)){$ZZZZZZZZZZZZZZZZZZZJ99 = explode("_", $ZZZZZZZZZZZZZZZZZZZI88->chartAxisX);array_shift($ZZZZZZZZZZZZZZZZZZZJ99);$moduleName = array_shift($ZZZZZZZZZZZZZZZZZZZJ99);$fieldName = implode("_", $ZZZZZZZZZZZZZZZZZZZJ99);$ZZZZZZZZZZZZZy24 = $db->ZZN1313($fieldName, $moduleName);foreach($ZZZZZZZZZZZZZZZZZZZI88->chartSortableValues as &$ZZZZZZZZZZZZZZZZZZZK1010) {$ZZZZZZZZZZZZZZZZZZZK1010->value = $ZZZZZZZZZZZZZy24[$ZZZZZZZZZZZZZZZZZZZK1010->key];}} $this->view_object_map['CHARTSORTABLEVALUES'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartSortableValues)?($ZZZZZZZZZZZZZZZZZZZI88->chartSortableValues):(false)) ;$this->view_object_map['CHARTLABELS'] =json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartLabels)?($ZZZZZZZZZZZZZZZZZZZI88->chartLabels):("")) ;$this->view_object_map['CHARTAXISX'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartAxisX)?($ZZZZZZZZZZZZZZZZZZZI88->chartAxisX):("")) ;$this->view_object_map['CHARTAXISY'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartAxisY)?($ZZZZZZZZZZZZZZZZZZZI88->chartAxisY):("")) ;$this->view_object_map['CHARTAXISY2'] =json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartAxisY2)?($ZZZZZZZZZZZZZZZZZZZI88->chartAxisY2):("")) ;$this->view_object_map['CHARTYAXISTYPE'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartYAxisType)?($ZZZZZZZZZZZZZZZZZZZI88->chartYAxisType):("")) ;$this->view_object_map['CHARTYAXIS2TYPE'] =json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartYAxis2Type)?($ZZZZZZZZZZZZZZZZZZZI88->chartYAxis2Type):("")) ;$this->view_object_map['CHARTLEGEND'] =json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartLegend)?($ZZZZZZZZZZZZZZZZZZZI88->chartLegend):("")) ;$this->view_object_map['CHARTSTACKED'] =json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartStacked)?($ZZZZZZZZZZZZZZZZZZZI88->chartStacked):(false)) ;$this->view_object_map['CHARTBARS1STACKED'] =json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartBars1Stacked)?($ZZZZZZZZZZZZZZZZZZZI88->chartBars1Stacked):(false)) ;$this->view_object_map['CHARTBARS2STACKED'] =json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartBars2Stacked)?($ZZZZZZZZZZZZZZZZZZZI88->chartBars2Stacked):(false)) ;$this->view_object_map['CHARTSIZE'] =json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartSize)?($ZZZZZZZZZZZZZZZZZZZI88->chartSize):(50)) ;$this->view_object_map['CHARTHEIGHT'] =json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartHeight)?($ZZZZZZZZZZZZZZZZZZZI88->chartHeight):(0)) ;$this->view_object_map['CHARTSHOWPERCENTS'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartShowPercents)?($ZZZZZZZZZZZZZZZZZZZI88->chartShowPercents):(false)) ;$this->view_object_map['CHARTSHOWLABELS'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartShowLabels)?($ZZZZZZZZZZZZZZZZZZZI88->chartShowLabels):(false));$this->view_object_map['CHARTSHOWZONELABELS'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartShowZoneLabels)?($ZZZZZZZZZZZZZZZZZZZI88->chartShowZoneLabels):(false));$this->view_object_map['CHARTVALUEZONES'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartValueZones)?($ZZZZZZZZZZZZZZZZZZZI88->chartValueZones):(false)) ;$this->view_object_map['CHARTAXISXSEGMENT'] = json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartAxisXSegment)?($ZZZZZZZZZZZZZZZZZZZI88->chartAxisXSegment):(false)) ;$this->view_object_map['REPORTACCESSUSERS'] =json_encode($ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZi8()) ;$this->view_object_map['REPORTACCESSUSERSSELECTED'] =json_encode($ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZj9((int)$_REQUEST["record"])) ;$this->view_object_map['REPORTSCHEDULEUSERS'] =json_encode($ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZk10());$this->view_object_map['REPORTSCHEDULEUSERSSELECTED'] =json_encode($ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZm12((int)$_REQUEST["record"])) ;$this->view_object_map['REPORTSCHEDULESETTINGS'] =json_encode($ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZn13((int)$_REQUEST["record"])) ;$this->view_object_map['REPORTSHARING'] =json_encode(($ZZZZZZZZZZZZZZZZZZn13['shared']==1)?("PUB"):("PRIV")) ;if($ZZZZZZZZZZZZZZZZZZn13['sharedlevel']==2){$ZZZZZZZZZZZZZZZZZZZL1111 = "DELETE";}elseif($ZZZZZZZZZZZZZZZZZZn13['sharedlevel']==1){$ZZZZZZZZZZZZZZZZZZZL1111 = "EDIT";}else{$ZZZZZZZZZZZZZZZZZZZL1111 = "VIEW";} $this->view_object_map['REPORTSHARINGLEVEL'] = json_encode($ZZZZZZZZZZZZZZZZZZZL1111) ;$this->view_object_map['REPORTOWNER'] = json_encode($ZZZZZZZZZZZZZZZZZZn13['owner']) ;$this->view_object_map['REPORTUSERS'] = json_encode($ZZZZZZZZZZZZZZZZZZq16->ZZZZf5());$this->view_object_map['CANEDIT'] = 1;$this->view_object_map['CANDELETE'] = ($ZZZZZZZZZZZZZZZZZZZE44<3)?0:1;$this->view_object_map['NUMBERSETTINGS'] = json_encode($ZZZZS1818->ZZZZX2323($current_user));$this->view_object_map['significantDigits'] = json_encode(PlatformConnector::ZZZZZZz25()) ;$ZY2424 = $db->ZZZu20("SELECT `id`, `title` FROM `advancedreports_categories` ");$num_rows=count($ZY2424);$ZZZZZZZZZZZZZZZZZZZM1212 = array();for($Zf5=0;$Zf5<$num_rows;$Zf5++){$ZZZZZZZZZZZZZZZZZZZN1313 = $ZY2424[$Zf5]['id'];$ZZZZZZZZZZZZZZZZZZZO1414 = $ZY2424[$Zf5]['title'];$ZZZZZZZZZZZZZZZZZZZM1212[$ZZZZZZZZZZZZZZZZZZZN1313] = $ZZZZZZZZZZZZZZZZZZZO1414;} $this->view_object_map['report_folders'] = $ZZZZZZZZZZZZZZZZZZZM1212;$this->view_object_map['current_report_folder'] = $ZZZZZZZZZZZZZZZZZZn13['category_id'];$ZZZZZZZZZZZZZZZZZZn13['isCombined'] = false;$this->view_object_map['REPORTCOMBINED'] = $isCombined;$ZZZZZZZZZZZZZZZZZZZP1515 = array();if($isCombined){$ZZZZZZZZZZZZZZZZZZo14 = new ZZZZZZZZZZZZZZ2525($db,$ZZZZS1818);$ZZZZZZZZZZZZZZZZZZZQ1616 = $ZZZZZZZZZZZZZZZZZZo14->ZZZZZZZZZZZZZZP1515($ZZZZZZZZZZZZZZZZZZp15);$ZZZZZZZZZZZZZZZZZZZP1515 = $ZZZZZZZZZZZZZZZZZZZG66->ZZZZZZZZZZD33($ZZZZZZZZZZZZZZZZZZZQ1616["skip"],$ZZZZZZZZZZZZZZZZZZZQ1616["common"]);$this->view_object_map['REPORTCOMBINEDMODULES'] = json_encode($ZZZZZZZZZZZZZZZZZZo14->ZZZZZZZZZZZZZZO1414($ZZZZZZZZZZZZZZZZZZp15));$this->view_object_map['REPORTCOMBINEDFIELDS'] = $ZZZZZZZZZZZZZZZZZZn13["combinedfields"];$this->view_object_map['REPORTCOMMONMODULES'] = json_encode($ZZZZZZZZZZZZZZZZZZZQ1616["commonIds"]);$this->view_object_map['SHOW_DETAILS'] = false;if(empty($ZZZZZZZZZZZZZZZZZZZQ1616["common"])){$this->view_object_map['SHOW_TABLE'] = false;}else{$this->view_object_map['SHOW_TABLE'] = true;}}else{$this->view_object_map['SHOW_DETAILS'] = true;$this->view_object_map['SHOW_TABLE'] = true;} $this->view_object_map['REPORTSELECTABLEFIELDS'] = json_encode($ZZZZZZZZZZZZZZZZZZZP1515);} function action_massSchedule() {global $current_user, $mod_strings;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZS1818 = new ZZZZT1919();$ZZZZZZZZZZZZZZZZZZq16 = new ZZZZZZZZZZZZZZZZZc2($db, $ZZZZS1818);$this->ZZZZZZZZZZZZZZZZZZZu20();$r17 = $_POST;function ZZZZZZZZZZZZZZZZZZZR1717($ZZZC22, $r17, $db, $ZZZZZZZZZZZZZZZZZZq16) {$ZZZD33 = $r17['globalSharing'];$ZZZE44 = $r17['globalSharingRights'];$ZZZZZZZZZZZZZZZZZZZS1818 = json_decode($r17['userSharing'], true);$ZZZF55 = (int) $r17['owner'];if($_REQUEST["updatePermissions"] == 1){$db->ZZZB11($ZZZC22, $ZZZD33, $ZZZE44, $ZZZF55);$ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZq16($ZZZC22, $ZZZZZZZZZZZZZZZZZZZS1818);} if($_REQUEST["isScheduled"] == 1){ZZZZZZZZZZZZZZZZZZZT1919($r17, $ZZZZZZZZZZZZZZZZZZq16, $ZZZC22, $ZZZF55);}} function ZZZZZZZZZZZZZZZZZZZT1919($r17, $ZZZZZZZZZZZZZZZZZZq16, $id, $ZZZF55){$ZZZZZZZZZZZZZZZZZZZU2020 = $r17["isScheduled"];if($ZZZZZZZZZZZZZZZZZZZU2020 == "1"){$ZZZZZZZZZZZZZZZZZZZV2121 = (isset($r17["scheduledRecipients"]))?($r17["scheduledRecipients"]):(array());$ZZZZZZZZZZZZZZZZZJ99 = (isset($r17["intervalOptions"]))?($r17["intervalOptions"]):(array());$ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZG66($id,$r17["interval"],$r17["intervalH"],$r17["intervalM"],$ZZZZZZZZZZZZZZZZZJ99,$ZZZF55,$r17["scheduledFormats"]);$ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZs18($id,$ZZZZZZZZZZZZZZZZZZZV2121);}else{$ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZt19($id);}} if(isset($r17['reportIds']) && ($r17['reportIds']) > 0) {foreach($r17['reportIds'] as $ZZZC22) {ZZZZZZZZZZZZZZZZZZZR1717($ZZZC22, $r17, $db, $ZZZZZZZZZZZZZZZZZZq16);}} echo json_encode(array("status" => "ok"));exit;} function action_loadPicklists() {global $current_user, $mod_strings;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZS1818 = new ZZZZT1919();$ZZZZZZZZZZZZZZZZZZq16 = new ZZZZZZZZZZZZZZZZZc2($db, $ZZZZS1818);$this->ZZZZZZZZZZZZZZZZZZZu20();$ZZZZZZZZZZZZZZZZZP1515 = array();$fieldName = $_REQUEST["fieldName"];list($Zf5, $moduleName, $fieldName) = $db->ZZZe4($fieldName);$ZZO1414 = $db->ZZN1313($fieldName, $moduleName);if($ZZO1414) {foreach($ZZO1414 as $ZZZZZZZZZZZZZZZZZZZW2222 => $ZZZZZZZZZZZZZZZZZZZX2323) {$ZZZZZZZZZZZZZZZZZP1515[] = array("key" => $ZZZZZZZZZZZZZZZZZZZW2222, "value" => $ZZZZZZZZZZZZZZZZZZZX2323);}} echo json_encode($ZZZZZZZZZZZZZZZZZP1515);exit;} function action_saveCategory() {$adb = DBManagerFactory::getInstance();$db	= new ZZp15($adb);$ZZZZZZZZZZZZZZZZZZZY2424 = $_REQUEST["_action"];$id = $_REQUEST["id"];$ZZZZZZZZZZZZZZZZZZZZ2525 = $_REQUEST["parentId"];$ZZZZZZZZZZZZZZZZZZZZa0 = $_REQUEST["position"];$ZZZZZZZZZZZZZZZZZZZZb1	= $_REQUEST["oldParentId"];$ZZZZZZZZZZZZZZZZZZZZc2	= $_REQUEST["oldPosition"];if(in_array($ZZZZZZZZZZZZZZZZZZZY2424, array('add', 'edit'))) {$title = $_REQUEST["title"];$description = $_REQUEST["description"];} switch($ZZZZZZZZZZZZZZZZZZZY2424) {case "add": $ZY2424 = $db->ZZH77("SELECT MAX(`sequence`) AS `sequence` FROM `advancedreports_categories` WHERE `parent_id` = ? ", array($id));$ZZZS1818 = $db->ZZI88($ZY2424, 'sequence');if(!$ZZZS1818) {$ZZZS1818 = 0;} if($ZZZS1818 != 0) {++$ZZZS1818;} $ZZq16 = "INSERT `advancedreports_categories` (`parent_id`, `sequence`, `title`, `description`) VALUES (?, ?, ?, ?)";$db->ZZH77($ZZq16, array($id, $ZZZS1818, $title, $description));break;case "edit": $ZZq16 = "UPDATE `advancedreports_categories` SET `title` = ?, `description` = ? WHERE `id` = ?";$db->ZZH77($ZZq16, array($title, $description, $id));break;case "delete": $ZY2424 = $db->ZZH77("SELECT `sequence`, `parent_id` FROM `advancedreports_categories` WHERE `id` = ? LIMIT 1", array($id));$ZZZZZZZZZZZZZZZZZZZZb1 = $db->ZZI88($ZY2424, 'parent_id');$ZZZZZZZZZZZZZZZZZZZZc2 = $db->ZZI88($ZY2424, 'sequence');$db->ZZH77("DELETE FROM `advancedreports_categories` WHERE `id` = ? LIMIT 1", array($id));$db->ZZH77("UPDATE `advancedreports_categories` SET `sequence` = `sequence` - 1 WHERE `parent_id` = ? AND `sequence` > ? ", array($ZZZZZZZZZZZZZZZZZZZZb1, $ZZZZZZZZZZZZZZZZZZZZc2));break;case "moveCategory": $db->ZZH77("UPDATE `advancedreports_categories` SET `sequence` = `sequence` + 1 WHERE `parent_id` = ? AND `sequence` >= ? ", array($ZZZZZZZZZZZZZZZZZZZZ2525, $ZZZZZZZZZZZZZZZZZZZZa0));$db->ZZH77("UPDATE `advancedreports_categories` SET `parent_id` = ?, `sequence` = ? WHERE `id` = ? ", array($ZZZZZZZZZZZZZZZZZZZZ2525, $ZZZZZZZZZZZZZZZZZZZZa0, $id));$db->ZZH77("UPDATE `advancedreports_categories` SET `sequence` = `sequence` - 1 WHERE `parent_id` = ? AND `sequence` > ? ", array($ZZZZZZZZZZZZZZZZZZZZb1, $ZZZZZZZZZZZZZZZZZZZZc2));break;case "moveItem": $db->ZZH77("UPDATE `advancedreports` SET `sequence` = `sequence` + 1 WHERE `category_id` = ? AND `sequence` >= ? ", array($ZZZZZZZZZZZZZZZZZZZZ2525, $ZZZZZZZZZZZZZZZZZZZZa0));$db->ZZH77("UPDATE `advancedreports` SET `category_id` = ?, `sequence` = ? WHERE `id` = ? ", array($ZZZZZZZZZZZZZZZZZZZZ2525, $ZZZZZZZZZZZZZZZZZZZZa0, $id));$db->ZZH77("UPDATE `advancedreports` SET `sequence` = `sequence` - 1 WHERE `category_id` = ? AND `sequence` > ? ", array($ZZZZZZZZZZZZZZZZZZZZb1, $ZZZZZZZZZZZZZZZZZZZZc2));break;} echo json_encode(array("status" => "ok"));die;} function action_reportBuilder(){global $mod_strings, $app_strings, $current_user;$this->view = 'reportbuilder';if(!PlatformConnector::ZZZZU2020($current_user)){die();} $adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZS1818 = new ZZZZT1919();if($_REQUEST['file'] == 'reportBuilder'){$ZZZZZZZZZZZZZZZZZP1515 = ZZZZZZZZZZZZZZZZZN1313::ZZZZZZZZZZZZZZZZZO1414($_REQUEST);if($ZZZZZZZZZZZZZZZZZP1515['statusCode']!=1){echo json_encode($ZZZZZZZZZZZZZZZZZP1515);die();} $ZZZZZZZZZZJ99 = $ZZZZS1818->ZZZZV2121($current_user);$ZZZZZZZZZZZZZZZZZV2121 = ZZZZZZZZZZZZZZZZZN1313::ZZZZZZZZZZZZZZZZZQ1616($_REQUEST, $ZZZZZZZZZZJ99);$ZZZZZZZZZZZZZZZZZP1515['insertedReportId'] = $db->ZZZZJ99($ZZZZZZZZZZZZZZZZZV2121);$ZZZZZZZZZZZZZZZZZP1515['statusMessage'] = $mod_strings['label_saved'];echo json_encode($ZZZZZZZZZZZZZZZZZP1515);die();} $ZZZZZZZZZZj9 = PlatformConnector::ZZZZZZ2525();asort($ZZZZZZZZZZj9);$ZZZZZZZZZZZZZZZZZZZZd3 = ZZZZZZZZZZZZZZZZZN1313::ZZZZZZZZZZZZZZZZZW2222($ZZZZZZZZZZj9);$this->view_object_map['MOD'] = $mod_strings;$this->view_object_map['APP'] = $app_strings;$this->view_object_map['modules'] = json_encode($ZZZZZZZZZZZZZZZZZZZZd3);$ZZZZZZp15 = $db->ZZZZM1212();$ZZZZZZZZZZZZZZZZZZZZe4 = PlatformConnector::ZZZZZZn13($ZZZZZZp15);$this->view_object_map['manyToManyConfig'] = json_encode($ZZZZZZZZZZZZZZZZZZZZe4);$ZZZZZZZZZZZZZZZZZZZZf5 = ZZZZZZZZZZo14::load('common', 'common');$this->view_object_map['commonConfig'] = $ZZZZZZZZZZZZZZZZZZZZf5;if($_REQUEST['parenttab'] == "settings"){}else{$ZZZZZZZZZZZZZZZZZZb1 = ZZZZZZZZZZZZZZZZZN1313::ZZZZZZZZZZZZZZZZZY2424($ZZZZZZZZZZj9, $db);$ZZZZZZZZZZZZZZZZZZb1 = ZZZZZZZZZZZZZZZZZN1313::ZZZZZZZZZZZZZZZZZZa0($ZZZZZZZZZZZZZZZZZZb1);$ZZZZI88 = $db->ZZZZF55('id, title', 'visible=1', 'title ASC');$ZZZZI88 = ZZZZZZZZZZZZZZZZZN1313::ZZZZZZZZZZZZZZZZZZk10($ZZZZI88);$this->view_object_map['modulesFields'] = json_encode($ZZZZZZZZZZZZZZZZZZb1);$this->view_object_map['categories'] = json_encode($ZZZZI88);$ZZZZZZZZZZZZZZZZZZZZg6 = ZZZZZZZZZZo14::load('reportBuilder', 'common');$this->view_object_map['reportTypes'] = json_encode($ZZZZZZZZZZZZZZZZZZZZg6['reportTypes']);$this->view_object_map['relationTypes'] = json_encode($ZZZZZZZZZZZZZZZZZZZZg6['relationTypes']);$this->view_object_map['internal'] = json_encode($ZZZZZZZZZZZZZZZZZZZZg6['internal']);}} function action_Toggle() {global $current_user, $mod_strings, $app_strings;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);if(is_admin($current_user)){if(isset($_REQUEST["record"]) && isset($_REQUEST["key"]) && isset($_REQUEST["value"])) {$ZZZZO1414 = $_REQUEST["record"];$Zu20 = $_REQUEST["key"];$value = $_REQUEST["value"];$db->ZZZZN1313($ZZZZO1414, $Zu20, $value);}} header("Location: " . $_SERVER["HTTP_REFERER"]);exit;} function action_settings() {global $mod_strings, $app_strings;$this->view = 'settings';$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZv21 = new ZV2121($db);$this->view_object_map['response'] = "";if(isset($_POST["key"]) && !empty($_POST["key"])) {$ZZv21->ZZs18("key", $_POST["key"]);$this->view_object_map['response'] = "Settings saved!";} $this->view_object_map['MOD'] = $mod_strings;$this->view_object_map['APP'] = $app_strings;$this->view_object_map['DICTIONARY'] = json_encode($mod_strings);$ZZZZZZZZZZZZZZZZZZZZf5 = ZZZZZZZZZZo14::load('common', 'common');$this->view_object_map['commonConfig'] = $ZZZZZZZZZZZZZZZZZZZZf5;} function action_Delete() {global $current_user, $mod_strings, $app_strings;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZS1818 = new ZZZZT1919();$ZZZZZZZZZZZZZZZZZZq16 = new ZZZZZZZZZZZZZZZZZc2($db,$ZZZZS1818);$ZZZZZZZZZZZZZZZZZZZE44 = $ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZp15($current_user,(int)$_REQUEST["record"]);if($ZZZZZZZZZZZZZZZZZZZE44>1){$db->deleteReport((int)$_REQUEST["record"]);} header("Location:index.php?module=AnalyticReporting");exit;} function action_saveReport() {global $current_user, $mod_strings, $app_strings;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZS1818 = new ZZZZT1919();$module = "AnalyticReporting";$this->ZZZZZZZZZZZZZZZZZZZu20();$ZZZc2 = html_entity_decode($_POST['columns']);$filters = html_entity_decode($_POST['filters']);$ZZZG66 = html_entity_decode($_POST['grouping']);$ZZZH77 = html_entity_decode($_POST['aggregates']);$ZZZI88 = html_entity_decode($_POST['totalAggregates']);$ZZZJ99 = html_entity_decode($_POST['options']);$ZZZK1010 = html_entity_decode($_POST['labels']);$ZZZL1111 = html_entity_decode($_POST['chartSettings']);$ZZZZZZZZZZZZZZZZZZq16 = new ZZZZZZZZZZZZZZZZZc2($db, $ZZZZS1818);$ZZZZZZZZZZZZZZZZZZZE44 = $ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZp15($current_user,(int)$_REQUEST["record"]);if($ZZZZZZZZZZZZZZZZZZZE44<2){$ZZZZS1818->ZZZZZg6();die;} function ZZZZZZZZZZZZZZZZZZZT1919($ZZZZZZZZZZZZZZZZZZq16,$id,$ZZZF55){global $_POST;$ZZZZZZZZZZZZZZZZZZZU2020 = $_POST["isScheduled"];if($ZZZZZZZZZZZZZZZZZZZU2020 == "1"){$ZZZZZZZZZZZZZZZZZZZV2121 = (isset($_POST["scheduledRecipients"]))?($_POST["scheduledRecipients"]):(array());$ZZZZZZZZZZZZZZZZZJ99 = (isset($_POST["intervalOptions"]))?($_POST["intervalOptions"]):(array());$ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZG66($id,$_POST["interval"],$_POST["intervalH"],$_POST["intervalM"],$ZZZZZZZZZZZZZZZZZJ99,$ZZZF55,$_POST["scheduledFormats"]);$ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZs18($id,$ZZZZZZZZZZZZZZZZZZZV2121);}else{$ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZt19($id);}} if(isset($_REQUEST["saveAs"])&&$_REQUEST["saveAs"]==1){$title = $_POST['title'];$description = $_POST['description'];$ZZZD33 = $_POST['globalSharing'];$ZZZE44 = $_POST['globalSharingRights'];$ZZZZZZZZZZZZZZZZZZZS1818 = json_decode($_POST['userSharing'],true);$ZZZF55 = $_POST['owner'];$ZZZZZZZZZZZZZZZZZZZZh7 = $db->loadReport((int)$_REQUEST["record"]);$ZZZM1212 = (isset($_POST['calcFields']))?$_POST['calcFields']:"[]";$ZZZR1717 = null;$isCombined = 0;if(isset($_REQUEST["combined"])&&$_REQUEST["combined"]==1){$ZZZR1717 = $_POST["combinedSelectedFields"];$isCombined = 1;} $id = $db->ZZZO1414($ZZZZZZZZZZZZZZZZZZZZh7["module"], $_POST["reportFolder"], json_encode($ZZZZZZZZZZZZZZZZZZZZh7["related_data"]),$ZZZc2, $filters, $ZZZG66, $ZZZH77, $ZZZI88, $ZZZJ99, $ZZZK1010, $title, $description, $ZZZL1111,$ZZZD33,$ZZZE44,$ZZZF55,$ZZZM1212,$isCombined,$ZZZR1717);$ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZq16($id,$ZZZZZZZZZZZZZZZZZZZS1818);ZZZZZZZZZZZZZZZZZZZT1919($ZZZZZZZZZZZZZZZZZZq16,$id,$ZZZF55);echo json_encode(array("id" => $id, "msg" => "".$ZZZZS1818->ZZZZZk10('label_new_report_saved', $module)));exit;}elseif(isset($_REQUEST["changeTitle"])&&$_REQUEST["changeTitle"]==1){$id = $_REQUEST["record"];$db->ZZZZd3($id,$_REQUEST["title"],$_REQUEST["description"]);}else{$ZZZD33 = $_POST['globalSharing'];$ZZZE44 = $_POST['globalSharingRights'];$ZZZZZZZZZZZZZZZZZZZS1818 = json_decode($_POST['userSharing'],true);$ZZZF55 = $_POST['owner'];$id = (int) $_REQUEST["record"];$ZZZR1717 = null;$ZZZM1212 = (isset($_POST['calcFields']))?$_POST['calcFields']:"[]";if(isset($_REQUEST["combined"])&&$_REQUEST["combined"]==1){$ZZZR1717 = $_POST["combinedSelectedFields"];} $db->saveReport($id, $ZZZc2, $filters, $ZZZG66, $ZZZH77, $ZZZI88, $ZZZJ99, $ZZZK1010, $ZZZL1111,$ZZZD33,$ZZZE44,$ZZZF55,$ZZZM1212,$ZZZR1717);$ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZq16($id,$ZZZZZZZZZZZZZZZZZZZS1818);ZZZZZZZZZZZZZZZZZZZT1919($ZZZZZZZZZZZZZZZZZZq16,$id,$ZZZF55);echo $ZZZZS1818->ZZZZZk10('label_saved', $module);} exit;} function action_makePDF() {global $current_user, $mod_strings, $app_strings;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZv21 = new ZV2121($db);$this->ZZZZZZZZZZZZZZZZZZZu20();$_REQUEST['file'] = 'makePDF';$r17 = retrieveData($adb);$ZZZZZZZZZZZZZZZZZZm12 = false;$ZZZZS1818 = new ZZZZT1919();$ZZZZZZZZZZZZZZZZZZI88 = $ZZZZS1818->ZZZZX2323($current_user);$ZZZZZZZZZZZZZZZZZZJ99 = $ZZZZZZZZZZZZZZZZZZI88['decimal'];$ZZZZZZZZZZZZZZZZZZK1010 = $ZZZZZZZZZZZZZZZZZZI88['seperator'];$ZZZJ99 = ($ZZZZZZZZZZZZZZZZZZm12)?json_decode($ZZZZZZZZZZZZZZZZZZn13["options"]):json_decode($_POST["options"]);if(empty($ZZZZZZZZZZZZZZZZZZn13["labels"])) {$ZZZZZZZZZZZZZZZZZZn13["labels"] = "[]";} $ZZZK1010 = ($ZZZZZZZZZZZZZZZZZZm12)? json_decode($ZZZZZZZZZZZZZZZZZZn13["labels"], true):json_decode($_POST["labels"], true);$ZZZI88 = ($ZZZZZZZZZZZZZZZZZZm12)?json_decode($ZZZZZZZZZZZZZZZZZZn13["totalAggregates"]):json_decode($_POST["totalAggregates"]);$ZZZZZZZZZZZZZZZZZZZZi8 = array();foreach ($ZZZI88 as $Zu20 => $value) {foreach ($value as $ZZZZZZZZZZZZZZZZZZZZj9 => $ZZZZZZZZZZZZZZZZZZZZk10) {if($ZZZZZZZZZZZZZZZZZZZZk10) $ZZZZZZZZZZZZZZZZZZZZi8[] = $Zu20.($ZZZZZZZZZZZZZZZZZZZZj9=='count'?'_cnt':'_sum');}} $ZZZZZZZZZZZZZZZZZZZZl11 = "Grand Total";if(isset($ZZZK1010["grandTotal"])) {$ZZZZZZZZZZZZZZZZZZZZl11 = $ZZZK1010["grandTotal"];} $ZZZZZZZZZZZv21 = PlatformConnector::ZZZZZZz25();if(count($ZZZZZZZZZZZZZZZZZZZZi8) > 0 && !$ZZZJ99->aggregateColumn){$ZZZZZZZZZZZZZZZZZZZZm12 = array();foreach ($r17['data'] as $Zu20 => $value) {foreach ($value as $ZZZZZZZZZZZZZZZZZZZZn13 => $ZZZZZZZZZZZZZZZZZZZZo14) {if(!isset($ZZZZZZZZZZZZZZZZZZZZm12[$ZZZZZZZZZZZZZZZZZZZZn13]) && (in_array(preg_replace('/[v]\d+[_]/', '', $ZZZZZZZZZZZZZZZZZZZZn13), $ZZZZZZZZZZZZZZZZZZZZi8) || in_array(preg_replace('/[v]\d+[_]/', '', $ZZZZZZZZZZZZZZZZZZZZn13)."_sum", $ZZZZZZZZZZZZZZZZZZZZi8) || in_array(preg_replace('/[v]\d+[_]/', '', $ZZZZZZZZZZZZZZZZZZZZn13)."_cnt", $ZZZZZZZZZZZZZZZZZZZZi8))){$ZZZZZZZZZZZZZZZZZZZZm12[$ZZZZZZZZZZZZZZZZZZZZn13] = 0;} if(substr($ZZZZZZZZZZZZZZZZZZZZo14, 0, 10) != "<SubTotal>" && (preg_match('/^\d+\.\d+$/', $ZZZZZZZZZZZZZZZZZZZZo14) || is_numeric($ZZZZZZZZZZZZZZZZZZZZo14)) && substr($ZZZZZZZZZZZZZZZZZZZZn13, -4) != "_avg" && (in_array(preg_replace('/[v]\d+[_]/', '', $ZZZZZZZZZZZZZZZZZZZZn13), $ZZZZZZZZZZZZZZZZZZZZi8) || in_array(preg_replace('/[v]\d+[_]/', '', $ZZZZZZZZZZZZZZZZZZZZn13)."_sum", $ZZZZZZZZZZZZZZZZZZZZi8))){$ZZZZZZZZZZZZZZZZZZZZm12[$ZZZZZZZZZZZZZZZZZZZZn13] = number_format($ZZZZZZZZZZZZZZZZZZZZm12[$ZZZZZZZZZZZZZZZZZZZZn13]+$ZZZZZZZZZZZZZZZZZZZZo14,$ZZZZZZZZZZZv21,".","");}elseif(substr($ZZZZZZZZZZZZZZZZZZZZo14, 0, 10) != "<SubTotal>" && in_array(preg_replace('/[v]\d+[_]/', '', $ZZZZZZZZZZZZZZZZZZZZn13)."_cnt", $ZZZZZZZZZZZZZZZZZZZZi8) && !preg_match('/^\d+\.\d+$/', $ZZZZZZZZZZZZZZZZZZZZo14) && !is_numeric($ZZZZZZZZZZZZZZZZZZZZo14)) {$ZZZZZZZZZZZZZZZZZZZZm12[$ZZZZZZZZZZZZZZZZZZZZn13]++;}}} $ZZZZZZZZZZZZZZZZZZZZm12[key($r17["cols"])] = $ZZZZZZZZZZZZZZZZZZZZl11;$r17['data'][] = $ZZZZZZZZZZZZZZZZZZZZm12;}elseif($ZZZJ99->aggregateColumn) {$ZZZZZZZZZZZZZZZZZZZZm12 = array();foreach ($r17['data'] as $Zu20 => $value) {$r17['data'][$Zu20]["grand_total"] = 0;foreach ($value as $ZZZZZZZZZZZZZZZZZZZZn13 => $ZZZZZZZZZZZZZZZZZZZZo14) {if(preg_match('/[v]\d+[_]/', $ZZZZZZZZZZZZZZZZZZZZn13)) $r17['data'][$Zu20]["grand_total"] += $ZZZZZZZZZZZZZZZZZZZZo14;}} $r17["cols"]["grand_total"] = $ZZZZZZZZZZZZZZZZZZZZl11;} foreach ($r17['data'] as $Zu20 => $value) {foreach ($value as $ZZZZZZZZZZZZZZZZZZZZn13 => $ZZZZZZZZZZZZZZZZZZZZo14) {if($r17['pdffields'][$ZZZZZZZZZZZZZZZZZZZZn13]=='txt'){continue;} if(is_numeric($ZZZZZZZZZZZZZZZZZZZZo14) && substr($ZZZZZZZZZZZZZZZZZZZZn13, -4) != "_cnt" && !in_array($ZZZZZZZZZZZZZZZZZZZZn13."_cnt", $ZZZZZZZZZZZZZZZZZZZZi8) && (!array_key_exists($ZZZZZZZZZZZZZZZZZZZZn13, $r17['pdffields']) || $r17['pdffields'][$ZZZZZZZZZZZZZZZZZZZZn13]!='integer') && (!array_key_exists('aggregates', $value) || !array_key_exists($value['aggregates'], $r17['pdffields']) || $r17['pdffields'][$value['aggregates']]!='integer')){$r17['data'][$Zu20][$ZZZZZZZZZZZZZZZZZZZZn13] = number_format($ZZZZZZZZZZZZZZZZZZZZo14,$ZZZZZZZZZZZv21,$ZZZZZZZZZZZZZZZZZZJ99,$ZZZZZZZZZZZZZZZZZZK1010);}elseif(is_numeric($ZZZZZZZZZZZZZZZZZZZZo14)){$r17['data'][$Zu20][$ZZZZZZZZZZZZZZZZZZZZn13] = number_format($ZZZZZZZZZZZZZZZZZZZZo14,$ZZZZZZZZZZZv21,$ZZZZZZZZZZZZZZZZZZJ99,$ZZZZZZZZZZZZZZZZZZK1010);}}} $ZZZZZZZZZZZd3 = array_keys($r17["cols"]);$ZZZZZZZZZZZZZZZZZZT1919 = count($ZZZZZZZZZZZd3);$ZZZZZZZZZZZZZZZZZZU2020 = ZZZZZZZZZZZZZZZZZZS1818($r17);$ZZZZZZZZZZZZZZZZZZW2222 = $ZZZZZZZZZZZZZZZZZZT1919 * 70;list($ZZZZZZZZZZZZZZZZZZX2323,$ZZZZZZZZZZZZZZZZZZY2424) = ZZZZZZZZZZZZZZZZZZV2121($ZZZZZZZZZZZZZZZZZZW2222);ini_set("memory_limit","256M");require_once('modules/AnalyticReporting/lib/tcpdf/tcpdf.php');$pdf = new TCPDF($ZZZZZZZZZZZZZZZZZZX2323, "mm", $ZZZZZZZZZZZZZZZZZZY2424, true, 'UTF-8', false);$pdf->SetCreator("IT Sapiens");$pdf->SetAuthor('IT Sapiens');$pdf->SetTitle($r17["title"]);$pdf->SetSubject($r17["title"]);$pdf->SetKeywords('Report');$pdf->SetDefaultMonospacedFont(PDF_FONT_MONOSPACED);$pdf->SetMargins(PDF_MARGIN_LEFT, PDF_MARGIN_TOP, PDF_MARGIN_RIGHT);$pdf->SetAutoPageBreak(true, PDF_MARGIN_BOTTOM);$pdf->setFontSubsetting(true);$ZZZZZZZZZZZZZZZZZZZZp15 = $ZZv21->getValue('pdfFontFamily');if(!$ZZZZZZZZZZZZZZZZZZZZp15) {die("No PDF font files found, please download.");} $pdf->SetFont($ZZZZZZZZZZZZZZZZZZZZp15, '', 9, '', true);unset($r17);$pdf->AddPage();$pdf->writeHTMLCell(0, 0, '', '', $ZZZZZZZZZZZZZZZZZZU2020, 0, 1, 0, true, '', true);$pdf->Output('Report.pdf', 'D');exit;} function action_makeXLS() {global $current_user, $mod_strings, $app_strings;$adb = DBManagerFactory::getInstance();$this->ZZZZZZZZZZZZZZZZZZZu20();$r17 = retrieveData($adb);$ZZZZZZZZZZZZZZZZZZQ1616 = ZZZZZZZZZZZZZZZZZZP1515($r17);header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');header('Content-Disposition: attachment;filename="Report.xlsx"');header('Cache-Control: max-age=1');header ('Expires: Mon, 26 Jul 1997 05:00:00 GMT');header ('Last-Modified: '.gmdate('D, d M Y H:i:s').' GMT');header ('Cache-Control: cache, must-revalidate');header ('Pragma: public');$ZZZZZZZZZZZZZZZZZZZZq16 = PHPExcel_IOFactory::createWriter($ZZZZZZZZZZZZZZZZZZQ1616, 'Excel2007');$ZZZZZZZZZZZZZZZZZZZZq16->save('php://output');exit;} function action_widget() {$ZZZZZZZZZZZZZZZZZZZZr17 = new Sugar_Smarty();global $current_user, $mod_strings, $app_strings;$adb = DBManagerFactory::getInstance();$ZZZZZZZZZZZZZD33 = PlatformConnector::ZZZZZZe4();$ZZZZZZZZZZZZZZZZZZZZr17->assign('MOD', $mod_strings);$ZZZZZZZZZZZZZZZZZZZZr17->assign('APP', $app_strings);$ZZZZZZZZZZZZZZZZZZZZs18 = 'false';if(isset($_REQUEST["fullScreen"]) && !empty($_REQUEST["fullScreen"])) {$ZZZZZZZZZZZZZZZZZZZZs18 = 'true';} $ZZZZZZZZZZZZZZZZZZZZr17->assign('fullScreen', $ZZZZZZZZZZZZZZZZZZZZs18);$db = new ZZp15($adb);$ZZZZS1818 = new ZZZZT1919();$ZZZZZZZZZZZZZZZZZZq16 = new ZZZZZZZZZZZZZZZZZc2($db,$ZZZZS1818);$ZZZZZZZZZZZZZZZZZZZZt19 = (int)$_REQUEST["record"];$ZZZZZZZZZZZZZZZZZZZE44 = $ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZp15($current_user, $ZZZZZZZZZZZZZZZZZZZZt19);if(!$ZZZZZZZZZZZZZZZZZZZE44){$ZZZZS1818->ZZZZZg6();die;} $ZZZZZZZZZZZZZZZZZZn13 = $db->loadReport($ZZZZZZZZZZZZZZZZZZZZt19);$module = new ZZZZZZZZZZx23($ZZZZZZZZZZZZZZZZZZn13["module"],$db,$ZZZZS1818);$ZZZZZZZZZZZZZZZZZZp15 = array();$isCombined = false;if(isset($ZZZZZZZZZZZZZZZZZZn13["iscombined"])&&$ZZZZZZZZZZZZZZZZZZn13["iscombined"] == 1){$isCombined = true;} $ZZT1919 = count($ZZZZZZZZZZZZZZZZZZn13["related_data"]);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZZZp15[] = new ZZZZZZZZZZu20($ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][0], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][1], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][2], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][3], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][4], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][5], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][6], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][7], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][8], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][9], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][10], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][11]);} $ZZZZZZZZZZZZZZZZZZZG66 = new ZZZZZZZZZZv21($ZZZZZZZZZZZZZZZZZZn13["module"], $ZZZZZZZZZZZZZZZZZZp15, $db, $ZZZZS1818, $isCombined);$ZZZZZZZZZZZZZZZZZZZH77 = json_decode($ZZZZZZZZZZZZZZZZZZn13["options"],true);$ZZZZZZZZZZZZZZZZZZZH77['isCombined'] = $isCombined;$ZZZZZZZZZZZZZZZZZZZZr17->assign("REPORTCOLUMNS",$ZZZZZZZZZZZZZZZZZZn13['fields']);$ZZZZZZZZZZZZZZZZZZZZr17->assign("REPORTFILTERS",$ZZZZZZZZZZZZZZZZZZn13['filters']);$ZZZZZZZZZZZZZZZZZZZZr17->assign("REPORTGROUPING",$ZZZZZZZZZZZZZZZZZZn13['grouping']);$ZZZZZZZZZZZZZZZZZZZZr17->assign("REPORTAGGREGATES",$ZZZZZZZZZZZZZZZZZZn13['aggregates']);$ZZZZZZZZZZZZZZZZZZZZr17->assign("REPORTTOTALAGGREGATES",$ZZZZZZZZZZZZZZZZZZn13['totalAggregates']);$ZZZZZZZZZZZZZZZZZZZZr17->assign("REPORTOPTIONS",json_encode($ZZZZZZZZZZZZZZZZZZZH77));$ZZZZZZZZZZZZZZZZZZZZr17->assign("REPORTLABELS", !empty($ZZZZZZZZZZZZZZZZZZn13['labels']) ? ($ZZZZZZZZZZZZZZZZZZn13['labels']) : json_encode(false));$ZZZZZZZZZZZZZZZZZZZZr17->assign("REPORTID",(int)$_REQUEST["record"]);$ZZZZZZZZZZZZZZZZZZZZr17->assign("REPORTTITLE", $ZZZZZZZZZZZZZZZZZZn13['title']);$ZZZZZZZZZZZZZZZZZZZZr17->assign("REPORTDESCRIPTION", $ZZZZZZZZZZZZZZZZZZn13['description']);$ZZZZZZZZZZZZZZZZZZZI88 = json_decode($ZZZZZZZZZZZZZZZZZZn13["chart"]);$ZZZZZZZZZZZZZZZZZZZZr17->assign("CHARTTITLE", json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartTitle)?($ZZZZZZZZZZZZZZZZZZZI88->chartTitle):("")));$ZZZZZZZZZZZZZZZZZZZZr17->assign("CHARTTYPE", json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartType)?($ZZZZZZZZZZZZZZZZZZZI88->chartType):("")));$ZZZZZZZZZZZZZZZZZZZZr17->assign("CHARTCUMULATED", json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartCumulated)?($ZZZZZZZZZZZZZZZZZZZI88->chartCumulated):(true)));if(isset($ZZZZZZZZZZZZZZZZZZZI88->chartSortableValues) && !empty($ZZZZZZZZZZZZZZZZZZZI88->chartSortableValues)){$ZZZZZZZZZZZZZZZZZZZJ99 = explode("_", $ZZZZZZZZZZZZZZZZZZZI88->chartAxisX);array_shift($ZZZZZZZZZZZZZZZZZZZJ99);$moduleName = array_shift($ZZZZZZZZZZZZZZZZZZZJ99);$fieldName = implode("_", $ZZZZZZZZZZZZZZZZZZZJ99);$ZZZZZZZZZZZZZy24 = $db->ZZN1313($fieldName, $moduleName);foreach($ZZZZZZZZZZZZZZZZZZZI88->chartSortableValues as &$ZZZZZZZZZZZZZZZZZZZK1010) {$ZZZZZZZZZZZZZZZZZZZK1010->value = $ZZZZZZZZZZZZZy24[$ZZZZZZZZZZZZZZZZZZZK1010->key];}} $ZZZZZZZZZZZZZZZZZZZZr17->assign("CHARTSORTABLEVALUES", json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartSortableValues)?($ZZZZZZZZZZZZZZZZZZZI88->chartSortableValues):(false)));$ZZZZZZZZZZZZZZZZZZZZr17->assign("CHARTLABELS",json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartLabels)?($ZZZZZZZZZZZZZZZZZZZI88->chartLabels):("")));$ZZZZZZZZZZZZZZZZZZZZr17->assign("CHARTAXISX", json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartAxisX)?($ZZZZZZZZZZZZZZZZZZZI88->chartAxisX):("")));$ZZZZZZZZZZZZZZZZZZZZr17->assign("CHARTAXISY", json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartAxisY)?($ZZZZZZZZZZZZZZZZZZZI88->chartAxisY):("")));$ZZZZZZZZZZZZZZZZZZZZr17->assign("CHARTAXISY2",json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartAxisY2)?($ZZZZZZZZZZZZZZZZZZZI88->chartAxisY2):("")));$ZZZZZZZZZZZZZZZZZZZZr17->assign("CHARTYAXISTYPE", json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartYAxisType)?($ZZZZZZZZZZZZZZZZZZZI88->chartYAxisType):("")));$ZZZZZZZZZZZZZZZZZZZZr17->assign("CHARTYAXIS2TYPE",json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartYAxis2Type)?($ZZZZZZZZZZZZZZZZZZZI88->chartYAxis2Type):("")));$ZZZZZZZZZZZZZZZZZZZZr17->assign("CHARTLEGEND",json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartLegend)?($ZZZZZZZZZZZZZZZZZZZI88->chartLegend):("")));$ZZZZZZZZZZZZZZZZZZZZr17->assign("CHARTSTACKED",json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartStacked)?($ZZZZZZZZZZZZZZZZZZZI88->chartStacked):(false)));$ZZZZZZZZZZZZZZZZZZZZr17->assign("CHARTBARS1STACKED",json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartBars1Stacked)?($ZZZZZZZZZZZZZZZZZZZI88->chartBars1Stacked):(false)));$ZZZZZZZZZZZZZZZZZZZZr17->assign("CHARTBARS2STACKED",json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartBars2Stacked)?($ZZZZZZZZZZZZZZZZZZZI88->chartBars2Stacked):(false)));$ZZZZZZZZZZZZZZZZZZZZr17->assign("CHARTSHOWPERCENTS", json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartShowPercents)?($ZZZZZZZZZZZZZZZZZZZI88->chartShowPercents):(false)));$ZZZZZZZZZZZZZZZZZZZZr17->assign("CHARTSHOWLABELS", json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartShowLabels)?($ZZZZZZZZZZZZZZZZZZZI88->chartShowLabels):(false)));$ZZZZZZZZZZZZZZZZZZZZr17->assign("CHARTSHOWZONELABELS", json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartShowZoneLabels)?($ZZZZZZZZZZZZZZZZZZZI88->chartShowZoneLabels):(false)));$ZZZZZZZZZZZZZZZZZZZZr17->assign("CHARTVALUEZONES", json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartValueZones)?($ZZZZZZZZZZZZZZZZZZZI88->chartValueZones):(false)));$ZZZZZZZZZZZZZZZZZZZZr17->assign("CHARTAXISXSEGMENT", json_encode(isset($ZZZZZZZZZZZZZZZZZZZI88->chartAxisXSegment)?($ZZZZZZZZZZZZZZZZZZZI88->chartAxisXSegment):(false)));$ZZZZZZZZZZZZZZZZZZZZr17->assign("NUMBERSETTINGS",json_encode($ZZZZS1818->ZZZZX2323($current_user)));$ZZZJ99 = json_decode($ZZZZZZZZZZZZZZZZZZn13["options"]);$ZZZJ99->aggregateColumn = false;$ZZZJ99->isCrosstab = false;$ZZZJ99->includeDetails = false;$ZZZZZZZZZZZZZZZZZZn13['isCombined'] = $ZZZJ99->isCombined;$ZZZZZZZZZZZZZZZZZZZZr17->assign("REPORTCOMBINED", $isCombined);$ZZZZZZZZZZZZZZZZZZZP1515 = array();if($isCombined){$ZZZZZZZZZZZZZZZZZZo14 = new ZZZZZZZZZZZZZZ2525($db, $ZZZZS1818);}else{$ZZZZZZZZZZZZZZZZZZo14 = new ZZZZZZZZZZZZZv21($db, $ZZZZS1818);} $ZZZZZZZZZZZZZZZZZZZZu20 = json_encode($ZZZZZZZZZZZZZZZZZZo14->ZZZZZZZZZZZZZA00($module, json_decode($ZZZZZZZZZZZZZZZZZZn13['fields']), json_decode($ZZZZZZZZZZZZZZZZZZn13["filters"]), $ZZZZZZZZZZZZZZZZZZp15, json_decode(json_encode($ZZZZZZZZZZZZZZZZZZZI88->chartGrouping),true), json_decode(json_encode($ZZZZZZZZZZZZZZZZZZZI88->chartAggregates),true), !$ZZZJ99->includeDetails, $ZZZJ99->isCrosstab, true, $ZZZJ99->aggregateColumn, $ZZZZS1818->ZZZZZe4($current_user), true, isset($ZZZZZZZZZZZZZZZZZZn13['calcFields']) ? json_decode($ZZZZZZZZZZZZZZZZZZn13['calcFields'], true) : array(), array(), $ZZZZZZZZZZZZZD33));$ZZZZZZZZZZZZZZZZZZZZr17->assign("CHARTDATA", $ZZZZZZZZZZZZZZZZZZZZu20);$ZZZZZZZZZZZZZZZZZZZZr17->display('modules/AnalyticReporting/Dashlets/WidgetDashlet/WidgetDashlet.tpl');exit;} function action_addToDashboard() {global $sugar_flavor;if($sugar_flavor == 'CE') {$this->ZZZZZZZZZZZZZZZZZZZZv21();} else {$this->ZZZZZZZZZZZZZZZZZZZZw22();}} function ZZZZZZZZZZZZZZZZZZZZw22() {global $current_user, $mod_strings, $sugar_config;;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZS1818 = new ZZZZT1919();$this->ZZZZZZZZZZZZZZZZZZZu20();$title	= $_REQUEST['title'];$ZZZZO1414	= $_REQUEST['record'];$ZZZZZZZZZZZZZZZZZZZZx23 = 'Home';$ZZZa0 = PlatformConnector::ZZZb1('Dashboards');$ZZZZZZZZZZZZZZZZZZZB11 = "dashboards.assigned_user_id = '".$current_user->id."' AND dashboards.deleted = 0 AND dashboards.dashboard_module = 'Home' AND dashboards.dashboard_type = 'dashboard'";$ZZZZZZZZZZZZZZZZZZZZy24 = $ZZZa0->get_list("", $ZZZZZZZZZZZZZZZZZZZB11);if(count($ZZZZZZZZZZZZZZZZZZZZy24['list'] > 0)) {$ZZZZZZZZZZZZZZZZZZZZz25 = $ZZZZZZZZZZZZZZZZZZZZy24['list'][0];} else {echo "Available dashboards not found";die;} $ZU2020 = SugarConfig::getInstance();$url = $ZU2020->get('site_url') . '/';if(empty($title)) {$title = "Analytic reporting widget";} $r17 = json_decode(html_entity_decode($ZZZZZZZZZZZZZZZZZZZZz25->metadata), true);$r17['components'][0]['rows'][] = array(array('width' => 12, 'context' => array('module' => 'Home', 'link' => null,), 'view' => array('url' => $url . 'index.php?entryPoint=analyticReportWidget&record=' . $ZZZZO1414, 'module' => "Home", 'limit' => 10, 'label' => $title, 'type' => "webpage",)));$ZZZZZZZZZZZZZZZZZZZZz25->metadata = json_encode($r17);$ZY2424 = $ZZZZZZZZZZZZZZZZZZZZz25->save();if($ZY2424) {echo "Chart added to dashboard with id: " . $ZY2424;} die;} function ZZZZZZZZZZZZZZZZZZZZv21() {global $current_user, $sugar_config;$ZZZZZZZZZZZZZZZZZZZZx23 = 'Home';$ZZZZW2222 = $current_user;if(!is_file(sugar_cached('dashlets/dashlets.php'))) {require_once('include/Dashlets/DashletCacheBuilder.php');$ZZZZZZZZZZZZZZZZZZZZA00 = new DashletCacheBuilder();$ZZZZZZZZZZZZZZZZZZZZA00->buildCache();} require sugar_cached('dashlets/dashlets.php');$this->ZZZZZZZZZZZZZZZZZZZu20();$title	= empty($_REQUEST['title']) ? "Analytic reporting widget" : $_REQUEST['title'];$ZZZC22 = $_REQUEST['record'];$ZZZZZZZZZZZZZZZZZZZZB11 = 'iFrameDashlet';$ZZZZZZZZZZZZZZZZZZZZC22 = 0;$ZZZZZZZZZZZZZZZZZZZZD33 = $sugar_config['site_url']."/index.php?module=AnalyticReporting&action=widget&record=".$ZZZC22;$ZZZZZZZZZZZZZZZZZZZZE44 = create_guid();$ZZZZZZZZZZZZZZZZZZZZF55 = $ZZZZW2222->getPreference('dashlets', $ZZZZZZZZZZZZZZZZZZZZx23);$ZZZZZZZZZZZZZh7 = $ZZZZW2222->getPreference('pages', $ZZZZZZZZZZZZZZZZZZZZx23);$ZZZJ99 = array('url' => $ZZZZZZZZZZZZZZZZZZZZD33, 'title' => $title);$ZZZZZZZZZZZZZZZZZZZZF55[$ZZZZZZZZZZZZZZZZZZZZE44] = array('className' => $dashletsFiles[$ZZZZZZZZZZZZZZZZZZZZB11]['class'], 'module' => $ZZZZZZZZZZZZZZZZZZZZx23, 'options' => $ZZZJ99, 'fileLocation' => $dashletsFiles[$ZZZZZZZZZZZZZZZZZZZZB11]['file']);if(!isset($ZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZZZZZZZC22]['columns'][0]['dashlets'])){return true;} array_unshift($ZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZZZZZZZC22]['columns'][0]['dashlets'], $ZZZZZZZZZZZZZZZZZZZZE44);$ZZZZW2222->setPreference('dashlets', $ZZZZZZZZZZZZZZZZZZZZF55, 0, $ZZZZZZZZZZZZZZZZZZZZx23);$ZZZZW2222->setPreference('pages', $ZZZZZZZZZZZZZh7, 0, $ZZZZZZZZZZZZZZZZZZZZx23);$ZZZZW2222->savePreferencesToDB();die();} function action_downloadFontCheck() {$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZv21 = new ZV2121($db);$ZZZZZZZZZZZZZZZZZP1515 = array("messages" => array(),);$ZZZZZZZZZZZZZZZZZZZZp15 = $ZZv21->getValue('pdfFontFamily');if($ZZZZZZZZZZZZZZZZZZZZp15) {$ZZZZZZZZZZZZZZZZZZZZG66 = "modules/AnalyticReporting/lib/tcpdf/fonts/";if(FunctionWrapper::_file_exists($ZZZZZZZZZZZZZZZZZZZZG66 . $ZZZZZZZZZZZZZZZZZZZZp15 . ".php")) {$ZZZZZZZZZZZZZZZZZZZZH77 = new ZZZZZZZZZZZZZZZZZZZe4();$ZZZZZZZZZZZZZZZZZZZZI88 = $ZZZZZZZZZZZZZZZZZZZZH77->retrieve($ZZv21->getValue('apiEndpoint') . "fonts/list", true);$ZZZZZZZZZZZZZZZZZZZZJ99 = false;foreach($ZZZZZZZZZZZZZZZZZZZZI88['files'] as $ZZZZZZZZZZZZZZZZZZZZK1010 => $ZZZZZZZZZZZZZZZZZZZZL1111) {if(FunctionWrapper::_file_exists($ZZZZZZZZZZZZZZZZZZZZG66 . $ZZZZZZZZZZZZZZZZZZZZK1010)) {if(md5_file($ZZZZZZZZZZZZZZZZZZZZG66 . $ZZZZZZZZZZZZZZZZZZZZK1010) != $ZZZZZZZZZZZZZZZZZZZZL1111) {$ZZZZZZZZZZZZZZZZZP1515["messages"][] = "File {$ZZZZZZZZZZZZZZZZZZZZG66}{$ZZZZZZZZZZZZZZZZZZZZK1010} have invalid checksum ({$ZZZZZZZZZZZZZZZZZZZZL1111})";$ZZZZZZZZZZZZZZZZZZZZJ99 = true;}} else {$ZZZZZZZZZZZZZZZZZZZZJ99 = true;}} if($ZZZZZZZZZZZZZZZZZZZZJ99) {$ZZZZZZZZZZZZZZZZZP1515["status"] = false;$ZZZZZZZZZZZZZZZZZP1515["error"] = "Fonts files should be downloaded, because checksum is different.";} else {$ZZZZZZZZZZZZZZZZZP1515["status"] = true;}} else {$ZZZZZZZZZZZZZZZZZP1515["status"] = false;$ZZZZZZZZZZZZZZZZZP1515["error"] = "Fonts files should be downloaded, because not found.";}} else if (isset($_SESSION["downloadFontProgress"]) && $_SESSION["downloadFontProgress"]) {$ZZZZZZZZZZZZZZZZZP1515["status"] = false;$ZZZZZZZZZZZZZZZZZP1515["error"] = "Font downloading failed. Please check module directory write permissions and try again.";unset($_SESSION["downloadFontProgress"]);} else {$ZZZZZZZZZZZZZZZZZP1515["status"] = false;$ZZZZZZZZZZZZZZZZZP1515["error"] = "Installation provided without PDF fonts, for smaller module file upload. Please download fonts, to successfully export PDF files.<br /><br /> This can take some time, depending on your internet connection.";} unset($_SESSION["downloadFontProgress"]);echo json_encode($ZZZZZZZZZZZZZZZZZP1515);die;} function action_downloadFont() {$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZv21 = new ZV2121($db);$ZZZZZZZZZZZZZZZZZP1515 = array();$ZZZZZZZZZZZZZZZZZZZZM1212 = array();$_SESSION["downloadFontProgress"] = true;$ZZZZZZZZZZZZZZZZZZZZH77 = new ZZZZZZZZZZZZZZZZZZZe4();$ZZZZZZZZZZZZZZZZZZZZI88 = $ZZZZZZZZZZZZZZZZZZZZH77->retrieve($ZZv21->getValue('apiEndpoint') . "fonts/list", true);if(isset($ZZZZZZZZZZZZZZZZZZZZI88['files']) && isset($ZZZZZZZZZZZZZZZZZZZZI88['path'])) {$ZZZZZZZZZZZZZZZZZZZZG66 = "modules/AnalyticReporting/lib/tcpdf/fonts/";@FunctionWrapper::_chmod($ZZZZZZZZZZZZZZZZZZZZG66, 0777);$ZZZZZZZZZZZZZZZZZZZf5 = 0;foreach($ZZZZZZZZZZZZZZZZZZZZI88['files'] as $ZZZZZZZZZZZZZZZZZZZZK1010 => $ZZZZZZZZZZZZZZZZZZZZL1111) {if(!FunctionWrapper::_file_exists($ZZZZZZZZZZZZZZZZZZZZG66 . $ZZZZZZZZZZZZZZZZZZZZK1010)) {if(md5_file($ZZZZZZZZZZZZZZZZZZZZG66 . $ZZZZZZZZZZZZZZZZZZZZK1010) == $ZZZZZZZZZZZZZZZZZZZZL1111) {$ZZZZZZZZZZZZZZZZZZZZM1212[] = "File {$ZZZZZZZZZZZZZZZZZZZZG66}{$ZZZZZZZZZZZZZZZZZZZZK1010} have valid checksum ({$ZZZZZZZZZZZZZZZZZZZZL1111})";continue;}} $ZZZZZZZZZZZZZZZZZZZZN1313 = $ZZZZZZZZZZZZZZZZZZZZH77->retrieve($ZZZZZZZZZZZZZZZZZZZZI88['path'] . $ZZZZZZZZZZZZZZZZZZZZK1010, false, false);$ZY2424 = FunctionWrapper::_file_put_contents($ZZZZZZZZZZZZZZZZZZZZG66 . $ZZZZZZZZZZZZZZZZZZZZK1010, $ZZZZZZZZZZZZZZZZZZZZN1313);if(md5_file($ZZZZZZZZZZZZZZZZZZZZG66 . $ZZZZZZZZZZZZZZZZZZZZK1010) != $ZZZZZZZZZZZZZZZZZZZZL1111) {$ZZZZZZZZZZZZZZZZZZZZM1212[] = "File {$ZZZZZZZZZZZZZZZZZZZZG66}{$ZZZZZZZZZZZZZZZZZZZZK1010} have invalid checksum ({$ZZZZZZZZZZZZZZZZZZZZL1111})";$ZY2424 = false;} if(!$ZY2424) {$ZZZZZZZZZZZZZZZZZZZf5++;}}} if(isset($ZZZZZZZZZZZZZZZZZZZZI88["fontFamily"]) && empty($ZZZZZZZZZZZZZZZZZZZf5)) {if(!FunctionWrapper::_is_file($ZZZZZZZZZZZZZZZZZZZZG66 . $ZZZZZZZZZZZZZZZZZZZZI88["fontFamily"] . ".php")) {return false;} $ZZv21->ZZs18("pdfFontFamily", $ZZZZZZZZZZZZZZZZZZZZI88["fontFamily"]);unset($_SESSION["downloadFontProgress"]);$ZZZZZZZZZZZZZZZZZP1515["status"] = true;} else {$ZZZZZZZZZZZZZZZZZP1515["status"] = false;} $ZZZZZZZZZZZZZZZZZP1515["messages"] = $ZZZZZZZZZZZZZZZZZZZZM1212;echo json_encode($ZZZZZZZZZZZZZZZZZP1515);die;}}